<!DOCTYPE html>
<html>
  <head>
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta http-equiv="Content-Type" content="text/html; charset=Windows-1252" />
  <title>CopyTicks</title>
  <meta name="keywords" content="CopyTicks" />
  <link type="text/css" href="default.css" rel="stylesheet" />
  <link type="text/css" href="screenshot.css" rel="stylesheet" />
  

   
   
   


</head>

<body style="background-color:#FFFFFF; font-family:'Trebuchet MS',Tahoma,Arial,Helvetica,sans-serif; margin:0px;">



<table width="100%" height="49"  border="0" cellpadding="0" cellspacing="0" style="margin-top:0px; background-color:#1660af;">
  <tr>
    <td></td>
    <td valign="middle">
      <table style="margin-top:4px; margin-bottom:5px;" width="100%"  border="0" cellspacing="0" cellpadding="5">
        <tr valign="middle">
          <td class="nav">
<a class="h_m" href="index.htm">          MQL5 Reference </a> / <a class="h_m" href="matrix.htm"> Matrix and Vector Methods </a> / <a class="h_m" href="matrix_initialization.htm"> Initialization </a>/ CopyTicks
          </td>
          <td width="70" align="right">
          <a href="matrix_copyrates.htm"><img style="vertical-align:middle;" src="previous.png" alt="Previous" width="27" height="27" border=0></a>&nbsp;
          <a href="matrix_copyticksrange.htm"><img style="vertical-align:middle;" src="next.png" alt="Next" width="27" height="27" border="0"></a>
          </td>
        </tr>
      </table>
    </td>
    <td width="5"></td>
  </tr>
</table>



<div id="help">
<p class="p_H1"><span class="f_H1">CopyTicks</span></p>
<p class="p_Function"><span class="f_Function">Get ticks from an </span><span class="f_ParameterDesrciption"><a href="mqltick.htm" class="topiclink">MqlTick</a> structure into a matrix or a vector.</span><span class="f_Function"> Elements are counted from the past to the present, which means that the tick with index 0 is the oldest one. To analyze a tick, check the </span><span class="f_Function" style="font-style: italic;"><a href="matrix_copyticks.htm#flags" class="topiclink">flags</a></span><span class="f_Function"> field which shows what exactly has changed in the tick.</span></p>
<div style="text-align: left; text-indent: 0; line-height: 1.0; page-break-inside: avoid; border-color: #b3b3b3; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0 0 0 0; margin: 2px 17px 2px 17px;"><table cellspacing="0" cellpadding="3" border="0" style="text-align: justify;border:none; border-spacing:0;">
<tr>
<td style="vertical-align:top; padding:3px; border:none"><p class="p_CodeExample" style="page-break-inside: avoid;"><span class="f_Keywords">bool&nbsp;&nbsp;matrix::</span><span class="f_Functions">CopyTicks</span><span class="f_CodeExample">(</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_Keywords">string</span><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_Param">symbol</span><span class="f_CodeExample">,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_Comments">//&nbsp;symbol&nbsp;name</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_Keywords">ulong</span><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_Param">flags</span><span class="f_CodeExample">,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_Comments">//&nbsp;flag&nbsp;indicating&nbsp;the&nbsp;type&nbsp;of&nbsp;ticks&nbsp;to&nbsp;be&nbsp;received&nbsp;</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_Keywords">ulong</span><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_Param">from_msc</span><span class="f_CodeExample">,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_Comments">//&nbsp;time&nbsp;from&nbsp;which&nbsp;ticks&nbsp;are&nbsp;requested</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_Keywords">ulong</span><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_Param">count&nbsp;</span><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_Comments">//&nbsp;number&nbsp;of&nbsp;ticks&nbsp;to&nbsp;be&nbsp;received</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;);</span></p>
</td>
</tr>
</table>
</div>
<p class="p_BoldTitles"><span class="f_BoldTitles">Vector Method</span></p>
<div style="text-align: left; text-indent: 0; line-height: 1.0; page-break-inside: avoid; border-color: #b3b3b3; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0 0 0 0; margin: 2px 17px 2px 17px;"><table cellspacing="0" cellpadding="3" border="0" style="text-align: justify;border:none; border-spacing:0;">
<tr>
<td style="vertical-align:top; padding:3px; border:none"><p class="p_CodeExample" style="page-break-inside: avoid;"><span class="f_Keywords">bool&nbsp;&nbsp;vector::</span><span class="f_Functions">CopyTicks</span><span class="f_CodeExample">(</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_Keywords">string</span><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_Param">symbol</span><span class="f_CodeExample">,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_Comments">//&nbsp;symbol&nbsp;name</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_Keywords">ulong</span><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_Param">flags</span><span class="f_CodeExample">,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_Comments">//&nbsp;flag&nbsp;indicating&nbsp;the&nbsp;type&nbsp;of&nbsp;ticks&nbsp;to&nbsp;be&nbsp;received&nbsp;</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_Keywords">ulong</span><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_Param">from_msc</span><span class="f_CodeExample">,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_Comments">//&nbsp;time&nbsp;from&nbsp;which&nbsp;ticks&nbsp;are&nbsp;requested</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_Keywords">ulong</span><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_Param">count&nbsp;</span><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_Comments">//&nbsp;number&nbsp;of&nbsp;ticks&nbsp;to&nbsp;be&nbsp;received</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;);</span></p>
</td>
</tr>
</table>
</div>
<p class="p_BoldTitles"><span class="f_BoldTitles">Parameters</span></p>
<p class="p_FunctionParameter"><span class="f_FunctionParameter">symbol</span></p>
<p class="p_ParameterDesrciption"><span class="f_ParameterDesrciption">[in] &nbsp;Symbol.</span></p>
<p class="p_FunctionParameter"><span class="f_FunctionParameter">flags</span></p>
<p class="p_ParameterDesrciption"><span class="f_ParameterDesrciption">[in] &nbsp;A combination of flags from the <a href="matrix_copyticks.htm#enum_copy_ticks" class="topiclink">ENUM_COPY_TICKS</a> enumeration indicating the contents of the requested data.</span><span class="f_Normal" style="font-family: 'Courier New',Courier,monospace; background-color: transparent;"> </span><span class="f_ParameterDesrciption">When copying to a vector, you can specify only one value from the ENUM_COPY_TICKS enumeration, otherwise an error will occur.</span></p>
<p class="p_FunctionParameter"><span class="f_FunctionParameter">from_msc</span></p>
<p class="p_ParameterDesrciption"><span class="f_ParameterDesrciption">[in] &nbsp;Time starting from which ticks are requested. Time is specified in milliseconds since 01/01/1970. If from_msc=0, the last number of ticks equal to 'count' are returned.</span></p>
<p class="p_FunctionParameter"><span class="f_FunctionParameter">count</span></p>
<p class="p_ParameterDesrciption"><span class="f_ParameterDesrciption">[in] &nbsp;The number of requested ticks. If parameters 'from_msc' and 'count' are not specified, all available ticks, but no more than 2000, will be written.</span></p>
<p class="p_FunctionParameter"><span class="f_FunctionParameter">&nbsp;</span></p>
<p class="p_BoldTitles"><span class="f_BoldTitles">Return Value</span></p>
<p class="p_FunctionRemark"><span class="f_FunctionRemark">Returns true on success or false if <a href="errorcodes.htm" class="topiclink">error</a> occurs.</span></p>
<p class="p_BoldTitles"><span class="f_BoldTitles">Note</span></p>
<p class="p_FunctionRemark"><span class="f_FunctionRemark">The first call of CopyTicks() initiates synchronization of the relevant symbol's tick database stored on the hard drive. If the local database does not provide all the requested ticks, then missing ticks will be automatically downloaded from the trade server. Ticks from </span><span class="f_FunctionRemark" style="font-style: italic; font-weight: bold;">from_msc</span><span class="f_FunctionRemark"> specified in CopyTicks() to the current moment will be synchronized. After that, all ticks arriving for this symbol will be added to the tick database thus keeping it in the synchronized state.</span></p>
<p class="p_FunctionRemark"><span class="f_FunctionRemark">If </span><span class="f_FunctionRemark" style="font-style: italic;">from_msc</span><span class="f_FunctionRemark"> and </span><span class="f_FunctionRemark" style="font-style: italic;">count</span><span class="f_FunctionRemark"> parameters are not specified, all available ticks, but no more than 2000, will be written to the matrix/vector. </span></p>
<p class="p_FunctionRemark"><span class="f_FunctionRemark" style="font-weight: bold;">In indicators, the CopyTicks() method returns the result immediately:</span><span class="f_FunctionRemark"> When called from an indicator, CopyTick() immediately returns all available ticks of a symbol and launches synchronization of the tick database if available data is not enough. All indicators on the same symbol operate in one common thread, so the indicator cannot wait for the completion of synchronization. After synchronization, CopyTicks() will return all requested ticks during the next call. In indicators, the <a href="oncalculate.htm" class="topiclink">OnCalculate()</a> function is called after the arrival of each tick. </span></p>
<p class="p_FunctionRemark"><span class="f_FunctionRemark" style="font-weight: bold;">In Expert Advisors and scripts, CopyTicks() can wait for the result for 45 seconds:</span><span class="f_FunctionRemark"> as distinct from indicators, every Expert Advisor or script operates in a separate thread, and therefore can wait up to 45 seconds for the synchronization to complete. If the required amount of ticks fails to be synchronized during this time, CopyTicks() will return available ticks by timeout and will continue synchronization. <a href="ontick.htm" class="topiclink">OnTick()</a> in Expert Advisors is not a handler of every tick, while it only notifies the Expert Advisor about changes in the market. This can be a batch of changes: the terminal can simultaneously receive multiple ticks, while OnTick() will be called only once, to notify the Expert Advisor about the latest market state. </span></p>
<p class="p_FunctionRemark"><span class="f_FunctionRemark" style="font-weight: bold;">Rate of data return:</span><span class="f_FunctionRemark"> the terminal stores 4096 last ticks for each instrument in the fast access cache (65536 ticks for symbols with the Market Depth running). Requests concerning this data are executed the fastest. If requested ticks for the current trading session are beyond the cache, CopyTicks() calls the ticks stored in the terminal memory. These requests require more time to complete. The slowest requests are those requesting ticks for other days, since the data is read from the drive in this case.</span></p>
<p class="p_BoldTitles"><span class="f_BoldTitles">&nbsp;</span></p>
<p class="p_BoldTitles"><a name="enum_copy_ticks" class="hmanchor"></a><span class="f_EnumType" style="font-weight: bold;">ENUM_COPY_TICKS</span></p>
<p class="p_Text"><span class="f_Text">The ENUM_COPY_TICKS enumeration contains the flags to specify the type of data to be passed to the matrix or array. The flag combination allows getting several series from the history in one request. The order of the rows in the matrix will correspond to the order of the values in the ENUM_COPY_TICKS enumeration. In other words, the row with High data will always be higher in the matrix than the row with Low data.</span></p>
<div style="text-align: justify; text-indent: 0; padding: 0 0 0 0; margin: 2px 17px 2px 17px;"><table class="EnumTable" cellspacing="0" cellpadding="5" border="1">
<thead>
<tr class="EnumTable">
<th class="EnumTable" style="width:200px;"><p class="p_EnumHeader"><span class="f_EnumHeader">ID</span></p>
</th>
<th class="EnumTable" style="width:100px;"><p class="p_EnumHeader"><span class="f_EnumHeader">Value</span></p>
</th>
<th class="EnumTable"><p class="p_EnumHeader"><span class="f_EnumHeader">Description</span></p>
</th>
</tr>
</thead>
<tbody>
<tr class="EnumTable">
<td class="EnumTable" style="width:200px;"><p class="p_fortable"><span class="f_fortable">COPY_TICKS_INFO</span></p>
</td>
<td class="EnumTable" style="width:100px;"><p class="p_fortable" style="text-align: center;"><span class="f_fortable">1</span></p>
</td>
<td class="EnumTable"><p class="p_EnumDesc"><span class="f_EnumDesc">All ticks</span></p>
</td>
</tr>
<tr class="EnumTable">
<td class="EnumTable" style="width:200px;"><p class="p_fortable"><span class="f_fortable">COPY_TICKS_TRADE</span></p>
</td>
<td class="EnumTable" style="width:100px;"><p class="p_fortable" style="text-align: center;"><span class="f_fortable">2</span></p>
</td>
<td class="EnumTable"><p class="p_EnumDesc"><span class="f_EnumDesc">Ticks containing Bid and/or Ask price changes</span></p>
</td>
</tr>
<tr class="EnumTable">
<td class="EnumTable" style="width:200px;"><p class="p_fortable"><span class="f_fortable">COPY_TICKS_ALL</span></p>
</td>
<td class="EnumTable" style="width:100px;"><p class="p_fortable" style="text-align: center;"><span class="f_fortable">3</span></p>
</td>
<td class="EnumTable"><p class="p_EnumDesc"><span class="f_EnumDesc">Ticks containing Last and/or Volume price changes</span></p>
</td>
</tr>
<tr class="EnumTable">
<td class="EnumTable" style="width:200px;"><p class="p_fortable"><span class="f_fortable">COPY_TICKS_TIME_MS</span></p>
</td>
<td class="EnumTable" style="width:100px;"><p class="p_fortable" style="text-align: center;"><span class="f_fortable">1&lt;&lt;8</span></p>
</td>
<td class="EnumTable"><p class="p_fortable"><span class="f_fortable">Tick time in milliseconds</span></p>
</td>
</tr>
<tr class="EnumTable">
<td class="EnumTable" style="width:200px;"><p class="p_fortable"><span class="f_fortable">COPY_TICKS_BID</span></p>
</td>
<td class="EnumTable" style="width:100px;"><p class="p_fortable" style="text-align: center;"><span class="f_fortable">1&lt;&lt;9</span></p>
</td>
<td class="EnumTable"><p class="p_fortable"><span class="f_fortable">Bid price</span></p>
</td>
</tr>
<tr class="EnumTable">
<td class="EnumTable" style="width:200px;"><p class="p_fortable"><span class="f_fortable">COPY_TICKS_ASK</span></p>
</td>
<td class="EnumTable" style="width:100px;"><p class="p_fortable" style="text-align: center;"><span class="f_fortable">1&lt;&lt;10</span></p>
</td>
<td class="EnumTable"><p class="p_fortable"><span class="f_fortable">Ask price</span></p>
</td>
</tr>
<tr class="EnumTable">
<td class="EnumTable" style="width:200px;"><p class="p_fortable"><span class="f_fortable">COPY_TICKS_LAST</span></p>
</td>
<td class="EnumTable" style="width:100px;"><p class="p_fortable" style="text-align: center;"><span class="f_fortable">1&lt;&lt;11</span></p>
</td>
<td class="EnumTable"><p class="p_fortable"><span class="f_fortable">Last price (last deal price)</span></p>
</td>
</tr>
<tr class="EnumTable">
<td class="EnumTable" style="width:200px;"><p class="p_fortable"><span class="f_fortable">COPY_TICKS_VOLUME</span></p>
</td>
<td class="EnumTable" style="width:100px;"><p class="p_fortable" style="text-align: center;"><span class="f_fortable">1&lt;&lt;12</span></p>
</td>
<td class="EnumTable"><p class="p_fortable"><span class="f_fortable">Last price Volume</span></p>
</td>
</tr>
<tr class="EnumTable">
<td class="EnumTable" style="width:200px;"><p class="p_fortable"><a name="flags" class="hmanchor"></a><span class="f_fortable">COPY_TICKS_FLAGS</span></p>
</td>
<td class="EnumTable" style="width:100px;"><p class="p_fortable" style="text-align: center;"><span class="f_fortable">1&lt;&lt;13</span></p>
</td>
<td class="EnumTable"><p class="p_fortable"><span class="f_fortable">Tick Flags</span></p>
</td>
</tr>
<tr class="EnumTable">
<td class="EnumTable" style="width:200px; background-color:#DBE9F9;"><p class="p_fortable"><span class="f_fortable" style="font-weight: bold;">Data arrangement</span></p>
</td>
<td class="EnumTable" style="width:100px; background-color:#DBE9F9;"><p class="p_fortable" style="text-align: center;"><span class="f_fortable">&nbsp;</span></p>
</td>
<td class="EnumTable" style="background-color:#DBE9F9;"><p class="p_fortable"><span class="f_fortable">&nbsp;</span></p>
</td>
</tr>
<tr class="EnumTable">
<td class="EnumTable" style="width:200px;"><p class="p_fortable"><span class="f_fortable">COPY_TICKS_VERTICAL</span></p>
</td>
<td class="EnumTable" style="width:100px;"><p class="p_fortable" style="text-align: center;"><span class="f_fortable">1&lt;&lt;15</span></p>
</td>
<td class="EnumTable"><p class="p_fortable"><span class="f_fortable">Ticks are copied into the matrix along the vertical axis. The received ticks will be arranged vertically in the matrix, i.e., the oldest ticks will be in the first row, while the most recent ticks will be in the last matrix row.</span></p>
<p class="p_fortable"><span class="f_fortable">&nbsp;</span></p>
<p class="p_fortable"><span class="f_fortable">With default copying, ticks are added into a matrix along the horizontal axis.</span></p>
<p class="p_fortable"><span class="f_fortable">&nbsp;</span></p>
<p class="p_fortable"><span class="f_fortable">The flag is only applicable when copying to a matrix.</span></p>
</td>
</tr>
</tbody>
</table>
</div>
<p class="p_Text"><span class="f_Text">Analyze the tick flags to find out which data has changed:</span></p>
<ul style="list-style-type:disc">
<li class="p_FunctionRemLI"><span class="f_FunctionRemLI">TICK_FLAG_BID — the tick has changed the bid price</span></li>
<li class="p_FunctionRemLI"><span class="f_FunctionRemLI">TICK_FLAG_ASK — the tick has changed the ask price</span></li>
<li class="p_FunctionRemLI"><span class="f_FunctionRemLI">TICK_FLAG_LAST — the tick has changed the last deal price</span></li>
<li class="p_FunctionRemLI"><span class="f_FunctionRemLI">TICK_FLAG_VOLUME — the tick has changed the volume</span></li>
<li class="p_FunctionRemLI"><span class="f_FunctionRemLI">TICK_FLAG_BUY — the tick is a result of a buy deal</span></li>
<li class="p_FunctionRemLI"><span class="f_FunctionRemLI">TICK_FLAG_SELL — the tick is a result of a sell deal</span></li>
</ul>
<p class="p_Text"><span class="f_Text">&nbsp;</span></p>
<p class="p_BoldTitles"><span class="f_BoldTitles">See also</span></p>
<p class="p_SeeAlso"><span class="f_SeeAlso"><a href="series.htm" class="topiclink">Access to Timeseries and Indicators</a>,  <a href="copyticks.htm" class="topiclink">CopyTicks</a></span></p>

</div>

</body>
</html>
