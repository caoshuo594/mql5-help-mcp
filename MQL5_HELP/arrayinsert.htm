<!DOCTYPE html>
<html>
  <head>
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta http-equiv="Content-Type" content="text/html; charset=Windows-1252" />
  <title>ArrayInsert</title>
  <meta name="keywords" content="ArrayInsert" />
  <link type="text/css" href="default.css" rel="stylesheet" />
  <link type="text/css" href="screenshot.css" rel="stylesheet" />
  

   
   
   


</head>

<body style="background-color:#FFFFFF; font-family:'Trebuchet MS',Tahoma,Arial,Helvetica,sans-serif; margin:0px;">



<table width="100%" height="49"  border="0" cellpadding="0" cellspacing="0" style="margin-top:0px; background-color:#1660af;">
  <tr>
    <td></td>
    <td valign="middle">
      <table style="margin-top:4px; margin-bottom:5px;" width="100%"  border="0" cellspacing="0" cellpadding="5">
        <tr valign="middle">
          <td class="nav">
<a class="h_m" href="index.htm">          MQL5 Reference </a> / <a class="h_m" href="array.htm"> Array Functions </a>/ ArrayInsert
          </td>
          <td width="70" align="right">
          <a href="arrayresize.htm"><img style="vertical-align:middle;" src="previous.png" alt="Previous" width="27" height="27" border=0></a>&nbsp;
          <a href="arrayremove.htm"><img style="vertical-align:middle;" src="next.png" alt="Next" width="27" height="27" border="0"></a>
          </td>
        </tr>
      </table>
    </td>
    <td width="5"></td>
  </tr>
</table>



<div id="help">
<p class="p_H1"><span class="f_H1">ArrayInsert</span></p>
<p class="p_Function"><span class="f_Function">Inserts the specified number of elements from a source array to a receiving one starting from a specified index.</span></p>
<div style="text-align: left; text-indent: 0; line-height: 1.0; page-break-inside: avoid; border-color: #b3b3b3; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0 0 0 0; margin: 2px 17px 2px 17px;"><table cellspacing="0" cellpadding="3" border="0" style="text-align: justify;border:none; border-spacing:0;">
<tr>
<td style="vertical-align:top; padding:3px; border:none"><p class="p_CodeExample" style="page-break-inside: avoid;"><span class="f_Keywords">bool&nbsp;&nbsp;</span><span class="f_Functions">ArrayInsert</span><span class="f_CodeExample">(</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_Keywords">void&amp;</span><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_Param">dst_array[]</span><span class="f_CodeExample">,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_Comments">//&nbsp;receiving&nbsp;array</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_Keywords">const&nbsp;void&amp;</span><span class="f_CodeExample">&nbsp;&nbsp;</span><span class="f_Param">src_array[]</span><span class="f_CodeExample">,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_Comments">//&nbsp;source&nbsp;array</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_Keywords">uint</span><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_Param">dst_start</span><span class="f_CodeExample">,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_Comments">//&nbsp;receiver&nbsp;array&nbsp;index&nbsp;to&nbsp;be&nbsp;inserted</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_Keywords">uint</span><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_Param">src_start=0</span><span class="f_CodeExample">,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_Comments">//&nbsp;source&nbsp;array&nbsp;index&nbsp;to&nbsp;be&nbsp;copied</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_Keywords">uint</span><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_Param">count=WHOLE_ARRAY</span><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_Comments">//&nbsp;number&nbsp;of&nbsp;elements&nbsp;to&nbsp;insert</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;);</span></p>
</td>
</tr>
</table>
</div>
<p class="p_BoldTitles"><span class="f_BoldTitles">Parameters</span></p>
<p class="p_FunctionParameter"><span class="f_FunctionParameter">dst_array[]</span></p>
<p class="p_ParameterDesrciption"><span class="f_ParameterDesrciption">[in][out] &nbsp;Receiving array the elements should be added to.</span></p>
<p class="p_FunctionParameter"><span class="f_FunctionParameter">src_array[]</span></p>
<p class="p_ParameterDesrciption"><span class="f_ParameterDesrciption">[in] &nbsp;Source array the elements are to be added from.</span></p>
<p class="p_FunctionParameter"><span class="f_FunctionParameter">dst_start</span></p>
<p class="p_ParameterDesrciption"><span class="f_ParameterDesrciption">[in] &nbsp;Index in the receiving array for inserting elements from the source array.</span></p>
<p class="p_FunctionParameter"><span class="f_FunctionParameter">src_start=0</span></p>
<p class="p_ParameterDesrciption"><span class="f_ParameterDesrciption">[in] &nbsp;Index in the source array, starting from which the elements of the source array are taken for insertion.</span></p>
<p class="p_FunctionParameter"><span class="f_FunctionParameter">count</span></p>
<p class="p_ParameterDesrciption"><span class="f_ParameterDesrciption">[in] &nbsp;Number of elements to be added from the source array. The <a href="otherconstants.htm" class="topiclink">WHOLE_ARRAY</a> means all elements from the specified index up to the end of the array.</span></p>
<p class="p_BoldTitles"><span class="f_BoldTitles">Return Value</span></p>
<p class="p_FunctionRemark"><span class="f_FunctionRemark">Returns true if successful, otherwise - false. To get information about the error, call the <a href="getlasterror.htm" class="topiclink">GetLastError()</a> function. Possible errors:</span></p>
<ul style="list-style-type:disc">
<li class="p_FunctionRemLI"><span class="f_FunctionRemLI">5052 – ERR_SMALL_ARRAY (the </span><span class="f_FunctionRemLI" style="font-style: italic;">start</span><span class="f_FunctionRemLI"> and/or </span><span class="f_FunctionRemLI" style="font-style: italic;">count</span><span class="f_FunctionRemLI"> parameters are set incorrectly or the </span><span class="f_FunctionRemLI" style="font-style: italic;">src_array[]</span><span class="f_FunctionRemLI"> source array is empty),</span></li>
<li class="p_FunctionRemLI"><span class="f_FunctionRemLI">5056 – ERR_SERIES_ARRAY (the array cannot be changed, indicator buffer),</span></li>
<li class="p_FunctionRemLI"><span class="f_FunctionRemLI">4006 – ERR_INVALID_ARRAY (copying to oneself is not allowed, or the arrays are of different types, or there is a fixed-size array containing class objects or destructor structures),</span></li>
<li class="p_FunctionRemLI"><span class="f_FunctionRemLI">4005 - ERR_STRUCT_WITHOBJECTS_ORCLASS (the array contains no <a href="classes.htm#simple_structure" class="topiclink">POD structures</a> meaning a simple copying is impossible),</span></li>
<li class="p_FunctionRemLI"><span class="f_FunctionRemLI">Errors occurred when changing the </span><span class="f_FunctionRemLI" style="font-style: italic;">dst_array[]</span><span class="f_FunctionRemLI"> receiving array size are provided in the <a href="arrayremove.htm" class="topiclink">ArrayRemove()</a> function description.</span></li>
</ul>
<p class="p_FunctionRemLI"><span class="f_FunctionRemLI">&nbsp;</span></p>
<p class="p_BoldTitles"><span class="f_BoldTitles">Note</span></p>
<p class="p_FunctionRemark"><span class="f_FunctionRemark">If the function is used for a fixed-size array, the size of the </span><span class="f_FunctionRemark" style="font-style: italic;">dst_array[]</span><span class="f_FunctionRemark"> receiving array itself does not change. Starting from the </span><span class="f_FunctionRemark" style="font-style: italic;">dst_start</span><span class="f_FunctionRemark"> position, the elements of the receiving array are shifted to the right (the last </span><span class="f_FunctionRemark" style="font-style: italic;">counts</span><span class="f_FunctionRemark"> of the elements &quot;come off&quot;), while the elements copied from the source array take their place.</span></p>
<p class="p_FunctionRemark"><span class="f_FunctionRemark">You cannot insert the elements to the dynamic arrays designated as the indicator buffers by the <a href="setindexbuffer.htm" class="topiclink">SetIndexBuffer()</a> function. For indicator buffers, all size changing operations are performed by the terminal's executing subsystem.</span></p>
<p class="p_FunctionRemark"><span class="f_FunctionRemark">In the source array, the elements are copied starting from the </span><span class="f_FunctionRemark" style="font-style: italic;">src_start</span><span class="f_FunctionRemark"> index. The source array size remains unchanged. The elements to be added to the receiving array are not links to the source array elements. This means that subsequent changes of the elements in any of the two arrays are not reflected in the second one.</span></p>
<p class="p_Text"><span class="f_Text" style="font-weight: bold;">Example:</span></p>
<div style="text-align: left; text-indent: 0; line-height: 1.0; page-break-inside: avoid; border-color: #b3b3b3; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0 0 0 0; margin: 2px 17px 2px 17px;"><table cellspacing="0" cellpadding="3" border="0" style="text-align: justify;border:none; border-spacing:0;">
<tr>
<td style="vertical-align:top; padding:3px; border:none"><p class="p_CodeExample" style="page-break-inside: avoid;"><span class="f_CodeExample" style="color: #808080;">//+------------------------------------------------------------------+</span>
<br><span class="f_CodeExample" style="color: #808080;">//|&nbsp;Script&nbsp;program&nbsp;start&nbsp;function&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|</span>
<br><span class="f_CodeExample" style="color: #808080;">//+------------------------------------------------------------------+</span>
<br><span class="f_CodeExample" style="color: #0000ff;">void</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">OnStart</span><span class="f_CodeExample">()</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;{</span>
<br><span class="f_CodeExample" style="color: #808080;">//---&nbsp;declare&nbsp;the&nbsp;fixed-size&nbsp;array&nbsp;and&nbsp;fill&nbsp;in&nbsp;the&nbsp;values</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">int</span><span class="f_CodeExample">&nbsp;array_dest[10];</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">for</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #0000ff;">int</span><span class="f_CodeExample">&nbsp;i=0;i&lt;10;i++)</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;array_dest[i]=i;</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #808080;">//---&nbsp;source&nbsp;array&nbsp;&nbsp;</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">int</span><span class="f_CodeExample">&nbsp;array_source[10];</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">for</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #0000ff;">int</span><span class="f_CodeExample">&nbsp;i=0;i&lt;10;i++)</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;array_source[i]=10+i;</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span>
<br><span class="f_CodeExample" style="color: #808080;">//---&nbsp;display&nbsp;arrays&nbsp;before&nbsp;inserting&nbsp;the&nbsp;elements</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">Print</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #008080;">&quot;Before&nbsp;calling&nbsp;ArrayInsert()&quot;</span><span class="f_CodeExample">);</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">ArrayPrint</span><span class="f_CodeExample">(array_dest);</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">ArrayPrint</span><span class="f_CodeExample">(array_source);</span>
<br><span class="f_CodeExample" style="color: #808080;">//---&nbsp;insert&nbsp;3&nbsp;elements&nbsp;from&nbsp;the&nbsp;source&nbsp;array&nbsp;and&nbsp;show&nbsp;the&nbsp;new&nbsp;set&nbsp;of&nbsp;the&nbsp;receiving&nbsp;array</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">ArrayInsert</span><span class="f_CodeExample">(array_dest,array_source,4,0,3);</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">Print</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #008080;">&quot;After&nbsp;calling&nbsp;ArrayInsert()&quot;</span><span class="f_CodeExample">);</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">ArrayPrint</span><span class="f_CodeExample">(array_dest);</span>
<br><span class="f_CodeExample">/*</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;Execution&nbsp;result</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;Before&nbsp;calling&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">ArrayInsert</span><span class="f_CodeExample">()</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;0&nbsp;1&nbsp;2&nbsp;3&nbsp;</span><span class="f_CodeExample" style="background-color: #ffff00;">4&nbsp;5&nbsp;6</span><span class="f_CodeExample">&nbsp;7&nbsp;8&nbsp;9</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;After&nbsp;calling&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">ArrayInsert</span><span class="f_CodeExample">()</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;0&nbsp;1&nbsp;2&nbsp;3&nbsp;</span><span class="f_CodeExample" style="background-color: #ffff00;">10&nbsp;11&nbsp;12</span><span class="f_CodeExample">&nbsp;7&nbsp;8&nbsp;9</span>
<br><span class="f_CodeExample">*/</span></p>
</td>
</tr>
</table>
</div>
<p class="p_BoldTitles"><span class="f_BoldTitles">&nbsp;</span></p>
<p class="p_BoldTitles"><span class="f_BoldTitles">See also</span></p>
<p class="p_SeeAlso"><span class="f_SeeAlso"><a href="arrayremove.htm" class="topiclink">ArrayRemove</a>,<a href="arraycopy.htm" class="topiclink"> ArrayCopy</a>, <a href="arrayresize.htm" class="topiclink">ArrayResize</a>, <a href="arrayfree.htm" class="topiclink">ArrayFree</a></span></p>
<p class="p_Text"><span class="f_Text">&nbsp;</span></p>

</div>

</body>
</html>
