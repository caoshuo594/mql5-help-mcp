<!DOCTYPE html>
<html>
  <head>
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta http-equiv="Content-Type" content="text/html; charset=Windows-1252" />
  <title>ReceiverOperatingCharacteristic</title>
  <meta name="keywords" content="" />
  <link type="text/css" href="default.css" rel="stylesheet" />
  <link type="text/css" href="screenshot.css" rel="stylesheet" />
  

   
   
   


</head>

<body style="background-color:#FFFFFF; font-family:'Trebuchet MS',Tahoma,Arial,Helvetica,sans-serif; margin:0px;">



<table width="100%" height="49"  border="0" cellpadding="0" cellspacing="0" style="margin-top:0px; background-color:#1660af;">
  <tr>
    <td></td>
    <td valign="middle">
      <table style="margin-top:4px; margin-bottom:5px;" width="100%"  border="0" cellspacing="0" cellpadding="5">
        <tr valign="middle">
          <td class="nav">
<a class="h_m" href="index.htm">          MQL5 Reference </a> / <a class="h_m" href="matrix.htm"> Matrix and Vector Methods </a> / <a class="h_m" href="matrix_machine_learning.htm"> Machine learning </a>/ ReceiverOperatingCharacteristic
          </td>
          <td width="70" align="right">
          <a href="matrix_precisionrecall.htm"><img style="vertical-align:middle;" src="previous.png" alt="Previous" width="27" height="27" border=0></a>&nbsp;
          <a href="openblas.htm"><img style="vertical-align:middle;" src="next.png" alt="Next" width="27" height="27" border="0"></a>
          </td>
        </tr>
      </table>
    </td>
    <td width="5"></td>
  </tr>
</table>



<div id="help">
<p class="p_H1"><span class="f_H1">ReceiverOperatingCharacteristic</span></p>
<p class="p_Function"><span class="f_Function">Compute values to construct the Receiver Operating Characteristic (ROC) curve. Similarly to <a href="matrix_classificationscore.htm" class="topiclink">ClassificationScore</a>, this method is applied to the vector of true values.</span></p>
<div style="text-align: left; text-indent: 0; line-height: 1.0; page-break-inside: avoid; border-color: #b3b3b3; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0 0 0 0; margin: 2px 17px 2px 17px;"><table cellspacing="0" cellpadding="3" border="0" style="text-align: justify;border:none; border-spacing:0;">
<tr>
<td style="vertical-align:top; padding:3px; border:none"><p class="p_CodeExample" style="page-break-inside: avoid;"><span class="f_Keywords">bool&nbsp;vector::</span><span class="f_Functions">ReceiverOperatingCharacteristic</span><span class="f_CodeExample">(</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_Keywords">const&nbsp;matrix&amp;</span><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_Param">pred_scores</span><span class="f_CodeExample">,&nbsp;&nbsp;&nbsp;</span><span class="f_Comments">//&nbsp;matrix&nbsp;containing&nbsp;the&nbsp;probability&nbsp;distribution&nbsp;for&nbsp;each&nbsp;class</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_Keywords">const&nbsp;ENUM_ENUM_AVERAGE_MODE&nbsp;</span><span class="f_CodeExample">&nbsp;</span><span class="f_Param">mode</span><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_Comments">//&nbsp;averaging&nbsp;mode</span>
<br><span class="f_Keywords">&nbsp;&nbsp;&nbsp;matrix&amp;</span><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_Param">fpr</span><span class="f_CodeExample">,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_Comments">//&nbsp;calculated&nbsp;false&nbsp;positive&nbsp;rate&nbsp;values&nbsp;for&nbsp;each&nbsp;threshold&nbsp;value</span>
<br><span class="f_Keywords">&nbsp;&nbsp;&nbsp;matrix&amp;</span><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_Param">tpr</span><span class="f_CodeExample">,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_Comments">//&nbsp;calculated&nbsp;true&nbsp;positive&nbsp;rate&nbsp;values&nbsp;for&nbsp;each&nbsp;threshold&nbsp;value</span>
<br><span class="f_Keywords">&nbsp;&nbsp;&nbsp;matrix&amp;</span><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_Param">thresholds</span><span class="f_CodeExample">,&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_Comments">//&nbsp;threshold&nbsp;values&nbsp;sorted&nbsp;in&nbsp;descending&nbsp;order</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;);</span></p>
</td>
</tr>
</table>
</div>
<p class="p_BoldTitles"><span class="f_BoldTitles">Parameters</span></p>
<p class="p_FunctionParameter"><span class="f_FunctionParameter">pred_scores</span></p>
<p class="p_ParameterDesrciption"><span class="f_ParameterDesrciption">[in] &nbsp;A matrix containing a set of horizontal vectors with probabilities for each class. The number of matrix rows must correspond to the size of the vector of true values.</span></p>
<p class="p_FunctionParameter"><span class="f_FunctionParameter">mode</span></p>
<p class="p_ParameterDesrciption"><span class="f_ParameterDesrciption">[in] &nbsp;Averaging mode from the <a href="matrix_enumerations.htm#enum_average_mode" class="topiclink">ENUM_AVERAGE_MODE</a> enumeration. Only AVERAGE_NONE, AVERAGE_BINARY and AVERAGE_MICRO are used.</span></p>
<p class="p_FunctionParameter"><span class="f_FunctionParameter">fpr</span></p>
<p class="p_ParameterDesrciption"><span class="f_ParameterDesrciption">[out] &nbsp;A matrix with calculated values of the false positive rate curve. If no averaging is applied (AVERAGE_NONE), the number of rows in the matrix corresponds to the number of model classes. The number of columns corresponds to the size of the vector of true values (or the number of rows in the probability distribution matrix pred_score). In the case of microaveraging, the number of rows in the matrix corresponds to the total number of threshold values, excluding duplicates.</span></p>
<p class="p_FunctionParameter"><span class="f_FunctionParameter">tpr</span></p>
<p class="p_ParameterDesrciption"><span class="f_ParameterDesrciption">[out] &nbsp;A matrix with calculated values of the true positive rate curve.</span></p>
<p class="p_FunctionParameter"><span class="f_FunctionParameter">threshold</span></p>
<p class="p_ParameterDesrciption"><span class="f_ParameterDesrciption">[out] &nbsp;Threshold matrix obtained by sorting the probability matrix</span></p>
<p class="p_ParameterDesrciption"><span class="f_ParameterDesrciption">&nbsp;</span></p>
<p class="p_BoldTitles"><span class="f_BoldTitles">Note</span></p>
<p class="p_FunctionRemark"><span class="f_FunctionRemark">See notes for the <a href="matrix_classificationscore.htm" class="topiclink">ClassificationScore</a> method.</span></p>
<p class="p_FunctionRemark"><span class="f_FunctionRemark">&nbsp;</span></p>
<p class="p_Text"><span class="f_Text" style="font-weight: bold;">Example</span></p>
<p class="p_Text"><span class="f_Text">An example of plotting ROC graphs, where tpr values are plotted on the y-axis and fpr values are plotted on the x-axis. Also fpr and tpr graphs are plotted separately, with threshold values plotted on the x-axis</span></p>
<div style="text-align: left; text-indent: 0; line-height: 1.0; page-break-inside: avoid; border-color: #b3b3b3; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0 0 0 0; margin: 2px 17px 2px 17px;"><table cellspacing="0" cellpadding="3" border="0" style="text-align: justify;border:none; border-spacing:0;">
<tr>
<td style="vertical-align:top; padding:3px; border:none"><p class="p_CodeExample" style="page-break-inside: avoid;"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">matrixf</span><span class="f_CodeExample">&nbsp;mat_thres;</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">matrixf</span><span class="f_CodeExample">&nbsp;mat_fpr;</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">matrixf</span><span class="f_CodeExample">&nbsp;mat_tpr;</span>
<br><span class="f_CodeExample">&nbsp;</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">if</span><span class="f_CodeExample">(y_true.ReceiverOperatingCharacteristic(y_scores,</span><span class="f_CodeExample" style="color: #0000ff;">AVERAGE_MICRO</span><span class="f_CodeExample">,mat_fpr,mat_tpr,mat_thres))</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">double</span><span class="f_CodeExample">&nbsp;fpr[],tpr[],thres[];</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">ArrayResize</span><span class="f_CodeExample">(fpr,mat_thres.Cols());</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">ArrayResize</span><span class="f_CodeExample">(tpr,mat_thres.Cols());</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">ArrayResize</span><span class="f_CodeExample">(thres,mat_thres.Cols());</span>
<br><span class="f_CodeExample">&nbsp;</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">for</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #0000ff;">uint</span><span class="f_CodeExample">&nbsp;i=0;&nbsp;i&lt;fpr.Size();&nbsp;i++)</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fpr[i]=mat_fpr[0][i];</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tpr[i]=mat_tpr[0][i];</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;thres[i]=mat_thres[0][i];</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;thres[0]=thres[1]+0.001;</span>
<br><span class="f_CodeExample">&nbsp;</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">PlotCurve</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #008080;">&quot;ROC&nbsp;curve&nbsp;(micro&nbsp;average)&quot;</span><span class="f_CodeExample">,</span><span class="f_CodeExample" style="color: #008080;">&quot;roc&quot;</span><span class="f_CodeExample">,</span><span class="f_CodeExample" style="color: #008080;">&quot;0.5&quot;</span><span class="f_CodeExample">,fpr,tpr);</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">Plot2Curves</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #008080;">&quot;fpr-tpr&nbsp;(micro&nbsp;average)&quot;</span><span class="f_CodeExample">,</span><span class="f_CodeExample" style="color: #008080;">&quot;fpr&quot;</span><span class="f_CodeExample">,</span><span class="f_CodeExample" style="color: #008080;">&quot;tpr&quot;</span><span class="f_CodeExample">,thres,fpr,tpr);</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;</span></p>
</td>
</tr>
</table>
</div>
<p class="p_FunctionRemark"><span class="f_FunctionRemark">&nbsp;</span></p>
<p class="p_Text"><span class="f_Text" style="font-weight: bold;">Resulting curves:</span></p>
<p class="p_Text"><img class="help" alt="Receiver Operating Characteristic (ROC)" title="Receiver Operating Characteristic (ROC)" width="750" height="750" style="margin:0;width:750px;height:750px;border:none" src="roc_curve_micro.png"/></p>
<p class="p_Text"><img class="help" alt="Graph fpr-tpr micro average" title="Graph fpr-tpr micro average" width="750" height="350" style="margin:0;width:750px;height:350px;border:none" src="fpr_tpr_micro.png"/></p>
<p class="p_Text"><span class="f_Text">&nbsp;</span></p>
<p class="p_Text"><span class="f_Text">The graph output code is simple and based on the &lt;Graphics/Graphic.mqh&gt; standard library.</span></p>
<p class="p_Text"><span class="f_Text">The examples use the data of the mnist.onnx model. The code is presented in the <a href="matrix_precisionrecall.htm" class="topiclink">PrecisionRecall</a> method description.</span></p>
<p class="p_Text"><span class="f_Text">ROC AUC is close to ideal.</span><br>
<span class="f_Text">&nbsp;</span></p>
<div style="text-align: left; text-indent: 0; line-height: 1.0; page-break-inside: avoid; border-color: #b3b3b3; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0 0 0 0; margin: 2px 17px 2px 17px;"><table cellspacing="0" cellpadding="3" border="0" style="text-align: justify;border:none; border-spacing:0;">
<tr>
<td style="vertical-align:top; padding:3px; border:none"><p class="p_CodeExample" style="page-break-inside: avoid; margin: 0 0 0 0;"><span class="f_Normal" style="font-family: 'Courier New',Courier,monospace; background-color: transparent;">roc&nbsp;auc&nbsp;score&nbsp;micro&nbsp;=&nbsp;[0.99991]</span></p>
</td>
</tr>
</table>
</div>
<p class="p_FunctionRemark"><span class="f_FunctionRemark">&nbsp;</span></p>

</div>

</body>
</html>
