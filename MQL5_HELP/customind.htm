<!DOCTYPE html>
<html>
  <head>
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta http-equiv="Content-Type" content="text/html; charset=Windows-1252" />
  <title>Custom Indicators</title>
  <meta name="keywords" content="" />
  <link type="text/css" href="default.css" rel="stylesheet" />
  <link type="text/css" href="screenshot.css" rel="stylesheet" />
  

   
   
   


</head>

<body style="background-color:#FFFFFF; font-family:'Trebuchet MS',Tahoma,Arial,Helvetica,sans-serif; margin:0px;">



<table width="100%" height="49"  border="0" cellpadding="0" cellspacing="0" style="margin-top:0px; background-color:#1660af;">
  <tr>
    <td></td>
    <td valign="middle">
      <table style="margin-top:4px; margin-bottom:5px;" width="100%"  border="0" cellspacing="0" cellpadding="5">
        <tr valign="middle">
          <td class="nav">
<a class="h_m" href="index.htm">          MQL5 Reference </a>/ Custom Indicators
          </td>
          <td width="70" align="right">
          <a href="folderclean.htm"><img style="vertical-align:middle;" src="previous.png" alt="Previous" width="27" height="27" border=0></a>&nbsp;
          <a href="indicators_examples.htm"><img style="vertical-align:middle;" src="next.png" alt="Next" width="27" height="27" border="0"></a>
          </td>
        </tr>
      </table>
    </td>
    <td width="5"></td>
  </tr>
</table>



<div id="help">
<p class="p_H1"><span class="f_H1">Custom Indicators </span></p>
<p class="p_Text"><span class="f_Text">This is the group functions used in the creation of custom indicators. These functions can't be used when writing Expert Advisors and Scripts.</span></p>
<div style="text-align: justify; text-indent: 0; padding: 0 0 0 0; margin: 8px 17px 7px 17px;"><table class="EnumTable" cellspacing="0" cellpadding="5" border="1">
<thead>
<tr class="EnumTable">
<th class="EnumTable" style="width:167px;"><p class="p_fortable"><span class="f_fortable" style="font-weight: bold;">Function</span></p>
</th>
<th class="EnumTable"><p class="p_fortable"><span class="f_fortable" style="font-weight: bold;">Action</span></p>
</th>
</tr>
</thead>
<tbody>
<tr class="EnumTable">
<td class="EnumTable" style="width:167px;"><p class="p_fortable"><span class="f_fortable"><a href="setindexbuffer.htm" class="topiclink">SetIndexBuffer</a></span></p>
</td>
<td class="EnumTable"><p class="p_fortable"><span class="f_fortable">Binds the specified indicator buffer with one-dimensional dynamic <a href="variables.htm#array_define" class="topiclink">array</a> of the <a href="double.htm" class="topiclink">double</a> type</span></p>
</td>
</tr>
<tr class="EnumTable">
<td class="EnumTable" style="width:167px;"><p class="p_fortable"><span class="f_fortable"><a href="indicatorsetdouble.htm" class="topiclink">IndicatorSetDouble</a></span></p>
</td>
<td class="EnumTable"><p class="p_fortable"><span class="f_fortable">Sets the value of an indicator property of the <a href="double.htm" class="topiclink">double</a> type</span></p>
</td>
</tr>
<tr class="EnumTable">
<td class="EnumTable" style="width:167px;"><p class="p_fortable"><span class="f_fortable"><a href="indicatorsetinteger.htm" class="topiclink">IndicatorSetInteger</a></span></p>
</td>
<td class="EnumTable"><p class="p_fortable"><span class="f_fortable">Sets the value of an indicator property of the <a href="integertypes.htm" class="topiclink">int</a> type</span></p>
</td>
</tr>
<tr class="EnumTable">
<td class="EnumTable" style="width:167px;"><p class="p_fortable"><span class="f_fortable"><a href="indicatorsetstring.htm" class="topiclink">IndicatorSetString</a></span></p>
</td>
<td class="EnumTable"><p class="p_fortable"><span class="f_fortable">Sets the value of an indicator property of the <a href="stringconst.htm" class="topiclink">string</a> type</span></p>
</td>
</tr>
<tr class="EnumTable">
<td class="EnumTable" style="width:167px;"><p class="p_fortable"><span class="f_fortable"><a href="plotindexsetdouble.htm" class="topiclink">PlotIndexSetDouble</a></span></p>
</td>
<td class="EnumTable"><p class="p_fortable"><span class="f_fortable">Sets the value of an indicator line property of the type <a href="double.htm" class="topiclink">double</a></span></p>
</td>
</tr>
<tr class="EnumTable">
<td class="EnumTable" style="width:167px;"><p class="p_fortable"><span class="f_fortable"><a href="plotindexsetinteger.htm" class="topiclink">PlotIndexSetInteger</a></span></p>
</td>
<td class="EnumTable"><p class="p_fortable"><span class="f_fortable">Sets the value of an indicator line property of the <a href="integertypes.htm" class="topiclink">int</a> type</span></p>
</td>
</tr>
<tr class="EnumTable">
<td class="EnumTable" style="width:167px;"><p class="p_fortable"><span class="f_fortable"><a href="plotindexsetstring.htm" class="topiclink">PlotIndexSetString</a></span></p>
</td>
<td class="EnumTable"><p class="p_fortable"><span class="f_fortable">Sets the value of an indicator line property of the <a href="stringconst.htm" class="topiclink">string</a> type</span></p>
</td>
</tr>
<tr class="EnumTable">
<td class="EnumTable" style="width:167px;"><p class="p_fortable"><span class="f_fortable"><a href="plotindexgetinteger.htm" class="topiclink">PlotIndexGetInteger</a></span></p>
</td>
<td class="EnumTable"><p class="p_fortable"><span class="f_fortable">Returns the value of an indicator line property of the <a href="integertypes.htm" class="topiclink">integer</a> type</span></p>
</td>
</tr>
</tbody>
</table>
</div>
<p class="p_Text"><span class="f_Text"><a href="propertiesandfunctions.htm" class="topiclink">Indicator properties</a> can be set using the compiler directives or using functions. To better understand this, it is recommended that you study <a href="indicators_examples.htm" class="topiclink">indicator styles in examples</a>.</span></p>
<p class="p_Text"><span class="f_Text">All the necessary calculations of a custom indicator must be placed in the predetermined function <a href="oncalculate.htm" class="topiclink">OnCalculate()</a>. If you use a short form of the OnCalculate() function call, like</span></p>
<div style="text-align: left; text-indent: 0; line-height: 1.0; page-break-inside: avoid; border-color: #b3b3b3; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0 0 0 0; margin: 2px 17px 2px 17px;"><table cellspacing="0" cellpadding="3" border="0" style="text-align: justify;border:none; border-spacing:0;">
<tr>
<td style="vertical-align:top; padding:3px; border:none"><p class="p_CodeExample" style="page-break-inside: avoid;"><span class="f_CodeExample" style="color: #0000ff;">int</span><span class="f_CodeExample">&nbsp;OnCalculate&nbsp;(</span><span class="f_CodeExample" style="color: #0000ff;">const</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">int</span><span class="f_CodeExample">&nbsp;rates_total,&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">const</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">int</span><span class="f_CodeExample">&nbsp;prev_calculated,&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">const</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">int</span><span class="f_CodeExample">&nbsp;begin,&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">const</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">double</span><span class="f_CodeExample">&amp;&nbsp;price[])</span></p>
</td>
</tr>
</table>
</div>
<p class="p_Text"><span class="f_Text">then the </span><span class="f_Text" style="font-style: italic;">rates_total</span><span class="f_Text"> variable contains the value of the total number of elements of the price[] array, passed as an input parameter for calculating indicator values.</span></p>
<p class="p_Text"><span class="f_Text">Parameter </span><span class="f_Text" style="font-style: italic;">prev_calculated</span><span class="f_Text"> is the result of the execution of OnCalculate() at the previous call; it allows organizing a saving algorithm for calculating indicator values. For example, if the current value rates_total = 1000, prev_calculated = 999, then perhaps it's enough to make calculations only for one value of each indicator buffer.</span></p>
<p class="p_Text"><span class="f_Text">If the information about the size of the input array price would have been unavailable, then it would lead to the necessity to make calculations for 1000 values of each indicator buffer. At the first call of OnCalculate() value prev_calculated = 0. If the price[] array has changed somehow, then in this case prev_calculated is also equal to 0.</span></p>
<p class="p_Text"><span class="f_Text">The </span><span class="f_Text" style="font-style: italic;">begin</span><span class="f_Text"> parameter shows the number of initial values of the price array, which don't contain data for calculation. For example, if values of Accelerator Oscillator (for which the first 37 values aren't calculated) were used as an input parameter, then begin = 37. For example, let's consider a simple indicator:</span></p>
<div style="text-align: left; text-indent: 0; line-height: 1.0; page-break-inside: avoid; border-color: #b3b3b3; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0 0 0 0; margin: 2px 17px 2px 17px;"><table cellspacing="0" cellpadding="3" border="0" style="text-align: justify;border:none; border-spacing:0;">
<tr>
<td style="vertical-align:top; padding:3px; border:none"><p class="p_CodeExample" style="page-break-inside: avoid;"><span class="f_CodeExample" style="color: #0000ff;">#property</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">indicator_chart_window</span>
<br><span class="f_CodeExample" style="color: #0000ff;">#property</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">indicator_buffers</span><span class="f_CodeExample">&nbsp;1</span>
<br><span class="f_CodeExample" style="color: #0000ff;">#property</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">indicator_plots</span><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;1</span>
<br><span class="f_CodeExample" style="color: #808080;">//----&nbsp;plot&nbsp;Label1</span>
<br><span class="f_CodeExample" style="color: #0000ff;">#property</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">indicator_label1</span><span class="f_CodeExample">&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #008080;">&quot;Label1&quot;</span>
<br><span class="f_CodeExample" style="color: #0000ff;">#property</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">indicator_type1</span><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">DRAW_LINE</span>
<br><span class="f_CodeExample" style="color: #0000ff;">#property</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">indicator_color1</span><span class="f_CodeExample">&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">clrRed</span>
<br><span class="f_CodeExample" style="color: #0000ff;">#property</span><span class="f_CodeExample">&nbsp;indicator_style1&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">STYLE_SOLID</span>
<br><span class="f_CodeExample" style="color: #0000ff;">#property</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">indicator_width1</span><span class="f_CodeExample">&nbsp;&nbsp;1</span>
<br><span class="f_CodeExample" style="color: #808080;">//---&nbsp;indicator&nbsp;buffers</span>
<br><span class="f_CodeExample" style="color: #0000ff;">double</span><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Label1Buffer[];</span>
<br><span class="f_CodeExample" style="color: #808080;">//+------------------------------------------------------------------+</span>
<br><span class="f_CodeExample" style="color: #808080;">//|&nbsp;Custom&nbsp;indicator&nbsp;initialization&nbsp;function&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|</span>
<br><span class="f_CodeExample" style="color: #808080;">//+------------------------------------------------------------------+</span>
<br><span class="f_CodeExample" style="color: #0000ff;">void</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">OnInit</span><span class="f_CodeExample">()</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;{</span>
<br><span class="f_CodeExample" style="color: #808080;">//---&nbsp;indicator&nbsp;buffers&nbsp;mapping</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">SetIndexBuffer</span><span class="f_CodeExample">(0,Label1Buffer,</span><span class="f_CodeExample" style="color: #0000ff;">INDICATOR_DATA</span><span class="f_CodeExample">);</span>
<br><span class="f_CodeExample" style="color: #808080;">//---</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;}</span>
<br><span class="f_CodeExample" style="color: #808080;">//+------------------------------------------------------------------+</span>
<br><span class="f_CodeExample" style="color: #808080;">//|&nbsp;Custom&nbsp;indicator&nbsp;iteration&nbsp;function&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|</span>
<br><span class="f_CodeExample" style="color: #808080;">//+------------------------------------------------------------------+</span>
<br><span class="f_CodeExample" style="color: #0000ff;">int</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">OnCalculate</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #0000ff;">const</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">int</span><span class="f_CodeExample">&nbsp;rates_total,</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">const</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">int</span><span class="f_CodeExample">&nbsp;prev_calculated,</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">const</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">int</span><span class="f_CodeExample">&nbsp;begin,</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">const</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">double</span><span class="f_CodeExample">&nbsp;&amp;price[])</span>
<br><span class="f_CodeExample">&nbsp;</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;{</span>
<br><span class="f_CodeExample" style="color: #808080;">//---</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">Print</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #008080;">&quot;begin&nbsp;=&nbsp;&quot;</span><span class="f_CodeExample">,begin,</span><span class="f_CodeExample" style="color: #008080;">&quot;&nbsp;&nbsp;prev_calculated&nbsp;=&nbsp;&quot;</span><span class="f_CodeExample">,prev_calculated,</span><span class="f_CodeExample" style="color: #008080;">&quot;&nbsp;&nbsp;rates_total&nbsp;=&nbsp;&quot;</span><span class="f_CodeExample">,rates_total);</span>
<br><span class="f_CodeExample" style="color: #808080;">//---&nbsp;return&nbsp;value&nbsp;of&nbsp;prev_calculated&nbsp;for&nbsp;next&nbsp;call</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">return</span><span class="f_CodeExample">(rates_total);</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;}</span></p>
</td>
</tr>
</table>
</div>
<p class="p_Text"><span class="f_Text">Drag it from the &quot;Navigator&quot; window to the window of the Accelerator Oscillator indicator and we indicate that calculations will be made based on the values of the previous indicator:</span></p>
<p class="p_Text" style="text-align: center;"><img class="help" alt="Calculating an indicator on values of the previously attached indicator" title="Calculating an indicator on values of the previously attached indicator" width="615" height="312" style="margin:0 auto 0 auto;width:615px;height:312px;border:none" src="previousindicatorsdata.png"/></p>
<p class="p_Text"><span class="f_Text">As a result, the first call of OnCalculate() the value of prev_calculated will be equal to zero, and in further calls it will be equal to the rates_total value (until the number of bars on the price chart increases).</span></p>
<p class="p_Text" style="text-align: center;"><img class="help" alt="The begin parameter shows the number of initial bars, on which values are omitted" title="The begin parameter shows the number of initial bars, on which values are omitted" width="750" height="546" style="margin:0 auto 0 auto;width:750px;height:546px;border:none" src="beginparameteronprevindabsent.png"/></p>
<p class="p_Text"><span class="f_Text">The value of the begin parameter will be exactly equal to the number of initial bars, for which the values of the Accelerator indicator aren't calculated according to the logic of this indicator. If we look at the source code of the custom indicator Accelerator.mq5, we'll see the following lines in the <a href="oninit.htm" class="topiclink">OnInit()</a> function:</span></p>
<div style="text-align: left; text-indent: 0; line-height: 1.0; page-break-inside: avoid; border-color: #b3b3b3; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0 0 0 0; margin: 2px 17px 2px 17px;"><table cellspacing="0" cellpadding="3" border="0" style="text-align: justify;border:none; border-spacing:0;">
<tr>
<td style="vertical-align:top; padding:3px; border:none"><p class="p_CodeExample" style="page-break-inside: avoid;"><span class="f_CodeExample" style="color: #808080;">//---&nbsp;sets&nbsp;first&nbsp;bar&nbsp;from&nbsp;which&nbsp;index&nbsp;will&nbsp;be&nbsp;drawn</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">PlotIndexSetInteger</span><span class="f_CodeExample">(0,</span><span class="f_CodeExample" style="color: #0000ff;">PLOT_DRAW_BEGIN</span><span class="f_CodeExample">,37);</span></p>
</td>
</tr>
</table>
</div>
<p class="p_Text"><span class="f_Text">Using the function <a href="plotindexsetinteger.htm" class="topiclink">PlotIndexSetInteger</a>(0, <a href="drawstyles.htm#enum_plot_property_integer" class="topiclink">PLOT_DRAW_BEGIN</a>, empty_first_values), we set the number of non-existing first values in the zero indicator array of a custom indicator, which we don't need to accept for calculation (empty_first_values). Thus, we have mechanisms to:</span></p>
<ol style="list-style-type:decimal">
<li value="1" class="p_li"><span class="f_li">set the number of initial values of an indicator, which shouldn't be used for calculations in another custom indicator;</span></li>
<li value="2" class="p_li"><span class="f_li">get information on the number of first values to be ignored when you call another custom indicator, without going into the logic of its calculations.</span></li>
</ol>
<p class="p_Text"><span class="f_Text">&nbsp;</span></p>
<p class="p_Text"><span class="f_Text">&nbsp;</span></p>

</div>

</body>
</html>
