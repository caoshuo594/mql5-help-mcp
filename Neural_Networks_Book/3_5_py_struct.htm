<!DOCTYPE html>
<html>
  <head>
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
  <title>3.5 Description of a Python script structure</title>
  <meta name="keywords" content="" />
  <link type="text/css" href="default.css" rel="stylesheet" />

   <script type="text/javascript" src="jquery.js"></script>
   <script type="text/javascript" src="helpman_settings.js"></script>
   <script type="text/javascript" src="helpman_topicinit.js"></script>


</head>

<body style="background-color:#FFFFFF; font-family:'Trebuchet MS',Tahoma,Arial,Helvetica,sans-serif; margin:0px;">



<table width="100%" height="49"  border="0" cellpadding="0" cellspacing="0" style="margin-top:0px; background-color:#1660af;">
  <tr>
    <td></td>
    <td valign="middle">
      <table style="margin-top:4px; margin-bottom:5px;" width="100%"  border="0" cellspacing="0" cellpadding="5">
        <tr valign="middle">
          <td class="nav">
<a class="h_m" href="index.htm">          Neural Networks for Algorithmic Trading with MQL5 </a> / <a class="h_m" href="3_realization.htm"> 3. Building the first neural network model in MQL5 </a>/ 3.5 Description of a Python script structure
          </td>
          <td width="70" align="right">
          <a href="3_4_4_layers_array.htm"><img style="vertical-align:middle;" src="previous.png" alt="?????" width="27" height="27" border=0></a>&nbsp;
          <a href="3_6_perceptron.htm"><img style="vertical-align:middle;" src="next.png" alt="??????" width="27" height="27" border="0"></a>
          </td>
        </tr>
      </table>
    </td>
    <td width="5"></td>
  </tr>
</table>



<div id="help">
<p class="p_H2"><span class="f_H2">3.5 Description of a Python script structure</span></p>
<p class="p_Text"><span class="f_Text">Python is an interpreted programming language with a minimalistic syntax. Such syntax enables the fast creation of small code blocks and the immediate testing of their functionality. Therefore, Python allows you to focus on solving the problem rather than programming. Perhaps, it's precisely due to this feature that Python has gained such popularity.</span></p>
<p class="p_Text"><span class="f_Text">Despite the fact that interpreted programming languages run slower than compiled ones, Python has currently become the most popular programming language for creating and conducting experiments with neural networks. The issue of execution speed is solved by using various libraries written, among others, in compiled programming languages. Fortunately, Python has the ability to easily expand and incorporate libraries written in practically all available programming languages.</span></p>
<p class="p_Text"><span class="f_Text">We, too, won't be constructing complex algorithms and will make use of ready-made solutions, including libraries both for building neural networks and for trading. Let's start by familiarizing ourselves with some of them.</span></p>
<p class="p_Text"><span class="f_Text">The </span><span class="f_Text" style="font-style: italic; font-weight: bold;">os</span><span class="f_Text"> module contains functions for working with the operating system. Using this library enables the creation of cross-platform applications, as the functionality of this module operates independently of the installed operating system. Here are just some of the functions of the </span><span class="f_Text" style="font-style: italic;">os</span><span class="f_Text"> library:</span></p>
<ul style="list-style-type:disc">
<li class="p_li"><span class="f_li" style="font-style: italic;">os.name</span><span class="f_li"> returns the name of the operating system. The following options are possible as a result of executing the function: 'posix', 'nt', 'mac', 'os2', 'ce', 'java'.</span></li>
<li class="p_li"><span class="f_li" style="font-style: italic;">os.environ</span><span class="f_li"> is a function for working with environment variables, allowing you to modify, add and delete environment variables.</span></li>
<li class="p_li"><span class="f_li" style="font-style: italic;">os.path</span><span class="f_li"> contains a number of functions for working with file and directory paths.</span></li>
</ul>
<p class="p_Text"><span class="f_Text">The </span><span class="f_Text" style="font-style: italic; font-weight: bold;">Pandas</span><span class="f_Text"> module is a library for processing and analyzing data. The library provides specialized data structures and operations for processing numeric tables and time series. It enables data analysis and modeling without using specialized programming languages for statistical processing, such as </span><span class="f_Text" style="font-style: italic;">R</span><span class="f_Text"> or </span><span class="f_Text" style="font-style: italic;">Octave</span><span class="f_Text">.</span></p>
<p class="p_Text"><span class="f_Text">The package is designed for data cleaning and initial assessment based on general statistical indicators. It can be used to calculate mean, quantiles, etc. At the same time, the package cannot be considered purely statistical in nature. However, the datasets it creates, such as </span><span class="f_Text" style="font-style: italic;">DataFrame</span><span class="f_Text"> and </span><span class="f_Text" style="font-style: italic;">Series</span><span class="f_Text"> types, are used as inputs in most data analysis and machine learning modules like </span><span class="f_Text" style="font-style: italic;">SciPy</span><span class="f_Text">, </span><span class="f_Text" style="font-style: italic;">Scikit-Learn</span><span class="f_Text">, and others.</span></p>
<p class="p_Text"><span class="f_Text">The </span><span class="f_Text" style="font-style: italic;">DataFrame</span><span class="f_Text"> object is created in the </span><span class="f_Text" style="font-style: italic;">Pandas</span><span class="f_Text"> library. It is designed to work with indexed arrays of two-dimensional data.</span></p>
<p class="p_Text"><span class="f_Text">In addition, the library provides:</span></p>
<ul style="list-style-type:disc">
<li class="p_li"><span class="f_li">Tools for data exchange between structures in memory and files of different formats;</span></li>
<li class="p_li"><span class="f_Text">Built-in data matching tools and ways to handle missing information;</span></li>
<li class="p_li"><span class="f_Text">Reformatting datasets, including creating pivot tables;</span></li>
<li class="p_li"><span class="f_Text">Advanced indexing and sampling capabilities from large datasets;</span></li>
<li class="p_li"><span class="f_li">Grouping capabilities that enable performing three-step operations like “split, apply, combine”;</span></li>
<li class="p_li"><span class="f_Text">Merging and combining different datasets.</span></li>
</ul>
<p class="p_Text"><span class="f_Text">The library provides the ability to create hierarchical indexing, allowing you to work with high-dimensional data within structures of lower dimensions. Functions for working with time series allow you to form time periods and change intervals. The library is optimized for high performance, with the most important parts of the code written in </span><span class="f_Text" style="font-style: italic;">Cython</span><span class="f_Text"> and </span><span class="f_Text" style="font-style: italic;">C</span><span class="f_Text">.</span></p>
<p class="p_Text"><span class="f_Text">Another library for working with multidimensional arrays, </span><span class="f_Text" style="font-style: italic; font-weight: bold;">NumPy</span><span class="f_Text">, is an open-source library. The main capabilities of this module include support for multidimensional arrays (including matrices) and high-level mathematical functions designed for working with multidimensional arrays.</span></p>
<p class="p_Text"><span class="f_Text">The </span><span class="f_Text" style="font-style: italic;">NumPy</span><span class="f_Text"> library implements computational algorithms in the form of functions and operators that are optimized for working with multidimensional arrays. The library offers the ability to perform vector operations on data. All functions are written in </span><span class="f_Text" style="font-style: italic;">C</span><span class="f_Text"> and optimized for maximum performance. As a result, any algorithm that can be expressed as a sequence of operations on arrays (matrices) and implemented using </span><span class="f_Text" style="font-style: italic;">NumPy</span><span class="f_Text"> runs as fast as the equivalent code executed in </span><span class="f_Text" style="font-style: italic;">MATLAB</span><span class="f_Text">.</span></p>
<p class="p_Text"><span class="f_Text">At the same time, </span><span class="f_Text" style="font-style: italic;">NumPy</span><span class="f_Text"> can be considered as an alternative to using </span><span class="f_Text" style="font-style: italic;">MATLAB</span><span class="f_Text">. Both languages are interpreted and allow performing operations on arrays.</span></p>
<p class="p_Text"><span class="f_Text" style="font-style: italic;">NumPy</span><span class="f_Text"> is often used as a base for working with multidimensional arrays in other libraries. The aforementioned </span><span class="f_Text" style="font-style: italic;">Pandas</span><span class="f_Text"> also uses the </span><span class="f_Text" style="font-style: italic;">NumPy</span><span class="f_Text"> library for low-level array operations.</span></p>
<p class="p_Text"><span class="f_Text">The </span><span class="f_Text" style="font-style: italic; font-weight: bold;">Matplotlib</span><span class="f_Text"> module is a comprehensive library for creating static, animated, and interactive visualizations. It can be used to visualize large volumes of data.</span></p>
<p class="p_Text"><span class="f_Text">We will use the </span><span class="f_Text" style="font-style: italic; font-weight: bold;">TensorFlow</span><span class="f_Text"> library to create neural network models</span><span class="f_Text" style="font-style: italic;">.</span><span class="f_Text"> This is a comprehensive open-source platform for machine learning. It has a flexible ecosystem of tools, libraries, and community resources that allow researchers to advance the latest achievements in machine learning while enabling developers to easily create and deploy machine learning-based applications.</span></p>
<p class="p_Text"><span class="f_Text">The library enables the creation and training of machine learning models using intuitive high-level APIs with eager execution, such as </span><span class="f_Text" style="font-style: italic;">Keras</span><span class="f_Text">. This provides immediate integration of the model and facilitates debugging.</span></p>
<p class="p_Text"><span class="f_Text">Of course, to integrate with the MetaTrader 5 terminal, we will use the </span><span class="f_Text" style="font-style: italic;">MetaTrader5</span><span class="f_Text"> library of the same name. It provides a set of functions for data exchange with the terminal, including functions for retrieving market information and executing trading operations.</span></p>
<p class="p_Text"><span class="f_Text">For technical analysis of data, you can make use of the TA-lib library, which offers a wide range of functions for technical indicators.</span></p>
<p class="p_Text"><span class="f_Text">Before you can use the libraries, you must install them in the </span><span class="f_Text" style="font-style: italic;">Python</span><span class="f_Text"> environment you are using. To do this, in the command prompt or </span><span class="f_Text" style="font-style: italic;">Windows PowerShell</span><span class="f_Text"> with administrator privileges, you need to execute a series of commands:</span></p>
<ul style="list-style-type:disc">
<li class="p_li"><span class="f_li" style="font-style: italic;">NumPy</span><span class="f_li"> installation</span></li>
</ul>
<div style="text-align: left; text-indent: 0; line-height: 1.0; page-break-inside: avoid; page-break-after: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0 0 0 0; margin: 2px 17px 2px 17px;"><table cellspacing="0" cellpadding="3" border="0" style="text-align: justify;border:none; border-spacing:0;">
<tr>
<td style="vertical-align:top; padding:3px; border:none"><p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample" style="color: #333333;">pip</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #333333;">install</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #333333;">numpy</span></p>
</td>
</tr>
</table>
</div>
<ul style="list-style-type:disc">
<li class="p_li"><span class="f_li">installing </span><span class="f_li" style="font-style: italic;">Pandas</span></li>
</ul>
<div style="text-align: left; text-indent: 0; line-height: 1.0; page-break-inside: avoid; page-break-after: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0 0 0 0; margin: 2px 17px 2px 17px;"><table cellspacing="0" cellpadding="3" border="0" style="text-align: justify;border:none; border-spacing:0;">
<tr>
<td style="vertical-align:top; padding:3px; border:none"><p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample" style="color: #333333;">pip</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #333333;">install</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #333333;">pandas</span></p>
</td>
</tr>
</table>
</div>
<ul style="list-style-type:disc">
<li class="p_li"><span class="f_li">installing </span><span class="f_li" style="font-style: italic;">Matplotlib</span></li>
</ul>
<div style="text-align: left; text-indent: 0; line-height: 1.0; page-break-inside: avoid; page-break-after: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0 0 0 0; margin: 2px 17px 2px 17px;"><table cellspacing="0" cellpadding="3" border="0" style="text-align: justify;border:none; border-spacing:0;">
<tr>
<td style="vertical-align:top; padding:3px; border:none"><p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample" style="color: #333333;">pip</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #333333;">install</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #333333;">matplotlib</span></p>
</td>
</tr>
</table>
</div>
<ul style="list-style-type:disc">
<li class="p_li"><span class="f_li">installing </span><span class="f_li" style="font-style: italic;">TensorFlow</span></li>
</ul>
<div style="text-align: left; text-indent: 0; line-height: 1.0; page-break-inside: avoid; page-break-after: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0 0 0 0; margin: 2px 17px 2px 17px;"><table cellspacing="0" cellpadding="3" border="0" style="text-align: justify;border:none; border-spacing:0;">
<tr>
<td style="vertical-align:top; padding:3px; border:none"><p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample" style="color: #333333;">pip</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #333333;">install</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #333333;">tensorflow</span></p>
</td>
</tr>
</table>
</div>
<ul style="list-style-type:disc">
<li class="p_li"><span class="f_li">installing </span><span class="f_li" style="font-style: italic;">Keras</span></li>
</ul>
<div style="text-align: left; text-indent: 0; line-height: 1.0; page-break-inside: avoid; page-break-after: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0 0 0 0; margin: 2px 17px 2px 17px;"><table cellspacing="0" cellpadding="3" border="0" style="text-align: justify;border:none; border-spacing:0;">
<tr>
<td style="vertical-align:top; padding:3px; border:none"><p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample" style="color: #333333;">pip</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #333333;">install</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #333333;">keras</span></p>
</td>
</tr>
</table>
</div>
<ul style="list-style-type:disc">
<li class="p_li"><span class="f_li">installing MetaTrader 5 library</span></li>
</ul>
<div style="text-align: left; text-indent: 0; line-height: 1.0; page-break-inside: avoid; page-break-after: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0 0 0 0; margin: 2px 17px 2px 17px;"><table cellspacing="0" cellpadding="3" border="0" style="text-align: justify;border:none; border-spacing:0;">
<tr>
<td style="vertical-align:top; padding:3px; border:none"><p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample">pip&nbsp;install&nbsp;MetaTrader5</span></p>
</td>
</tr>
</table>
</div>
<p class="p_Text"><span class="f_Text">Moving directly to the structure of our script, let's create a template </span><span class="f_Text" style="font-style: italic;">template.py</span><span class="f_Text">. The script will consist of several blocks. First, we need to connect the necessary libraries to our script.</span></p>
<div style="text-align: left; text-indent: 0; line-height: 1.0; page-break-inside: avoid; page-break-after: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0 0 0 0; margin: 2px 17px 2px 17px;"><table cellspacing="0" cellpadding="3" border="0" style="text-align: justify;border:none; border-spacing:0;">
<tr>
<td style="vertical-align:top; padding:3px; border:none"><p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample" style="color: #808080;">#&nbsp;import&nbsp;libraries</span><br>
<span class="f_CodeExample" style="color: #0000ff;">import</span><span class="f_CodeExample">&nbsp;os</span><br>
<span class="f_CodeExample" style="color: #0000ff;">import</span><span class="f_CodeExample">&nbsp;pandas&nbsp;</span><span class="f_CodeExample" style="color: #ff0000;">as</span><span class="f_CodeExample">&nbsp;pd</span><br>
<span class="f_CodeExample" style="color: #0000ff;">import</span><span class="f_CodeExample">&nbsp;numpy&nbsp;</span><span class="f_CodeExample" style="color: #ff0000;">as</span><span class="f_CodeExample">&nbsp;np</span><br>
<span class="f_CodeExample" style="color: #0000ff;">import</span><span class="f_CodeExample">&nbsp;tensorflow&nbsp;</span><span class="f_CodeExample" style="color: #ff0000;">as</span><span class="f_CodeExample">&nbsp;tf&nbsp;</span><br>
<span class="f_CodeExample" style="color: #0000ff;">from</span><span class="f_CodeExample">&nbsp;tensorflow&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">import</span><span class="f_CodeExample">&nbsp;keras&nbsp;</span><br>
<span class="f_CodeExample" style="color: #0000ff;">import</span><span class="f_CodeExample">&nbsp;matplotlib&nbsp;</span><span class="f_CodeExample" style="color: #ff0000;">as</span><span class="f_CodeExample">&nbsp;mp</span><br>
<span class="f_CodeExample" style="color: #0000ff;">import</span><span class="f_CodeExample">&nbsp;matplotlib.pyplot&nbsp;</span><span class="f_CodeExample" style="color: #ff0000;">as</span><span class="f_CodeExample">&nbsp;plt</span><br>
<span class="f_CodeExample" style="color: #0000ff;">import</span><span class="f_CodeExample">&nbsp;matplotlib.font_manager&nbsp;</span><span class="f_CodeExample" style="color: #ff0000;">as</span><span class="f_CodeExample">&nbsp;fm</span><br>
<span class="f_CodeExample" style="color: #0000ff;">import</span><span class="f_CodeExample">&nbsp;MetaTrader5&nbsp;</span><span class="f_CodeExample" style="color: #ff0000;">as</span><span class="f_CodeExample">&nbsp;mt5</span></p>
</td>
</tr>
</table>
</div>
<p class="p_Text"><span class="f_Text">After training the models, we will create visualization plots to depict the training process and compare the performance of different models. To standardize the plots, we will define common parameters for their construction.</span></p>
<div style="text-align: left; text-indent: 0; line-height: 1.0; page-break-inside: avoid; page-break-after: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0 0 0 0; margin: 2px 17px 2px 17px;"><table cellspacing="0" cellpadding="3" border="0" style="text-align: justify;border:none; border-spacing:0;">
<tr>
<td style="vertical-align:top; padding:3px; border:none"><p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample" style="color: #808080;">#&nbsp;set&nbsp;parameters&nbsp;for&nbsp;results&nbsp;graphs</span><br>
<span class="f_CodeExample">mp.rcParams.update({</span><span class="f_CodeExample" style="color: #008080;">'font.family'</span><span class="f_CodeExample">:</span><span class="f_CodeExample" style="color: #008080;">'serif'</span><span class="f_CodeExample">,</span><br>
<span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #008080;">'font.serif'</span><span class="f_CodeExample">:</span><span class="f_CodeExample" style="color: #008080;">'Clear&nbsp;Sans'</span><span class="f_CodeExample">,</span><br>
<span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #008080;">'axes.labelsize'</span><span class="f_CodeExample">:</span><span class="f_CodeExample" style="color: #008080;">'medium'</span><span class="f_CodeExample">,</span><br>
<span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #008080;">'legend.fontsize'</span><span class="f_CodeExample">:</span><span class="f_CodeExample" style="color: #008080;">'small'</span><span class="f_CodeExample">,</span><br>
<span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #008080;">'figure.figsize'</span><span class="f_CodeExample">:[</span><span class="f_CodeExample" style="color: #0000ff;">6.0</span><span class="f_CodeExample">,</span><span class="f_CodeExample" style="color: #0000ff;">4.0</span><span class="f_CodeExample">],</span><br>
<span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #008080;">'xtick.labelsize'</span><span class="f_CodeExample">:</span><span class="f_CodeExample" style="color: #008080;">'small'</span><span class="f_CodeExample">,</span><br>
<span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #008080;">'ytick.labelsize'</span><span class="f_CodeExample">:</span><span class="f_CodeExample" style="color: #008080;">'small'</span><span class="f_CodeExample">,</span><br>
<span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #008080;">'axes.titlesize'</span><span class="f_CodeExample">:&nbsp;</span><span class="f_CodeExample" style="color: #008080;">'x-large'</span><span class="f_CodeExample">,</span><br>
<span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #008080;">'axes.titlecolor'</span><span class="f_CodeExample">:&nbsp;</span><span class="f_CodeExample" style="color: #008080;">'#333333'</span><span class="f_CodeExample">,</span><br>
<span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #008080;">'axes.labelcolor'</span><span class="f_CodeExample">:&nbsp;</span><span class="f_CodeExample" style="color: #008080;">'#333333'</span><span class="f_CodeExample">,</span><br>
<span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #008080;">'axes.edgecolor'</span><span class="f_CodeExample">:&nbsp;</span><span class="f_CodeExample" style="color: #008080;">'#333333'</span><br>
<span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;})</span></p>
</td>
</tr>
</table>
</div>
<p class="p_Text"><span class="f_Text">We will perform the training and testing of all models on a single dataset, which we will specifically preload into a file on the local disk. This approach will allow us to eliminate the influence of disparate data and assess the performance of different neural network models under consistent conditions.</span></p>
<p class="p_Text"><span class="f_Text">Hence, in the next step, we will load the initial data from the file into the table. Please note the following: since MetaTrader 5 restricts access to files from its programs within the sandboxed environment, you need to provide the full path to the source data file. It will be stored in the </span><span class="f_Text" style="font-style: italic;">MQL5\Files</span><span class="f_Text"> directory of your terminal or its subdirectories if they were specified when saving the data file.</span></p>
<p class="p_Text"><span class="f_Text">Instead of hardcoding the path to the terminal sandbox in our program code, we will retrieve it from MetaTrader 5 using the provided API. To achieve this, we first establish a connection to the installed terminal and verify the outcome of this operation.</span></p>
<div style="text-align: left; text-indent: 0; line-height: 1.0; page-break-inside: avoid; page-break-after: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0 0 0 0; margin: 2px 17px 2px 17px;"><table cellspacing="0" cellpadding="3" border="0" style="text-align: justify;border:none; border-spacing:0;">
<tr>
<td style="vertical-align:top; padding:3px; border:none"><p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample" style="color: #808080;">#&nbsp;Connecting&nbsp;to&nbsp;the&nbsp;MetaTrader&nbsp;5&nbsp;terminal</span><br>
<span class="f_CodeExample" style="color: #0000ff;">if</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">not</span><span class="f_CodeExample">&nbsp;mt5.initialize():</span><br>
<span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">print</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #008080;">&quot;initialize()&nbsp;failed,&nbsp;error&nbsp;code&nbsp;=&quot;</span><span class="f_CodeExample">,mt5.last_error())</span><br>
<span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;quit()</span></p>
</td>
</tr>
</table>
</div>
<p class="p_Text"><span class="f_Text">After successfully connecting to the terminal, we will request the sandbox path and then disconnect from the terminal. Subsequent operations involving model creation and training will be conducted using Python tools. We do not plan to perform any trading operations in this script.</span></p>
<div style="text-align: left; text-indent: 0; line-height: 1.0; page-break-inside: avoid; page-break-after: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0 0 0 0; margin: 2px 17px 2px 17px;"><table cellspacing="0" cellpadding="3" border="0" style="text-align: justify;border:none; border-spacing:0;">
<tr>
<td style="vertical-align:top; padding:3px; border:none"><p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample" style="color: #808080;">#&nbsp;Requesting&nbsp;a&nbsp;sandbox&nbsp;path</span><br>
<span class="f_CodeExample">path=os.path.join(mt5.terminal_info().data_path,</span><span class="f_CodeExample" style="color: #008080;">r'MQL5\Files'</span><span class="f_CodeExample">)</span><br>
<span class="f_CodeExample">mt5.shutdown()</span></p>
</td>
</tr>
</table>
</div>
<p class="p_Text"><span class="f_Text">In the following short data loading block, you can observe the usage of functions from all three aforementioned libraries simultaneously. Using the os.</span><span class="f_Text" style="font-style: italic;">path.join</span><span class="f_Text"> function, we concatenate the path to the working directory with the name of the training sample file. With the </span><span class="f_Text" style="font-style: italic;">read_table</span><span class="f_Text"> function from the </span><span class="f_Text" style="font-style: italic;">Pandas</span><span class="f_Text"> library, we read and convert the contents of the </span><span class="f_Text" style="font-style: italic;">CSV</span><span class="f_Text"> file into a table. Then we convert the obtained table into a two-dimensional array using the </span><span class="f_Text" style="font-style: italic;">NumPy</span><span class="f_Text"> library function.</span></p>
<div style="text-align: left; text-indent: 0; line-height: 1.0; page-break-inside: avoid; page-break-after: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0 0 0 0; margin: 2px 17px 2px 17px;"><table cellspacing="0" cellpadding="3" border="0" style="text-align: justify;border:none; border-spacing:0;">
<tr>
<td style="vertical-align:top; padding:3px; border:none"><p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample" style="color: #808080;">#&nbsp;Loading&nbsp;a&nbsp;training&nbsp;sample</span><br>
<span class="f_CodeExample">filename&nbsp;=&nbsp;os.path.join(path,</span><span class="f_CodeExample" style="color: #008080;">'study_data.csv'</span><span class="f_CodeExample">)</span><br>
<span class="f_CodeExample">data&nbsp;=&nbsp;np.asarray(&nbsp;pd.read_table(filename,</span><br>
<span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sep=</span><span class="f_CodeExample" style="color: #008080;">','</span><span class="f_CodeExample">,</span><br>
<span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;header=</span><span class="f_CodeExample" style="color: #ff0000;">None</span><span class="f_CodeExample">,</span><br>
<span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;skipinitialspace=</span><span class="f_CodeExample" style="color: #ff0000;">True</span><span class="f_CodeExample">,</span><br>
<span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;encoding=</span><span class="f_CodeExample" style="color: #008080;">'utf-8'</span><span class="f_CodeExample">,</span><br>
<span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;float_precision=</span><span class="f_CodeExample" style="color: #008080;">'high'</span><span class="f_CodeExample">,</span><br>
<span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dtype=np.float64,</span><br>
<span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;low_memory=</span><span class="f_CodeExample" style="color: #ff0000;">False</span><span class="f_CodeExample">))</span></p>
</td>
</tr>
</table>
</div>
<p class="p_Text"><span class="f_Text">The actual reading of the </span><span class="f_Text" style="font-style: italic;">CSV</span><span class="f_Text"> file contents and the transformation of rows into a table are performed using the </span><span class="f_Text" style="font-style: italic;">read_table</span><span class="f_Text"> function from the </span><span class="f_Text" style="font-style: italic;">Pandas</span><span class="f_Text"> library. This function has quite a few parameters for precise configuration of the methods to transform string data into the desired numerical data type. Their full description can be found in the library <a href="https://pandas.pydata.org/docs/reference/api/pandas.read_table.html" target="_blank" rel="external" class="weblink" title="Pandas documentation">documentation</a>. We will only describe those we use:</span></p>
<ul style="list-style-type:disc">
<li class="p_li"><span class="f_li" style="font-style: italic;">filename</span><span class="f_li"> gives the name of the file to be read, specifying full or relative path;</span></li>
<li class="p_li"><span class="f_li" style="font-style: italic;">sep</span><span class="f_li"> specifies the data separator used in the file;</span></li>
<li class="p_li"><span class="f_li" style="font-style: italic;">header</span><span class="f_li"> provides row numbers to be used as column names and the beginning of the data, in the absence of headers we specify the value </span><span class="f_li" style="font-style: italic;">None</span><span class="f_li">;</span></li>
<li class="p_li"><span class="f_li" style="font-style: italic;">skipinitialspace</span><span class="f_li"> is a boolean parameter that specifies whether to skip spaces after the delimiter;</span></li>
<li class="p_li"><span class="f_li" style="font-style: italic;">encoding</span><span class="f_li"> specifies the type of encoding used;</span></li>
<li class="p_li"><span class="f_li" style="font-style: italic;">float_precision</span><span class="f_li"> determines which converter should be used for floating point values;</span></li>
<li class="p_li"><span class="f_li" style="font-style: italic;">dtype</span><span class="f_li"> specifies the final data type;</span></li>
<li class="p_li"><span class="f_li" style="font-style: italic;">low_memory</span><span class="f_li"> internally processes the file piecemeal, which will result in less memory usage during parsing.</span></li>
</ul>
<p class="p_Text"><span class="f_Text">As a result of these operations, all training sample data were loaded into a two-dimensional array object of type </span><span class="f_Text" style="font-style: italic;">numpy.ndarray</span><span class="f_Text"> from the </span><span class="f_Text" style="font-style: italic;">NumPy</span><span class="f_Text"> library. Among the loaded data, there are elements of the source data and target values. However, for training a neural network, we need to separately feed the source data as input to the network and then compare the obtained output with the target values after the forward pass. It turns out that the input data and targets for the neural network are separated in time and place of use.</span></p>
<p class="p_Text"><span class="f_Text">Hence, we need to split this data into separate arrays. Let each data row represent an individual data pattern, with the last two elements of the row containing the target points for that pattern. The </span><span class="f_Text" style="font-style: italic;">shape</span><span class="f_Text"> function will show the size of our array, which means we can use it to determine the dimensions of the initial data and target values. Only by knowing these dimensions can we copy specific samples into new arrays.</span></p>
<p class="p_Text"><span class="f_Text">In the block below, we will divide the training sample into 2 tables. In doing so, we are separating only the columns while preserving the entire structure of rows. Thus, we get the initial data in one array and the target values in the other array. The patterns can be mapped to the corresponding target values by row number.</span></p>
<div style="text-align: left; text-indent: 0; line-height: 1.0; page-break-inside: avoid; page-break-after: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0 0 0 0; margin: 2px 17px 2px 17px;"><table cellspacing="0" cellpadding="3" border="0" style="text-align: justify;border:none; border-spacing:0;">
<tr>
<td style="vertical-align:top; padding:3px; border:none"><p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample" style="color: #808080;">#&nbsp;Dividing&nbsp;the&nbsp;training&nbsp;sample&nbsp;into&nbsp;baseline&nbsp;data&nbsp;and&nbsp;targets</span><br>
<span class="f_CodeExample">inputs=data.shape[</span><span class="f_CodeExample" style="color: #008100;">1</span><span class="f_CodeExample">]-</span><span class="f_CodeExample" style="color: #008100;">2</span><br>
<span class="f_CodeExample">targerts=</span><span class="f_CodeExample" style="color: #008100;">2</span><br>
<span class="f_CodeExample">train_data=data[:,</span><span class="f_CodeExample" style="color: #008100;">0</span><span class="f_CodeExample">:inputs]</span><br>
<span class="f_CodeExample">train_target=data[:,inputs:]</span></p>
</td>
</tr>
</table>
</div>
<p class="p_Text"><span class="f_Text">Now that we have the training data, we can start building the neural network model. We will create models using the function </span><span class="f_Text" style="font-style: italic;">Sequential</span><span class="f_Text"> from the </span><span class="f_Text" style="font-style: italic;">Keras</span><span class="f_Text"> library.</span></p>
<div style="text-align: left; text-indent: 0; line-height: 1.0; page-break-inside: avoid; page-break-after: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0 0 0 0; margin: 2px 17px 2px 17px;"><table cellspacing="0" cellpadding="3" border="0" style="text-align: justify;border:none; border-spacing:0;">
<tr>
<td style="vertical-align:top; padding:3px; border:none"><p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample" style="color: #808080;">#&nbsp;Create&nbsp;a&nbsp;neural&nbsp;network&nbsp;model</span><br>
<span class="f_CodeExample" style="color: #333333;">model</span><span class="f_CodeExample">&nbsp;=&nbsp;</span><span class="f_CodeExample" style="color: #333333;">keras</span><span class="f_CodeExample">.</span><span class="f_CodeExample" style="color: #333333;">Sequential</span><span class="f_CodeExample">([....])</span></p>
</td>
</tr>
</table>
</div>
<p class="p_Text"><span class="f_Text">The Sequential model is a linear stack of layers. You can create a Sequential model by passing a list of layers to the model's constructor, and you can also add layers using the </span><span class="f_Text" style="font-style: italic;">add</span><span class="f_Text"> method.</span></p>
<p class="p_Text"><span class="f_Text">First of all, our model needs to know what dimensionality of data to expect at the input. In this regard, the first layer of the </span><span class="f_Text" style="font-style: italic;">Sequential</span><span class="f_Text"> model must obtain information about the dimensionality of the input data. All subsequent layers perform an automatic dimensionality calculation.</span></p>
<p class="p_Text"><span class="f_Text">There are several ways to specify the dimensions of the raw data:</span></p>
<ul style="list-style-type:disc">
<li class="p_li"><span class="f_li">Pass the </span><span class="f_li" style="font-style: italic;">input_shape</span><span class="f_li"> argument to the first layer.</span></li>
<li class="p_li"><span class="f_li">Some 2D layers support the specification of the dimensionality of the input data via the </span><span class="f_li" style="font-style: italic;">input_dim</span><span class="f_li"> argument. Some 3D layers support </span><span class="f_li" style="font-style: italic;">input_dim</span><span class="f_li"> and </span><span class="f_li" style="font-style: italic;">input_length</span><span class="f_li"> arguments.</span></li>
<li class="p_li"><span class="f_li">Use a special type of neural layer for the original </span><span class="f_li" style="font-style: italic;">Input</span><span class="f_li"> data with the </span><span class="f_li" style="font-style: italic;">shape</span><span class="f_li"> parameter that specifies the size of the layer.</span></li>
</ul>
<div style="text-align: left; text-indent: 0; line-height: 1.0; page-break-inside: avoid; page-break-after: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0 0 0 0; margin: 2px 17px 2px 17px;"><table cellspacing="0" cellpadding="3" border="0" style="text-align: justify;border:none; border-spacing:0;">
<tr>
<td style="vertical-align:top; padding:3px; border:none"><p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample" style="color: #808080;">#&nbsp;Create&nbsp;a&nbsp;neural&nbsp;network&nbsp;model</span><br>
<span class="f_CodeExample">model&nbsp;=&nbsp;keras.Sequential([keras.Input(shape=inputs),</span><br>
<span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #808080;">#&nbsp;Fill&nbsp;the&nbsp;model&nbsp;with&nbsp;a&nbsp;description&nbsp;of&nbsp;the&nbsp;neural&nbsp;layers</span><br>
<span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;])</span></p>
</td>
</tr>
</table>
</div>
<p class="p_Text"><span class="f_Text">We will become familiar with the types of proposed neural layers as we study their architectures. Now let's look at the general principles of building and organizing models.</span></p>
<p class="p_Text"><span class="f_Text">Once the model is created, you need to prepare it for training and customize the process. This functionality is performed in the </span><span class="f_Text" style="font-style: italic;"><a href="https://www.tensorflow.org/api_docs/python/tf/keras/Model#compile" target="_blank" rel="external" class="weblink" title="TensorFlow model.compile documentation">compile</a></span><span class="f_Text"> method which has several parameters:</span></p>
<ul style="list-style-type:disc">
<li class="p_li"><span class="f_li" style="font-style: italic;">optimizer</span><span class="f_li"> – an optimizer, can be specified as a string identifier of an existing optimizer or as an instance of the </span><span class="f_li" style="font-style: italic;">Optimizer</span><span class="f_li"> class;</span></li>
<li class="p_li"><span class="f_li" style="font-style: italic;">loss</span><span class="f_li"> – a loss function, can be specified by a string identifier of an existing loss function, or an eigenfunction;</span></li>
<li class="p_li"><span class="f_li" style="font-style: italic;">metrics</span><span class="f_li"> – a list of metrics that the model should evaluate during training and testing, for example, 'accuracy' could be used for the classification task;</span></li>
<li class="p_li"><span class="f_li" style="font-style: italic;">loss_weights</span><span class="f_li"> – an optional list or dictionary that defines scalar coefficients for weighting the loss contributions of various model outputs;</span></li>
<li class="p_li"><span class="f_li">weighted_metrics – a list of metrics that will be evaluated and weighted during training and testing.</span></li>
</ul>
<p class="p_Text"><span class="f_Text">For each parameter, the </span><span class="f_Text" style="font-style: italic;">Keras</span><span class="f_Text"> library offers a different list of possible values, but it does not limit the user to the proposed options. For each parameter, there is a possibility to add custom classes and algorithms.</span></p>
<div style="text-align: left; text-indent: 0; line-height: 1.0; page-break-inside: avoid; page-break-after: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0 0 0 0; margin: 2px 17px 2px 17px;"><table cellspacing="0" cellpadding="3" border="0" style="text-align: justify;border:none; border-spacing:0;">
<tr>
<td style="vertical-align:top; padding:3px; border:none"><p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample" style="color: #333333;">model</span><span class="f_CodeExample">.</span><span class="f_CodeExample" style="color: #333333;">compile</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #333333;">optimizer</span><span class="f_CodeExample">=</span><span class="f_CodeExample" style="color: #008080;">'Adam'</span><span class="f_CodeExample">,&nbsp;</span><br>
<span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">loss</span><span class="f_CodeExample">=</span><span class="f_CodeExample" style="color: #008080;">'mean_squared_error'</span><span class="f_CodeExample">,&nbsp;</span><br>
<span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">metrics</span><span class="f_CodeExample">=[</span><span class="f_CodeExample" style="color: #008080;">'accuracy'</span><span class="f_CodeExample">])</span></p>
</td>
</tr>
</table>
</div>
<p class="p_Text"><span class="f_Text">Next, we can start training the created model using the </span><span class="f_Text" style="font-style: italic;"><a href="https://www.tensorflow.org/api_docs/python/tf/keras/Model#fit" target="_blank" rel="external" class="weblink" title="TensorFlow model.fit documentation">fit</a></span><span class="f_Text"> method, which allows training a model with a fixed number of epochs. This method has parameters to customize the learning process.</span></p>
<ul style="list-style-type:disc">
<li class="p_li"><span class="f_li" style="font-style: italic;">x</span><span class="f_li"> – an array of initial data;</span></li>
<li class="p_li"><span class="f_li" style="font-style: italic;">y</span><span class="f_li"> – an array of target results;</span></li>
<li class="p_li"><span class="f_li" style="font-style: italic;">batch_size</span><span class="f_li"> – an optional parameter, specifies the number of sets of &quot;source data - target values&quot; pairs before updating the weights matrix;</span></li>
<li class="p_li"><span class="f_li" style="font-style: italic;">epochs</span><span class="f_li"> – a number of epochs of training;</span></li>
<li class="p_li"><span class="f_li" style="font-style: italic;">verbose</span><span class="f_li"> – an optional parameter, specifies the level of detail of training logging: 0 - no messages, 1 - progress bar, 2 - one line per epoch, </span><span class="f_li" style="font-style: italic;">auto</span><span class="f_li"> - automatic selection;</span></li>
<li class="p_li"><span class="f_li" style="font-style: italic;">callbacks</span><span class="f_li"> – a list of callbacks to apply during training;</span></li>
<li class="p_li"><span class="f_li" style="font-style: italic;">validation_split</span><span class="f_li"> – carries out allocation of a part of the training sample for validation, specified in fractions from 1.0;</span></li>
<li class="p_li"><span class="f_li" style="font-style: italic;">validation_data</span><span class="f_li"> – a separate sample for validating the learning process;</span></li>
<li class="p_li"><span class="f_li" style="font-style: italic;">shuffle</span><span class="f_li"> – a logical value that indicates the need to shuffle the training sample data before the next epoch;</span></li>
<li class="p_li"><span class="f_li" style="font-style: italic;">class_weight</span><span class="f_li"> – an optional dictionary mapping class indices to a weight value used to weight the loss function (only during training);</span></li>
<li class="p_li"><span class="f_li" style="font-style: italic;">sample_weight</span><span class="f_li"> – an optional array of </span><span class="f_li" style="font-style: italic;">NumPy</span><span class="f_li"> weights for the training sample used to weight the loss function (only during training);</span></li>
<li class="p_li"><span class="f_li" style="font-style: italic;">initial_epoch</span><span class="f_li"> – a training start epoch, can be useful for resuming a previous training cycle;</span></li>
<li class="p_li"><span class="f_li" style="font-style: italic;">steps_per_epoch</span><span class="f_li"> – a total number of packets before declaring one epoch completed and starting the next, by default equal to the training sample size;</span></li>
<li class="p_li"><span class="f_li" style="font-style: italic;">validation_steps</span><span class="f_li"> – the total number of packets from the validation sample before stopping when performing validation at the end of each epoch, defaults to the validation sample size;</span></li>
<li class="p_li"><span class="f_li" style="font-style: italic;">validation_batch_size</span><span class="f_li"> – a number of samples per validation batch;</span></li>
<li class="p_li"><span class="f_li" style="font-style: italic;">validation_freq</span><span class="f_li"> – an integer, specifies the number of training periods before performing a new validation run.</span></li>
</ul>
<p class="p_Text"><span class="f_Text">Of course, we will not use the full set of parameters in the first model. I propose to stop at the parameter </span><span class="f_Text" style="font-style: italic;"><a href="https://www.tensorflow.org/api_docs/python/tf/keras/callbacks/Callback" target="_blank" rel="external" class="weblink" title="TensorFlow keras.callbacks documentation">callbacks</a></span><span class="f_Text"> which sets a callback list. This option provides methods for interacting with the learning process in an interactive way.</span></p>
<p class="p_Text"><span class="f_Text">Its usage allows configuring the retrieval of real-time information about the training process and managing the process itself. In particular, you can accumulate the average values of indicators for an epoch or save the results of each epoch to a </span><span class="f_Text" style="font-style: italic;">CSV</span><span class="f_Text"> file. You can also monitor training metrics and adjust the learning rate or even stop the training process when the monitored metric stops improving. At the same time, it is possible to add your own callback classes.</span></p>
<p class="p_Text"><span class="f_Text">I suggest using early stopping in the training procedure if there is no improvement in the error function metric over five epochs.</span></p>
<div style="text-align: left; text-indent: 0; line-height: 1.0; page-break-inside: avoid; page-break-after: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0 0 0 0; margin: 2px 17px 2px 17px;"><table cellspacing="0" cellpadding="3" border="0" style="text-align: justify;border:none; border-spacing:0;">
<tr>
<td style="vertical-align:top; padding:3px; border:none"><p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample" style="color: #333333;">callback</span><span class="f_CodeExample">&nbsp;=&nbsp;</span><span class="f_CodeExample" style="color: #333333;">tf</span><span class="f_CodeExample">.</span><span class="f_CodeExample" style="color: #333333;">keras</span><span class="f_CodeExample">.</span><span class="f_CodeExample" style="color: #333333;">callbacks</span><span class="f_CodeExample">.</span><span class="f_CodeExample" style="color: #333333;">EarlyStopping</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #333333;">monitor</span><span class="f_CodeExample">=</span><span class="f_CodeExample" style="color: #008080;">'loss'</span><span class="f_CodeExample">,&nbsp;</span><span class="f_CodeExample" style="color: #333333;">patience</span><span class="f_CodeExample">=</span><span class="f_CodeExample" style="color: #333333;">5</span><span class="f_CodeExample">)</span><br>
<span class="f_CodeExample" style="color: #333333;">history</span><span class="f_CodeExample">&nbsp;=&nbsp;</span><span class="f_CodeExample" style="color: #333333;">model</span><span class="f_CodeExample">.</span><span class="f_CodeExample" style="color: #333333;">fit</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #333333;">train_data</span><span class="f_CodeExample">,&nbsp;</span><span class="f_CodeExample" style="color: #333333;">train_target</span><span class="f_CodeExample">,</span><br>
<span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">epochs</span><span class="f_CodeExample">=</span><span class="f_CodeExample" style="color: #333333;">500</span><span class="f_CodeExample">,&nbsp;</span><span class="f_CodeExample" style="color: #333333;">batch_size</span><span class="f_CodeExample">=</span><span class="f_CodeExample" style="color: #333333;">1000</span><span class="f_CodeExample">,</span><br>
<span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">callbacks</span><span class="f_CodeExample">=[</span><span class="f_CodeExample" style="color: #333333;">callback</span><span class="f_CodeExample">],</span><br>
<span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">verbose</span><span class="f_CodeExample">=</span><span class="f_CodeExample" style="color: #333333;">2</span><span class="f_CodeExample">,</span><br>
<span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">validation_split</span><span class="f_CodeExample">=</span><span class="f_CodeExample" style="color: #333333;">0</span><span class="f_CodeExample">.</span><span class="f_CodeExample" style="color: #333333;">2</span><span class="f_CodeExample">,</span><br>
<span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">shuffle</span><span class="f_CodeExample">=</span><span class="f_CodeExample" style="color: #ff0000;">true</span><span class="f_CodeExample">)</span></p>
</td>
</tr>
</table>
</div>
<p class="p_Text"><span class="f_Text">After training is complete, save the trained model to a file on the local disk. To do this, let's use the methods of the </span><span class="f_Text" style="font-style: italic;">Keras</span><span class="f_Text"> and </span><span class="f_Text" style="font-style: italic;">os</span><span class="f_Text"> libraries.</span></p>
<div style="text-align: left; text-indent: 0; line-height: 1.0; page-break-inside: avoid; page-break-after: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0 0 0 0; margin: 2px 17px 2px 17px;"><table cellspacing="0" cellpadding="3" border="0" style="text-align: justify;border:none; border-spacing:0;">
<tr>
<td style="vertical-align:top; padding:3px; border:none"><p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample" style="color: #808080;">#&nbsp;Saving&nbsp;the&nbsp;learned&nbsp;model</span><br>
<span class="f_CodeExample" style="color: #333333;">model</span><span class="f_CodeExample">.</span><span class="f_CodeExample" style="color: #333333;">save</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #333333;">os</span><span class="f_CodeExample">.</span><span class="f_CodeExample" style="color: #333333;">path</span><span class="f_CodeExample">.</span><span class="f_CodeExample" style="color: #333333;">join</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #333333;">path</span><span class="f_CodeExample">,</span><span class="f_CodeExample" style="color: #008080;">'model.h5'</span><span class="f_CodeExample">))</span></p>
</td>
</tr>
</table>
</div>
<p class="p_Text"><span class="f_Text">For clarity and understanding of the training process, let's plot the dynamics of metric changes during training and validation. Here we will use the methods of the </span><span class="f_Text" style="font-style: italic;">Matplotlib</span><span class="f_Text"> library.</span></p>
<div style="text-align: left; text-indent: 0; line-height: 1.0; page-break-inside: avoid; page-break-after: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0 0 0 0; margin: 2px 17px 2px 17px;"><table cellspacing="0" cellpadding="3" border="0" style="text-align: justify;border:none; border-spacing:0;">
<tr>
<td style="vertical-align:top; padding:3px; border:none"><p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample" style="color: #808080;">#&nbsp;Drawing&nbsp;model&nbsp;learning&nbsp;results</span><br>
<span class="f_CodeExample" style="color: #333333;">plt</span><span class="f_CodeExample">.</span><span class="f_CodeExample" style="color: #333333;">plot</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #333333;">history</span><span class="f_CodeExample">.</span><span class="f_CodeExample" style="color: #333333;">history</span><span class="f_CodeExample">[</span><span class="f_CodeExample" style="color: #008080;">'loss'</span><span class="f_CodeExample">],&nbsp;</span><span class="f_CodeExample" style="color: #333333;">label</span><span class="f_CodeExample">=</span><span class="f_CodeExample" style="color: #008080;">'Train'</span><span class="f_CodeExample">)</span><br>
<span class="f_CodeExample" style="color: #333333;">plt</span><span class="f_CodeExample">.</span><span class="f_CodeExample" style="color: #333333;">plot</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #333333;">history</span><span class="f_CodeExample">.</span><span class="f_CodeExample" style="color: #333333;">history</span><span class="f_CodeExample">[</span><span class="f_CodeExample" style="color: #008080;">'val_loss'</span><span class="f_CodeExample">],&nbsp;</span><span class="f_CodeExample" style="color: #333333;">label</span><span class="f_CodeExample">=</span><span class="f_CodeExample" style="color: #008080;">'Validation'</span><span class="f_CodeExample">)</span><br>
<span class="f_CodeExample" style="color: #333333;">plt</span><span class="f_CodeExample">.</span><span class="f_CodeExample" style="color: #333333;">ylabel</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #008080;">'$MSE$&nbsp;$Loss$'</span><span class="f_CodeExample">)</span><br>
<span class="f_CodeExample" style="color: #333333;">plt</span><span class="f_CodeExample">.</span><span class="f_CodeExample" style="color: #333333;">xlabel</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #008080;">'$Epochs$'</span><span class="f_CodeExample">)</span><br>
<span class="f_CodeExample" style="color: #333333;">plt</span><span class="f_CodeExample">.</span><span class="f_CodeExample" style="color: #333333;">title</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #008080;">'Dynamic&nbsp;of&nbsp;Models&nbsp;train'</span><span class="f_CodeExample">)</span><br>
<span class="f_CodeExample" style="color: #333333;">plt</span><span class="f_CodeExample">.</span><span class="f_CodeExample" style="color: #333333;">legend</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #333333;">loc</span><span class="f_CodeExample">=</span><span class="f_CodeExample" style="color: #008080;">'upper&nbsp;right'</span><span class="f_CodeExample">)</span><br>
<span class="f_CodeExample">&nbsp;</span><br>
<span class="f_CodeExample" style="color: #333333;">plt</span><span class="f_CodeExample">.</span><span class="f_CodeExample" style="color: #333333;">figure</span><span class="f_CodeExample">()</span><br>
<span class="f_CodeExample" style="color: #333333;">plt</span><span class="f_CodeExample">.</span><span class="f_CodeExample" style="color: #333333;">plot</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #333333;">history</span><span class="f_CodeExample">.</span><span class="f_CodeExample" style="color: #333333;">history</span><span class="f_CodeExample">[</span><span class="f_CodeExample" style="color: #008080;">'accuracy'</span><span class="f_CodeExample">],&nbsp;</span><span class="f_CodeExample" style="color: #333333;">label</span><span class="f_CodeExample">=</span><span class="f_CodeExample" style="color: #008080;">'Train'</span><span class="f_CodeExample">)</span><br>
<span class="f_CodeExample" style="color: #333333;">plt</span><span class="f_CodeExample">.</span><span class="f_CodeExample" style="color: #333333;">plot</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #333333;">history</span><span class="f_CodeExample">.</span><span class="f_CodeExample" style="color: #333333;">history</span><span class="f_CodeExample">[</span><span class="f_CodeExample" style="color: #008080;">'val_accuracy'</span><span class="f_CodeExample">],&nbsp;</span><span class="f_CodeExample" style="color: #333333;">label</span><span class="f_CodeExample">=</span><span class="f_CodeExample" style="color: #008080;">'Validation'</span><span class="f_CodeExample">)</span><br>
<span class="f_CodeExample" style="color: #333333;">plt</span><span class="f_CodeExample">.</span><span class="f_CodeExample" style="color: #333333;">ylabel</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #008080;">'$Accuracy$'</span><span class="f_CodeExample">)</span><br>
<span class="f_CodeExample" style="color: #333333;">plt</span><span class="f_CodeExample">.</span><span class="f_CodeExample" style="color: #333333;">xlabel</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #008080;">'$Epochs$'</span><span class="f_CodeExample">)</span><br>
<span class="f_CodeExample" style="color: #333333;">plt</span><span class="f_CodeExample">.</span><span class="f_CodeExample" style="color: #333333;">title</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #008080;">'Dynamic&nbsp;of&nbsp;Models&nbsp;train'</span><span class="f_CodeExample">)</span><br>
<span class="f_CodeExample" style="color: #333333;">plt</span><span class="f_CodeExample">.</span><span class="f_CodeExample" style="color: #333333;">legend</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #333333;">loc</span><span class="f_CodeExample">=</span><span class="f_CodeExample" style="color: #008080;">'lower&nbsp;right'</span><span class="f_CodeExample">)</span></p>
</td>
</tr>
</table>
</div>
<p class="p_Text"><span class="f_Text">After training, it's necessary to evaluate our model's performance on the test dataset, as before deploying the model in real conditions, we need to understand how it will perform on new data. To do this, we will load a test sample. The data loading procedure is entirely analogous to loading the training dataset, with the only difference being the filename.</span></p>
<div style="text-align: left; text-indent: 0; line-height: 1.0; page-break-inside: avoid; page-break-after: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0 0 0 0; margin: 2px 17px 2px 17px;"><table cellspacing="0" cellpadding="3" border="0" style="text-align: justify;border:none; border-spacing:0;">
<tr>
<td style="vertical-align:top; padding:3px; border:none"><p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample" style="color: #808080;">#&nbsp;Loading&nbsp;a&nbsp;test&nbsp;sample</span><br>
<span class="f_CodeExample" style="color: #333333;">test_filename</span><span class="f_CodeExample">&nbsp;=&nbsp;</span><span class="f_CodeExample" style="color: #333333;">os</span><span class="f_CodeExample">.</span><span class="f_CodeExample" style="color: #333333;">path</span><span class="f_CodeExample">.</span><span class="f_CodeExample" style="color: #333333;">join</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #333333;">path</span><span class="f_CodeExample">,</span><span class="f_CodeExample" style="color: #008080;">'test_data.csv'</span><span class="f_CodeExample">)</span><br>
<span class="f_CodeExample" style="color: #333333;">test</span><span class="f_CodeExample">&nbsp;=&nbsp;</span><span class="f_CodeExample" style="color: #333333;">np</span><span class="f_CodeExample">.</span><span class="f_CodeExample" style="color: #333333;">asarray</span><span class="f_CodeExample">(&nbsp;</span><span class="f_CodeExample" style="color: #333333;">pd</span><span class="f_CodeExample">.</span><span class="f_CodeExample" style="color: #333333;">read_table</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #333333;">test_filename</span><span class="f_CodeExample">,</span><br>
<span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">sep</span><span class="f_CodeExample">=</span><span class="f_CodeExample" style="color: #008080;">','</span><span class="f_CodeExample">,</span><br>
<span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">header</span><span class="f_CodeExample">=</span><span class="f_CodeExample" style="color: #333333;">None</span><span class="f_CodeExample">,</span><br>
<span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">skipinitialspace</span><span class="f_CodeExample">=</span><span class="f_CodeExample" style="color: #ff0000;">true</span><span class="f_CodeExample">,</span><br>
<span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">encoding</span><span class="f_CodeExample">=</span><span class="f_CodeExample" style="color: #008080;">'utf-8'</span><span class="f_CodeExample">,</span><br>
<span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">float_precision</span><span class="f_CodeExample">=</span><span class="f_CodeExample" style="color: #008080;">'high'</span><span class="f_CodeExample">,</span><br>
<span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">dtype</span><span class="f_CodeExample">=</span><span class="f_CodeExample" style="color: #333333;">np</span><span class="f_CodeExample">.</span><span class="f_CodeExample" style="color: #333333;">float64</span><span class="f_CodeExample">,</span><br>
<span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">low_memory</span><span class="f_CodeExample">=</span><span class="f_CodeExample" style="color: #ff0000;">false</span><span class="f_CodeExample">))</span></p>
</td>
</tr>
</table>
</div>
<p class="p_Text"><span class="f_Text">After loading the data, we will split the obtained table into source data and target labels, just as we did with the training dataset.</span></p>
<div style="text-align: left; text-indent: 0; line-height: 1.0; page-break-inside: avoid; page-break-after: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0 0 0 0; margin: 2px 17px 2px 17px;"><table cellspacing="0" cellpadding="3" border="0" style="text-align: justify;border:none; border-spacing:0;">
<tr>
<td style="vertical-align:top; padding:3px; border:none"><p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample" style="color: #808080;">#&nbsp;Dividing&nbsp;the&nbsp;test&nbsp;sample&nbsp;into&nbsp;raw&nbsp;data&nbsp;and&nbsp;targets</span><br>
<span class="f_CodeExample" style="color: #333333;">test_data</span><span class="f_CodeExample">=</span><span class="f_CodeExample" style="color: #333333;">test</span><span class="f_CodeExample">[:,</span><span class="f_CodeExample" style="color: #333333;">0</span><span class="f_CodeExample">:</span><span class="f_CodeExample" style="color: #333333;">inputs</span><span class="f_CodeExample">]</span><br>
<span class="f_CodeExample" style="color: #333333;">test_target</span><span class="f_CodeExample">=</span><span class="f_CodeExample" style="color: #333333;">test</span><span class="f_CodeExample">[:,</span><span class="f_CodeExample" style="color: #333333;">inputs</span><span class="f_CodeExample">:]</span></p>
</td>
</tr>
</table>
</div>
<p class="p_Text"><span class="f_Text">We will check the quality of the trained model on the test sample using the </span><span class="f_Text" style="font-style: italic;"><a href="https://www.tensorflow.org/api_docs/python/tf/keras/Model#evaluate" target="_blank" rel="external" class="weblink" title="TensorFlow model.evaluate documentation">evaluate</a> </span><span class="f_Text">method from the </span><span class="f_Text" style="font-style: italic;">Keras</span><span class="f_Text"> library. As a result of calling the specified method, we obtain the loss value and metrics on the test dataset. The method has a number of parameters to customize the testing process:</span></p>
<ul style="list-style-type:disc">
<li class="p_li"><span class="f_li" style="font-style: italic;">x</span><span class="f_li"> – an array of initial data of the test sample;</span></li>
<li class="p_li"><span class="f_li" style="font-style: italic;">y</span><span class="f_li"> – an array of test sample targets;</span></li>
<li class="p_li"><span class="f_li" style="font-style: italic;">batch_size</span><span class="f_li"> – a size of the test batch;</span></li>
<li class="p_li"><span class="f_li" style="font-style: italic;">verbose</span><span class="f_li"> – a mode of process logging detailing (0 - no logging, 1 - progress indication);</span></li>
<li class="p_li"><span class="f_li" style="font-style: italic;">sample_weight</span><span class="f_li"> – an optional parameter used to weight the loss function;</span></li>
<li class="p_li"><span class="f_li" style="font-style: italic;">steps</span><span class="f_li"> – a total number of steps to declare the testing process complete;</span></li>
<li class="p_li"><span class="f_li" style="font-style: italic;">callbacks</span><span class="f_li"> – a list of callbacks used in the training process;</span></li>
<li class="p_li"><span class="f_li" style="font-style: italic;">return_dict</span><span class="f_li"> – a boolean variable that defines the format of the method output (</span><span class="f_li" style="font-style: italic;">True</span><span class="f_li"> = as a &quot;metric-value&quot; dictionary, </span><span class="f_li" style="font-style: italic;">False</span><span class="f_li"> = as a list).</span></li>
</ul>
<p class="p_Text"><span class="f_Text">Most of the above parameters are optional and also have default values. To initiate the testing process, in most cases, it's sufficient to simply provide the data arrays.</span></p>
<div style="text-align: left; text-indent: 0; line-height: 1.0; page-break-inside: avoid; page-break-after: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0 0 0 0; margin: 2px 17px 2px 17px;"><table cellspacing="0" cellpadding="3" border="0" style="text-align: justify;border:none; border-spacing:0;">
<tr>
<td style="vertical-align:top; padding:3px; border:none"><p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample" style="color: #808080;">#&nbsp;Validation&nbsp;of&nbsp;model&nbsp;results&nbsp;on&nbsp;test&nbsp;sample</span><br>
<span class="f_CodeExample">l</span><span class="f_CodeExample" style="color: #333333;">test_loss</span><span class="f_CodeExample">,&nbsp;</span><span class="f_CodeExample" style="color: #333333;">test_acc</span><span class="f_CodeExample">&nbsp;=&nbsp;</span><span class="f_CodeExample" style="color: #333333;">model</span><span class="f_CodeExample">.</span><span class="f_CodeExample" style="color: #333333;">evaluate</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #333333;">test_data</span><span class="f_CodeExample">,&nbsp;</span><span class="f_CodeExample" style="color: #333333;">test_target</span><span class="f_CodeExample">)&nbsp;</span></p>
</td>
</tr>
</table>
</div>
<p class="p_Text"><span class="f_Text">Finally, let's output the test results to the log and display the previously plotted graphs.</span></p>
<div style="text-align: left; text-indent: 0; line-height: 1.0; page-break-inside: avoid; page-break-after: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0 0 0 0; margin: 2px 17px 2px 17px;"><table cellspacing="0" cellpadding="3" border="0" style="text-align: justify;border:none; border-spacing:0;">
<tr>
<td style="vertical-align:top; padding:3px; border:none"><p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample" style="color: #808080;">#&nbsp;Logging&nbsp;test&nbsp;results</span><br>
<span class="f_CodeExample" style="color: #0000ff;">print</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #008080;">'Model&nbsp;in&nbsp;test'</span><span class="f_CodeExample">)</span><br>
<span class="f_CodeExample" style="color: #0000ff;">print</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #008080;">'Test&nbsp;accuracy:'</span><span class="f_CodeExample">,&nbsp;</span><span class="f_CodeExample" style="color: #333333;">test_acc</span><span class="f_CodeExample">)</span><br>
<span class="f_CodeExample" style="color: #0000ff;">print</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #008080;">'Test&nbsp;loss:'</span><span class="f_CodeExample">,&nbsp;</span><span class="f_CodeExample" style="color: #333333;">test_loss</span><span class="f_CodeExample">)</span><br>
<span class="f_CodeExample">&nbsp;</span><br>
<span class="f_CodeExample" style="color: #808080;">#&nbsp;Output&nbsp;of&nbsp;created&nbsp;charts</span><br>
<span class="f_CodeExample" style="color: #333333;">plt</span><span class="f_CodeExample">.</span><span class="f_CodeExample" style="color: #333333;">show</span><span class="f_CodeExample">()</span></p>
</td>
</tr>
</table>
</div>
<p class="p_Text"><span class="f_Text">At this point, the basic script template can be considered complete. It's worth noting that attempting to run this script will result in an error. It has nothing to do with errors in template construction. Indeed, we haven't provided a description of our model yet and left the block empty. During the process of exploring various neural network solutions, we will fill in the model architecture description block, allowing us to fully assess the performance of our template.</span></p>

</div>

</body>
</html>
