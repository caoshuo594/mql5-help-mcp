<!DOCTYPE html>
<html>
  <head>
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
  <title>5.1.3 Organization of parallel calculations in the attention block</title>
  <meta name="keywords" content="" />
  <link type="text/css" href="default.css" rel="stylesheet" />

   <script type="text/javascript" src="jquery.js"></script>
   <script type="text/javascript" src="helpman_settings.js"></script>
   <script type="text/javascript" src="helpman_topicinit.js"></script>


</head>

<body style="background-color:#FFFFFF; font-family:'Trebuchet MS',Tahoma,Arial,Helvetica,sans-serif; margin:0px;">



<table width="100%" height="49"  border="0" cellpadding="0" cellspacing="0" style="margin-top:0px; background-color:#1660af;">
  <tr>
    <td></td>
    <td valign="middle">
      <table style="margin-top:4px; margin-bottom:5px;" width="100%"  border="0" cellspacing="0" cellpadding="5">
        <tr valign="middle">
          <td class="nav">
<a class="h_m" href="index.htm">          Neural Networks for Algorithmic Trading with MQL5 </a> / <a class="h_m" href="5_transformer.htm"> 5. Attention mechanisms </a> / <a class="h_m" href="5_1_self-attention.htm"> 5.1 Self-Attention </a>/ 5.1.3 Organizing parallel computing in the attention block
          </td>
          <td width="70" align="right">
          <a href="5_1_2_3_tr_save_load.htm"><img style="vertical-align:middle;" src="previous.png" alt="?????" width="27" height="27" border=0></a>&nbsp;
          <a href="5_1_4_tr_comparison.htm"><img style="vertical-align:middle;" src="next.png" alt="??????" width="27" height="27" border="0"></a>
          </td>
        </tr>
      </table>
    </td>
    <td width="5"></td>
  </tr>
</table>



<div id="help">
<p class="p_H3"><span class="f_H3">5.1.3 Organizing parallel computing in the attention block</span></p>
<p class="p_Text"><span class="f_Text">In the previous sections, we built a working attention block algorithm using standard MQL5 language capabilities. Now you can add an attention block to your model and test the quality of the </span><span class="f_Text" style="font-style: italic;">Self-Attention</span><span class="f_Text"> mechanism. However, look at the block structure. In its operation, we used five internal layers and created an algorithm for transferring data between them in both the forward and backward directions. It's also important to note that each element of the sequence, described by a value vector, is processed using shared weight matrices, but independently of each other. This allows us to easily distribute operations across parallel threads, enabling us to perform a full set of operations in shorter time intervals. And yes, from the beginning, we decided to create a library with the capability to use two technologies. By doing so, we provide users with the opportunity to independently test and choose the most suitable technology for their specific use case.</span></p>
<p class="p_Text"><span class="f_Text">As before, we organize the parallel computing unit using OpenCL. To use this technology, we will need to complete two stages of work:</span></p>
<ul style="list-style-type:disc">
<li class="p_li"><span class="f_li">Create an OpenCL program</span></li>
<li class="p_li"><span class="f_li">Make changes to the main program</span></li>
</ul>
<p class="p_Text"><span class="f_Text">We will add the OpenCL program code to the previously created file <a href="3_7_1_opencl_programm.htm" class="topiclink">opencl_program.cl</a>. It is in this file that we collected all the kernels of the OpenCL program used in the work of the previous classes. To organize the operation of our attention class, we will need to create six kernels. In these kernels, we will need to organize the flow of information between the internal neural layers used in both the forward and backward directions.</span></p>
<p class="p_Text"><span class="f_Text">First, we'll create the </span><span class="f_Text" style="font-style: italic;">AttentionFeedForward</span><span class="f_Text"> kernel. Below is a brief recap on the sequence of operations during the feed-forward pass through the </span><span class="f_Text" style="font-style: italic;">Self-Attention</span><span class="f_Text"> block:</span></p>
<ol style="list-style-type:decimal">
<li value="1" class="p_li"><span class="f_li">The source data is fed into three internal convolutional neural layers: </span><span class="f_li" style="font-style: italic;">m_cQuery</span><span class="f_li">, </span><span class="f_li" style="font-style: italic;">m_cKeys</span><span class="f_li">, </span><span class="f_li" style="font-style: italic;">m_cValues.</span></li>
</ol>
<p class="p_li" style="text-align: center;"><span style="display:inline-block;width:165px;height:21px;padding:0 0;overflow:visible"><svg xmlns="http://www.w3.org/2000/svg" style="width:100%;height:100%;overflow:visible" viewBox="0 0 660 84"><path d="M14 40 C14 42,14 43,14 44 C14 45,14 45,14 46 C14 47,14 48,14 48 C15 49,16 49,17 49 L17 51 L2 51 L2 49 C3 49,4 49,5 48 C5 48,5 48,6 47 C6 46,6 46,7 45 C7 44,7 42,8 40 L14 12 C15 10,15 8,15 6 C15 5,15 4,14 4 C13 3,13 3,11 3 L12 1 L26 1 L26 3 C25 3,24 4,24 4 C24 4,23 4,23 5 C23 5,22 6,22 7 C22 8,21 10,21 12 L14 40 Z" fill="#212121"/><path d="M38 27 C39 25,39 23,39 22 C39 21,39 20,38 20 C38 19,38 19,37 19 C36 19,35 19,34 20 C34 21,32 22,31 23 L29 21 C31 19,33 17,35 16 C36 16,38 15,40 15 C41 15,42 16,43 17 C44 18,45 19,45 20 C45 22,44 23,44 25 L44 25 C46 21,49 19,51 17 C53 16,55 15,58 15 C60 15,62 16,63 17 C64 18,65 20,65 23 C65 24,64 27,64 29 L61 39 C61 42,60 44,60 45 C60 46,60 47,61 47 C61 48,62 48,62 48 C63 48,64 48,65 47 C65 47,67 46,68 44 L70 46 C68 48,66 50,65 51 C63 52,61 52,59 52 C58 52,57 51,56 50 C55 49,54 48,54 46 C54 44,55 42,55 39 L57 32 C58 30,58 28,58 27 C58 26,58 25,58 24 C58 22,58 21,58 20 C57 19,56 19,55 19 C54 19,53 20,51 20 C50 21,49 22,48 24 C46 26,45 27,44 29 C44 31,43 33,42 35 L39 51 L33 51 L38 27 Z" fill="#212121"/><path d="M81 28 C82 25,82 23,82 22 C82 21,82 20,81 20 C81 19,81 19,80 19 C79 19,78 19,77 20 C77 21,75 22,74 23 L72 21 C74 19,76 17,77 16 C79 16,81 15,83 15 C84 15,85 16,86 17 C87 18,87 19,87 20 C87 22,87 23,87 25 L87 25 C92 18,96 15,101 15 C103 15,105 16,107 18 C108 20,109 23,109 27 C109 31,108 35,107 39 C105 43,103 46,100 49 C97 51,94 52,90 52 C87 52,84 51,82 50 L80 58 C80 60,80 61,80 62 C80 63,80 64,81 64 C81 65,82 65,84 65 L84 67 L72 67 L81 28 Z M85 38 C84 40,84 41,84 41 C84 42,84 43,84 43 C84 45,85 47,85 48 C86 49,88 49,90 49 C91 49,92 49,93 48 C94 48,95 47,96 46 C97 45,98 44,99 43 C99 41,100 40,101 38 C101 36,102 34,102 32 C102 30,102 29,102 27 C102 24,102 22,101 21 C101 20,100 19,98 19 C97 19,96 20,94 20 C93 21,92 23,90 25 C89 27,88 28,87 30 C86 32,86 34,85 37 L85 38 Z" fill="#212121"/><path d="M146 40 C146 42,145 44,145 45 C145 46,145 47,146 47 C146 48,147 48,147 48 C148 48,149 48,150 47 C150 47,152 46,153 44 L155 46 C153 48,151 50,150 51 C148 52,146 52,145 52 C143 52,142 52,141 51 C140 50,140 48,140 47 C140 46,140 44,140 43 L140 42 C138 46,135 48,133 50 C131 51,129 52,126 52 C124 52,122 51,121 50 C120 49,119 47,119 44 C119 43,120 41,120 38 L123 28 C123 25,124 23,124 22 C124 21,124 20,123 20 C123 19,123 19,122 19 C121 19,120 19,119 20 C119 21,117 22,116 23 L114 21 C116 19,118 18,119 17 C120 16,121 16,122 16 C123 15,124 15,125 15 C126 15,128 16,129 17 C129 18,130 19,130 21 C130 23,130 26,129 29 L127 35 C127 37,126 38,126 39 C126 40,126 41,126 41 C126 42,126 43,126 43 C126 45,126 46,127 47 C127 48,128 48,129 48 C130 48,131 48,133 47 C134 46,135 45,136 43 C138 41,139 40,140 38 C140 37,141 35,142 32 L145 16 L151 16 L146 40 Z" fill="#212121"/><path d="M181 44 C179 47,177 49,175 50 C173 51,171 52,169 52 C164 52,162 50,162 44 C162 43,162 41,162 39 L166 20 L160 20 L161 18 C162 18,163 18,164 18 C165 18,165 17,166 17 C166 17,167 16,167 15 C168 15,168 14,169 13 C169 12,170 10,170 7 L175 7 L173 16 L184 16 L184 20 L173 20 L169 34 C169 37,168 39,168 41 C168 42,168 43,168 43 C168 47,169 48,172 48 C173 48,174 48,175 47 C176 46,178 44,179 42 L181 44 Z" fill="#212121"/><path d="M236 35 L234 39 L224 32 L226 44 L221 44 L222 32 L212 39 L210 35 L220 30 L210 25 L212 21 L222 28 L221 16 L226 16 L224 28 L234 21 L236 25 L226 30 L236 35 Z" fill="#212121"/><path d="M293 52 L293 25 C293 21,293 16,294 11 L293 11 L274 52 L268 52 L266 11 C266 9,266 7,266 6 C265 5,265 4,264 4 C264 3,263 3,262 3 L262 1 L278 1 L277 3 C276 3,275 4,275 4 C274 5,274 5,273 6 C273 7,273 9,273 11 L273 12 C273 12,273 13,273 13 L273 28 C273 29,273 31,273 36 L273 43 L274 43 L294 1 L299 1 L299 26 C299 30,299 36,299 43 L299 43 L314 14 C315 13,315 12,316 11 C317 9,317 8,317 7 C317 5,316 4,313 3 L314 1 L329 1 L328 3 C327 3,326 4,325 5 C324 6,323 8,321 11 L299 52 L293 52 Z" fill="#212121"/><path d="M334 84 C333 84,332 84,331 83 C330 83,329 83,329 82 C328 81,327 80,327 79 C326 77,326 76,325 74 C324 74,322 74,321 73 C320 73,318 72,318 71 C317 70,316 69,315 67 C315 66,315 64,315 63 C315 61,315 60,315 58 C316 56,316 54,317 53 C317 51,318 49,319 48 C320 46,321 44,323 43 C324 42,326 41,328 40 C330 39,332 39,334 39 C336 39,338 39,339 40 C341 41,342 41,343 42 C344 43,344 44,345 46 C345 47,346 49,346 51 C346 52,346 53,345 55 C345 56,345 58,344 59 C344 61,343 62,342 64 C341 66,341 67,339 68 C338 70,337 71,336 72 C334 73,332 73,331 74 C331 75,332 76,332 77 C332 78,333 78,333 79 C334 79,334 80,334 80 C335 80,335 80,336 80 C336 80,337 80,337 80 C337 80,338 79,338 79 C338 79,339 79,339 78 C340 78,340 78,340 77 L342 79 C341 80,341 81,340 81 C339 82,339 82,338 83 C337 83,337 83,336 84 C335 84,335 84,334 84 L334 84 Z M320 64 C320 66,321 68,322 69 C323 71,324 71,327 71 C328 71,329 71,331 70 C332 69,333 69,334 67 C335 66,336 65,337 63 C337 62,338 60,339 59 C339 57,339 56,340 54 C340 52,340 51,340 50 C340 47,340 45,339 44 C338 43,336 42,334 42 C332 42,331 42,330 43 C328 44,327 45,326 46 C325 47,324 49,323 50 C323 52,322 53,322 55 C321 56,321 58,321 60 C320 61,320 62,320 64 L320 64 Z" fill="#212121"/><path d="M376 25 L376 20 L422 20 L422 25 L376 25 Z M376 40 L376 35 L422 35 L422 40 L376 40 Z" fill="#212121"/><path d="M473 51 C474 53,474 55,475 56 C475 57,476 58,476 59 C477 59,477 60,477 60 C478 61,478 61,479 61 C479 61,480 61,480 61 C481 61,482 61,483 60 C484 60,485 59,486 58 L488 60 C486 62,484 63,483 64 C481 65,479 65,478 65 C476 65,474 65,473 64 C471 63,470 61,469 60 C468 58,467 55,467 52 C462 52,459 50,456 48 C454 45,453 41,453 36 C453 32,454 28,455 23 C456 19,458 15,460 11 C463 7,465 5,469 3 C472 1,475 0,479 0 C484 0,487 2,490 4 C493 7,494 11,494 16 C494 20,493 24,492 28 C491 32,490 36,488 39 C486 43,484 45,481 47 C479 49,476 51,473 51 L473 51 Z M487 15 C487 11,486 8,485 6 C484 4,481 3,479 3 C476 3,474 4,471 6 C469 8,467 11,465 14 C464 18,462 22,461 26 C460 30,460 34,460 37 C460 45,463 49,468 49 C471 49,475 47,477 44 C480 41,483 36,484 31 C486 25,487 20,487 15 L487 15 Z" fill="#212121"/><path d="M532 40 C532 42,531 44,531 45 C531 46,531 47,532 47 C532 48,533 48,533 48 C534 48,535 48,536 47 C536 47,538 46,539 44 L541 46 C539 48,537 50,536 51 C534 52,532 52,531 52 C529 52,528 52,527 51 C526 50,526 48,526 47 C526 46,526 44,526 43 L526 42 C524 46,521 48,519 50 C517 51,515 52,512 52 C510 52,508 51,507 50 C506 49,505 47,505 44 C505 43,506 41,506 38 L509 28 C509 25,510 23,510 22 C510 21,510 20,509 20 C509 19,509 19,508 19 C507 19,506 19,505 20 C505 21,503 22,502 23 L500 21 C502 19,504 18,505 17 C506 16,507 16,508 16 C509 15,510 15,511 15 C512 15,514 16,515 17 C515 18,516 19,516 21 C516 23,516 26,515 29 L513 35 C513 37,512 38,512 39 C512 40,512 41,512 41 C512 42,512 43,512 43 C512 45,512 46,513 47 C513 48,514 48,515 48 C516 48,517 48,519 47 C520 46,521 45,522 43 C524 41,525 40,526 38 C526 37,527 35,528 32 L531 16 L537 16 L532 40 Z" fill="#212121"/><path d="M573 44 C570 47,568 49,565 50 C563 51,560 52,557 52 C553 52,551 51,549 49 C547 47,546 44,546 40 C546 37,546 34,547 31 C548 28,550 25,552 23 C553 20,556 18,558 17 C561 16,564 15,567 15 C570 15,572 16,574 17 C575 18,576 20,576 23 C576 27,574 30,570 32 C566 34,560 35,553 35 C552 37,552 38,552 40 C552 43,553 45,554 46 C555 47,556 48,559 48 C561 48,563 48,565 47 C566 46,568 44,570 42 L573 44 Z M553 32 C557 32,560 32,562 31 C565 31,566 30,568 28 C569 27,570 25,570 23 C570 21,569 20,569 19 C568 19,567 18,566 18 C563 18,561 19,558 22 C556 24,554 28,553 32 L553 32 Z" fill="#212121"/><path d="M595 25 C598 21,600 19,602 17 C604 16,607 15,609 15 C611 15,612 15,613 15 L612 24 L608 24 C608 23,607 22,607 22 C607 21,607 21,606 20 C606 20,605 20,605 20 C604 20,603 20,602 21 C601 22,600 23,598 25 C597 26,596 28,595 29 C595 31,594 33,593 35 L590 51 L584 51 L589 27 C589 26,590 25,590 24 C590 23,590 23,590 22 C590 21,590 20,589 20 C589 19,589 19,588 19 C587 19,586 19,585 20 C585 21,583 22,582 23 L580 21 C582 19,584 17,586 16 C587 16,589 15,591 15 C592 15,593 16,594 17 C595 18,595 19,595 20 C595 22,595 23,595 24 L595 25 Z" fill="#212121"/><path d="M633 51 C632 47,631 42,630 36 C629 29,628 25,627 23 C627 21,626 20,626 20 C626 19,625 19,625 19 C624 19,623 19,622 20 C622 21,621 22,620 23 L617 21 C619 19,621 18,622 17 C624 16,625 15,627 15 C628 15,629 15,630 15 C630 16,631 16,631 17 C632 17,632 18,632 18 C633 19,633 20,633 21 C634 22,634 24,634 26 C635 29,636 32,636 36 C637 39,637 43,637 46 C640 42,642 39,644 36 C645 32,646 30,647 27 C648 25,648 23,648 21 C648 20,648 19,647 19 C647 18,646 18,645 18 L645 16 L655 16 L656 18 C654 23,652 28,648 34 C645 40,642 46,638 51 C634 56,631 60,628 63 C626 64,624 66,623 66 C622 67,620 67,619 67 C618 67,618 67,617 67 C616 67,616 67,615 67 L617 60 L620 60 C620 61,620 62,621 62 C623 62,624 61,626 59 C628 58,630 55,633 51 L633 51 Z" fill="#212121"/></svg></span></p>
<p class="p_li" style="text-align: center;"><span style="display:inline-block;width:147px;height:19px;padding:0 0;overflow:visible"><svg xmlns="http://www.w3.org/2000/svg" style="width:100%;height:100%;overflow:visible" viewBox="0 0 588 76"><path d="M14 39 C14 41,14 42,14 43 C14 44,14 44,14 45 C14 46,14 47,14 47 C15 48,16 48,17 48 L17 50 L2 50 L2 48 C3 48,4 48,5 47 C5 47,5 47,6 46 C6 45,6 45,7 44 C7 43,7 41,8 39 L14 11 C15 9,15 7,15 5 C15 4,15 3,14 3 C13 2,13 2,11 2 L12 0 L26 0 L26 2 C25 2,24 3,24 3 C24 3,23 3,23 4 C23 4,22 5,22 6 C22 7,21 9,21 11 L14 39 Z" fill="#212121"/><path d="M38 26 C39 24,39 22,39 21 C39 20,39 19,38 19 C38 18,38 18,37 18 C36 18,35 18,34 19 C34 20,32 21,31 22 L29 20 C31 18,33 16,35 15 C36 15,38 14,40 14 C41 14,42 15,43 16 C44 17,45 18,45 19 C45 21,44 22,44 24 L44 24 C46 20,49 18,51 16 C53 15,55 14,58 14 C60 14,62 15,63 16 C64 17,65 19,65 22 C65 23,64 26,64 28 L61 38 C61 41,60 43,60 44 C60 45,60 46,61 46 C61 47,62 47,62 47 C63 47,64 47,65 46 C65 46,67 45,68 43 L70 45 C68 47,66 49,65 50 C63 51,61 51,59 51 C58 51,57 50,56 49 C55 48,54 47,54 45 C54 43,55 41,55 38 L57 31 C58 29,58 27,58 26 C58 25,58 24,58 23 C58 21,58 20,58 19 C57 18,56 18,55 18 C54 18,53 19,51 19 C50 20,49 21,48 23 C46 25,45 26,44 28 C44 30,43 32,42 34 L39 50 L33 50 L38 26 Z" fill="#212121"/><path d="M81 27 C82 24,82 22,82 21 C82 20,82 19,81 19 C81 18,81 18,80 18 C79 18,78 18,77 19 C77 20,75 21,74 22 L72 20 C74 18,76 16,77 15 C79 15,81 14,83 14 C84 14,85 15,86 16 C87 17,87 18,87 19 C87 21,87 22,87 24 L87 24 C92 17,96 14,101 14 C103 14,105 15,107 17 C108 19,109 22,109 26 C109 30,108 34,107 38 C105 42,103 45,100 48 C97 50,94 51,90 51 C87 51,84 50,82 49 L80 57 C80 59,80 60,80 61 C80 62,80 63,81 63 C81 64,82 64,84 64 L84 66 L72 66 L81 27 Z M85 37 C84 39,84 40,84 40 C84 41,84 42,84 42 C84 44,85 46,85 47 C86 48,88 48,90 48 C91 48,92 48,93 47 C94 47,95 46,96 45 C97 44,98 43,99 42 C99 40,100 39,101 37 C101 35,102 33,102 31 C102 29,102 28,102 26 C102 23,102 21,101 20 C101 19,100 18,98 18 C97 18,96 19,94 19 C93 20,92 22,90 24 C89 26,88 27,87 29 C86 31,86 33,85 36 L85 37 Z" fill="#212121"/><path d="M146 39 C146 41,145 43,145 44 C145 45,145 46,146 46 C146 47,147 47,147 47 C148 47,149 47,150 46 C150 46,152 45,153 43 L155 45 C153 47,151 49,150 50 C148 51,146 51,145 51 C143 51,142 51,141 50 C140 49,140 47,140 46 C140 45,140 43,140 42 L140 41 C138 45,135 47,133 49 C131 50,129 51,126 51 C124 51,122 50,121 49 C120 48,119 46,119 43 C119 42,120 40,120 37 L123 27 C123 24,124 22,124 21 C124 20,124 19,123 19 C123 18,123 18,122 18 C121 18,120 18,119 19 C119 20,117 21,116 22 L114 20 C116 18,118 17,119 16 C120 15,121 15,122 15 C123 14,124 14,125 14 C126 14,128 15,129 16 C129 17,130 18,130 20 C130 22,130 25,129 28 L127 34 C127 36,126 37,126 38 C126 39,126 40,126 40 C126 41,126 42,126 42 C126 44,126 45,127 46 C127 47,128 47,129 47 C130 47,131 47,133 46 C134 45,135 44,136 42 C138 40,139 39,140 37 C140 36,141 34,142 31 L145 15 L151 15 L146 39 Z" fill="#212121"/><path d="M181 43 C179 46,177 48,175 49 C173 50,171 51,169 51 C164 51,162 49,162 43 C162 42,162 40,162 38 L166 19 L160 19 L161 17 C162 17,163 17,164 17 C165 17,165 16,166 16 C166 16,167 15,167 14 C168 14,168 13,169 12 C169 11,170 9,170 6 L175 6 L173 15 L184 15 L184 19 L173 19 L169 33 C169 36,168 38,168 40 C168 41,168 42,168 42 C168 46,169 47,172 47 C173 47,174 47,175 46 C176 45,178 43,179 41 L181 43 Z" fill="#212121"/><path d="M236 34 L234 38 L224 31 L226 43 L221 43 L222 31 L212 38 L210 34 L220 29 L210 24 L212 20 L222 27 L221 15 L226 15 L224 27 L234 20 L236 24 L226 29 L236 34 Z" fill="#212121"/><path d="M293 51 L293 24 C293 20,293 15,294 10 L293 10 L274 51 L268 51 L266 10 C266 8,266 6,266 5 C265 4,265 3,264 3 C264 2,263 2,262 2 L262 0 L278 0 L277 2 C276 2,275 3,275 3 C274 4,274 4,273 5 C273 6,273 8,273 10 L273 11 C273 11,273 12,273 12 L273 27 C273 28,273 30,273 35 L273 42 L274 42 L294 0 L299 0 L299 25 C299 29,299 35,299 42 L299 42 L314 13 C315 12,315 11,316 10 C317 8,317 7,317 6 C317 4,316 3,313 2 L314 0 L329 0 L328 2 C327 2,326 3,325 4 C324 5,323 7,321 10 L299 51 L293 51 Z" fill="#212121"/><path d="M327 54 L328 54 C328 54,328 54,329 54 C329 54,329 54,330 54 C330 54,330 53,331 53 C331 53,331 53,332 52 C334 51,335 50,337 48 C338 47,339 46,340 45 C340 44,341 44,341 43 C342 42,342 42,342 41 C342 41,342 41,341 40 C341 40,340 40,340 40 L340 38 L352 38 L352 40 C351 40,351 40,351 40 C350 40,350 41,349 41 C349 41,348 42,348 42 C347 43,346 44,345 45 L335 54 L341 66 C341 67,342 68,342 69 C342 69,343 70,343 70 C343 70,344 71,344 71 C345 71,345 71,346 71 L345 73 L334 73 L335 71 C335 71,336 71,336 71 C336 71,336 70,336 70 C336 70,336 70,336 69 C336 69,336 69,336 69 C336 69,336 68,336 68 C335 68,335 67,335 67 L331 59 C331 58,331 58,331 57 C330 57,330 57,330 57 C330 56,329 56,329 56 C329 56,328 56,328 56 L326 56 C326 57,326 58,326 58 C326 59,325 60,325 61 C325 62,325 63,325 63 C324 64,324 65,324 66 C324 67,324 67,324 68 C324 68,324 69,324 69 C324 70,324 70,324 71 C325 71,325 71,327 71 L326 73 L315 73 L315 71 C316 71,316 71,316 71 C317 71,317 70,317 70 C318 70,318 69,318 68 C318 68,319 67,319 65 L323 46 C324 45,324 44,324 44 C324 43,324 43,324 42 C324 41,324 41,323 41 C323 40,322 40,321 40 L321 38 L333 38 L332 40 C332 40,332 40,331 40 C331 40,331 41,331 41 C330 41,330 41,330 41 C330 42,330 42,330 42 C329 43,329 43,329 44 C329 45,329 45,329 46 L327 54 Z" fill="#212121"/><path d="M382 24 L382 19 L428 19 L428 24 L382 24 Z M382 39 L382 34 L428 34 L428 39 L382 39 Z" fill="#212121"/><path d="M472 22 L473 22 C474 22,475 22,476 22 C477 21,478 21,479 20 C480 19,482 17,484 15 C487 13,489 11,490 10 C491 9,491 7,492 7 C492 6,493 5,493 4 C493 4,492 3,492 3 C491 2,491 2,490 2 L490 0 L506 0 L505 2 C504 2,503 3,502 4 C501 4,499 6,496 8 L482 22 L490 41 C491 43,492 44,492 45 C493 46,493 47,494 47 C495 48,496 48,497 48 L496 50 L482 50 L482 48 C484 48,484 47,484 46 C484 46,484 45,484 44 C484 43,483 42,483 41 L478 30 C478 28,477 27,477 27 C477 26,476 26,476 25 C475 25,474 25,473 25 L471 25 L468 39 C468 41,468 42,468 43 C468 43,468 44,468 45 C468 46,468 47,468 47 C469 48,470 48,471 48 L471 50 L456 50 L456 48 C457 48,458 48,459 47 C459 47,459 47,460 46 C460 45,460 45,461 44 C461 43,461 41,462 39 L468 11 C469 9,469 7,469 5 C469 4,469 3,468 3 C467 2,467 2,465 2 L466 0 L480 0 L480 2 C479 2,478 3,478 3 C478 3,477 3,477 4 C477 4,476 5,476 6 C476 7,475 9,475 11 L472 22 Z" fill="#212121"/><path d="M537 43 C534 46,532 48,529 49 C527 50,524 51,521 51 C517 51,515 50,513 48 C511 46,510 43,510 39 C510 36,510 33,511 30 C512 27,514 24,516 22 C517 19,520 17,522 16 C525 15,528 14,531 14 C534 14,536 15,538 16 C539 17,540 19,540 22 C540 26,538 29,534 31 C530 33,524 34,517 34 C516 36,516 37,516 39 C516 42,517 44,518 45 C519 46,520 47,523 47 C525 47,527 47,529 46 C530 45,532 43,534 41 L537 43 Z M517 31 C521 31,524 31,526 30 C529 30,530 29,532 27 C533 26,534 24,534 22 C534 20,533 19,533 18 C532 18,531 17,530 17 C527 17,525 18,522 21 C520 23,518 27,517 31 L517 31 Z" fill="#212121"/><path d="M561 50 C560 46,559 41,558 35 C557 28,556 24,555 22 C555 20,554 19,554 19 C554 18,553 18,553 18 C552 18,551 18,550 19 C550 20,549 21,548 22 L545 20 C547 18,549 17,550 16 C552 15,553 14,555 14 C556 14,557 14,558 14 C558 15,559 15,559 16 C560 16,560 17,560 17 C561 18,561 19,561 20 C562 21,562 23,562 25 C563 28,564 31,564 35 C565 38,565 42,565 45 C568 41,570 38,572 35 C573 31,574 29,575 26 C576 24,576 22,576 20 C576 19,576 18,575 18 C575 17,574 17,573 17 L573 15 L583 15 L584 17 C582 22,580 27,576 33 C573 39,570 45,566 50 C562 55,559 59,556 62 C554 63,552 65,551 65 C550 66,548 66,547 66 C546 66,546 66,545 66 C544 66,544 66,543 66 L545 59 L548 59 C548 60,548 61,549 61 C551 61,552 60,554 58 C556 57,558 54,561 50 L561 50 Z" fill="#212121"/></svg></span></p>
<p class="p_li" style="text-align: center;"><span style="display:inline-block;width:161px;height:19px;padding:0 0;overflow:visible"><svg xmlns="http://www.w3.org/2000/svg" style="width:100%;height:100%;overflow:visible" viewBox="0 0 644 76"><path d="M14 41 C14 43,14 44,14 45 C14 46,14 46,14 47 C14 48,14 49,14 49 C15 50,16 50,17 50 L17 52 L2 52 L2 50 C3 50,4 50,5 49 C5 49,5 49,6 48 C6 47,6 47,7 46 C7 45,7 43,8 41 L14 13 C15 11,15 9,15 7 C15 6,15 5,14 5 C13 4,13 4,11 4 L12 2 L26 2 L26 4 C25 4,24 5,24 5 C24 5,23 5,23 6 C23 6,22 7,22 8 C22 9,21 11,21 13 L14 41 Z" fill="#212121"/><path d="M38 28 C39 26,39 24,39 23 C39 22,39 21,38 21 C38 20,38 20,37 20 C36 20,35 20,34 21 C34 22,32 23,31 24 L29 22 C31 20,33 18,35 17 C36 17,38 16,40 16 C41 16,42 17,43 18 C44 19,45 20,45 21 C45 23,44 24,44 26 L44 26 C46 22,49 20,51 18 C53 17,55 16,58 16 C60 16,62 17,63 18 C64 19,65 21,65 24 C65 25,64 28,64 30 L61 40 C61 43,60 45,60 46 C60 47,60 48,61 48 C61 49,62 49,62 49 C63 49,64 49,65 48 C65 48,67 47,68 45 L70 47 C68 49,66 51,65 52 C63 53,61 53,59 53 C58 53,57 52,56 51 C55 50,54 49,54 47 C54 45,55 43,55 40 L57 33 C58 31,58 29,58 28 C58 27,58 26,58 25 C58 23,58 22,58 21 C57 20,56 20,55 20 C54 20,53 21,51 21 C50 22,49 23,48 25 C46 27,45 28,44 30 C44 32,43 34,42 36 L39 52 L33 52 L38 28 Z" fill="#212121"/><path d="M81 29 C82 26,82 24,82 23 C82 22,82 21,81 21 C81 20,81 20,80 20 C79 20,78 20,77 21 C77 22,75 23,74 24 L72 22 C74 20,76 18,77 17 C79 17,81 16,83 16 C84 16,85 17,86 18 C87 19,87 20,87 21 C87 23,87 24,87 26 L87 26 C92 19,96 16,101 16 C103 16,105 17,107 19 C108 21,109 24,109 28 C109 32,108 36,107 40 C105 44,103 47,100 50 C97 52,94 53,90 53 C87 53,84 52,82 51 L80 59 C80 61,80 62,80 63 C80 64,80 65,81 65 C81 66,82 66,84 66 L84 68 L72 68 L81 29 Z M85 39 C84 41,84 42,84 42 C84 43,84 44,84 44 C84 46,85 48,85 49 C86 50,88 50,90 50 C91 50,92 50,93 49 C94 49,95 48,96 47 C97 46,98 45,99 44 C99 42,100 41,101 39 C101 37,102 35,102 33 C102 31,102 30,102 28 C102 25,102 23,101 22 C101 21,100 20,98 20 C97 20,96 21,94 21 C93 22,92 24,90 26 C89 28,88 29,87 31 C86 33,86 35,85 38 L85 39 Z" fill="#212121"/><path d="M146 41 C146 43,145 45,145 46 C145 47,145 48,146 48 C146 49,147 49,147 49 C148 49,149 49,150 48 C150 48,152 47,153 45 L155 47 C153 49,151 51,150 52 C148 53,146 53,145 53 C143 53,142 53,141 52 C140 51,140 49,140 48 C140 47,140 45,140 44 L140 43 C138 47,135 49,133 51 C131 52,129 53,126 53 C124 53,122 52,121 51 C120 50,119 48,119 45 C119 44,120 42,120 39 L123 29 C123 26,124 24,124 23 C124 22,124 21,123 21 C123 20,123 20,122 20 C121 20,120 20,119 21 C119 22,117 23,116 24 L114 22 C116 20,118 19,119 18 C120 17,121 17,122 17 C123 16,124 16,125 16 C126 16,128 17,129 18 C129 19,130 20,130 22 C130 24,130 27,129 30 L127 36 C127 38,126 39,126 40 C126 41,126 42,126 42 C126 43,126 44,126 44 C126 46,126 47,127 48 C127 49,128 49,129 49 C130 49,131 49,133 48 C134 47,135 46,136 44 C138 42,139 41,140 39 C140 38,141 36,142 33 L145 17 L151 17 L146 41 Z" fill="#212121"/><path d="M181 45 C179 48,177 50,175 51 C173 52,171 53,169 53 C164 53,162 51,162 45 C162 44,162 42,162 40 L166 21 L160 21 L161 19 C162 19,163 19,164 19 C165 19,165 18,166 18 C166 18,167 17,167 16 C168 16,168 15,169 14 C169 13,170 11,170 8 L175 8 L173 17 L184 17 L184 21 L173 21 L169 35 C169 38,168 40,168 42 C168 43,168 44,168 44 C168 48,169 49,172 49 C173 49,174 49,175 48 C176 47,178 45,179 43 L181 45 Z" fill="#212121"/><path d="M236 36 L234 40 L224 33 L226 45 L221 45 L222 33 L212 40 L210 36 L220 31 L210 26 L212 22 L222 29 L221 17 L226 17 L224 29 L234 22 L236 26 L226 31 L236 36 Z" fill="#212121"/><path d="M293 53 L293 26 C293 22,293 17,294 12 L293 12 L274 53 L268 53 L266 12 C266 10,266 8,266 7 C265 6,265 5,264 5 C264 4,263 4,262 4 L262 2 L278 2 L277 4 C276 4,275 5,275 5 C274 6,274 6,273 7 C273 8,273 10,273 12 L273 13 C273 13,273 14,273 14 L273 29 C273 30,273 32,273 37 L273 44 L274 44 L294 2 L299 2 L299 27 C299 31,299 37,299 44 L299 44 L314 15 C315 14,315 13,316 12 C317 10,317 9,317 8 C317 6,316 5,313 4 L314 2 L329 2 L328 4 C327 4,326 5,325 6 C324 7,323 9,321 12 L299 53 L293 53 Z" fill="#212121"/><path d="M325 40 L325 42 C325 42,324 42,324 42 C323 43,323 43,323 43 C322 44,322 44,322 44 C322 45,322 46,322 46 C322 46,322 47,322 47 C322 48,322 48,322 49 C322 50,322 52,323 54 C323 56,323 58,323 59 C323 61,323 63,323 64 C323 66,323 67,323 68 L324 68 L334 50 C335 50,335 49,336 48 C336 48,336 47,337 47 C337 46,337 46,337 45 C337 45,337 45,337 44 C337 43,336 42,334 42 L335 40 L346 40 L346 42 C346 42,345 42,345 42 C345 42,344 43,344 43 C343 43,343 44,342 45 C342 45,341 46,340 48 L323 75 L319 75 C319 70,318 66,318 61 C318 57,317 52,317 47 C317 46,317 46,317 45 C316 44,316 44,316 44 C316 43,315 43,315 43 C315 42,314 42,313 42 L314 40 L325 40 Z" fill="#212121"/><path d="M376 26 L376 21 L422 21 L422 26 L376 26 Z M376 41 L376 36 L422 36 L422 41 L376 41 Z" fill="#212121"/><path d="M467 2 L467 4 C466 4,465 5,464 5 C464 6,463 6,463 7 C463 8,463 9,463 11 C463 11,463 12,463 14 L464 41 L464 44 L464 44 L480 15 C481 14,482 12,482 11 C482 10,483 9,483 8 C483 6,481 5,479 4 L479 2 L494 2 L494 4 C493 4,493 4,492 5 C491 5,491 6,490 7 C489 8,488 10,487 12 L463 53 L458 53 L456 12 C456 11,456 9,455 8 C455 7,455 6,454 5 C454 5,453 4,451 4 L452 2 L467 2 Z" fill="#212121"/><path d="M526 19 L530 16 L532 17 L527 41 C526 43,526 45,526 46 C526 47,526 48,526 48 C527 49,527 49,528 49 C529 49,530 49,530 48 C531 48,532 47,534 45 L536 47 C534 49,532 51,530 52 C529 53,527 53,525 53 C524 53,523 53,522 52 C521 51,520 49,520 48 C520 47,521 45,521 44 L521 43 C518 47,516 49,514 51 C512 52,510 53,507 53 C505 53,503 52,501 50 C500 48,499 45,499 41 C499 37,500 33,501 29 C503 25,505 22,508 20 C511 17,514 16,518 16 C519 16,521 16,522 17 C524 17,525 18,526 19 L526 19 Z M523 30 C523 29,524 28,524 27 C524 26,524 26,524 25 C524 23,523 21,523 20 C522 20,520 19,518 19 C516 19,514 20,512 22 C510 24,508 27,507 31 C506 34,505 38,505 41 C505 44,506 46,506 47 C507 48,508 49,510 49 C512 49,513 48,515 47 C516 46,518 43,519 41 C521 38,522 35,523 31 L523 30 Z" fill="#212121"/><path d="M550 10 C550 9,550 8,550 7 C550 6,550 6,550 5 C550 4,550 4,550 3 C550 3,549 3,549 2 C548 2,548 2,546 2 L547 0 L556 0 L558 0 L549 41 C549 43,548 45,548 46 C548 47,548 48,549 48 C549 49,550 49,550 49 C551 49,552 49,553 48 C553 48,555 47,556 45 L558 47 C556 49,554 51,552 52 C551 53,549 53,547 53 C546 53,544 52,543 51 C543 50,542 49,542 47 C542 45,542 43,543 40 L550 10 Z" fill="#212121"/><path d="M594 41 C594 43,593 45,593 46 C593 47,593 48,594 48 C594 49,595 49,595 49 C596 49,597 49,598 48 C598 48,600 47,601 45 L603 47 C601 49,599 51,598 52 C596 53,594 53,593 53 C591 53,590 53,589 52 C588 51,588 49,588 48 C588 47,588 45,588 44 L588 43 C586 47,583 49,581 51 C579 52,577 53,574 53 C572 53,570 52,569 51 C568 50,567 48,567 45 C567 44,568 42,568 39 L571 29 C571 26,572 24,572 23 C572 22,572 21,571 21 C571 20,571 20,570 20 C569 20,568 20,567 21 C567 22,565 23,564 24 L562 22 C564 20,566 19,567 18 C568 17,569 17,570 17 C571 16,572 16,573 16 C574 16,576 17,577 18 C577 19,578 20,578 22 C578 24,578 27,577 30 L575 36 C575 38,574 39,574 40 C574 41,574 42,574 42 C574 43,574 44,574 44 C574 46,574 47,575 48 C575 49,576 49,577 49 C578 49,579 49,581 48 C582 47,583 46,584 44 C586 42,587 41,588 39 C588 38,589 36,590 33 L593 17 L599 17 L594 41 Z" fill="#212121"/><path d="M635 45 C632 48,630 50,627 51 C625 52,622 53,619 53 C615 53,613 52,611 50 C609 48,608 45,608 41 C608 38,608 35,609 32 C610 29,612 26,614 24 C615 21,618 19,620 18 C623 17,626 16,629 16 C632 16,634 17,636 18 C637 19,638 21,638 24 C638 28,636 31,632 33 C628 35,622 36,615 36 C614 38,614 39,614 41 C614 44,615 46,616 47 C617 48,618 49,621 49 C623 49,625 49,627 48 C628 47,630 45,632 43 L635 45 Z M615 33 C619 33,622 33,624 32 C627 32,628 31,630 29 C631 28,632 26,632 24 C632 22,631 21,631 20 C630 20,629 19,628 19 C625 19,623 20,620 23 C618 25,616 29,615 33 L615 33 Z" fill="#212121"/></svg></span></p>
<ol style="list-style-type:decimal">
<li value="2" class="p_li"><span class="f_li">The </span><span class="f_li" style="font-style: italic;">m_cQuery</span><span class="f_li"> and </span><span class="f_li" style="font-style: italic;">m_cKeys</span><span class="f_li"> result tensors are multiplied to obtain the </span><span class="f_li" style="font-style: italic;">m_cScores</span><span class="f_li"> dependency matrix.</span></li>
</ol>
<p class="p_li" style="text-align: center;"><span style="display:inline-block;width:146px;height:20px;padding:0 0;overflow:visible"><svg xmlns="http://www.w3.org/2000/svg" style="width:100%;height:100%;overflow:visible" viewBox="0 0 584 80"><path d="M25 62 C26 64,26 66,27 67 C27 68,28 69,28 70 C29 70,29 71,29 71 C30 72,30 72,31 72 C31 72,32 72,32 72 C33 72,34 72,35 71 C36 71,37 70,38 69 L40 71 C38 73,36 74,35 75 C33 76,31 76,30 76 C28 76,26 76,25 75 C23 74,22 72,21 71 C20 69,19 66,19 63 C14 63,11 61,8 59 C6 56,5 52,5 47 C5 43,6 39,7 34 C8 30,10 26,12 22 C15 18,17 16,21 14 C24 12,27 11,31 11 C36 11,39 13,42 15 C45 18,46 22,46 27 C46 31,45 35,44 39 C43 43,42 47,40 50 C38 54,36 56,33 58 C31 60,28 62,25 62 L25 62 Z M39 26 C39 22,38 19,37 17 C36 15,33 14,31 14 C28 14,26 15,23 17 C21 19,19 22,17 25 C16 29,14 33,13 37 C12 41,12 45,12 48 C12 56,15 60,20 60 C23 60,27 58,29 55 C32 52,35 47,36 42 C38 36,39 31,39 26 L39 26 Z" fill="#212121"/><path d="M84 51 C84 53,83 55,83 56 C83 57,83 58,84 58 C84 59,85 59,85 59 C86 59,87 59,88 58 C88 58,90 57,91 55 L93 57 C91 59,89 61,88 62 C86 63,84 63,83 63 C81 63,80 63,79 62 C78 61,78 59,78 58 C78 57,78 55,78 54 L78 53 C76 57,73 59,71 61 C69 62,67 63,64 63 C62 63,60 62,59 61 C58 60,57 58,57 55 C57 54,58 52,58 49 L61 39 C61 36,62 34,62 33 C62 32,62 31,61 31 C61 30,61 30,60 30 C59 30,58 30,57 31 C57 32,55 33,54 34 L52 32 C54 30,56 29,57 28 C58 27,59 27,60 27 C61 26,62 26,63 26 C64 26,66 27,67 28 C67 29,68 30,68 32 C68 34,68 37,67 40 L65 46 C65 48,64 49,64 50 C64 51,64 52,64 52 C64 53,64 54,64 54 C64 56,64 57,65 58 C65 59,66 59,67 59 C68 59,69 59,71 58 C72 57,73 56,74 54 C76 52,77 51,78 49 C78 48,79 46,80 43 L83 27 L89 27 L84 51 Z" fill="#212121"/><path d="M125 55 C122 58,120 60,117 61 C115 62,112 63,109 63 C105 63,103 62,101 60 C99 58,98 55,98 51 C98 48,98 45,99 42 C100 39,102 36,104 34 C105 31,108 29,110 28 C113 27,116 26,119 26 C122 26,124 27,126 28 C127 29,128 31,128 34 C128 38,126 41,122 43 C118 45,112 46,105 46 C104 48,104 49,104 51 C104 54,105 56,106 57 C107 58,108 59,111 59 C113 59,115 59,117 58 C118 57,120 55,122 53 L125 55 Z M105 43 C109 43,112 43,114 42 C117 42,118 41,120 39 C121 38,122 36,122 34 C122 32,121 31,121 30 C120 30,119 29,118 29 C115 29,113 30,110 33 C108 35,106 39,105 43 L105 43 Z" fill="#212121"/><path d="M147 36 C150 32,152 30,154 28 C156 27,159 26,161 26 C163 26,164 26,165 26 L164 35 L160 35 C160 34,159 33,159 33 C159 32,159 32,158 31 C158 31,157 31,157 31 C156 31,155 31,154 32 C153 33,152 34,150 36 C149 37,148 39,147 40 C147 42,146 44,145 46 L142 62 L136 62 L141 38 C141 37,142 36,142 35 C142 34,142 34,142 33 C142 32,142 31,141 31 C141 30,141 30,140 30 C139 30,138 30,137 31 C137 32,135 33,134 34 L132 32 C134 30,136 28,138 27 C139 27,141 26,143 26 C144 26,145 27,146 28 C147 29,147 30,147 31 C147 33,147 34,147 35 L147 36 Z" fill="#212121"/><path d="M185 62 C184 58,183 53,182 47 C181 40,180 36,179 34 C179 32,178 31,178 31 C178 30,177 30,177 30 C176 30,175 30,174 31 C174 32,173 33,172 34 L169 32 C171 30,173 29,174 28 C176 27,177 26,179 26 C180 26,181 26,182 26 C182 27,183 27,183 28 C184 28,184 29,184 29 C185 30,185 31,185 32 C186 33,186 35,186 37 C187 40,188 43,188 47 C189 50,189 54,189 57 C192 53,194 50,196 47 C197 43,198 41,199 38 C200 36,200 34,200 32 C200 31,200 30,199 30 C199 29,198 29,197 29 L197 27 L207 27 L208 29 C206 34,204 39,200 45 C197 51,194 57,190 62 C186 67,183 71,180 74 C178 75,176 77,175 77 C174 78,172 78,171 78 C170 78,170 78,169 78 C168 78,168 78,167 78 L169 71 L172 71 C172 72,172 73,173 73 C175 73,176 72,178 70 C180 69,182 66,185 62 L185 62 Z" fill="#212121"/><path d="M258 46 L256 50 L246 43 L248 55 L243 55 L244 43 L234 50 L232 46 L242 41 L232 36 L234 32 L244 39 L243 27 L248 27 L246 39 L256 32 L258 36 L248 41 L258 46 Z" fill="#212121"/><path d="M298 34 L299 34 C300 34,301 34,302 34 C303 33,304 33,305 32 C306 31,308 29,310 27 C313 25,315 23,316 22 C317 21,317 19,318 19 C318 18,319 17,319 16 C319 16,318 15,318 15 C317 14,317 14,316 14 L316 12 L332 12 L331 14 C330 14,329 15,328 16 C327 16,325 18,322 20 L308 34 L316 53 C317 55,318 56,318 57 C319 58,319 59,320 59 C321 60,322 60,323 60 L322 62 L308 62 L308 60 C310 60,310 59,310 58 C310 58,310 57,310 56 C310 55,309 54,309 53 L304 42 C304 40,303 39,303 39 C303 38,302 38,302 37 C301 37,300 37,299 37 L297 37 L294 51 C294 53,294 54,294 55 C294 55,294 56,294 57 C294 58,294 59,294 59 C295 60,296 60,297 60 L297 62 L282 62 L282 60 C283 60,284 60,285 59 C285 59,285 59,286 58 C286 57,286 57,287 56 C287 55,287 53,288 51 L294 23 C295 21,295 19,295 17 C295 16,295 15,294 15 C293 14,293 14,291 14 L292 12 L306 12 L306 14 C305 14,304 15,304 15 C304 15,303 15,303 16 C303 16,302 17,302 18 C302 19,301 21,301 23 L298 34 Z" fill="#212121"/><path d="M363 55 C360 58,358 60,355 61 C353 62,350 63,347 63 C343 63,341 62,339 60 C337 58,336 55,336 51 C336 48,336 45,337 42 C338 39,340 36,342 34 C343 31,346 29,348 28 C351 27,354 26,357 26 C360 26,362 27,364 28 C365 29,366 31,366 34 C366 38,364 41,360 43 C356 45,350 46,343 46 C342 48,342 49,342 51 C342 54,343 56,344 57 C345 58,346 59,349 59 C351 59,353 59,355 58 C356 57,358 55,360 53 L363 55 Z M343 43 C347 43,350 43,352 42 C355 42,356 41,358 39 C359 38,360 36,360 34 C360 32,359 31,359 30 C358 30,357 29,356 29 C353 29,351 30,348 33 C346 35,344 39,343 43 L343 43 Z" fill="#212121"/><path d="M387 62 C386 58,385 53,384 47 C383 40,382 36,381 34 C381 32,380 31,380 31 C380 30,379 30,379 30 C378 30,377 30,376 31 C376 32,375 33,374 34 L371 32 C373 30,375 29,376 28 C378 27,379 26,381 26 C382 26,383 26,384 26 C384 27,385 27,385 28 C386 28,386 29,386 29 C387 30,387 31,387 32 C388 33,388 35,388 37 C389 40,390 43,390 47 C391 50,391 54,391 57 C394 53,396 50,398 47 C399 43,400 41,401 38 C402 36,402 34,402 32 C402 31,402 30,401 30 C401 29,400 29,399 29 L399 27 L409 27 L410 29 C408 34,406 39,402 45 C399 51,396 57,392 62 C388 67,385 71,382 74 C380 75,378 77,377 77 C376 78,374 78,373 78 C372 78,372 78,371 78 C370 78,370 78,369 78 L371 71 L374 71 C374 72,374 73,375 73 C377 73,378 72,380 70 C382 69,384 66,387 62 L387 62 Z" fill="#212121"/><path d="M417 35 L418 33 C418 33,418 33,419 33 C419 33,419 33,420 33 C420 32,420 32,420 32 C420 32,421 31,421 31 C421 31,421 30,421 29 C421 29,422 28,422 27 L427 3 L423 3 C423 3,422 3,422 3 C422 3,421 3,421 3 C420 4,420 4,420 4 C420 4,419 5,419 5 C419 6,418 6,418 7 C418 8,417 8,417 9 L414 9 L416 0 L445 0 L443 10 L440 10 L440 8 C440 8,440 8,440 7 C440 7,440 7,440 6 C440 6,440 5,440 5 C440 5,440 5,440 4 C439 4,439 4,439 4 C439 4,439 3,439 3 C438 3,438 3,438 3 C438 3,437 3,437 3 L432 3 L427 27 C427 28,427 29,427 29 C426 30,426 31,426 31 C426 31,426 32,427 32 C427 32,427 32,427 33 C427 33,428 33,428 33 C428 33,429 33,429 33 L429 35 L417 35 Z" fill="#212121"/><path d="M475 36 L475 31 L521 31 L521 36 L475 36 Z M475 51 L475 46 L521 46 L521 51 L475 51 Z" fill="#212121"/><path d="M553 51 C553 54,554 56,555 58 C557 59,559 60,562 60 C565 60,568 59,570 57 C571 55,572 53,572 49 C572 48,572 46,572 45 C571 44,570 43,569 42 C568 41,567 40,565 38 C563 37,561 36,560 34 C559 33,558 32,557 31 C557 29,556 27,556 26 C556 23,557 20,558 18 C560 16,562 14,564 13 C567 12,570 11,573 11 C575 11,577 11,579 12 C581 12,583 12,586 13 L584 22 L580 22 C580 20,580 19,579 17 C579 16,578 15,577 15 C576 14,574 14,573 14 C571 14,569 15,567 15 C566 16,565 17,564 19 C563 20,563 22,563 24 C563 25,563 27,564 28 C565 30,567 32,570 33 C572 35,574 37,575 38 C576 39,577 41,578 42 C579 44,579 46,579 47 C579 51,578 53,577 56 C575 58,573 60,571 61 C568 62,565 63,562 63 C560 63,557 63,555 63 C552 62,550 62,548 61 L550 51 L553 51 Z" fill="#212121"/></svg></span></p>
<ol style="list-style-type:decimal">
<li value="3" class="p_li"><span class="f_li">The values of the </span><span class="f_li" style="font-style: italic;">m_cScores</span><span class="f_li"> matrix are divided by the square root of the size of the description vector of one element of the </span><span class="f_li" style="font-style: italic;">m_cKeys</span><span class="f_li"> sequence and normalized by the </span><span class="f_li" style="font-style: italic;">Softmax</span><span class="f_li"> function in terms of rows (</span><span class="f_li" style="font-style: italic;">m_cQuery</span><span class="f_li"> queries).</span></li>
</ol>
<p class="p_li" style="text-align: center;"><span style="display:inline-block;width:243px;height:58px;padding:0 0;overflow:visible"><svg xmlns="http://www.w3.org/2000/svg" style="width:100%;height:100%;overflow:visible" viewBox="0 0 972 232"><path d="M6 121 C6 124,7 126,8 128 C10 129,12 130,15 130 C18 130,21 129,23 127 C24 125,25 123,25 119 C25 118,25 116,25 115 C24 114,23 113,22 112 C21 111,20 110,18 108 C16 107,14 106,13 104 C12 103,11 102,10 101 C10 99,9 97,9 96 C9 93,10 90,11 88 C13 86,15 84,17 83 C20 82,23 81,26 81 C28 81,30 81,32 82 C34 82,36 82,39 83 L37 92 L33 92 C33 90,33 89,32 87 C32 86,31 85,30 85 C29 84,27 84,26 84 C24 84,22 85,20 85 C19 86,18 87,17 89 C16 90,16 92,16 94 C16 95,16 97,17 98 C18 100,20 102,23 103 C25 105,27 107,28 108 C29 109,30 111,31 112 C32 114,32 116,32 117 C32 121,31 123,30 126 C28 128,26 130,24 131 C21 132,18 133,15 133 C13 133,10 133,8 133 C5 132,3 132,1 131 L3 121 L6 121 Z" fill="#212121"/><path d="M56 133 C52 133,49 132,47 130 C45 128,44 125,44 120 C44 119,44 116,45 114 C46 110,47 107,49 104 C51 102,53 100,55 98 C58 97,61 96,64 96 C68 96,71 97,73 99 C75 102,76 105,76 109 C76 112,75 115,74 118 C73 121,72 124,70 126 C69 129,67 130,64 131 C62 133,59 133,56 133 L56 133 Z M50 122 C50 125,51 127,52 128 C53 129,55 130,57 130 C60 130,62 129,64 127 C65 125,67 122,68 118 C69 114,70 110,70 107 C70 105,69 103,68 101 C67 100,65 99,63 99 C61 99,58 100,57 102 C55 105,53 108,52 112 C51 116,50 119,50 122 L50 122 Z" fill="#212121"/><path d="M96 133 C95 138,93 142,91 144 C88 147,85 148,82 148 C81 148,80 148,79 148 L80 145 C80 145,81 145,82 145 C83 145,84 145,85 144 C85 144,86 143,87 141 C87 140,88 138,89 136 L97 101 L90 101 L91 99 C93 99,94 99,94 99 C95 99,96 98,96 98 C97 98,97 97,97 97 C97 96,98 95,98 93 C100 89,102 86,104 83 C107 81,110 80,115 80 C117 80,119 80,121 81 L119 87 L116 87 C116 86,115 85,115 84 C114 83,113 83,112 83 C111 83,110 83,109 84 C108 85,107 86,106 87 C106 89,105 91,104 93 L103 97 L113 97 L112 101 L103 101 L96 133 Z" fill="#212121"/><path d="M146 125 C144 128,142 130,140 131 C138 132,136 133,134 133 C129 133,127 131,127 125 C127 124,127 122,127 120 L131 101 L125 101 L126 99 C127 99,128 99,129 99 C130 99,130 98,131 98 C131 98,132 97,132 96 C133 96,133 95,134 94 C134 93,135 91,135 88 L140 88 L138 97 L149 97 L149 101 L138 101 L134 115 C134 118,133 120,133 122 C133 123,133 124,133 124 C133 128,134 129,137 129 C138 129,139 129,140 128 C141 127,143 125,144 123 L146 125 Z" fill="#212121"/><path d="M167 106 C169 102,172 100,174 98 C176 97,178 96,181 96 C183 96,185 97,186 98 C187 99,188 101,188 104 L188 104 C188 104,188 104,188 105 C190 102,192 100,194 98 C196 97,198 96,200 96 C203 96,204 97,206 98 C207 99,208 101,208 104 C208 105,207 108,206 110 L204 120 C203 123,203 125,203 126 C203 127,203 128,204 128 C204 129,204 129,205 129 C206 129,207 129,207 128 C208 128,209 127,211 125 L213 127 C211 129,209 131,208 132 C206 133,204 133,202 133 C201 133,199 132,198 131 C197 130,197 129,197 127 C197 125,197 123,198 120 L200 113 C200 111,201 109,201 108 C201 107,201 106,201 105 C201 103,201 102,200 101 C200 100,199 100,198 100 C197 100,195 101,194 101 C193 102,192 103,191 105 C189 107,188 108,187 110 C187 111,186 113,185 116 L182 132 L176 132 L180 113 C181 111,181 109,181 108 C181 107,181 106,181 105 C181 103,181 102,180 101 C180 100,179 100,177 100 C177 100,176 101,174 101 C173 102,172 103,171 105 C169 107,168 108,167 110 C167 112,166 114,165 116 L162 132 L156 132 L161 108 C162 106,162 104,162 103 C162 102,162 101,161 101 C161 100,161 100,160 100 C159 100,158 100,157 101 C157 102,155 103,154 104 L152 102 C154 100,156 99,157 98 C159 97,161 96,163 96 C164 96,165 97,166 98 C167 99,168 100,168 101 C168 103,167 104,167 106 L167 106 Z" fill="#212121"/><path d="M245 99 L249 96 L251 97 L246 121 C245 123,245 125,245 126 C245 127,245 128,245 128 C246 129,246 129,247 129 C248 129,249 129,249 128 C250 128,251 127,253 125 L255 127 C253 129,251 131,249 132 C248 133,246 133,244 133 C243 133,242 133,241 132 C240 131,239 129,239 128 C239 127,240 125,240 124 L240 123 C237 127,235 129,233 131 C231 132,229 133,226 133 C224 133,222 132,220 130 C219 128,218 125,218 121 C218 117,219 113,220 109 C222 105,224 102,227 100 C230 97,233 96,237 96 C238 96,240 96,241 97 C243 97,244 98,245 99 L245 99 Z M242 110 C242 109,243 108,243 107 C243 106,243 106,243 105 C243 103,242 101,242 100 C241 100,239 99,237 99 C235 99,233 100,231 102 C229 104,227 107,226 111 C225 114,224 118,224 121 C224 124,225 126,225 127 C226 128,227 129,229 129 C231 129,232 128,234 127 C235 126,237 123,238 121 C240 118,241 115,242 111 L242 110 Z" fill="#212121"/><path d="M273 115 C273 113,273 112,272 110 C272 108,272 106,271 105 C271 103,270 102,270 101 C270 101,270 101,269 100 C269 100,269 100,268 100 C268 100,267 100,267 100 C266 101,266 101,265 102 C265 102,264 103,263 104 L261 102 C263 100,264 99,265 98 C267 97,269 96,270 96 C271 96,272 96,272 96 C273 97,274 97,274 97 C274 98,275 98,275 99 C276 99,276 100,276 101 C277 102,277 103,277 105 C277 106,278 108,278 109 L278 109 C281 106,282 103,283 102 C285 100,286 99,287 98 C287 97,288 97,289 97 C290 96,291 96,292 96 C293 96,294 96,295 97 L293 104 L291 104 C291 103,290 102,290 102 C289 102,289 102,289 102 C289 102,288 102,288 103 C288 103,287 103,286 104 C286 105,285 106,284 107 C283 108,282 109,281 110 L279 113 C279 116,280 118,280 119 C281 121,281 123,281 124 C282 125,282 126,282 127 C282 127,283 128,283 128 C283 129,283 129,284 129 C284 129,284 129,285 129 C285 129,286 129,286 128 C287 128,288 127,289 125 L292 127 C290 129,288 131,287 132 C286 133,284 133,282 133 C281 133,280 133,279 132 C279 132,278 131,277 131 C277 130,276 128,276 127 C275 123,275 121,275 119 L274 119 C272 123,270 126,268 127 C267 129,266 130,265 131 C265 132,264 132,263 133 C262 133,261 133,260 133 C259 133,258 133,257 133 L259 125 L261 125 C261 126,262 127,262 127 C263 127,263 127,264 127 C264 127,264 126,265 125 C266 125,267 124,268 122 C269 121,271 118,273 115 L273 115 Z" fill="#212121"/><path d="M341 3 C331 14,324 29,319 47 C314 66,311 87,311 110 C311 134,314 155,319 174 C324 193,331 207,341 218 L339 221 C328 210,319 196,313 177 C307 158,304 136,304 110 C304 85,307 63,313 44 C319 26,328 11,339 0 L341 3 Z" fill="#212121"/><path d="M473 64 C473 67,474 69,475 71 C477 72,479 73,482 73 C485 73,488 72,490 70 C491 68,492 66,492 62 C492 61,492 59,492 58 C491 57,490 56,489 55 C488 54,487 53,485 51 C483 50,481 49,480 47 C479 46,478 45,477 44 C477 42,476 40,476 39 C476 36,477 33,478 31 C480 29,482 27,484 26 C487 25,490 24,493 24 C495 24,497 24,499 25 C501 25,503 25,506 26 L504 35 L500 35 C500 33,500 32,499 30 C499 29,498 28,497 28 C496 27,494 27,493 27 C491 27,489 28,487 28 C486 29,485 30,484 32 C483 33,483 35,483 37 C483 38,483 40,484 41 C485 43,487 45,490 46 C492 48,494 50,495 51 C496 52,497 54,498 55 C499 57,499 59,499 60 C499 64,498 66,497 69 C495 71,493 73,491 74 C488 75,485 76,482 76 C480 76,477 76,475 76 C472 75,470 75,468 74 L470 64 L473 64 Z" fill="#212121"/><path d="M357 183 L370 211 L392 128 L402 128 L402 133 L395 133 L371 221 L368 221 L353 189 L346 191 L345 189 L357 183 Z" fill="#212121"/><path d="M418 163 L419 163 C420 163,421 163,422 163 C423 162,424 162,425 161 C426 160,428 158,430 156 C433 154,435 152,436 151 C437 150,437 148,438 148 C438 147,439 146,439 145 C439 145,438 144,438 144 C437 143,437 143,436 143 L436 141 L452 141 L451 143 C450 143,449 144,448 145 C447 145,445 147,442 149 L428 163 L436 182 C437 184,438 185,438 186 C439 187,439 188,440 188 C441 189,442 189,443 189 L442 191 L428 191 L428 189 C430 189,430 188,430 187 C430 187,430 186,430 185 C430 184,429 183,429 182 L424 171 C424 169,423 168,423 168 C423 167,422 167,422 166 C421 166,420 166,419 166 L417 166 L414 180 C414 182,414 183,414 184 C414 184,414 185,414 186 C414 187,414 188,414 188 C415 189,416 189,417 189 L417 191 L402 191 L402 189 C403 189,404 189,405 188 C405 188,405 188,406 187 C406 186,406 186,407 185 C407 184,407 182,408 180 L414 152 C415 150,415 148,415 146 C415 145,415 144,414 144 C413 143,413 143,411 143 L412 141 L426 141 L426 143 C425 143,424 144,424 144 C424 144,423 144,423 145 C423 145,422 146,422 147 C422 148,421 150,421 152 L418 163 Z" fill="#212121"/><path d="M483 184 C480 187,478 189,475 190 C473 191,470 192,467 192 C463 192,461 191,459 189 C457 187,456 184,456 180 C456 177,456 174,457 171 C458 168,460 165,462 163 C463 160,466 158,468 157 C471 156,474 155,477 155 C480 155,482 156,484 157 C485 158,486 160,486 163 C486 167,484 170,480 172 C476 174,470 175,463 175 C462 177,462 178,462 180 C462 183,463 185,464 186 C465 187,466 188,469 188 C471 188,473 188,475 187 C476 186,478 184,480 182 L483 184 Z M463 172 C467 172,470 172,472 171 C475 171,476 170,478 168 C479 167,480 165,480 163 C480 161,479 160,479 159 C478 159,477 158,476 158 C473 158,471 159,468 162 C466 164,464 168,463 172 L463 172 Z" fill="#212121"/><path d="M507 191 C506 187,505 182,504 176 C503 169,502 165,501 163 C501 161,500 160,500 160 C500 159,499 159,499 159 C498 159,497 159,496 160 C496 161,495 162,494 163 L491 161 C493 159,495 158,496 157 C498 156,499 155,501 155 C502 155,503 155,504 155 C504 156,505 156,505 157 C506 157,506 158,506 158 C507 159,507 160,507 161 C508 162,508 164,508 166 C509 169,510 172,510 176 C511 179,511 183,511 186 C514 182,516 179,518 176 C519 172,520 170,521 167 C522 165,522 163,522 161 C522 160,522 159,521 159 C521 158,520 158,519 158 L519 156 L529 156 L530 158 C528 163,526 168,522 174 C519 180,516 186,512 191 C508 196,505 200,502 203 C500 204,498 206,497 206 C496 207,494 207,493 207 C492 207,492 207,491 207 C490 207,490 207,489 207 L491 200 L494 200 C494 201,494 202,495 202 C497 202,498 201,500 199 C502 198,504 195,507 191 L507 191 Z" fill="#212121"/><path d="M545 200 C545 198,545 197,544 196 C543 196,542 195,540 195 C539 195,538 195,538 195 C537 196,537 196,536 196 C536 196,535 197,535 197 C535 198,535 198,535 199 C535 199,535 200,535 200 C535 200,535 201,536 201 C536 202,536 202,537 202 C538 203,539 203,540 204 C541 204,542 205,543 206 C543 206,544 207,544 207 C545 208,545 208,545 209 C546 210,546 210,546 211 C546 212,545 214,545 215 C544 216,544 216,543 217 C542 218,541 218,539 219 C538 219,537 219,535 219 C534 219,532 219,530 219 C529 219,527 218,525 218 L527 211 L529 211 C529 213,530 214,531 215 C532 216,533 216,535 216 C537 216,538 216,539 215 C540 214,541 213,541 212 C541 212,541 211,541 211 C541 210,540 210,540 210 C540 209,539 209,538 208 C538 208,537 208,536 207 C535 206,534 206,533 205 C532 205,532 204,531 204 C531 203,531 202,530 202 C530 201,530 200,530 200 C530 199,530 198,531 197 C531 196,532 195,533 194 C534 194,535 193,536 193 C537 192,538 192,540 192 C542 192,543 192,545 192 C546 193,548 193,549 193 L548 200 L545 200 Z" fill="#212121"/><path d="M568 181 L566 187 L561 187 L562 181 L568 181 Z M561 209 C561 210,561 211,561 212 C561 212,561 213,561 213 C561 214,561 214,561 215 C561 215,562 215,562 215 C563 215,563 215,563 215 C564 215,564 215,564 214 C565 214,565 214,565 213 C566 213,566 212,567 212 L569 214 C568 215,567 216,566 216 C565 217,565 217,564 218 C563 218,563 219,562 219 C561 219,561 219,560 219 C559 219,559 219,558 219 C558 219,557 218,557 218 C556 217,556 217,556 216 C556 216,555 215,555 214 C555 214,556 213,556 212 C556 211,556 210,556 209 C557 208,557 207,557 206 C557 205,558 204,558 203 C558 202,558 201,558 200 C559 199,559 198,559 197 C559 197,559 197,559 196 C559 196,559 196,559 196 C559 195,559 195,558 195 C558 194,557 194,556 194 L556 192 L564 192 L565 192 L561 209 Z" fill="#212121"/><path d="M595 211 L593 219 L572 219 L571 217 C573 215,574 213,576 211 C578 209,580 207,582 206 C583 204,585 202,587 200 C589 198,590 197,591 195 C591 195,591 195,591 195 L584 195 C584 195,583 195,582 195 C582 195,581 196,581 196 C580 196,580 197,579 198 C579 198,578 199,578 200 L575 200 L577 192 L598 192 L598 194 C597 195,596 197,595 198 C594 199,593 200,592 201 C591 202,590 203,589 204 C588 206,586 207,585 208 C584 209,583 210,582 212 C581 213,579 214,578 216 C578 216,578 216,578 216 L585 216 C585 216,586 216,586 216 C587 216,587 216,588 216 C588 216,588 216,589 216 C589 215,589 215,590 215 C590 214,590 214,591 213 C591 213,591 212,592 211 L595 211 Z" fill="#212121"/><path d="M624 213 C622 215,620 217,618 218 C616 219,614 219,611 219 C610 219,609 219,607 218 C606 218,605 218,605 217 C604 216,603 215,603 214 C603 213,602 212,602 210 C602 209,603 208,603 207 C603 206,603 205,604 204 C604 203,604 202,605 201 C606 200,606 199,607 198 C608 196,610 195,612 194 C614 193,617 192,619 192 C622 192,623 193,625 194 C626 195,626 196,626 198 C626 204,620 207,608 207 C608 208,608 208,608 209 C608 209,608 210,608 210 C608 212,608 214,609 215 C610 216,611 216,613 216 C613 216,614 216,615 216 C616 216,617 215,617 215 C618 215,619 214,620 213 C620 213,621 212,622 211 L624 213 Z M608 204 C611 204,613 204,614 204 C616 203,617 203,618 202 C619 202,620 201,621 201 C621 200,621 199,621 198 C621 197,621 197,621 196 C620 195,619 195,618 195 C617 195,616 195,615 196 C614 196,613 197,613 198 C612 198,611 199,610 200 C610 201,609 203,608 204 L608 204 Z" fill="#212121"/><rect x="400" y="128" width="230" height="5" fill="#212121"/><rect x="344" y="108" width="286" height="5" fill="#212121"/><path d="M634 0 C645 11,654 26,660 44 C666 63,669 85,669 110 C669 136,666 158,660 177 C654 196,645 210,634 221 L632 218 C642 207,649 193,654 174 C660 155,662 134,662 110 C662 87,660 66,654 47 C649 29,642 14,632 3 L634 0 Z" fill="#212121"/><path d="M702 106 L702 101 L748 101 L748 106 L702 106 Z M702 121 L702 116 L748 116 L748 121 L702 121 Z" fill="#212121"/><path d="M780 121 C780 124,781 126,782 128 C784 129,786 130,789 130 C792 130,795 129,797 127 C798 125,799 123,799 119 C799 118,799 116,799 115 C798 114,797 113,796 112 C795 111,794 110,792 108 C790 107,788 106,787 104 C786 103,785 102,784 101 C784 99,783 97,783 96 C783 93,784 90,785 88 C787 86,789 84,791 83 C794 82,797 81,800 81 C802 81,804 81,806 82 C808 82,810 82,813 83 L811 92 L807 92 C807 90,807 89,806 87 C806 86,805 85,804 85 C803 84,801 84,800 84 C798 84,796 85,794 85 C793 86,792 87,791 89 C790 90,790 92,790 94 C790 95,790 97,791 98 C792 100,794 102,797 103 C799 105,801 107,802 108 C803 109,804 111,805 112 C806 114,806 116,806 117 C806 121,805 123,804 126 C802 128,800 130,798 131 C795 132,792 133,789 133 C787 133,784 133,782 133 C779 132,777 132,775 131 L777 121 L780 121 Z" fill="#212121"/><path d="M842 106 C842 104,841 103,841 102 C841 101,840 100,840 100 C839 99,839 99,837 99 C835 99,833 100,831 102 C829 104,827 107,826 111 C825 115,824 118,824 121 C824 124,825 126,826 127 C827 128,828 129,830 129 C832 129,834 129,836 128 C837 127,839 126,841 124 L843 126 C841 129,839 130,836 131 C834 133,831 133,829 133 C825 133,822 132,821 130 C819 128,818 125,818 120 C818 118,818 115,819 112 C820 109,822 106,824 103 C825 101,828 99,830 98 C833 97,835 96,838 96 C842 96,844 96,847 97 L845 106 L842 106 Z" fill="#212121"/><path d="M865 133 C861 133,858 132,856 130 C854 128,853 125,853 120 C853 119,853 116,854 114 C855 110,856 107,858 104 C860 102,862 100,864 98 C867 97,870 96,873 96 C877 96,880 97,882 99 C884 102,885 105,885 109 C885 112,884 115,883 118 C882 121,881 124,879 126 C878 129,876 130,873 131 C871 133,868 133,865 133 L865 133 Z M859 122 C859 125,860 127,861 128 C862 129,864 130,866 130 C869 130,871 129,873 127 C874 125,876 122,877 118 C878 114,879 110,879 107 C879 105,878 103,877 101 C876 100,874 99,872 99 C870 99,867 100,866 102 C864 105,862 108,861 112 C860 116,859 119,859 122 L859 122 Z" fill="#212121"/><path d="M905 106 C908 102,910 100,912 98 C914 97,917 96,919 96 C921 96,922 96,923 96 L922 105 L918 105 C918 104,917 103,917 103 C917 102,917 102,916 101 C916 101,915 101,915 101 C914 101,913 101,912 102 C911 103,910 104,908 106 C907 107,906 109,905 110 C905 112,904 114,903 116 L900 132 L894 132 L899 108 C899 107,900 106,900 105 C900 104,900 104,900 103 C900 102,900 101,899 101 C899 100,899 100,898 100 C897 100,896 100,895 101 C895 102,893 103,892 104 L890 102 C892 100,894 98,896 97 C897 97,899 96,901 96 C902 96,903 97,904 98 C905 99,905 100,905 101 C905 103,905 104,905 105 L905 106 Z" fill="#212121"/><path d="M956 125 C953 128,951 130,948 131 C946 132,943 133,940 133 C936 133,934 132,932 130 C930 128,929 125,929 121 C929 118,929 115,930 112 C931 109,933 106,935 104 C936 101,939 99,941 98 C944 97,947 96,950 96 C953 96,955 97,957 98 C958 99,959 101,959 104 C959 108,957 111,953 113 C949 115,943 116,936 116 C935 118,935 119,935 121 C935 124,936 126,937 127 C938 128,939 129,942 129 C944 129,946 129,948 128 C949 127,951 125,953 123 L956 125 Z M936 113 C940 113,943 113,945 112 C948 112,949 111,951 109 C952 108,953 106,953 104 C953 102,952 101,952 100 C951 100,950 99,949 99 C946 99,944 100,941 103 C939 105,937 109,936 113 L936 113 Z" fill="#212121"/></svg></span></p>
<ol style="list-style-type:decimal">
<li value="4" class="p_li"><span class="f_li">The normalized matrix </span><span class="f_li" style="font-style: italic;">m_cScores</span><span class="f_li"> is multiplied by the neural layer results tensor </span><span class="f_li" style="font-style: italic;">m_cValues</span><span class="f_li"> to obtain the </span><span class="f_li" style="font-style: italic;">Self-Attention</span><span class="f_li"> results.</span></li>
</ol>
<p class="p_li" style="text-align: center;"><span style="display:inline-block;width:274px;height:22px;padding:0 0;overflow:visible"><svg xmlns="http://www.w3.org/2000/svg" style="width:100%;height:100%;overflow:visible" viewBox="0 0 1096 88"><path d="M6 41 C6 44,7 46,8 48 C10 49,12 50,15 50 C18 50,21 49,23 47 C24 45,25 43,25 39 C25 38,25 36,25 35 C24 34,23 33,22 32 C21 31,20 30,18 28 C16 27,14 26,13 24 C12 23,11 22,10 21 C10 19,9 17,9 16 C9 13,10 10,11 8 C13 6,15 4,17 3 C20 2,23 1,26 1 C28 1,30 1,32 2 C34 2,36 2,39 3 L37 12 L33 12 C33 10,33 9,32 7 C32 6,31 5,30 5 C29 4,27 4,26 4 C24 4,22 5,20 5 C19 6,18 7,17 9 C16 10,16 12,16 14 C16 15,16 17,17 18 C18 20,20 22,23 23 C25 25,27 27,28 28 C29 29,30 31,31 32 C32 34,32 36,32 37 C32 41,31 43,30 46 C28 48,26 50,24 51 C21 52,18 53,15 53 C13 53,10 53,8 53 C5 52,3 52,1 51 L3 41 L6 41 Z" fill="#212121"/><path d="M68 26 C68 24,67 23,67 22 C67 21,66 20,66 20 C65 19,65 19,63 19 C61 19,59 20,57 22 C55 24,53 27,52 31 C51 35,50 38,50 41 C50 44,51 46,52 47 C53 48,54 49,56 49 C58 49,60 49,62 48 C63 47,65 46,67 44 L69 46 C67 49,65 50,62 51 C60 53,57 53,55 53 C51 53,48 52,47 50 C45 48,44 45,44 40 C44 38,44 35,45 32 C46 29,48 26,50 23 C51 21,54 19,56 18 C59 17,61 16,64 16 C68 16,70 16,73 17 L71 26 L68 26 Z" fill="#212121"/><path d="M91 53 C87 53,84 52,82 50 C80 48,79 45,79 40 C79 39,79 36,80 34 C81 30,82 27,84 24 C86 22,88 20,90 18 C93 17,96 16,99 16 C103 16,106 17,108 19 C110 22,111 25,111 29 C111 32,110 35,109 38 C108 41,107 44,105 46 C104 49,102 50,99 51 C97 53,94 53,91 53 L91 53 Z M85 42 C85 45,86 47,87 48 C88 49,90 50,92 50 C95 50,97 49,99 47 C100 45,102 42,103 38 C104 34,105 30,105 27 C105 25,104 23,103 21 C102 20,100 19,98 19 C96 19,93 20,92 22 C90 25,88 28,87 32 C86 36,85 39,85 42 L85 42 Z" fill="#212121"/><path d="M131 26 C134 22,136 20,138 18 C140 17,143 16,145 16 C147 16,148 16,149 16 L148 25 L144 25 C144 24,143 23,143 23 C143 22,143 22,142 21 C142 21,141 21,141 21 C140 21,139 21,138 22 C137 23,136 24,134 26 C133 27,132 29,131 30 C131 32,130 34,129 36 L126 52 L120 52 L125 28 C125 27,126 26,126 25 C126 24,126 24,126 23 C126 22,126 21,125 21 C125 20,125 20,124 20 C123 20,122 20,121 21 C121 22,119 23,118 24 L116 22 C118 20,120 18,122 17 C123 17,125 16,127 16 C128 16,129 17,130 18 C131 19,131 20,131 21 C131 23,131 24,131 25 L131 26 Z" fill="#212121"/><path d="M182 45 C179 48,177 50,174 51 C172 52,169 53,166 53 C162 53,160 52,158 50 C156 48,155 45,155 41 C155 38,155 35,156 32 C157 29,159 26,161 24 C162 21,165 19,167 18 C170 17,173 16,176 16 C179 16,181 17,183 18 C184 19,185 21,185 24 C185 28,183 31,179 33 C175 35,169 36,162 36 C161 38,161 39,161 41 C161 44,162 46,163 47 C164 48,165 49,168 49 C170 49,172 49,174 48 C175 47,177 45,179 43 L182 45 Z M162 33 C166 33,169 33,171 32 C174 32,175 31,177 29 C178 28,179 26,179 24 C179 22,178 21,178 20 C177 20,176 19,175 19 C172 19,170 20,167 23 C165 25,163 29,162 33 L162 33 Z" fill="#212121"/><path d="M238 36 L236 40 L226 33 L228 45 L223 45 L224 33 L214 40 L212 36 L222 31 L212 26 L214 22 L224 29 L223 17 L228 17 L226 29 L236 22 L238 26 L228 31 L238 36 Z" fill="#212121"/><path d="M279 2 L279 4 C278 4,277 5,276 5 C276 6,275 6,275 7 C275 8,275 9,275 11 C275 11,275 12,275 14 L276 41 L276 44 L276 44 L292 15 C293 14,294 12,294 11 C294 10,295 9,295 8 C295 6,293 5,291 4 L291 2 L306 2 L306 4 C305 4,305 4,304 5 C303 5,303 6,302 7 C301 8,300 10,299 12 L275 53 L270 53 L268 12 C268 11,268 9,267 8 C267 7,267 6,266 5 C266 5,265 4,263 4 L264 2 L279 2 Z" fill="#212121"/><path d="M338 19 L342 16 L344 17 L339 41 C338 43,338 45,338 46 C338 47,338 48,338 48 C339 49,339 49,340 49 C341 49,342 49,342 48 C343 48,344 47,346 45 L348 47 C346 49,344 51,342 52 C341 53,339 53,337 53 C336 53,335 53,334 52 C333 51,332 49,332 48 C332 47,333 45,333 44 L333 43 C330 47,328 49,326 51 C324 52,322 53,319 53 C317 53,315 52,313 50 C312 48,311 45,311 41 C311 37,312 33,313 29 C315 25,317 22,320 20 C323 17,326 16,330 16 C331 16,333 16,334 17 C336 17,337 18,338 19 L338 19 Z M335 30 C335 29,336 28,336 27 C336 26,336 26,336 25 C336 23,335 21,335 20 C334 20,332 19,330 19 C328 19,326 20,324 22 C322 24,320 27,319 31 C318 34,317 38,317 41 C317 44,318 46,318 47 C319 48,320 49,322 49 C324 49,325 48,327 47 C328 46,330 43,331 41 C333 38,334 35,335 31 L335 30 Z" fill="#212121"/><path d="M362 10 C362 9,362 8,362 7 C362 6,362 6,362 5 C362 4,362 4,362 3 C362 3,361 3,361 2 C360 2,360 2,358 2 L359 0 L368 0 L370 0 L361 41 C361 43,360 45,360 46 C360 47,360 48,361 48 C361 49,362 49,362 49 C363 49,364 49,365 48 C365 48,367 47,368 45 L370 47 C368 49,366 51,364 52 C363 53,361 53,359 53 C358 53,356 52,355 51 C355 50,354 49,354 47 C354 45,354 43,355 40 L362 10 Z" fill="#212121"/><path d="M406 41 C406 43,405 45,405 46 C405 47,405 48,406 48 C406 49,407 49,407 49 C408 49,409 49,410 48 C410 48,412 47,413 45 L415 47 C413 49,411 51,410 52 C408 53,406 53,405 53 C403 53,402 53,401 52 C400 51,400 49,400 48 C400 47,400 45,400 44 L400 43 C398 47,395 49,393 51 C391 52,389 53,386 53 C384 53,382 52,381 51 C380 50,379 48,379 45 C379 44,380 42,380 39 L383 29 C383 26,384 24,384 23 C384 22,384 21,383 21 C383 20,383 20,382 20 C381 20,380 20,379 21 C379 22,377 23,376 24 L374 22 C376 20,378 19,379 18 C380 17,381 17,382 17 C383 16,384 16,385 16 C386 16,388 17,389 18 C389 19,390 20,390 22 C390 24,390 27,389 30 L387 36 C387 38,386 39,386 40 C386 41,386 42,386 42 C386 43,386 44,386 44 C386 46,386 47,387 48 C387 49,388 49,389 49 C390 49,391 49,393 48 C394 47,395 46,396 44 C398 42,399 41,400 39 C400 38,401 36,402 33 L405 17 L411 17 L406 41 Z" fill="#212121"/><path d="M447 45 C444 48,442 50,439 51 C437 52,434 53,431 53 C427 53,425 52,423 50 C421 48,420 45,420 41 C420 38,420 35,421 32 C422 29,424 26,426 24 C427 21,430 19,432 18 C435 17,438 16,441 16 C444 16,446 17,448 18 C449 19,450 21,450 24 C450 28,448 31,444 33 C440 35,434 36,427 36 C426 38,426 39,426 41 C426 44,427 46,428 47 C429 48,430 49,433 49 C435 49,437 49,439 48 C440 47,442 45,444 43 L447 45 Z M427 33 C431 33,434 33,436 32 C439 32,440 31,442 29 C443 28,444 26,444 24 C444 22,443 21,443 20 C442 20,441 19,440 19 C437 19,435 20,432 23 C430 25,428 29,427 33 L427 33 Z" fill="#212121"/><path d="M481 26 L481 21 L527 21 L527 26 L481 26 Z M481 41 L481 36 L527 36 L527 41 L481 41 Z" fill="#212121"/><path d="M584 1 C589 1,592 3,595 5 C598 8,599 12,599 17 C599 21,598 26,597 30 C596 35,594 39,591 43 C589 46,586 49,583 51 C580 52,576 53,573 53 C568 53,564 52,562 49 C559 46,558 42,558 37 C558 33,559 29,560 24 C561 20,563 16,565 12 C568 8,570 6,574 4 C577 2,580 1,584 1 L584 1 Z M592 16 C592 8,589 4,584 4 C581 4,579 5,576 7 C574 9,572 12,570 15 C569 19,567 23,566 27 C565 31,565 35,565 38 C565 46,568 50,573 50 C576 50,580 49,582 45 C585 42,587 38,589 32 C591 26,592 21,592 16 L592 16 Z" fill="#212121"/><path d="M637 41 C637 43,636 45,636 46 C636 47,636 48,637 48 C637 49,638 49,638 49 C639 49,640 49,641 48 C641 48,643 47,644 45 L646 47 C644 49,642 51,641 52 C639 53,637 53,636 53 C634 53,633 53,632 52 C631 51,631 49,631 48 C631 47,631 45,631 44 L631 43 C629 47,626 49,624 51 C622 52,620 53,617 53 C615 53,613 52,612 51 C611 50,610 48,610 45 C610 44,611 42,611 39 L614 29 C614 26,615 24,615 23 C615 22,615 21,614 21 C614 20,614 20,613 20 C612 20,611 20,610 21 C610 22,608 23,607 24 L605 22 C607 20,609 19,610 18 C611 17,612 17,613 17 C614 16,615 16,616 16 C617 16,619 17,620 18 C620 19,621 20,621 22 C621 24,621 27,620 30 L618 36 C618 38,617 39,617 40 C617 41,617 42,617 42 C617 43,617 44,617 44 C617 46,617 47,618 48 C618 49,619 49,620 49 C621 49,622 49,624 48 C625 47,626 46,627 44 C629 42,630 41,631 39 C631 38,632 36,633 33 L636 17 L642 17 L637 41 Z" fill="#212121"/><path d="M672 45 C670 48,668 50,666 51 C664 52,662 53,660 53 C655 53,653 51,653 45 C653 44,653 42,653 40 L657 21 L651 21 L652 19 C653 19,654 19,655 19 C656 19,656 18,657 18 C657 18,658 17,658 16 C659 16,659 15,660 14 C660 13,661 11,661 8 L666 8 L664 17 L675 17 L675 21 L664 21 L660 35 C660 38,659 40,659 42 C659 43,659 44,659 44 C659 48,660 49,663 49 C664 49,665 49,666 48 C667 47,669 45,670 43 L672 45 Z" fill="#212121"/><path d="M681 70 C681 72,681 74,682 75 C683 76,685 76,687 76 C688 76,690 76,690 76 C691 76,692 75,693 74 C693 74,694 73,694 72 C695 72,695 71,695 70 C695 69,695 68,695 68 C694 67,694 66,694 66 C693 65,693 65,692 64 C691 63,690 63,689 62 C688 61,687 61,686 60 C685 59,685 59,684 58 C683 57,683 56,683 56 C682 55,682 54,682 53 C682 52,683 50,683 49 C684 48,685 47,686 46 C687 45,688 44,690 44 C691 43,693 43,695 43 C697 43,698 43,700 43 C701 44,703 44,705 45 L703 51 L700 51 C700 50,700 49,700 48 C700 48,699 47,699 47 C698 46,698 46,697 46 C696 46,695 45,694 45 C693 45,692 46,692 46 C691 46,690 47,689 47 C689 48,688 48,688 49 C688 50,687 50,687 51 C687 52,688 53,688 53 C688 54,688 54,689 55 C689 55,689 56,690 57 C691 57,692 58,693 58 C694 59,695 60,696 61 C697 61,698 62,698 63 C699 64,699 65,700 65 C700 66,700 67,700 68 C700 70,700 71,699 73 C698 74,698 75,696 76 C695 77,694 78,692 78 C691 79,689 79,687 79 C685 79,684 79,682 79 C680 78,678 78,676 77 L678 70 L681 70 Z" fill="#212121"/><path d="M730 72 C728 74,726 76,724 77 C722 78,720 78,717 78 C716 78,715 78,713 77 C712 77,711 77,711 76 C710 75,709 74,709 73 C709 72,708 71,708 69 C708 68,709 67,709 66 C709 65,709 64,710 63 C710 62,710 61,711 60 C712 59,712 58,713 57 C714 55,716 54,718 53 C720 52,723 51,725 51 C728 51,729 52,731 53 C732 54,732 55,732 57 C732 63,726 66,714 66 C714 67,714 67,714 68 C714 68,714 69,714 69 C714 71,714 73,715 74 C716 75,717 75,719 75 C719 75,720 75,721 75 C722 75,723 74,723 74 C724 74,725 73,726 72 C726 72,727 71,728 70 L730 72 Z M714 63 C717 63,719 63,720 63 C722 62,723 62,724 61 C725 61,726 60,727 60 C727 59,727 58,727 57 C727 56,727 56,727 55 C726 54,725 54,724 54 C723 54,722 54,721 55 C720 55,719 56,719 57 C718 57,717 58,716 59 C716 60,715 62,714 63 L714 63 Z" fill="#212121"/><path d="M740 67 C741 64,742 61,743 57 C743 54,744 51,744 49 C745 47,745 46,745 45 C745 45,745 44,745 44 C745 44,745 44,744 44 C744 43,744 43,743 43 C743 43,742 43,742 43 L742 41 L749 41 L751 41 C750 46,749 51,748 55 C747 59,746 63,745 68 C745 69,745 70,745 71 C745 71,744 72,744 72 C744 73,745 73,745 74 C745 74,746 74,746 74 C747 74,747 74,747 74 C748 74,748 74,748 73 C749 73,749 73,749 72 C750 72,750 71,751 71 L753 72 C752 74,751 74,750 75 C749 76,749 76,748 77 C747 77,747 78,746 78 C745 78,745 78,744 78 C743 78,743 78,742 78 C742 77,741 77,741 77 C740 76,740 76,740 75 C740 75,739 74,739 73 C739 72,740 72,740 71 C740 70,740 69,740 67 L740 67 Z" fill="#212121"/><path d="M768 77 C767 81,766 84,764 86 C762 88,759 89,756 89 C755 89,755 89,754 89 C754 88,755 88,755 87 C755 87,755 87,755 86 C755 86,755 86,755 86 C756 86,756 86,756 86 C757 86,758 86,758 86 C759 86,759 85,760 85 C760 84,761 83,761 82 C762 81,762 80,762 78 L768 54 L763 54 L763 52 C764 52,765 52,766 52 C766 52,767 52,767 51 C768 51,768 51,768 50 C769 47,771 45,773 43 C775 42,778 41,781 41 C782 41,783 41,784 41 C784 41,785 41,786 42 L785 47 L782 47 C782 46,782 45,781 45 C781 44,780 44,779 44 C778 44,778 44,777 45 C776 45,776 46,775 46 C775 47,774 48,774 49 C774 50,773 50,773 51 L781 51 L780 54 L773 54 L768 77 Z" fill="#212121"/><path d="M793 64 L793 60 L823 60 L823 64 L793 64 Z" fill="#212121"/><path d="M850 78 L850 76 C851 76,851 76,851 76 C852 76,852 75,852 75 C853 75,853 74,853 74 C853 74,853 73,853 72 C853 72,853 71,853 71 C853 71,853 70,853 70 C853 69,853 69,853 68 C853 68,853 68,853 67 L841 67 C840 68,840 68,840 69 C839 69,839 70,839 71 C838 71,838 72,838 72 C838 73,837 73,837 74 C837 75,838 76,840 76 L840 78 L828 78 L829 76 C829 76,829 76,830 76 C830 76,831 75,831 75 C831 74,832 74,832 73 C833 73,834 72,834 70 L851 43 L856 43 L858 71 C858 72,859 73,859 73 C859 74,859 74,859 75 C860 75,860 75,860 76 C861 76,861 76,862 76 L861 78 L850 78 Z M852 49 C850 51,849 54,847 56 C845 59,844 62,842 64 L853 64 C853 63,853 62,852 61 C852 60,852 59,852 57 C852 56,852 55,852 53 C852 52,852 51,852 49 L852 49 Z" fill="#212121"/><path d="M885 72 C884 73,883 74,882 75 C881 76,881 76,880 77 C879 77,878 78,877 78 C877 78,876 78,875 78 C873 78,871 78,870 77 C869 76,869 74,869 72 C869 72,869 71,869 70 C869 69,869 69,869 68 L872 54 L868 54 L868 52 C869 52,870 52,871 52 C872 52,872 51,872 51 C873 51,873 50,873 50 C873 50,874 49,874 49 C874 48,874 47,875 47 C875 46,875 45,876 44 L880 44 L878 51 L887 51 L887 54 L878 54 L875 65 C875 66,875 66,874 67 C874 68,874 68,874 68 C874 69,874 69,874 70 C874 70,874 70,874 71 C874 72,874 73,875 73 C875 74,876 74,877 74 C878 74,879 74,880 73 C881 73,882 72,883 70 L885 72 Z" fill="#212121"/><path d="M909 72 C908 73,907 74,906 75 C905 76,905 76,904 77 C903 77,902 78,901 78 C901 78,900 78,899 78 C897 78,895 78,894 77 C893 76,893 74,893 72 C893 72,893 71,893 70 C893 69,893 69,893 68 L896 54 L892 54 L892 52 C893 52,894 52,895 52 C896 52,896 51,896 51 C897 51,897 50,897 50 C897 50,898 49,898 49 C898 48,898 47,899 47 C899 46,899 45,900 44 L904 44 L902 51 L911 51 L911 54 L902 54 L899 65 C899 66,899 66,898 67 C898 68,898 68,898 68 C898 69,898 69,898 70 C898 70,898 70,898 71 C898 72,898 73,899 73 C899 74,900 74,901 74 C902 74,903 74,904 73 C905 73,906 72,907 70 L909 72 Z" fill="#212121"/><path d="M937 72 C935 74,933 76,931 77 C929 78,927 78,924 78 C923 78,922 78,920 77 C919 77,918 77,918 76 C917 75,916 74,916 73 C916 72,915 71,915 69 C915 68,916 67,916 66 C916 65,916 64,917 63 C917 62,917 61,918 60 C919 59,919 58,920 57 C921 55,923 54,925 53 C927 52,930 51,932 51 C935 51,936 52,938 53 C939 54,939 55,939 57 C939 63,933 66,921 66 C921 67,921 67,921 68 C921 68,921 69,921 69 C921 71,921 73,922 74 C923 75,924 75,926 75 C926 75,927 75,928 75 C929 75,930 74,930 74 C931 74,932 73,933 72 C933 72,934 71,935 70 L937 72 Z M921 63 C924 63,926 63,927 63 C929 62,930 62,931 61 C932 61,933 60,934 60 C934 59,934 58,934 57 C934 56,934 56,934 55 C933 54,932 54,931 54 C930 54,929 54,928 55 C927 55,926 56,926 57 C925 57,924 58,923 59 C923 60,922 62,921 63 L921 63 Z" fill="#212121"/><path d="M956 58 C958 56,959 54,961 53 C963 52,965 51,966 51 C968 51,970 52,971 53 C972 54,972 55,972 57 C972 57,972 58,972 59 C972 60,971 61,971 62 C971 63,971 64,970 65 C970 66,970 68,969 68 C969 69,969 70,969 71 C969 72,969 72,969 72 C969 73,969 73,969 74 C969 74,970 74,970 74 C971 74,971 74,971 74 C972 74,972 74,972 73 C973 73,973 73,973 72 C974 72,974 71,975 71 L977 72 C976 74,975 74,974 75 C974 76,973 76,972 77 C972 77,971 78,970 78 C969 78,969 78,968 78 C967 78,967 78,966 78 C966 78,965 77,965 77 C964 76,964 76,964 75 C964 75,964 74,964 73 C964 73,964 72,964 71 C964 70,964 69,964 68 C965 67,965 66,965 65 C966 64,966 63,966 62 C966 61,966 61,967 60 C967 59,967 59,967 58 C967 57,967 56,966 56 C966 55,965 55,964 55 C964 55,963 55,962 55 C962 56,961 56,960 57 C960 57,959 58,959 58 C958 59,957 60,957 60 C956 61,956 62,956 63 C955 64,955 64,955 65 L952 78 L947 78 L951 61 C951 60,951 60,951 59 C951 58,951 57,951 57 C951 56,951 55,950 55 C949 55,949 55,949 55 C948 55,948 56,948 56 C947 56,947 57,946 57 C946 57,946 58,945 58 L943 57 C944 56,945 55,946 54 C946 53,947 53,948 52 C948 52,949 52,950 51 C950 51,951 51,952 51 C953 51,954 52,955 52 C956 53,956 54,956 56 C956 56,956 57,956 57 C956 57,956 58,956 58 L956 58 Z" fill="#212121"/><path d="M999 72 C998 73,997 74,996 75 C995 76,995 76,994 77 C993 77,992 78,991 78 C991 78,990 78,989 78 C987 78,985 78,984 77 C983 76,983 74,983 72 C983 72,983 71,983 70 C983 69,983 69,983 68 L986 54 L982 54 L982 52 C983 52,984 52,985 52 C986 52,986 51,986 51 C987 51,987 50,987 50 C987 50,988 49,988 49 C988 48,988 47,989 47 C989 46,989 45,990 44 L994 44 L992 51 L1001 51 L1001 54 L992 54 L989 65 C989 66,989 66,988 67 C988 68,988 68,988 68 C988 69,988 69,988 70 C988 70,988 70,988 71 C988 72,988 73,989 73 C989 74,990 74,991 74 C992 74,993 74,994 73 C995 73,996 72,997 70 L999 72 Z" fill="#212121"/><path d="M1019 40 L1017 46 L1012 46 L1013 40 L1019 40 Z M1012 68 C1012 69,1012 70,1012 71 C1012 71,1012 72,1012 72 C1012 73,1012 73,1012 74 C1012 74,1013 74,1013 74 C1014 74,1014 74,1014 74 C1015 74,1015 74,1015 73 C1016 73,1016 73,1016 72 C1017 72,1017 71,1018 71 L1020 73 C1019 74,1018 75,1017 75 C1016 76,1016 76,1015 77 C1014 77,1014 78,1013 78 C1012 78,1012 78,1011 78 C1010 78,1010 78,1009 78 C1009 78,1008 77,1008 77 C1007 76,1007 76,1007 75 C1007 75,1006 74,1006 73 C1006 73,1007 72,1007 71 C1007 70,1007 69,1007 68 C1008 67,1008 66,1008 65 C1008 64,1009 63,1009 62 C1009 61,1009 60,1009 59 C1010 58,1010 57,1010 56 C1010 56,1010 56,1010 55 C1010 55,1010 55,1010 55 C1010 54,1010 54,1009 54 C1009 53,1008 53,1007 53 L1007 51 L1015 51 L1016 51 L1012 68 Z" fill="#212121"/><path d="M1034 78 C1033 78,1031 78,1030 77 C1029 77,1028 76,1027 76 C1026 75,1026 74,1025 73 C1025 72,1024 70,1024 69 C1024 66,1025 64,1026 62 C1027 60,1028 58,1029 56 C1030 55,1032 53,1034 52 C1036 52,1038 51,1040 51 C1042 51,1043 51,1044 52 C1046 52,1047 53,1048 54 C1048 55,1049 56,1049 57 C1050 58,1050 59,1050 61 C1050 63,1050 66,1049 68 C1048 70,1047 72,1045 73 C1044 75,1042 76,1040 77 C1038 78,1036 78,1034 78 L1034 78 Z M1030 69 C1030 71,1030 73,1031 74 C1032 75,1033 75,1035 75 C1036 75,1037 75,1038 74 C1039 74,1039 73,1040 73 C1041 72,1041 71,1042 70 C1043 69,1043 68,1043 67 C1044 66,1044 65,1044 63 C1045 62,1045 61,1045 60 C1045 58,1044 57,1043 56 C1043 55,1041 54,1040 54 C1039 54,1038 54,1037 55 C1036 55,1035 56,1035 56 C1034 57,1033 58,1033 59 C1032 60,1031 61,1031 62 C1031 63,1030 65,1030 66 C1030 67,1030 68,1030 69 L1030 69 Z" fill="#212121"/><path d="M1067 58 C1069 56,1070 54,1072 53 C1074 52,1076 51,1077 51 C1079 51,1081 52,1082 53 C1083 54,1083 55,1083 57 C1083 57,1083 58,1083 59 C1083 60,1082 61,1082 62 C1082 63,1082 64,1081 65 C1081 66,1081 68,1080 68 C1080 69,1080 70,1080 71 C1080 72,1080 72,1080 72 C1080 73,1080 73,1080 74 C1080 74,1081 74,1081 74 C1082 74,1082 74,1082 74 C1083 74,1083 74,1083 73 C1084 73,1084 73,1084 72 C1085 72,1085 71,1086 71 L1088 72 C1087 74,1086 74,1085 75 C1085 76,1084 76,1083 77 C1083 77,1082 78,1081 78 C1080 78,1080 78,1079 78 C1078 78,1078 78,1077 78 C1077 78,1076 77,1076 77 C1075 76,1075 76,1075 75 C1075 75,1075 74,1075 73 C1075 73,1075 72,1075 71 C1075 70,1075 69,1075 68 C1076 67,1076 66,1076 65 C1077 64,1077 63,1077 62 C1077 61,1077 61,1078 60 C1078 59,1078 59,1078 58 C1078 57,1078 56,1077 56 C1077 55,1076 55,1075 55 C1075 55,1074 55,1073 55 C1073 56,1072 56,1071 57 C1071 57,1070 58,1070 58 C1069 59,1068 60,1068 60 C1067 61,1067 62,1067 63 C1066 64,1066 64,1066 65 L1063 78 L1058 78 L1062 61 C1062 60,1062 60,1062 59 C1062 58,1062 57,1062 57 C1062 56,1062 55,1061 55 C1060 55,1060 55,1060 55 C1059 55,1059 56,1059 56 C1058 56,1058 57,1057 57 C1057 57,1057 58,1056 58 L1054 57 C1055 56,1056 55,1057 54 C1057 53,1058 53,1059 52 C1059 52,1060 52,1061 51 C1061 51,1062 51,1063 51 C1064 51,1065 52,1066 52 C1067 53,1067 54,1067 56 C1067 56,1067 57,1067 57 C1067 57,1067 58,1067 58 L1067 58 Z" fill="#212121"/></svg></span></p>
<ol style="list-style-type:decimal">
<li value="5" class="p_li"><span class="f_li">The results of the </span><span class="f_li" style="font-style: italic;">Self-Attention</span><span class="f_li"> block are added to the original data and normalized.</span></li>
</ol>
<p class="p_li" style="text-align: center;"><span style="display:inline-block;width:399px;height:22px;padding:0 0;overflow:visible"><svg xmlns="http://www.w3.org/2000/svg" style="width:100%;height:100%;overflow:visible" viewBox="0 0 1596 88"><path d="M53 3 L52 5 C52 5,51 6,50 6 C50 6,50 6,49 7 C49 7,49 8,48 9 C48 10,48 12,47 14 L38 53 L34 53 L23 21 C22 18,20 14,19 10 L19 10 C19 11,18 14,18 17 C17 21,16 24,16 28 L12 42 C12 45,12 46,12 48 C12 49,12 50,12 50 C13 51,14 51,15 51 L15 53 L2 53 L2 51 C3 51,4 51,5 50 C5 50,5 50,6 49 C6 48,6 48,7 47 C7 46,7 44,8 42 L14 14 C14 13,14 12,15 11 C15 10,15 9,15 8 C15 7,15 6,14 6 C13 5,12 5,11 5 L12 3 L23 3 L33 32 C34 36,35 39,36 42 L37 42 C37 41,37 38,38 35 C39 31,39 28,40 26 L42 14 C43 12,43 10,43 8 C43 7,43 6,42 6 C42 5,41 5,40 5 L40 3 L53 3 Z" fill="#212121"/><path d="M71 54 C67 54,64 53,62 51 C60 49,59 46,59 41 C59 40,59 37,60 35 C61 31,62 28,64 25 C66 23,68 21,70 19 C73 18,76 17,79 17 C83 17,86 18,88 20 C90 23,91 26,91 30 C91 33,90 36,89 39 C88 42,87 45,85 47 C84 50,82 51,79 52 C77 54,74 54,71 54 L71 54 Z M65 43 C65 46,66 48,67 49 C68 50,70 51,72 51 C75 51,77 50,79 48 C80 46,82 43,83 39 C84 35,85 31,85 28 C85 26,84 24,83 22 C82 21,80 20,78 20 C76 20,73 21,72 23 C70 26,68 29,67 33 C66 37,65 40,65 43 L65 43 Z" fill="#212121"/><path d="M111 27 C114 23,116 21,118 19 C120 18,123 17,125 17 C127 17,128 17,129 17 L128 26 L124 26 C124 25,123 24,123 24 C123 23,123 23,122 22 C122 22,121 22,121 22 C120 22,119 22,118 23 C117 24,116 25,114 27 C113 28,112 30,111 31 C111 33,110 35,109 37 L106 53 L100 53 L105 29 C105 28,106 27,106 26 C106 25,106 25,106 24 C106 23,106 22,105 22 C105 21,105 21,104 21 C103 21,102 21,101 22 C101 23,99 24,98 25 L96 23 C98 21,100 19,102 18 C103 18,105 17,107 17 C108 17,109 18,110 19 C111 20,111 21,111 22 C111 24,111 25,111 26 L111 27 Z" fill="#212121"/><path d="M147 27 C149 23,152 21,154 19 C156 18,158 17,161 17 C163 17,165 18,166 19 C167 20,168 22,168 25 L168 25 C168 25,168 25,168 26 C170 23,172 21,174 19 C176 18,178 17,180 17 C183 17,184 18,186 19 C187 20,188 22,188 25 C188 26,187 29,186 31 L184 41 C183 44,183 46,183 47 C183 48,183 49,184 49 C184 50,184 50,185 50 C186 50,187 50,187 49 C188 49,189 48,191 46 L193 48 C191 50,189 52,188 53 C186 54,184 54,182 54 C181 54,179 53,178 52 C177 51,177 50,177 48 C177 46,177 44,178 41 L180 34 C180 32,181 30,181 29 C181 28,181 27,181 26 C181 24,181 23,180 22 C180 21,179 21,178 21 C177 21,175 22,174 22 C173 23,172 24,171 26 C169 28,168 29,167 31 C167 32,166 34,165 37 L162 53 L156 53 L160 34 C161 32,161 30,161 29 C161 28,161 27,161 26 C161 24,161 23,160 22 C160 21,159 21,157 21 C157 21,156 22,154 22 C153 23,152 24,151 26 C149 28,148 29,147 31 C147 33,146 35,145 37 L142 53 L136 53 L141 29 C142 27,142 25,142 24 C142 23,142 22,141 22 C141 21,141 21,140 21 C139 21,138 21,137 22 C137 23,135 24,134 25 L132 23 C134 21,136 20,137 19 C139 18,141 17,143 17 C144 17,145 18,146 19 C147 20,148 21,148 22 C148 24,147 25,147 27 L147 27 Z" fill="#212121"/><path d="M225 20 L229 17 L231 18 L226 42 C225 44,225 46,225 47 C225 48,225 49,225 49 C226 50,226 50,227 50 C228 50,229 50,229 49 C230 49,231 48,233 46 L235 48 C233 50,231 52,229 53 C228 54,226 54,224 54 C223 54,222 54,221 53 C220 52,219 50,219 49 C219 48,220 46,220 45 L220 44 C217 48,215 50,213 52 C211 53,209 54,206 54 C204 54,202 53,200 51 C199 49,198 46,198 42 C198 38,199 34,200 30 C202 26,204 23,207 21 C210 18,213 17,217 17 C218 17,220 17,221 18 C223 18,224 19,225 20 L225 20 Z M222 31 C222 30,223 29,223 28 C223 27,223 27,223 26 C223 24,222 22,222 21 C221 21,219 20,217 20 C215 20,213 21,211 23 C209 25,207 28,206 32 C205 35,204 39,204 42 C204 45,205 47,205 48 C206 49,207 50,209 50 C211 50,212 49,214 48 C215 47,217 44,218 42 C220 39,221 36,222 32 L222 31 Z" fill="#212121"/><path d="M249 11 C249 10,249 9,249 8 C249 7,249 7,249 6 C249 5,249 5,249 4 C249 4,248 4,248 3 C247 3,247 3,245 3 L246 1 L255 1 L257 1 L248 42 C248 44,247 46,247 47 C247 48,247 49,248 49 C248 50,249 50,249 50 C250 50,251 50,252 49 C252 49,254 48,255 46 L257 48 C255 50,253 52,251 53 C250 54,248 54,246 54 C245 54,243 53,242 52 C242 51,241 50,241 48 C241 46,241 44,242 41 L249 11 Z" fill="#212121"/><path d="M281 3 L279 10 L273 10 L274 3 L281 3 Z M269 29 C269 26,270 24,270 23 C270 22,269 21,269 21 C268 20,267 20,266 20 L266 18 L275 17 L277 17 L272 42 C272 44,271 46,271 47 C271 48,271 49,272 49 C272 50,273 50,273 50 C274 50,275 50,276 49 C276 49,278 48,279 46 L281 48 C279 50,277 52,275 53 C274 54,272 54,270 54 C269 54,268 53,267 52 C266 51,265 50,265 48 C265 46,266 44,266 41 L269 29 Z" fill="#212121"/><path d="M314 43 L312 53 L286 53 L285 51 L305 28 C308 25,310 23,311 21 L311 21 L302 21 C301 21,300 21,300 21 C299 22,298 22,298 22 C297 23,297 23,296 24 C295 25,295 26,294 28 L290 28 L293 18 L319 18 L319 20 L302 40 C299 44,296 47,293 50 L293 50 L302 50 C303 50,304 50,305 50 C306 50,306 49,307 49 C308 49,308 48,309 47 C309 46,310 45,311 43 L314 43 Z" fill="#212121"/><path d="M351 46 C348 49,346 51,343 52 C341 53,338 54,335 54 C331 54,329 53,327 51 C325 49,324 46,324 42 C324 39,324 36,325 33 C326 30,328 27,330 25 C331 22,334 20,336 19 C339 18,342 17,345 17 C348 17,350 18,352 19 C353 20,354 22,354 25 C354 29,352 32,348 34 C344 36,338 37,331 37 C330 39,330 40,330 42 C330 45,331 47,332 48 C333 49,334 50,337 50 C339 50,341 50,343 49 C344 48,346 46,348 44 L351 46 Z M331 34 C335 34,338 34,340 33 C343 33,344 32,346 30 C347 29,348 27,348 25 C348 23,347 22,347 21 C346 21,345 20,344 20 C341 20,339 21,336 24 C334 26,332 30,331 34 L331 34 Z" fill="#212121"/><path d="M372 35 C372 43,373 51,376 56 C379 62,383 65,389 67 L388 70 C381 68,375 64,372 58 C368 52,366 44,366 35 C366 26,368 19,372 12 C375 6,381 2,388 0 L389 3 C383 5,379 9,376 14 C373 20,372 26,372 35 L372 35 Z" fill="#212121"/><path d="M404 42 C404 44,404 45,404 46 C404 47,404 47,404 48 C404 49,404 50,404 50 C405 51,406 51,407 51 L407 53 L392 53 L392 51 C393 51,394 51,395 50 C395 50,395 50,396 49 C396 48,396 48,397 47 C397 46,397 44,398 42 L404 14 C405 12,405 10,405 8 C405 7,405 6,404 6 C403 5,403 5,401 5 L402 3 L416 3 L416 5 C415 5,414 6,414 6 C414 6,413 6,413 7 C413 7,412 8,412 9 C412 10,411 12,411 14 L404 42 Z" fill="#212121"/><path d="M428 29 C429 27,429 25,429 24 C429 23,429 22,428 22 C428 21,428 21,427 21 C426 21,425 21,424 22 C424 23,422 24,421 25 L419 23 C421 21,423 19,425 18 C426 18,428 17,430 17 C431 17,432 18,433 19 C434 20,435 21,435 22 C435 24,434 25,434 27 L434 27 C436 23,439 21,441 19 C443 18,445 17,448 17 C450 17,452 18,453 19 C454 20,455 22,455 25 C455 26,454 29,454 31 L451 41 C451 44,450 46,450 47 C450 48,450 49,451 49 C451 50,452 50,452 50 C453 50,454 50,455 49 C455 49,457 48,458 46 L460 48 C458 50,456 52,455 53 C453 54,451 54,449 54 C448 54,447 53,446 52 C445 51,444 50,444 48 C444 46,445 44,445 41 L447 34 C448 32,448 30,448 29 C448 28,448 27,448 26 C448 24,448 23,448 22 C447 21,446 21,445 21 C444 21,443 22,441 22 C440 23,439 24,438 26 C436 28,435 29,434 31 C434 33,433 35,432 37 L429 53 L423 53 L428 29 Z" fill="#212121"/><path d="M471 30 C472 27,472 25,472 24 C472 23,472 22,471 22 C471 21,471 21,470 21 C469 21,468 21,467 22 C467 23,465 24,464 25 L462 23 C464 21,466 19,467 18 C469 18,471 17,473 17 C474 17,475 18,476 19 C477 20,477 21,477 22 C477 24,477 25,477 27 L477 27 C482 20,486 17,491 17 C493 17,495 18,497 20 C498 22,499 25,499 29 C499 33,498 37,497 41 C495 45,493 48,490 51 C487 53,484 54,480 54 C477 54,474 53,472 52 L470 60 C470 62,470 63,470 64 C470 65,470 66,471 66 C471 67,472 67,474 67 L474 69 L462 69 L471 30 Z M475 40 C474 42,474 43,474 43 C474 44,474 45,474 45 C474 47,475 49,475 50 C476 51,478 51,480 51 C481 51,482 51,483 50 C484 50,485 49,486 48 C487 47,488 46,489 45 C489 43,490 42,491 40 C491 38,492 36,492 34 C492 32,492 31,492 29 C492 26,492 24,491 23 C491 22,490 21,488 21 C487 21,486 22,484 22 C483 23,482 25,480 27 C479 29,478 30,477 32 C476 34,476 36,475 39 L475 40 Z" fill="#212121"/><path d="M536 42 C536 44,535 46,535 47 C535 48,535 49,536 49 C536 50,537 50,537 50 C538 50,539 50,540 49 C540 49,542 48,543 46 L545 48 C543 50,541 52,540 53 C538 54,536 54,535 54 C533 54,532 54,531 53 C530 52,530 50,530 49 C530 48,530 46,530 45 L530 44 C528 48,525 50,523 52 C521 53,519 54,516 54 C514 54,512 53,511 52 C510 51,509 49,509 46 C509 45,510 43,510 40 L513 30 C513 27,514 25,514 24 C514 23,514 22,513 22 C513 21,513 21,512 21 C511 21,510 21,509 22 C509 23,507 24,506 25 L504 23 C506 21,508 20,509 19 C510 18,511 18,512 18 C513 17,514 17,515 17 C516 17,518 18,519 19 C519 20,520 21,520 23 C520 25,520 28,519 31 L517 37 C517 39,516 40,516 41 C516 42,516 43,516 43 C516 44,516 45,516 45 C516 47,516 48,517 49 C517 50,518 50,519 50 C520 50,521 50,523 49 C524 48,525 47,526 45 C528 43,529 42,530 40 C530 39,531 37,532 34 L535 18 L541 18 L536 42 Z" fill="#212121"/><path d="M571 46 C569 49,567 51,565 52 C563 53,561 54,559 54 C554 54,552 52,552 46 C552 45,552 43,552 41 L556 22 L550 22 L551 20 C552 20,553 20,554 20 C555 20,555 19,556 19 C556 19,557 18,557 17 C558 17,558 16,559 15 C559 14,560 12,560 9 L565 9 L563 18 L574 18 L574 22 L563 22 L559 36 C559 39,558 41,558 43 C558 44,558 45,558 45 C558 49,559 50,562 50 C563 50,564 50,565 49 C566 48,568 46,569 44 L571 46 Z" fill="#212121"/><path d="M626 34 L626 55 L620 55 L620 34 L600 34 L600 29 L620 29 L620 8 L626 8 L626 29 L646 29 L646 34 L626 34 Z" fill="#212121"/><path d="M699 2 C704 2,707 4,710 6 C713 9,714 13,714 18 C714 22,713 27,712 31 C711 36,709 40,706 44 C704 47,701 50,698 52 C695 53,691 54,688 54 C683 54,679 53,677 50 C674 47,673 43,673 38 C673 34,674 30,675 25 C676 21,678 17,680 13 C683 9,685 7,689 5 C692 3,695 2,699 2 L699 2 Z M707 17 C707 9,704 5,699 5 C696 5,694 6,691 8 C689 10,687 13,685 16 C684 20,682 24,681 28 C680 32,680 36,680 39 C680 47,683 51,688 51 C691 51,695 50,697 46 C700 43,702 39,704 33 C706 27,707 22,707 17 L707 17 Z" fill="#212121"/><path d="M752 42 C752 44,751 46,751 47 C751 48,751 49,752 49 C752 50,753 50,753 50 C754 50,755 50,756 49 C756 49,758 48,759 46 L761 48 C759 50,757 52,756 53 C754 54,752 54,751 54 C749 54,748 54,747 53 C746 52,746 50,746 49 C746 48,746 46,746 45 L746 44 C744 48,741 50,739 52 C737 53,735 54,732 54 C730 54,728 53,727 52 C726 51,725 49,725 46 C725 45,726 43,726 40 L729 30 C729 27,730 25,730 24 C730 23,730 22,729 22 C729 21,729 21,728 21 C727 21,726 21,725 22 C725 23,723 24,722 25 L720 23 C722 21,724 20,725 19 C726 18,727 18,728 18 C729 17,730 17,731 17 C732 17,734 18,735 19 C735 20,736 21,736 23 C736 25,736 28,735 31 L733 37 C733 39,732 40,732 41 C732 42,732 43,732 43 C732 44,732 45,732 45 C732 47,732 48,733 49 C733 50,734 50,735 50 C736 50,737 50,739 49 C740 48,741 47,742 45 C744 43,745 42,746 40 C746 39,747 37,748 34 L751 18 L757 18 L752 42 Z" fill="#212121"/><path d="M787 46 C785 49,783 51,781 52 C779 53,777 54,775 54 C770 54,768 52,768 46 C768 45,768 43,768 41 L772 22 L766 22 L767 20 C768 20,769 20,770 20 C771 20,771 19,772 19 C772 19,773 18,773 17 C774 17,774 16,775 15 C775 14,776 12,776 9 L781 9 L779 18 L790 18 L790 22 L779 22 L775 36 C775 39,774 41,774 43 C774 44,774 45,774 45 C774 49,775 50,778 50 C779 50,780 50,781 49 C782 48,784 46,785 44 L787 46 Z" fill="#212121"/><path d="M796 71 C796 73,796 75,797 76 C798 77,800 77,802 77 C803 77,805 77,805 77 C806 77,807 76,808 75 C808 75,809 74,809 73 C810 73,810 72,810 71 C810 70,810 69,810 69 C809 68,809 67,809 67 C808 66,808 66,807 65 C806 64,805 64,804 63 C803 62,802 62,801 61 C800 60,800 60,799 59 C798 58,798 57,798 57 C797 56,797 55,797 54 C797 53,798 51,798 50 C799 49,800 48,801 47 C802 46,803 45,805 45 C806 44,808 44,810 44 C812 44,813 44,815 44 C816 45,818 45,820 46 L818 52 L815 52 C815 51,815 50,815 49 C815 49,814 48,814 48 C813 47,813 47,812 47 C811 47,810 46,809 46 C808 46,807 47,807 47 C806 47,805 48,804 48 C804 49,803 49,803 50 C803 51,802 51,802 52 C802 53,803 54,803 54 C803 55,803 55,804 56 C804 56,804 57,805 58 C806 58,807 59,808 59 C809 60,810 61,811 62 C812 62,813 63,813 64 C814 65,814 66,815 66 C815 67,815 68,815 69 C815 71,815 72,814 74 C813 75,813 76,811 77 C810 78,809 79,807 79 C806 80,804 80,802 80 C800 80,799 80,797 80 C795 79,793 79,791 78 L793 71 L796 71 Z" fill="#212121"/><path d="M845 73 C843 75,841 77,839 78 C837 79,835 79,832 79 C831 79,830 79,828 78 C827 78,826 78,826 77 C825 76,824 75,824 74 C824 73,823 72,823 70 C823 69,824 68,824 67 C824 66,824 65,825 64 C825 63,825 62,826 61 C827 60,827 59,828 58 C829 56,831 55,833 54 C835 53,838 52,840 52 C843 52,844 53,846 54 C847 55,847 56,847 58 C847 64,841 67,829 67 C829 68,829 68,829 69 C829 69,829 70,829 70 C829 72,829 74,830 75 C831 76,832 76,834 76 C834 76,835 76,836 76 C837 76,838 75,838 75 C839 75,840 74,841 73 C841 73,842 72,843 71 L845 73 Z M829 64 C832 64,834 64,835 64 C837 63,838 63,839 62 C840 62,841 61,842 61 C842 60,842 59,842 58 C842 57,842 57,842 56 C841 55,840 55,839 55 C838 55,837 55,836 56 C835 56,834 57,834 58 C833 58,832 59,831 60 C831 61,830 63,829 64 L829 64 Z" fill="#212121"/><path d="M855 68 C856 65,857 62,858 58 C858 55,859 52,859 50 C860 48,860 47,860 46 C860 46,860 45,860 45 C860 45,860 45,859 45 C859 44,859 44,858 44 C858 44,857 44,857 44 L857 42 L864 42 L866 42 C865 47,864 52,863 56 C862 60,861 64,860 69 C860 70,860 71,860 72 C860 72,859 73,859 73 C859 74,860 74,860 75 C860 75,861 75,861 75 C862 75,862 75,862 75 C863 75,863 75,863 74 C864 74,864 74,864 73 C865 73,865 72,866 72 L868 73 C867 75,866 75,865 76 C864 77,864 77,863 78 C862 78,862 79,861 79 C860 79,860 79,859 79 C858 79,858 79,857 79 C857 78,856 78,856 78 C855 77,855 77,855 76 C855 76,854 75,854 74 C854 73,855 73,855 72 C855 71,855 70,855 68 L855 68 Z" fill="#212121"/><path d="M883 78 C882 82,881 85,879 87 C877 89,874 90,871 90 C870 90,870 90,869 90 C869 89,870 89,870 88 C870 88,870 88,870 87 C870 87,870 87,870 87 C871 87,871 87,871 87 C872 87,873 87,873 87 C874 87,874 86,875 86 C875 85,876 84,876 83 C877 82,877 81,877 79 L883 55 L878 55 L878 53 C879 53,880 53,881 53 C881 53,882 53,882 52 C883 52,883 52,883 51 C884 48,886 46,888 44 C890 43,893 42,896 42 C897 42,898 42,899 42 C899 42,900 42,901 43 L900 48 L897 48 C897 47,897 46,896 46 C896 45,895 45,894 45 C893 45,893 45,892 46 C891 46,891 47,890 47 C890 48,889 49,889 50 C889 51,888 51,888 52 L896 52 L895 55 L888 55 L883 78 Z" fill="#212121"/><path d="M908 65 L908 61 L938 61 L938 65 L908 65 Z" fill="#212121"/><path d="M965 79 L965 77 C966 77,966 77,966 77 C967 77,967 76,967 76 C968 76,968 75,968 75 C968 75,968 74,968 73 C968 73,968 72,968 72 C968 72,968 71,968 71 C968 70,968 70,968 69 C968 69,968 69,968 68 L956 68 C955 69,955 69,955 70 C954 70,954 71,954 72 C953 72,953 73,953 73 C953 74,952 74,952 75 C952 76,953 77,955 77 L955 79 L943 79 L944 77 C944 77,944 77,945 77 C945 77,946 76,946 76 C946 75,947 75,947 74 C948 74,949 73,949 71 L966 44 L971 44 L973 72 C973 73,974 74,974 74 C974 75,974 75,974 76 C975 76,975 76,975 77 C976 77,976 77,977 77 L976 79 L965 79 Z M967 50 C965 52,964 55,962 57 C960 60,959 63,957 65 L968 65 C968 64,968 63,967 62 C967 61,967 60,967 58 C967 57,967 56,967 54 C967 53,967 52,967 50 L967 50 Z" fill="#212121"/><path d="M1000 73 C999 74,998 75,997 76 C996 77,996 77,995 78 C994 78,993 79,992 79 C992 79,991 79,990 79 C988 79,986 79,985 78 C984 77,984 75,984 73 C984 73,984 72,984 71 C984 70,984 70,984 69 L987 55 L983 55 L983 53 C984 53,985 53,986 53 C987 53,987 52,987 52 C988 52,988 51,988 51 C988 51,989 50,989 50 C989 49,989 48,990 48 C990 47,990 46,991 45 L995 45 L993 52 L1002 52 L1002 55 L993 55 L990 66 C990 67,990 67,989 68 C989 69,989 69,989 69 C989 70,989 70,989 71 C989 71,989 71,989 72 C989 73,989 74,990 74 C990 75,991 75,992 75 C993 75,994 75,995 74 C996 74,997 73,998 71 L1000 73 Z" fill="#212121"/><path d="M1024 73 C1023 74,1022 75,1021 76 C1020 77,1020 77,1019 78 C1018 78,1017 79,1016 79 C1016 79,1015 79,1014 79 C1012 79,1010 79,1009 78 C1008 77,1008 75,1008 73 C1008 73,1008 72,1008 71 C1008 70,1008 70,1008 69 L1011 55 L1007 55 L1007 53 C1008 53,1009 53,1010 53 C1011 53,1011 52,1011 52 C1012 52,1012 51,1012 51 C1012 51,1013 50,1013 50 C1013 49,1013 48,1014 48 C1014 47,1014 46,1015 45 L1019 45 L1017 52 L1026 52 L1026 55 L1017 55 L1014 66 C1014 67,1014 67,1013 68 C1013 69,1013 69,1013 69 C1013 70,1013 70,1013 71 C1013 71,1013 71,1013 72 C1013 73,1013 74,1014 74 C1014 75,1015 75,1016 75 C1017 75,1018 75,1019 74 C1020 74,1021 73,1022 71 L1024 73 Z" fill="#212121"/><path d="M1052 73 C1050 75,1048 77,1046 78 C1044 79,1042 79,1039 79 C1038 79,1037 79,1035 78 C1034 78,1033 78,1033 77 C1032 76,1031 75,1031 74 C1031 73,1030 72,1030 70 C1030 69,1031 68,1031 67 C1031 66,1031 65,1032 64 C1032 63,1032 62,1033 61 C1034 60,1034 59,1035 58 C1036 56,1038 55,1040 54 C1042 53,1045 52,1047 52 C1050 52,1051 53,1053 54 C1054 55,1054 56,1054 58 C1054 64,1048 67,1036 67 C1036 68,1036 68,1036 69 C1036 69,1036 70,1036 70 C1036 72,1036 74,1037 75 C1038 76,1039 76,1041 76 C1041 76,1042 76,1043 76 C1044 76,1045 75,1045 75 C1046 75,1047 74,1048 73 C1048 73,1049 72,1050 71 L1052 73 Z M1036 64 C1039 64,1041 64,1042 64 C1044 63,1045 63,1046 62 C1047 62,1048 61,1049 61 C1049 60,1049 59,1049 58 C1049 57,1049 57,1049 56 C1048 55,1047 55,1046 55 C1045 55,1044 55,1043 56 C1042 56,1041 57,1041 58 C1040 58,1039 59,1038 60 C1038 61,1037 63,1036 64 L1036 64 Z" fill="#212121"/><path d="M1071 59 C1073 57,1074 55,1076 54 C1078 53,1080 52,1081 52 C1083 52,1085 53,1086 54 C1087 55,1087 56,1087 58 C1087 58,1087 59,1087 60 C1087 61,1086 62,1086 63 C1086 64,1086 65,1085 66 C1085 67,1085 69,1084 69 C1084 70,1084 71,1084 72 C1084 73,1084 73,1084 73 C1084 74,1084 74,1084 75 C1084 75,1085 75,1085 75 C1086 75,1086 75,1086 75 C1087 75,1087 75,1087 74 C1088 74,1088 74,1088 73 C1089 73,1089 72,1090 72 L1092 73 C1091 75,1090 75,1089 76 C1089 77,1088 77,1087 78 C1087 78,1086 79,1085 79 C1084 79,1084 79,1083 79 C1082 79,1082 79,1081 79 C1081 79,1080 78,1080 78 C1079 77,1079 77,1079 76 C1079 76,1079 75,1079 74 C1079 74,1079 73,1079 72 C1079 71,1079 70,1079 69 C1080 68,1080 67,1080 66 C1081 65,1081 64,1081 63 C1081 62,1081 62,1082 61 C1082 60,1082 60,1082 59 C1082 58,1082 57,1081 57 C1081 56,1080 56,1079 56 C1079 56,1078 56,1077 56 C1077 57,1076 57,1075 58 C1075 58,1074 59,1074 59 C1073 60,1072 61,1072 61 C1071 62,1071 63,1071 64 C1070 65,1070 65,1070 66 L1067 79 L1062 79 L1066 62 C1066 61,1066 61,1066 60 C1066 59,1066 58,1066 58 C1066 57,1066 56,1065 56 C1064 56,1064 56,1064 56 C1063 56,1063 57,1063 57 C1062 57,1062 58,1061 58 C1061 58,1061 59,1060 59 L1058 58 C1059 57,1060 56,1061 55 C1061 54,1062 54,1063 53 C1063 53,1064 53,1065 52 C1065 52,1066 52,1067 52 C1068 52,1069 53,1070 53 C1071 54,1071 55,1071 57 C1071 57,1071 58,1071 58 C1071 58,1071 59,1071 59 L1071 59 Z" fill="#212121"/><path d="M1114 73 C1113 74,1112 75,1111 76 C1110 77,1110 77,1109 78 C1108 78,1107 79,1106 79 C1106 79,1105 79,1104 79 C1102 79,1100 79,1099 78 C1098 77,1098 75,1098 73 C1098 73,1098 72,1098 71 C1098 70,1098 70,1098 69 L1101 55 L1097 55 L1097 53 C1098 53,1099 53,1100 53 C1101 53,1101 52,1101 52 C1102 52,1102 51,1102 51 C1102 51,1103 50,1103 50 C1103 49,1103 48,1104 48 C1104 47,1104 46,1105 45 L1109 45 L1107 52 L1116 52 L1116 55 L1107 55 L1104 66 C1104 67,1104 67,1103 68 C1103 69,1103 69,1103 69 C1103 70,1103 70,1103 71 C1103 71,1103 71,1103 72 C1103 73,1103 74,1104 74 C1104 75,1105 75,1106 75 C1107 75,1108 75,1109 74 C1110 74,1111 73,1112 71 L1114 73 Z" fill="#212121"/><path d="M1134 41 L1132 47 L1127 47 L1128 41 L1134 41 Z M1127 69 C1127 70,1127 71,1127 72 C1127 72,1127 73,1127 73 C1127 74,1127 74,1127 75 C1127 75,1128 75,1128 75 C1129 75,1129 75,1129 75 C1130 75,1130 75,1130 74 C1131 74,1131 74,1131 73 C1132 73,1132 72,1133 72 L1135 74 C1134 75,1133 76,1132 76 C1131 77,1131 77,1130 78 C1129 78,1129 79,1128 79 C1127 79,1127 79,1126 79 C1125 79,1125 79,1124 79 C1124 79,1123 78,1123 78 C1122 77,1122 77,1122 76 C1122 76,1121 75,1121 74 C1121 74,1122 73,1122 72 C1122 71,1122 70,1122 69 C1123 68,1123 67,1123 66 C1123 65,1124 64,1124 63 C1124 62,1124 61,1124 60 C1125 59,1125 58,1125 57 C1125 57,1125 57,1125 56 C1125 56,1125 56,1125 56 C1125 55,1125 55,1124 55 C1124 54,1123 54,1122 54 L1122 52 L1130 52 L1131 52 L1127 69 Z" fill="#212121"/><path d="M1149 79 C1148 79,1146 79,1145 78 C1144 78,1143 77,1142 77 C1141 76,1141 75,1140 74 C1140 73,1139 71,1139 70 C1139 67,1140 65,1141 63 C1142 61,1143 59,1144 57 C1145 56,1147 54,1149 53 C1151 53,1153 52,1155 52 C1157 52,1158 52,1159 53 C1161 53,1162 54,1163 55 C1163 56,1164 57,1164 58 C1165 59,1165 60,1165 62 C1165 64,1165 67,1164 69 C1163 71,1162 73,1160 74 C1159 76,1157 77,1155 78 C1153 79,1151 79,1149 79 L1149 79 Z M1145 70 C1145 72,1145 74,1146 75 C1147 76,1148 76,1150 76 C1151 76,1152 76,1153 75 C1154 75,1154 74,1155 74 C1156 73,1156 72,1157 71 C1158 70,1158 69,1158 68 C1159 67,1159 66,1159 64 C1160 63,1160 62,1160 61 C1160 59,1159 58,1158 57 C1158 56,1156 55,1155 55 C1154 55,1153 55,1152 56 C1151 56,1150 57,1150 57 C1149 58,1148 59,1148 60 C1147 61,1146 62,1146 63 C1146 64,1145 66,1145 67 C1145 68,1145 69,1145 70 L1145 70 Z" fill="#212121"/><path d="M1182 59 C1184 57,1185 55,1187 54 C1189 53,1191 52,1192 52 C1194 52,1196 53,1197 54 C1198 55,1198 56,1198 58 C1198 58,1198 59,1198 60 C1198 61,1197 62,1197 63 C1197 64,1197 65,1196 66 C1196 67,1196 69,1195 69 C1195 70,1195 71,1195 72 C1195 73,1195 73,1195 73 C1195 74,1195 74,1195 75 C1195 75,1196 75,1196 75 C1197 75,1197 75,1197 75 C1198 75,1198 75,1198 74 C1199 74,1199 74,1199 73 C1200 73,1200 72,1201 72 L1203 73 C1202 75,1201 75,1200 76 C1200 77,1199 77,1198 78 C1198 78,1197 79,1196 79 C1195 79,1195 79,1194 79 C1193 79,1193 79,1192 79 C1192 79,1191 78,1191 78 C1190 77,1190 77,1190 76 C1190 76,1190 75,1190 74 C1190 74,1190 73,1190 72 C1190 71,1190 70,1190 69 C1191 68,1191 67,1191 66 C1192 65,1192 64,1192 63 C1192 62,1192 62,1193 61 C1193 60,1193 60,1193 59 C1193 58,1193 57,1192 57 C1192 56,1191 56,1190 56 C1190 56,1189 56,1188 56 C1188 57,1187 57,1186 58 C1186 58,1185 59,1185 59 C1184 60,1183 61,1183 61 C1182 62,1182 63,1182 64 C1181 65,1181 65,1181 66 L1178 79 L1173 79 L1177 62 C1177 61,1177 61,1177 60 C1177 59,1177 58,1177 58 C1177 57,1177 56,1176 56 C1175 56,1175 56,1175 56 C1174 56,1174 57,1174 57 C1173 57,1173 58,1172 58 C1172 58,1172 59,1171 59 L1169 58 C1170 57,1171 56,1172 55 C1172 54,1173 54,1174 53 C1174 53,1175 53,1176 52 C1176 52,1177 52,1178 52 C1179 52,1180 53,1181 53 C1182 54,1182 55,1182 57 C1182 57,1182 58,1182 58 C1182 58,1182 59,1182 59 L1182 59 Z" fill="#212121"/><path d="M1225 35 C1225 26,1224 20,1221 14 C1218 9,1214 5,1208 3 L1209 0 C1216 2,1222 6,1225 12 C1229 19,1231 26,1231 35 C1231 44,1229 52,1225 58 C1222 64,1216 68,1209 70 L1208 67 C1214 65,1218 62,1221 56 C1224 51,1225 43,1225 35 L1225 35 Z" fill="#212121"/><path d="M1264 27 L1264 22 L1310 22 L1310 27 L1264 27 Z M1264 42 L1264 37 L1310 37 L1310 42 L1264 42 Z" fill="#212121"/><path d="M1367 2 C1372 2,1375 4,1378 6 C1381 9,1382 13,1382 18 C1382 22,1381 27,1380 31 C1379 36,1377 40,1374 44 C1372 47,1369 50,1366 52 C1363 53,1359 54,1356 54 C1351 54,1347 53,1345 50 C1342 47,1341 43,1341 38 C1341 34,1342 30,1343 25 C1344 21,1346 17,1348 13 C1351 9,1353 7,1357 5 C1360 3,1363 2,1367 2 L1367 2 Z M1375 17 C1375 9,1372 5,1367 5 C1364 5,1362 6,1359 8 C1357 10,1355 13,1353 16 C1352 20,1350 24,1349 28 C1348 32,1348 36,1348 39 C1348 47,1351 51,1356 51 C1359 51,1363 50,1365 46 C1368 43,1370 39,1372 33 C1374 27,1375 22,1375 17 L1375 17 Z" fill="#212121"/><path d="M1420 42 C1420 44,1419 46,1419 47 C1419 48,1419 49,1420 49 C1420 50,1421 50,1421 50 C1422 50,1423 50,1424 49 C1424 49,1426 48,1427 46 L1429 48 C1427 50,1425 52,1424 53 C1422 54,1420 54,1419 54 C1417 54,1416 54,1415 53 C1414 52,1414 50,1414 49 C1414 48,1414 46,1414 45 L1414 44 C1412 48,1409 50,1407 52 C1405 53,1403 54,1400 54 C1398 54,1396 53,1395 52 C1394 51,1393 49,1393 46 C1393 45,1394 43,1394 40 L1397 30 C1397 27,1398 25,1398 24 C1398 23,1398 22,1397 22 C1397 21,1397 21,1396 21 C1395 21,1394 21,1393 22 C1393 23,1391 24,1390 25 L1388 23 C1390 21,1392 20,1393 19 C1394 18,1395 18,1396 18 C1397 17,1398 17,1399 17 C1400 17,1402 18,1403 19 C1403 20,1404 21,1404 23 C1404 25,1404 28,1403 31 L1401 37 C1401 39,1400 40,1400 41 C1400 42,1400 43,1400 43 C1400 44,1400 45,1400 45 C1400 47,1400 48,1401 49 C1401 50,1402 50,1403 50 C1404 50,1405 50,1407 49 C1408 48,1409 47,1410 45 C1412 43,1413 42,1414 40 C1414 39,1415 37,1416 34 L1419 18 L1425 18 L1420 42 Z" fill="#212121"/><path d="M1455 46 C1453 49,1451 51,1449 52 C1447 53,1445 54,1443 54 C1438 54,1436 52,1436 46 C1436 45,1436 43,1436 41 L1440 22 L1434 22 L1435 20 C1436 20,1437 20,1438 20 C1439 20,1439 19,1440 19 C1440 19,1441 18,1441 17 C1442 17,1442 16,1443 15 C1443 14,1444 12,1444 9 L1449 9 L1447 18 L1458 18 L1458 22 L1447 22 L1443 36 C1443 39,1442 41,1442 43 C1442 44,1442 45,1442 45 C1442 49,1443 50,1446 50 C1447 50,1448 50,1449 49 C1450 48,1452 46,1453 44 L1455 46 Z" fill="#212121"/><path d="M1470 30 C1471 27,1471 25,1471 24 C1471 23,1471 22,1470 22 C1470 21,1470 21,1469 21 C1468 21,1467 21,1466 22 C1466 23,1464 24,1463 25 L1461 23 C1463 21,1465 19,1466 18 C1468 18,1470 17,1472 17 C1473 17,1474 18,1475 19 C1476 20,1476 21,1476 22 C1476 24,1476 25,1476 27 L1476 27 C1481 20,1485 17,1490 17 C1492 17,1494 18,1496 20 C1497 22,1498 25,1498 29 C1498 33,1497 37,1496 41 C1494 45,1492 48,1489 51 C1486 53,1483 54,1479 54 C1476 54,1473 53,1471 52 L1469 60 C1469 62,1469 63,1469 64 C1469 65,1469 66,1470 66 C1470 67,1471 67,1473 67 L1473 69 L1461 69 L1470 30 Z M1474 40 C1473 42,1473 43,1473 43 C1473 44,1473 45,1473 45 C1473 47,1474 49,1474 50 C1475 51,1477 51,1479 51 C1480 51,1481 51,1482 50 C1483 50,1484 49,1485 48 C1486 47,1487 46,1488 45 C1488 43,1489 42,1490 40 C1490 38,1491 36,1491 34 C1491 32,1491 31,1491 29 C1491 26,1491 24,1490 23 C1490 22,1489 21,1487 21 C1486 21,1485 22,1483 22 C1482 23,1481 25,1479 27 C1478 29,1477 30,1476 32 C1475 34,1475 36,1474 39 L1474 40 Z" fill="#212121"/><path d="M1535 42 C1535 44,1534 46,1534 47 C1534 48,1534 49,1535 49 C1535 50,1536 50,1536 50 C1537 50,1538 50,1539 49 C1539 49,1541 48,1542 46 L1544 48 C1542 50,1540 52,1539 53 C1537 54,1535 54,1534 54 C1532 54,1531 54,1530 53 C1529 52,1529 50,1529 49 C1529 48,1529 46,1529 45 L1529 44 C1527 48,1524 50,1522 52 C1520 53,1518 54,1515 54 C1513 54,1511 53,1510 52 C1509 51,1508 49,1508 46 C1508 45,1509 43,1509 40 L1512 30 C1512 27,1513 25,1513 24 C1513 23,1513 22,1512 22 C1512 21,1512 21,1511 21 C1510 21,1509 21,1508 22 C1508 23,1506 24,1505 25 L1503 23 C1505 21,1507 20,1508 19 C1509 18,1510 18,1511 18 C1512 17,1513 17,1514 17 C1515 17,1517 18,1518 19 C1518 20,1519 21,1519 23 C1519 25,1519 28,1518 31 L1516 37 C1516 39,1515 40,1515 41 C1515 42,1515 43,1515 43 C1515 44,1515 45,1515 45 C1515 47,1515 48,1516 49 C1516 50,1517 50,1518 50 C1519 50,1520 50,1522 49 C1523 48,1524 47,1525 45 C1527 43,1528 42,1529 40 C1529 39,1530 37,1531 34 L1534 18 L1540 18 L1535 42 Z" fill="#212121"/><path d="M1570 46 C1568 49,1566 51,1564 52 C1562 53,1560 54,1558 54 C1553 54,1551 52,1551 46 C1551 45,1551 43,1551 41 L1555 22 L1549 22 L1550 20 C1551 20,1552 20,1553 20 C1554 20,1554 19,1555 19 C1555 19,1556 18,1556 17 C1557 17,1557 16,1558 15 C1558 14,1559 12,1559 9 L1564 9 L1562 18 L1573 18 L1573 22 L1562 22 L1558 36 C1558 39,1557 41,1557 43 C1557 44,1557 45,1557 45 C1557 49,1558 50,1561 50 C1562 50,1563 50,1564 49 C1565 48,1567 46,1568 44 L1570 46 Z" fill="#212121"/></svg></span></p>
<ol style="list-style-type:decimal">
<li value="6" class="p_li"><span class="f_li">The obtained tensor serves as the input data for a block of two convolutional layers: </span><span class="f_li" style="font-style: italic;">m_cFF1</span><span class="f_li"> and </span><span class="f_li" style="font-style: italic;">m_cFF2</span><span class="f_li">.</span></li>
</ol>
<p class="p_Text"><span class="f_Text">Points 1 and 6 are covered by using the previously discussed convolutional layer class, which already implements a multi-threaded computation block. So, we will need to implement the remaining points in a new kernel. </span></p>
<p class="p_Text"><span class="f_Text">To organize the specified operations, we will need to pass six data buffers and two parameters to the kernel. To make the program code more readable, the names of buffers and variables will be aligned with the names of the corresponding matrices in the algorithm description.</span></p>
<div style="text-align: left; text-indent: 0; line-height: 1.0; page-break-inside: avoid; page-break-after: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0 0 0 0; margin: 2px 17px 2px 17px;"><table cellspacing="0" cellpadding="3" border="0" style="text-align: justify;border:none; border-spacing:0;">
<tr>
<td style="vertical-align:top; padding:3px; border:none"><p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample" style="color: #0000ff;">__kernel</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">void</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #333333;">AttentionFeedForward</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #0000ff;">__global</span><span class="f_CodeExample">&nbsp;</span><span class="f_Definition">TYPE</span><span class="f_CodeExample">&nbsp;*</span><span class="f_CodeExample" style="color: #333333;">querys</span><span class="f_CodeExample">,</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">__global</span><span class="f_CodeExample">&nbsp;</span><span class="f_Definition">TYPE</span><span class="f_CodeExample">&nbsp;*</span><span class="f_CodeExample" style="color: #333333;">keys</span><span class="f_CodeExample">,</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">__global</span><span class="f_CodeExample">&nbsp;</span><span class="f_Definition">TYPE</span><span class="f_CodeExample">&nbsp;*</span><span class="f_CodeExample" style="color: #333333;">scores</span><span class="f_CodeExample">,</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">__global</span><span class="f_CodeExample">&nbsp;</span><span class="f_Definition">TYPE</span><span class="f_CodeExample">&nbsp;*</span><span class="f_CodeExample" style="color: #333333;">values</span><span class="f_CodeExample">,</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">__global</span><span class="f_CodeExample">&nbsp;</span><span class="f_Definition">TYPE</span><span class="f_CodeExample">&nbsp;*</span><span class="f_CodeExample" style="color: #333333;">outputs</span><span class="f_CodeExample">,</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">int</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #333333;">window</span><span class="f_CodeExample">,</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">int</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #333333;">key_size</span><span class="f_CodeExample">)</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;{</span></p>
</td>
</tr>
</table>
</div>
<p class="p_Text"><span class="f_Text">As you may have noticed from the description of the </span><span class="f_Text" style="font-style: italic;">Self-Attention</span><span class="f_Text"> algorithm, the primary analytical unit in this method is an element of the sequence, described by a value vector. For language models, this is usually a word. In the case of financial market analysis, we use a bar. It is precisely between these elements of the sequence that the coefficients of mutual dependencies are determined. Taking into account these coefficients, the values of the element description vectors are adjusted. Therefore, it is quite logical to divide the operations into threads based on the elements of the sequence.</span></p>
<p class="p_Text"><span class="f_Text">Therefore, in the body of the kernel, the first thing we will do is determine the element of the sequence being analyzed based on the identifier of our thread. At the same time, the total number of running threads will indicate the number of elements in the sequence. Here, we will also immediately determine the offset in the query tensor and the dependency coefficient matrix to the first analyzed value.</span></p>
<div style="text-align: left; text-indent: 0; line-height: 1.0; page-break-inside: avoid; page-break-after: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0 0 0 0; margin: 2px 17px 2px 17px;"><table cellspacing="0" cellpadding="3" border="0" style="text-align: justify;border:none; border-spacing:0;">
<tr>
<td style="vertical-align:top; padding:3px; border:none"><p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">const</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">int</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #333333;">q</span><span class="f_CodeExample">&nbsp;=&nbsp;</span><span class="f_Functions">get_global_id</span><span class="f_CodeExample">(</span><span class="f_Normal" style="font-family: Arial,Helvetica,sans-serif; color: #000000; background-color: transparent;">0</span><span class="f_CodeExample">);</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">const</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">int</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #333333;">units</span><span class="f_CodeExample">&nbsp;=&nbsp;</span><span class="f_Functions">get_global_size</span><span class="f_CodeExample">(</span><span class="f_Normal" style="font-family: Arial,Helvetica,sans-serif; color: #000000; background-color: transparent;">0</span><span class="f_CodeExample">);</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">int</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #333333;">shift_query</span><span class="f_CodeExample">&nbsp;=&nbsp;</span><span class="f_CodeExample" style="color: #333333;">key_size</span><span class="f_CodeExample">&nbsp;*&nbsp;</span><span class="f_CodeExample" style="color: #333333;">q</span><span class="f_CodeExample">;</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">int</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #333333;">shift_scores</span><span class="f_CodeExample">&nbsp;=&nbsp;</span><span class="f_CodeExample" style="color: #333333;">units</span><span class="f_CodeExample">&nbsp;*&nbsp;</span><span class="f_CodeExample" style="color: #333333;">q</span><span class="f_CodeExample">;</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_Definition">TYPE</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #333333;">summ</span><span class="f_CodeExample">&nbsp;=&nbsp;</span><span class="f_Normal" style="font-family: Arial,Helvetica,sans-serif; color: #000000; background-color: transparent;">0</span><span class="f_CodeExample">;</span></p>
</td>
</tr>
</table>
</div>
<p class="p_Text"><span class="f_Text">To normalize data with the </span><span class="f_Text" style="font-style: italic;">Softmax</span><span class="f_Text"> function, we need the sum of the exponents of all normalized values. To calculate it, we add a variable with an initial zero value.</span></p>
<p class="p_Text"><span class="f_Text">After completing the preparatory work, we will determine the values of one vector from the dependency coefficient matrix, which is related to the calculations for the dependencies of the analyzed element of the sequence. For this, we create a loop with the number of iterations equal to the number of elements in the sequence. In the body of the loop, we will alternately multiply the </span><span class="f_Text" style="font-style: italic;">Query </span><span class="f_Text">vector of the analyzed sequence element with all vectors of the </span><span class="f_Text" style="font-style: italic;">Key</span><span class="f_Text"> tensor. For each vector multiplication result, we will take an exponential value and write it into the corresponding element of the </span><span class="f_Text" style="font-style: italic;">Score matrix.</span><span class="f_Text"> Of course, we will add the values of the vector to our accumulator sum of all vector values for subsequent normalization.</span></p>
<div style="text-align: left; text-indent: 0; line-height: 1.0; page-break-inside: avoid; page-break-after: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0 0 0 0; margin: 2px 17px 2px 17px;"><table cellspacing="0" cellpadding="3" border="0" style="text-align: justify;border:none; border-spacing:0;">
<tr>
<td style="vertical-align:top; padding:3px; border:none"><p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">for</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #0000ff;">int</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #333333;">s</span><span class="f_CodeExample">&nbsp;=&nbsp;</span><span class="f_Normal" style="font-family: Arial,Helvetica,sans-serif; color: #000000; background-color: transparent;">0</span><span class="f_CodeExample">;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">s</span><span class="f_CodeExample">&nbsp;&lt;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">units</span><span class="f_CodeExample">;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">s</span><span class="f_CodeExample">++)</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_Definition">TYPE</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #333333;">score</span><span class="f_CodeExample">&nbsp;=&nbsp;</span><span class="f_Normal" style="font-family: Arial,Helvetica,sans-serif; color: #000000; background-color: transparent;">0</span><span class="f_CodeExample">;</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">int</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #333333;">shift_key</span><span class="f_CodeExample">&nbsp;=&nbsp;</span><span class="f_CodeExample" style="color: #333333;">key_size</span><span class="f_CodeExample">&nbsp;*&nbsp;</span><span class="f_CodeExample" style="color: #333333;">s</span><span class="f_CodeExample">;</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">for</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #0000ff;">int</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #333333;">k</span><span class="f_CodeExample">&nbsp;=&nbsp;</span><span class="f_Normal" style="font-family: Arial,Helvetica,sans-serif; color: #000000; background-color: transparent;">0</span><span class="f_CodeExample">;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">k</span><span class="f_CodeExample">&nbsp;&lt;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">key_size</span><span class="f_CodeExample">;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">k</span><span class="f_CodeExample">&nbsp;++)</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">score</span><span class="f_CodeExample">&nbsp;+=&nbsp;</span><span class="f_CodeExample" style="color: #333333;">querys</span><span class="f_CodeExample">[</span><span class="f_CodeExample" style="color: #333333;">shift_query</span><span class="f_CodeExample">&nbsp;+&nbsp;</span><span class="f_CodeExample" style="color: #333333;">k</span><span class="f_CodeExample">]&nbsp;*&nbsp;</span><span class="f_CodeExample" style="color: #333333;">keys</span><span class="f_CodeExample">[</span><span class="f_CodeExample" style="color: #333333;">shift_key</span><span class="f_CodeExample">&nbsp;+&nbsp;</span><span class="f_CodeExample" style="color: #333333;">k</span><span class="f_CodeExample">];</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">score</span><span class="f_CodeExample">&nbsp;=&nbsp;</span><span class="f_Functions">exp</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #333333;">score</span><span class="f_CodeExample">&nbsp;/&nbsp;</span><span class="f_Functions">sqrt</span><span class="f_CodeExample">((</span><span class="f_Definition">TYPE</span><span class="f_CodeExample">)</span><span class="f_CodeExample" style="color: #333333;">key_size</span><span class="f_CodeExample">));</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">summ</span><span class="f_CodeExample">&nbsp;+=&nbsp;</span><span class="f_CodeExample" style="color: #333333;">score</span><span class="f_CodeExample">;</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">scores</span><span class="f_CodeExample">[</span><span class="f_CodeExample" style="color: #333333;">shift_scores</span><span class="f_CodeExample">&nbsp;+&nbsp;</span><span class="f_CodeExample" style="color: #333333;">s</span><span class="f_CodeExample">]&nbsp;=&nbsp;</span><span class="f_CodeExample" style="color: #333333;">score</span><span class="f_CodeExample">;</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></p>
</td>
</tr>
</table>
</div>
<p class="p_Text"><span class="f_Text">After the loop completes, our variable </span><span class="f_Text" style="font-style: italic;">summ</span><span class="f_Text"> will accumulate the sum of all elements of our vector from the dependency coefficients tensor. To complete the normalization of the given vector values, all we have to do is divide the value of each of its elements by the total sum of all the values of the vector.</span></p>
<div style="text-align: left; text-indent: 0; line-height: 1.0; page-break-inside: avoid; page-break-after: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0 0 0 0; margin: 2px 17px 2px 17px;"><table cellspacing="0" cellpadding="3" border="0" style="text-align: justify;border:none; border-spacing:0;">
<tr>
<td style="vertical-align:top; padding:3px; border:none"><p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">for</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #0000ff;">int</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #333333;">s</span><span class="f_CodeExample">&nbsp;=&nbsp;</span><span class="f_Normal" style="font-family: Arial,Helvetica,sans-serif; color: #000000; background-color: transparent;">0</span><span class="f_CodeExample">;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">s</span><span class="f_CodeExample">&nbsp;&lt;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">units</span><span class="f_CodeExample">;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">s</span><span class="f_CodeExample">++)</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">scores</span><span class="f_CodeExample">[</span><span class="f_CodeExample" style="color: #333333;">shift_scores</span><span class="f_CodeExample">&nbsp;+&nbsp;</span><span class="f_CodeExample" style="color: #333333;">s</span><span class="f_CodeExample">]&nbsp;/=&nbsp;</span><span class="f_CodeExample" style="color: #333333;">summ</span><span class="f_CodeExample">;</span></p>
</td>
</tr>
</table>
</div>
<p class="p_Text"><span class="f_Text">In the analyzed vector, we obtained the coefficients of dependencies of the analyzed element of the sequence on the rest of its elements. The sum of all coefficients will be equal to one.</span></p>
<p class="p_Text"><span class="f_Text">Next, according to the algorithm, we need to multiply each vector of the </span><span class="f_Text" style="font-style: italic;">Value</span><span class="f_Text"> tensor by the corresponding element of the resulting vector of dependency coefficients. The resulting vectors need to be added up. The final vector of values will be the result of the </span><span class="f_Text" style="font-style: italic;">Self-Attention</span><span class="f_Text"> block.</span></p>
<p class="p_Text"><span class="f_Text">Before passing the data further, we need to add the obtained data to the tensor of input data and normalize them. In the body of the kernel, I propose focusing on determining the results of the </span><span class="f_Text" style="font-style: italic;">Self-Attention</span><span class="f_Text"> block. It will be more efficient to perform matrix addition and data normalization separately across the entire neural layer.</span></p>
<p class="p_Parameters"><span class="f_Parameters">Let's look at the implementation of such a solution. To avoid recalculating at each iteration, we first determine the offset in the tensors of the initial data and results. The tensors have the same dimension, so the offset will be the same for both cases. Then, we will set up a system of two nested loops: in the outer loop, we will iterate over the elements of the vector of the analyzed element of the sequence, and in the inner loop, we will perform the actual computation of the values for each element of the result vector. For this purpose, the number of iterations in the inner loop will be equal to the number of elements in the sequence. In the body of this loop, we will multiply the values of the </span><span class="f_Parameters" style="font-style: italic;">Value </span><span class="f_Parameters">tensor elements by the corresponding dependency coefficients from the </span><span class="f_Parameters" style="font-style: italic;">Score</span><span class="f_Parameters"> matrix. We will accumulate the resulting products in the local variable </span><span class="f_Parameters" style="font-style: italic;">query</span><span class="f_Parameters">. After completing the iterations of the inner loop, we will write the result into the corresponding element of the result tensor.</span></p>
<div style="text-align: left; text-indent: 0; line-height: 1.0; page-break-inside: avoid; page-break-after: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0 0 0 0; margin: 2px 17px 2px 17px;"><table cellspacing="0" cellpadding="3" border="0" style="text-align: justify;border:none; border-spacing:0;">
<tr>
<td style="vertical-align:top; padding:3px; border:none"><p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">shift_query</span><span class="f_CodeExample">&nbsp;=&nbsp;</span><span class="f_CodeExample" style="color: #333333;">window</span><span class="f_CodeExample">&nbsp;*&nbsp;</span><span class="f_CodeExample" style="color: #333333;">q</span><span class="f_CodeExample">;</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">for</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #0000ff;">int</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #333333;">i</span><span class="f_CodeExample">&nbsp;=&nbsp;</span><span class="f_Normal" style="font-family: Arial,Helvetica,sans-serif; color: #000000; background-color: transparent;">0</span><span class="f_CodeExample">;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">i</span><span class="f_CodeExample">&nbsp;&lt;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">window</span><span class="f_CodeExample">;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">i</span><span class="f_CodeExample">++)</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_Definition">TYPE</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #333333;">query</span><span class="f_CodeExample">&nbsp;=&nbsp;</span><span class="f_Normal" style="font-family: Arial,Helvetica,sans-serif; color: #000000; background-color: transparent;">0</span><span class="f_CodeExample">;</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">for</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #0000ff;">int</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #333333;">v</span><span class="f_CodeExample">&nbsp;=&nbsp;</span><span class="f_Normal" style="font-family: Arial,Helvetica,sans-serif; color: #000000; background-color: transparent;">0</span><span class="f_CodeExample">;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">v</span><span class="f_CodeExample">&nbsp;&lt;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">units</span><span class="f_CodeExample">;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">v</span><span class="f_CodeExample">++)</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">query</span><span class="f_CodeExample">&nbsp;+=&nbsp;</span><span class="f_CodeExample" style="color: #333333;">values</span><span class="f_CodeExample">[</span><span class="f_CodeExample" style="color: #333333;">window</span><span class="f_CodeExample">&nbsp;*&nbsp;</span><span class="f_CodeExample" style="color: #333333;">v</span><span class="f_CodeExample">&nbsp;+&nbsp;</span><span class="f_CodeExample" style="color: #333333;">i</span><span class="f_CodeExample">]&nbsp;*&nbsp;</span><span class="f_CodeExample" style="color: #333333;">scores</span><span class="f_CodeExample">[</span><span class="f_CodeExample" style="color: #333333;">shift_scores</span><span class="f_CodeExample">&nbsp;+&nbsp;</span><span class="f_CodeExample" style="color: #333333;">v</span><span class="f_CodeExample">];</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">outputs</span><span class="f_CodeExample">[</span><span class="f_CodeExample" style="color: #333333;">shift_query</span><span class="f_CodeExample">&nbsp;+&nbsp;</span><span class="f_CodeExample" style="color: #333333;">i</span><span class="f_CodeExample">]&nbsp;=&nbsp;</span><span class="f_CodeExample" style="color: #333333;">query</span><span class="f_CodeExample">;</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;}</span></p>
</td>
</tr>
</table>
</div>
<p class="p_Text"><span class="f_Text">With this, we will complete work on the first feed-forward kernel. The next step is to create a kernel for adding up two tensors. It is sometimes more economical to do such work using matrix operations on the side of the main program. The operation is straightforward, and the overhead of data transfer is unlikely to be justified. We now have the opposite situation. We organize the entire process on the OpenCL context side. All the information is already in the context memory, and to perform the operation on the main program side, we will need to copy the data. We do not need to transfer data if computations are performed within the context. Therefore, we have created a kernel called </span><span class="f_Text" style="font-style: italic;">Sum</span><span class="f_Text">, in which we simply add elements from two buffers with the same index and store the result in an element of the third buffer with the same index.</span></p>
<div style="text-align: left; text-indent: 0; line-height: 1.0; page-break-inside: avoid; page-break-after: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0 0 0 0; margin: 2px 17px 2px 17px;"><table cellspacing="0" cellpadding="3" border="0" style="text-align: justify;border:none; border-spacing:0;">
<tr>
<td style="vertical-align:top; padding:3px; border:none"><p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample" style="color: #0000ff;">__kernel</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">void</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #333333;">Sum</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #0000ff;">__global</span><span class="f_CodeExample">&nbsp;</span><span class="f_Definition">TYPE</span><span class="f_CodeExample">&nbsp;*</span><span class="f_CodeExample" style="color: #333333;">inputs1</span><span class="f_CodeExample">,</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">__global</span><span class="f_CodeExample">&nbsp;</span><span class="f_Definition">TYPE</span><span class="f_CodeExample">&nbsp;*</span><span class="f_CodeExample" style="color: #333333;">inputs2</span><span class="f_CodeExample">,</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">__global</span><span class="f_CodeExample">&nbsp;</span><span class="f_Definition">TYPE</span><span class="f_CodeExample">&nbsp;*</span><span class="f_CodeExample" style="color: #333333;">outputs</span><span class="f_CodeExample">)</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;{</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">const</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">int</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #333333;">n</span><span class="f_CodeExample">&nbsp;=&nbsp;</span><span class="f_Functions">get_global_id</span><span class="f_CodeExample">(</span><span class="f_Normal" style="font-family: Arial,Helvetica,sans-serif; color: #000000; background-color: transparent;">0</span><span class="f_CodeExample">);</span>
<br><span class="f_CodeExample" style="color: #808080;">//---</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">outputs</span><span class="f_CodeExample">[</span><span class="f_CodeExample" style="color: #333333;">n</span><span class="f_CodeExample">]&nbsp;=&nbsp;</span><span class="f_CodeExample" style="color: #333333;">inputs1</span><span class="f_CodeExample">[</span><span class="f_CodeExample" style="color: #333333;">n</span><span class="f_CodeExample">]&nbsp;+&nbsp;</span><span class="f_CodeExample" style="color: #333333;">inputs2</span><span class="f_CodeExample">[</span><span class="f_CodeExample" style="color: #333333;">n</span><span class="f_CodeExample">];</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;}</span></p>
</td>
</tr>
</table>
</div>
<p class="p_Text"><span class="f_Text">The data normalization process has a more complex architecture. As you know, its process is expressed by the following mathematical formulas:</span></p>
<p class="p_Text" style="text-align: center;"><span style="display:inline-block;width:91px;height:47px;padding:0 0;overflow:visible"><svg xmlns="http://www.w3.org/2000/svg" style="width:100%;height:100%;overflow:visible" viewBox="0 0 364 188"><path d="M31 86 L35 83 L37 84 L32 108 C31 110,31 112,31 113 C31 114,31 115,31 115 C32 116,32 116,33 116 C34 116,35 116,35 115 C36 115,37 114,39 112 L41 114 C39 116,37 118,35 119 C34 120,32 120,30 120 C29 120,28 120,27 119 C26 118,25 116,25 115 C25 114,26 112,26 111 L26 110 C23 114,21 116,19 118 C17 119,15 120,12 120 C10 120,8 119,6 117 C5 115,4 112,4 108 C4 104,5 100,6 96 C8 92,10 89,13 87 C16 84,19 83,23 83 C24 83,26 83,27 84 C29 84,30 85,31 86 L31 86 Z M28 97 C28 96,29 95,29 94 C29 93,29 93,29 92 C29 90,28 88,28 87 C27 87,25 86,23 86 C21 86,19 87,17 89 C15 91,13 94,12 98 C11 101,10 105,10 108 C10 111,11 113,11 114 C12 115,13 116,15 116 C17 116,18 115,20 114 C21 113,23 110,24 108 C26 105,27 102,28 98 L28 97 Z" fill="#212121"/><path d="M35 75 L16 75 L16 71 L35 71 L35 75 Z" fill="#212121"/><path d="M70 93 L70 88 L116 88 L116 93 L70 93 Z M70 108 L70 103 L116 103 L116 108 L70 108 Z" fill="#212121"/><path d="M168 52 C168 54,168 55,168 55 C168 56,169 57,169 57 C169 58,170 58,171 58 C172 59,172 59,174 59 C175 59,176 59,178 59 L178 62 L151 62 L151 59 C154 59,156 59,157 59 C158 58,159 58,159 58 C160 57,160 57,161 56 C161 55,161 54,161 52 L161 22 C161 21,161 21,161 20 C160 20,160 20,159 20 C158 20,157 20,156 21 C154 22,153 23,151 24 L149 21 L166 11 L168 11 C168 13,168 17,168 21 L168 52 Z" fill="#212121"/><path d="M155 127 C155 125,156 123,156 122 C156 121,155 120,155 120 C154 119,153 119,151 119 L152 117 L161 117 L163 117 L157 141 L157 142 C160 139,162 136,164 135 C166 134,168 133,170 133 C172 133,174 134,175 135 C177 136,177 138,177 141 C177 142,177 145,176 147 L174 157 C173 160,173 162,173 163 C173 164,173 165,173 165 C174 166,174 166,175 166 C176 166,176 166,177 165 C178 165,179 164,181 162 L183 164 C180 166,178 168,177 169 C175 170,174 170,172 170 C170 170,169 169,168 168 C167 167,167 166,167 164 C167 162,167 160,168 157 L169 150 C170 148,170 146,171 145 C171 144,171 143,171 142 C171 140,171 139,170 138 C170 137,169 137,167 137 C166 137,165 138,164 138 C163 139,162 141,160 142 C159 144,158 146,157 147 C156 149,156 151,155 153 L152 169 L145 169 L155 127 Z" fill="#212121"/><rect x="142" y="95" width="42" height="5" fill="#212121"/><path d="M230 59 L254 94 L254 97 L227 133 L260 133 C263 133,265 132,266 130 C268 129,269 126,269 122 L273 122 L272 140 L217 140 L217 138 L247 98 L219 57 L219 55 L273 55 L273 72 L269 72 C268 68,267 65,265 63 C263 60,260 59,256 59 L230 59 Z" fill="#212121"/><path d="M252 27 C252 28,252 28,251 29 C251 29,251 30,251 30 C251 30,251 30,251 31 C251 31,251 31,251 31 C251 32,251 32,251 33 C252 33,252 33,253 33 C253 33,253 33,254 33 C254 33,254 33,255 32 C255 32,255 32,256 31 C256 31,257 30,257 30 C258 30,258 30,258 31 C259 31,259 31,259 31 C258 33,257 33,257 34 C256 35,255 35,255 36 C254 36,253 37,253 37 C252 37,251 37,250 37 C250 37,249 37,249 37 C248 37,248 36,247 36 C247 35,247 35,246 34 C246 34,246 33,246 32 C246 32,246 31,246 30 C246 29,247 28,247 27 C247 26,247 25,248 24 C248 23,248 22,248 22 C249 21,249 20,249 19 C249 19,249 18,249 17 C249 17,249 17,249 16 C249 16,249 15,249 15 C248 15,248 15,248 14 C247 14,247 14,246 14 C246 14,245 14,244 15 C243 16,242 17,241 18 C240 19,239 20,238 21 C238 22,237 24,237 25 C236 27,236 29,236 31 C235 33,235 35,234 37 L229 37 L235 8 C236 7,236 6,236 6 C236 5,236 5,236 4 C236 4,236 3,236 3 C236 3,236 3,235 3 C235 2,235 2,234 2 C234 2,233 2,233 2 L233 0 L240 0 L242 0 L239 16 L239 16 C240 15,241 14,242 13 C242 13,243 12,244 12 C245 11,246 11,246 10 C247 10,248 10,249 10 C251 10,252 11,253 12 C254 13,254 14,254 16 C254 16,254 17,254 18 C254 18,254 19,254 20 L252 27 Z" fill="#212121"/><path d="M214 147 L212 153 L207 153 L208 147 L214 147 Z M207 175 C207 176,207 177,207 178 C207 178,207 179,207 179 C207 180,207 180,207 181 C207 181,208 181,208 181 C209 181,209 181,209 181 C210 181,210 181,210 180 C211 180,211 180,211 179 C212 179,212 178,213 178 L215 180 C214 181,213 182,212 182 C211 183,211 183,210 184 C209 184,209 185,208 185 C207 185,207 185,206 185 C205 185,205 185,204 185 C204 185,203 184,203 184 C202 183,202 183,202 182 C202 182,201 181,201 180 C201 180,202 179,202 178 C202 177,202 176,202 175 C203 174,203 173,203 172 C203 171,204 170,204 169 C204 168,204 167,204 166 C205 165,205 164,205 163 C205 163,205 163,205 162 C205 162,205 162,205 162 C205 161,205 161,204 161 C204 160,203 160,202 160 L202 158 L210 158 L211 158 L207 175 Z" fill="#212121"/><path d="M223 165 L223 161 L253 161 L253 165 L223 165 Z M223 177 L223 173 L253 173 L253 177 L223 177 Z" fill="#212121"/><path d="M278 178 C278 179,278 179,278 180 C278 180,278 181,278 181 C278 181,278 181,278 182 C278 182,279 182,279 182 C279 182,279 182,280 183 C280 183,280 183,281 183 C281 183,282 183,283 183 C284 183,285 183,286 183 L286 185 L264 185 L264 183 C265 183,266 183,267 183 C268 183,268 183,269 183 C269 183,270 183,270 183 C271 182,271 182,271 182 C271 182,272 182,272 182 C272 182,272 181,272 181 C272 181,272 180,272 180 C272 180,272 179,272 178 L272 159 C272 159,272 158,272 158 C272 158,271 157,271 157 C270 157,270 158,268 158 C267 159,266 160,264 161 C264 160,264 160,264 160 C263 159,263 159,263 158 C265 157,267 156,270 155 C272 154,274 152,276 151 L278 151 C278 152,278 153,278 154 C278 155,278 155,278 156 C278 157,278 157,278 158 L278 178 Z" fill="#212121"/><path d="M334 86 L338 83 L340 84 L335 108 C334 110,334 112,334 113 C334 114,334 115,334 115 C335 116,335 116,336 116 C337 116,338 116,338 115 C339 115,340 114,342 112 L344 114 C342 116,340 118,338 119 C337 120,335 120,333 120 C332 120,331 120,330 119 C329 118,328 116,328 115 C328 114,329 112,329 111 L329 110 C326 114,324 116,322 118 C320 119,318 120,315 120 C313 120,311 119,309 117 C308 115,307 112,307 108 C307 104,308 100,309 96 C311 92,313 89,316 87 C319 84,322 83,326 83 C327 83,329 83,330 84 C332 84,333 85,334 86 L334 86 Z M331 97 C331 96,332 95,332 94 C332 93,332 93,332 92 C332 90,331 88,331 87 C330 87,328 86,326 86 C324 86,322 87,320 89 C318 91,316 94,315 98 C314 101,313 105,313 108 C313 111,314 113,314 114 C315 115,316 116,318 116 C320 116,321 115,323 114 C324 113,326 110,327 108 C329 105,330 102,331 98 L331 97 Z" fill="#212121"/><path d="M357 107 L355 113 L350 113 L351 107 L357 107 Z M350 135 C350 136,350 137,350 138 C350 138,350 139,350 139 C350 140,350 140,350 141 C350 141,351 141,351 141 C352 141,352 141,352 141 C353 141,353 141,353 140 C354 140,354 140,354 139 C355 139,355 138,356 138 L358 140 C357 141,356 142,355 142 C354 143,354 143,353 144 C352 144,352 145,351 145 C350 145,350 145,349 145 C348 145,348 145,347 145 C347 145,346 144,346 144 C345 143,345 143,345 142 C345 142,344 141,344 140 C344 140,345 139,345 138 C345 137,345 136,345 135 C346 134,346 133,346 132 C346 131,347 130,347 129 C347 128,347 127,347 126 C348 125,348 124,348 123 C348 123,348 123,348 122 C348 122,348 122,348 122 C348 121,348 121,347 121 C347 120,346 120,345 120 L345 118 L353 118 L354 118 L350 135 Z" fill="#212121"/></svg></span></p>
<p class="p_Text" style="text-align: center;"><span style="display:inline-block;width:152px;height:87px;padding:0 0;overflow:visible"><svg xmlns="http://www.w3.org/2000/svg" style="width:100%;height:100%;overflow:visible" viewBox="0 0 608 348"><path d="M31 72 L35 69 L37 70 L32 94 C31 96,31 98,31 99 C31 100,31 101,31 101 C32 102,32 102,33 102 C34 102,35 102,35 101 C36 101,37 100,39 98 L41 100 C39 102,37 104,35 105 C34 106,32 106,30 106 C29 106,28 106,27 105 C26 104,25 102,25 101 C25 100,26 98,26 97 L26 96 C23 100,21 102,19 104 C17 105,15 106,12 106 C10 106,8 105,6 103 C5 101,4 98,4 94 C4 90,5 86,6 82 C8 78,10 75,13 73 C16 70,19 69,23 69 C24 69,26 69,27 70 C29 70,30 71,31 72 L31 72 Z M28 83 C28 82,29 81,29 80 C29 79,29 79,29 78 C29 76,28 74,28 73 C27 73,25 72,23 72 C21 72,19 73,17 75 C15 77,13 80,12 84 C11 87,10 91,10 94 C10 97,11 99,11 100 C12 101,13 102,15 102 C17 102,18 101,20 100 C21 99,23 96,24 94 C26 91,27 88,28 84 L28 83 Z" fill="#212121"/><path d="M28 52 L36 64 L33 66 L26 57 L26 57 L17 66 L15 64 L23 52 L28 52 Z" fill="#212121"/><path d="M70 79 L70 74 L116 74 L116 79 L70 79 Z M70 94 L70 89 L116 89 L116 94 L70 94 Z" fill="#212121"/><path d="M317 15 L321 12 L323 13 L318 37 C317 39,317 41,317 42 C317 43,317 44,317 44 C318 45,318 45,319 45 C320 45,321 45,321 44 C322 44,323 43,325 41 L327 43 C325 45,323 47,321 48 C320 49,318 49,316 49 C315 49,314 49,313 48 C312 47,311 45,311 44 C311 43,312 41,312 40 L312 39 C309 43,307 45,305 47 C303 48,301 49,298 49 C296 49,294 48,292 46 C291 44,290 41,290 37 C290 33,291 29,292 25 C294 21,296 18,299 16 C302 13,305 12,309 12 C310 12,312 12,313 13 C315 13,316 14,317 15 L317 15 Z M314 26 C314 25,315 24,315 23 C315 22,315 22,315 21 C315 19,314 17,314 16 C313 16,311 15,309 15 C307 15,305 16,303 18 C301 20,299 23,298 27 C297 30,296 34,296 37 C296 40,297 42,297 43 C298 44,299 45,301 45 C303 45,304 44,306 43 C307 42,309 39,310 37 C312 34,313 31,314 27 L314 26 Z" fill="#212121"/><path d="M352 29 L352 24 L398 24 L398 29 L352 29 Z" fill="#212121"/><path d="M451 15 L455 12 L457 13 L452 37 C451 39,451 41,451 42 C451 43,451 44,451 44 C452 45,452 45,453 45 C454 45,455 45,455 44 C456 44,457 43,459 41 L461 43 C459 45,457 47,455 48 C454 49,452 49,450 49 C449 49,448 49,447 48 C446 47,445 45,445 44 C445 43,446 41,446 40 L446 39 C443 43,441 45,439 47 C437 48,435 49,432 49 C430 49,428 48,426 46 C425 44,424 41,424 37 C424 33,425 29,426 25 C428 21,430 18,433 16 C436 13,439 12,443 12 C444 12,446 12,447 13 C449 13,450 14,451 15 L451 15 Z M448 26 C448 25,449 24,449 23 C449 22,449 22,449 21 C449 19,448 17,448 16 C447 16,445 15,443 15 C441 15,439 16,437 18 C435 20,433 23,432 27 C431 30,430 34,430 37 C430 40,431 42,431 43 C432 44,433 45,435 45 C437 45,438 44,440 43 C441 42,443 39,444 37 C446 34,447 31,448 27 L448 26 Z" fill="#212121"/><path d="M455 4 L436 4 L436 0 L455 0 L455 4 Z" fill="#212121"/><path d="M156 302 L175 337 L191 100 L202 100 L202 105 L195 105 L178 351 L175 351 L152 308 L145 312 L143 309 L156 302 Z" fill="#212121"/><path d="M220 204 C220 205,220 205,220 206 C220 206,220 207,220 207 C220 207,220 207,220 208 C220 208,221 208,221 208 C221 208,221 208,222 209 C222 209,222 209,223 209 C223 209,224 209,225 209 C226 209,227 209,228 209 L228 211 L206 211 L206 209 C207 209,208 209,209 209 C210 209,210 209,211 209 C211 209,212 209,212 209 C213 208,213 208,213 208 C213 208,214 208,214 208 C214 208,214 207,214 207 C214 207,214 206,214 206 C214 206,214 205,214 204 L214 185 C214 185,214 184,214 184 C214 184,213 183,213 183 C212 183,212 184,210 184 C209 185,208 186,206 187 C206 186,206 186,206 186 C205 185,205 185,205 184 C207 183,209 182,212 181 C214 180,216 178,218 177 L220 177 C220 178,220 179,220 180 C220 181,220 181,220 182 C220 183,220 183,220 184 L220 204 Z" fill="#212121"/><path d="M225 283 C225 284,225 284,224 285 C224 285,224 286,224 286 C224 286,224 286,224 287 C224 287,224 287,224 287 C224 288,224 288,224 289 C225 289,225 289,226 289 C226 289,226 289,227 289 C227 289,227 289,228 288 C228 288,228 288,229 287 C229 287,230 286,230 286 C231 286,231 286,231 287 C232 287,232 287,232 287 C231 289,230 289,230 290 C229 291,228 291,228 292 C227 292,226 293,226 293 C225 293,224 293,223 293 C223 293,222 293,222 293 C221 293,221 292,220 292 C220 291,220 291,219 290 C219 290,219 289,219 288 C219 288,219 287,219 286 C219 285,220 284,220 283 C220 282,220 281,221 280 C221 279,221 278,221 278 C222 277,222 276,222 275 C222 275,222 274,222 273 C222 273,222 273,222 272 C222 272,222 271,222 271 C221 271,221 271,221 270 C220 270,220 270,219 270 C219 270,218 270,217 271 C216 272,215 273,214 274 C213 275,212 276,211 277 C211 278,210 280,210 281 C209 283,209 285,209 287 C208 289,208 291,207 293 L202 293 L208 264 C209 263,209 262,209 262 C209 261,209 261,209 260 C209 260,209 259,209 259 C209 259,209 259,208 259 C208 258,208 258,207 258 C207 258,206 258,206 258 L206 256 L213 256 L215 256 L212 272 L212 272 C213 271,214 270,215 269 C215 269,216 268,217 268 C218 267,219 267,219 266 C220 266,221 266,222 266 C224 266,225 267,226 268 C227 269,227 270,227 272 C227 272,227 273,227 274 C227 274,227 275,227 276 L225 283 Z" fill="#212121"/><rect x="199" y="231" width="34" height="5" fill="#212121"/><path d="M279 207 L296 234 L296 237 L277 264 L301 264 C302 264,303 264,304 264 C305 264,306 263,306 263 C307 262,307 262,308 261 C308 260,308 259,309 258 C309 257,310 255,310 253 L314 253 L313 271 L267 271 L267 269 L289 238 L268 205 L268 203 L313 203 L313 219 L309 219 C308 217,308 215,307 214 C307 212,306 211,306 210 C305 210,305 209,304 208 C303 208,303 208,302 207 C301 207,300 207,299 207 L279 207 Z" fill="#212121"/><path d="M301 175 C301 176,301 176,300 177 C300 177,300 178,300 178 C300 178,300 178,300 179 C300 179,300 179,300 179 C300 180,300 180,300 181 C301 181,301 181,302 181 C302 181,302 181,303 181 C303 181,303 181,304 180 C304 180,304 180,305 179 C305 179,306 178,306 178 C307 178,307 178,307 179 C308 179,308 179,308 179 C307 181,306 181,306 182 C305 183,304 183,304 184 C303 184,302 185,302 185 C301 185,300 185,299 185 C299 185,298 185,298 185 C297 185,297 184,296 184 C296 183,296 183,295 182 C295 182,295 181,295 180 C295 180,295 179,295 178 C295 177,296 176,296 175 C296 174,296 173,297 172 C297 171,297 170,297 170 C298 169,298 168,298 167 C298 167,298 166,298 165 C298 165,298 165,298 164 C298 164,298 163,298 163 C297 163,297 163,297 162 C296 162,296 162,295 162 C295 162,294 162,293 163 C292 164,291 165,290 166 C289 167,288 168,287 169 C287 170,286 172,286 173 C285 175,285 177,285 179 C284 181,284 183,283 185 L278 185 L284 156 C285 155,285 154,285 154 C285 153,285 153,285 152 C285 152,285 151,285 151 C285 151,285 151,284 151 C284 150,284 150,283 150 C283 150,282 150,282 150 L282 148 L289 148 L291 148 L288 164 L288 164 C289 163,290 162,291 161 C291 161,292 160,293 160 C294 159,295 159,295 158 C296 158,297 158,298 158 C300 158,301 159,302 160 C303 161,303 162,303 164 C303 164,303 165,303 166 C303 166,303 167,303 168 L301 175 Z" fill="#212121"/><path d="M263 278 L261 284 L256 284 L257 278 L263 278 Z M256 306 C256 307,256 308,256 309 C256 309,256 310,256 310 C256 311,256 311,256 312 C256 312,257 312,257 312 C258 312,258 312,258 312 C259 312,259 312,259 311 C260 311,260 311,260 310 C261 310,261 309,262 309 L264 311 C263 312,262 313,261 313 C260 314,260 314,259 315 C258 315,258 316,257 316 C256 316,256 316,255 316 C254 316,254 316,253 316 C253 316,252 315,252 315 C251 314,251 314,251 313 C251 313,250 312,250 311 C250 311,251 310,251 309 C251 308,251 307,251 306 C252 305,252 304,252 303 C252 302,253 301,253 300 C253 299,253 298,253 297 C254 296,254 295,254 294 C254 294,254 294,254 293 C254 293,254 293,254 293 C254 292,254 292,253 292 C253 291,252 291,251 291 L251 289 L259 289 L260 289 L256 306 Z" fill="#212121"/><path d="M272 296 L272 292 L302 292 L302 296 L272 296 Z M272 308 L272 304 L302 304 L302 308 L272 308 Z" fill="#212121"/><path d="M327 309 C327 310,327 310,327 311 C327 311,327 312,327 312 C327 312,327 312,327 313 C327 313,328 313,328 313 C328 313,328 313,329 314 C329 314,329 314,330 314 C330 314,331 314,332 314 C333 314,334 314,335 314 L335 316 L313 316 L313 314 C314 314,315 314,316 314 C317 314,317 314,318 314 C318 314,319 314,319 314 C320 313,320 313,320 313 C320 313,321 313,321 313 C321 313,321 312,321 312 C321 312,321 311,321 311 C321 311,321 310,321 309 L321 290 C321 290,321 289,321 289 C321 289,320 288,320 288 C319 288,319 289,317 289 C316 290,315 291,313 292 C313 291,313 291,313 291 C312 290,312 290,312 289 C314 288,316 287,319 286 C321 285,323 283,325 282 L327 282 C327 283,327 284,327 285 C327 286,327 286,327 287 C327 288,327 288,327 289 L327 309 Z" fill="#212121"/><path d="M352 237 C352 245,353 253,356 258 C359 264,363 267,369 269 L368 272 C361 270,355 266,352 260 C348 254,346 246,346 237 C346 228,348 221,352 214 C355 208,361 204,368 202 L369 205 C363 207,359 211,356 216 C353 222,352 228,352 237 L352 237 Z" fill="#212121"/><path d="M401 222 L405 219 L407 220 L402 244 C401 246,401 248,401 249 C401 250,401 251,401 251 C402 252,402 252,403 252 C404 252,405 252,405 251 C406 251,407 250,409 248 L411 250 C409 252,407 254,405 255 C404 256,402 256,400 256 C399 256,398 256,397 255 C396 254,395 252,395 251 C395 250,396 248,396 247 L396 246 C393 250,391 252,389 254 C387 255,385 256,382 256 C380 256,378 255,376 253 C375 251,374 248,374 244 C374 240,375 236,376 232 C378 228,380 225,383 223 C386 220,389 219,393 219 C394 219,396 219,397 220 C399 220,400 221,401 222 L401 222 Z M398 233 C398 232,399 231,399 230 C399 229,399 229,399 228 C399 226,398 224,398 223 C397 223,395 222,393 222 C391 222,389 223,387 225 C385 227,383 230,382 234 C381 237,380 241,380 244 C380 247,381 249,381 250 C382 251,383 252,385 252 C387 252,388 251,390 250 C391 249,393 246,394 244 C396 241,397 238,398 234 L398 233 Z" fill="#212121"/><path d="M436 236 L436 231 L482 231 L482 236 L436 236 Z" fill="#212121"/><path d="M535 222 L539 219 L541 220 L536 244 C535 246,535 248,535 249 C535 250,535 251,535 251 C536 252,536 252,537 252 C538 252,539 252,539 251 C540 251,541 250,543 248 L545 250 C543 252,541 254,539 255 C538 256,536 256,534 256 C533 256,532 256,531 255 C530 254,529 252,529 251 C529 250,530 248,530 247 L530 246 C527 250,525 252,523 254 C521 255,519 256,516 256 C514 256,512 255,510 253 C509 251,508 248,508 244 C508 240,509 236,510 232 C512 228,514 225,517 223 C520 220,523 219,527 219 C528 219,530 219,531 220 C533 220,534 221,535 222 L535 222 Z M532 233 C532 232,533 231,533 230 C533 229,533 229,533 228 C533 226,532 224,532 223 C531 223,529 222,527 222 C525 222,523 223,521 225 C519 227,517 230,516 234 C515 237,514 241,514 244 C514 247,515 249,515 250 C516 251,517 252,519 252 C521 252,522 251,524 250 C525 249,527 246,528 244 C530 241,531 238,532 234 L532 233 Z" fill="#212121"/><path d="M539 211 L520 211 L520 207 L539 207 L539 211 Z" fill="#212121"/><path d="M566 237 C566 228,565 222,562 216 C559 211,555 207,549 205 L550 202 C557 204,563 208,566 214 C570 221,572 228,572 237 C572 246,570 254,566 260 C563 266,557 270,550 272 L549 269 C555 267,559 264,562 258 C565 253,566 245,566 237 L566 237 Z" fill="#212121"/><path d="M597 215 C597 215,598 215,599 215 C599 215,599 215,600 215 C600 214,600 214,601 214 C601 213,601 213,601 212 L604 212 C604 213,604 214,604 216 C604 217,604 218,603 219 L581 219 L581 218 C581 217,582 216,582 215 C583 214,583 213,584 212 C585 211,586 210,587 209 C587 208,588 207,590 206 C591 204,593 203,594 202 C595 200,596 199,596 198 C597 197,597 197,597 196 C598 195,598 194,598 193 C598 192,598 192,597 191 C597 190,597 189,596 189 C596 188,595 188,594 188 C594 187,593 187,592 187 C590 187,589 188,588 188 C587 189,586 190,585 192 L582 192 L582 187 C584 186,586 185,588 185 C590 184,592 184,593 184 C595 184,597 184,598 185 C599 185,600 186,601 186 C602 187,602 188,603 189 C603 190,603 191,603 192 C603 193,603 194,603 194 C603 195,603 196,603 196 C602 197,602 197,602 198 C601 199,601 199,600 200 C600 201,599 201,599 202 C598 203,597 204,596 204 C595 205,594 206,594 207 C593 208,592 209,591 210 C590 211,589 212,588 213 C588 214,587 214,587 215 L597 215 Z" fill="#212121"/><rect x="199" y="100" width="408" height="5" fill="#212121"/><rect x="142" y="81" width="465" height="5" fill="#212121"/></svg></span></p>
<p class="p_Text"><span class="f_Text">As you can notice, to calculate the normalized value of each element in the sequence, you need the arithmetic mean and the root mean square deviation of the entire sequence. To calculate them, we need to organize data transfer between individual threads. We will solve this problem in a way similar to the multi-threaded implementation of the </span><span class="f_Text" style="font-style: italic;"><a href="3_7_1_opencl_programm.htm#softmax_opencl" class="topiclink">Softmax</a></span><span class="f_Text"> activation function, that is, via an array in local memory. We will need to organize two summation blocks for values across the entire vector because before calculating the arithmetic mean, we cannot compute the variance. Furthermore, we cannot calculate the normalized value until we determine the variance.</span></p>
<p class="p_Text"><span class="f_Text">The normalization process is organized in the </span><span class="f_Text" style="font-style: italic;">LayerNormalize</span><span class="f_Text"> kernel. In the parameters, the kernel receives pointers to 3 buffers:</span></p>
<ul style="list-style-type:disc">
<li class="p_li"><span class="f_li">Source data buffer</span></li>
<li class="p_li"><span class="f_li">Results buffer</span></li>
<li class="p_li"><span class="f_li">Buffer for recording standard deviation parameters</span></li>
</ul>
<p class="p_Text"><span class="f_Text">We needed the last standard deviation buffer to save and transmit data to the backpropagation kernel.</span></p>
<p class="p_Text"><span class="f_Text">Additionally, we will pass two parameters to the kernel: the total number of elements in the buffer being normalized and the offset in the buffer for root mean square deviations. I would like to remind you that within one attention neural layer, we perform data normalization twice. Let's normalize the results of the </span><span class="f_Text" style="font-style: italic;">Self-Attention</span><span class="f_Text"> and </span><span class="f_Text" style="font-style: italic;">FeedForward</span><span class="f_Text"> blocks.</span></p>
<div style="text-align: left; text-indent: 0; line-height: 1.0; page-break-inside: avoid; page-break-after: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0 0 0 0; margin: 2px 17px 2px 17px;"><table cellspacing="0" cellpadding="3" border="0" style="text-align: justify;border:none; border-spacing:0;">
<tr>
<td style="vertical-align:top; padding:3px; border:none"><p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample" style="color: #0000ff;">__kernel</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">void</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #333333;">LayerNormalize</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #0000ff;">__global</span><span class="f_CodeExample">&nbsp;</span><span class="f_Definition">TYPE</span><span class="f_CodeExample">*&nbsp;</span><span class="f_CodeExample" style="color: #333333;">inputs</span><span class="f_CodeExample">,</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">__global</span><span class="f_CodeExample">&nbsp;</span><span class="f_Definition">TYPE</span><span class="f_CodeExample">*&nbsp;</span><span class="f_CodeExample" style="color: #333333;">outputs</span><span class="f_CodeExample">,</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">__global</span><span class="f_CodeExample">&nbsp;</span><span class="f_Definition">TYPE</span><span class="f_CodeExample">*&nbsp;</span><span class="f_CodeExample" style="color: #333333;">stds</span><span class="f_CodeExample">,</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">const</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">int</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #333333;">total</span><span class="f_CodeExample">,</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">const</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">int</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #333333;">std_shift</span><span class="f_CodeExample">)</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;{</span></p>
</td>
</tr>
</table>
</div>
<p class="p_Text"><span class="f_Text">In the kernel body, we define thread identifiers and initialize a local data array.</span></p>
<div style="text-align: left; text-indent: 0; line-height: 1.0; page-break-inside: avoid; page-break-after: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0 0 0 0; margin: 2px 17px 2px 17px;"><table cellspacing="0" cellpadding="3" border="0" style="text-align: justify;border:none; border-spacing:0;">
<tr>
<td style="vertical-align:top; padding:3px; border:none"><p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">uint</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #333333;">i</span><span class="f_CodeExample">&nbsp;=&nbsp;(</span><span class="f_CodeExample" style="color: #0000ff;">uint</span><span class="f_CodeExample">)</span><span class="f_Functions">get_global_id</span><span class="f_CodeExample">(</span><span class="f_Normal" style="font-family: Arial,Helvetica,sans-serif; color: #000000; background-color: transparent;">0</span><span class="f_CodeExample">);</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">uint</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #333333;">l</span><span class="f_CodeExample">&nbsp;=&nbsp;(</span><span class="f_CodeExample" style="color: #0000ff;">uint</span><span class="f_CodeExample">)</span><span class="f_Functions">get_local_id</span><span class="f_CodeExample">(</span><span class="f_Normal" style="font-family: Arial,Helvetica,sans-serif; color: #000000; background-color: transparent;">0</span><span class="f_CodeExample">);</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">uint</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #333333;">ls</span><span class="f_CodeExample">&nbsp;=&nbsp;</span><span class="f_Functions">min</span><span class="f_CodeExample">((</span><span class="f_CodeExample" style="color: #0000ff;">uint</span><span class="f_CodeExample">)</span><span class="f_Functions">get_local_size</span><span class="f_CodeExample">(</span><span class="f_Normal" style="font-family: Arial,Helvetica,sans-serif; color: #000000; background-color: transparent;">0</span><span class="f_CodeExample">),&nbsp;(</span><span class="f_CodeExample" style="color: #0000ff;">uint</span><span class="f_CodeExample">)</span><span class="f_Definition">LOCAL_SIZE</span><span class="f_CodeExample">);</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">__local</span><span class="f_CodeExample">&nbsp;</span><span class="f_Definition">TYPE</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #333333;">temp</span><span class="f_CodeExample">[</span><span class="f_Definition">LOCAL_SIZE</span><span class="f_CodeExample">];</span></p>
</td>
</tr>
</table>
</div>
<p class="p_Text"><span class="f_Text">First, we will determine the arithmetic mean of the buffer elements. To do this, we organize a loop in which each thread sums its values and stores the result in its own element of the local array. Since we are calculating the arithmetic mean of the entire buffer, we will divide the obtained value by the number of elements in the buffer.</span></p>
<div style="text-align: left; text-indent: 0; line-height: 1.0; page-break-inside: avoid; page-break-after: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0 0 0 0; margin: 2px 17px 2px 17px;"><table cellspacing="0" cellpadding="3" border="0" style="text-align: justify;border:none; border-spacing:0;">
<tr>
<td style="vertical-align:top; padding:3px; border:none"><p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">uint</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #333333;">count</span><span class="f_CodeExample">&nbsp;=&nbsp;</span><span class="f_Normal" style="font-family: Arial,Helvetica,sans-serif; color: #000000; background-color: transparent;">0</span><span class="f_CodeExample">;</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">do</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">uint</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #333333;">shift</span><span class="f_CodeExample">&nbsp;=&nbsp;</span><span class="f_CodeExample" style="color: #333333;">count</span><span class="f_CodeExample">&nbsp;*&nbsp;</span><span class="f_CodeExample" style="color: #333333;">ls</span><span class="f_CodeExample">&nbsp;+&nbsp;</span><span class="f_CodeExample" style="color: #333333;">l</span><span class="f_CodeExample">;</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">temp</span><span class="f_CodeExample">[</span><span class="f_CodeExample" style="color: #333333;">l</span><span class="f_CodeExample">]&nbsp;=&nbsp;(</span><span class="f_CodeExample" style="color: #333333;">count</span><span class="f_CodeExample">&nbsp;&gt;&nbsp;</span><span class="f_Normal" style="font-family: Arial,Helvetica,sans-serif; color: #000000; background-color: transparent;">0</span><span class="f_CodeExample">&nbsp;?&nbsp;</span><span class="f_CodeExample" style="color: #333333;">temp</span><span class="f_CodeExample">[</span><span class="f_CodeExample" style="color: #333333;">l</span><span class="f_CodeExample">]&nbsp;:&nbsp;</span><span class="f_Normal" style="font-family: Arial,Helvetica,sans-serif; color: #000000; background-color: transparent;">0</span><span class="f_CodeExample">)&nbsp;+&nbsp;(</span><span class="f_CodeExample" style="color: #333333;">shift</span><span class="f_CodeExample">&nbsp;&lt;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">total</span><span class="f_CodeExample">&nbsp;?&nbsp;</span><span class="f_CodeExample" style="color: #333333;">inputs</span><span class="f_CodeExample">[</span><span class="f_CodeExample" style="color: #333333;">shift</span><span class="f_CodeExample">]&nbsp;:&nbsp;</span><span class="f_Normal" style="font-family: Arial,Helvetica,sans-serif; color: #000000; background-color: transparent;">0</span><span class="f_CodeExample">);</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">count</span><span class="f_CodeExample">++;</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">while</span><span class="f_CodeExample">((</span><span class="f_CodeExample" style="color: #333333;">count</span><span class="f_CodeExample">&nbsp;*&nbsp;</span><span class="f_CodeExample" style="color: #333333;">ls</span><span class="f_CodeExample">&nbsp;+&nbsp;</span><span class="f_CodeExample" style="color: #333333;">l</span><span class="f_CodeExample">)&nbsp;&lt;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">total</span><span class="f_CodeExample">);</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">temp</span><span class="f_CodeExample">[</span><span class="f_CodeExample" style="color: #333333;">l</span><span class="f_CodeExample">]&nbsp;/=&nbsp;(</span><span class="f_Definition">TYPE</span><span class="f_CodeExample">)</span><span class="f_CodeExample" style="color: #333333;">total</span><span class="f_CodeExample">;</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_Functions">barrier</span><span class="f_CodeExample">(</span><span class="f_Definition">CLK_LOCAL_MEM_FENCE</span><span class="f_CodeExample">);</span></p>
</td>
</tr>
</table>
</div>
<p class="p_Text"><span class="f_Text">We will synchronize the work of threads using the </span><span class="f_Text" style="font-style: italic;">barrier</span><span class="f_Text"> function. Since the calculations of the threads do not overlap, we only need one barrier at the end of the block.</span></p>
<p class="p_Text"><span class="f_Text">Next, we need to collect parts of the total amount into a single whole. We will organize another loop in which we will collect the arithmetic mean of the buffer into one element of the local array with index 0. The result will be saved in a local variable.</span></p>
<div style="text-align: left; text-indent: 0; line-height: 1.0; page-break-inside: avoid; page-break-after: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0 0 0 0; margin: 2px 17px 2px 17px;"><table cellspacing="0" cellpadding="3" border="0" style="text-align: justify;border:none; border-spacing:0;">
<tr>
<td style="vertical-align:top; padding:3px; border:none"><p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">count</span><span class="f_CodeExample">&nbsp;=&nbsp;</span><span class="f_CodeExample" style="color: #333333;">ls</span><span class="f_CodeExample">;</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">do</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">count</span><span class="f_CodeExample">&nbsp;=&nbsp;(</span><span class="f_CodeExample" style="color: #333333;">count</span><span class="f_CodeExample">&nbsp;+&nbsp;</span><span class="f_Normal" style="font-family: Arial,Helvetica,sans-serif; color: #000000; background-color: transparent;">1</span><span class="f_CodeExample">)&nbsp;/&nbsp;</span><span class="f_Normal" style="font-family: Arial,Helvetica,sans-serif; color: #000000; background-color: transparent;">2</span><span class="f_CodeExample">;</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">temp</span><span class="f_CodeExample">[</span><span class="f_CodeExample" style="color: #333333;">l</span><span class="f_CodeExample">]&nbsp;+=&nbsp;(</span><span class="f_CodeExample" style="color: #333333;">l</span><span class="f_CodeExample">&nbsp;&lt;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">count</span><span class="f_CodeExample">&nbsp;?&nbsp;</span><span class="f_CodeExample" style="color: #333333;">temp</span><span class="f_CodeExample">[</span><span class="f_CodeExample" style="color: #333333;">l</span><span class="f_CodeExample">&nbsp;+&nbsp;</span><span class="f_CodeExample" style="color: #333333;">count</span><span class="f_CodeExample">]&nbsp;:&nbsp;</span><span class="f_Normal" style="font-family: Arial,Helvetica,sans-serif; color: #000000; background-color: transparent;">0</span><span class="f_CodeExample">);</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_Functions">barrier</span><span class="f_CodeExample">(</span><span class="f_Definition">CLK_LOCAL_MEM_FENCE</span><span class="f_CodeExample">);</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">while</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #333333;">count</span><span class="f_CodeExample">&nbsp;&gt;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">1</span><span class="f_CodeExample">);</span>
<br><span class="f_CodeExample" style="color: #808080;">//---</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_Definition">TYPE</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #333333;">mean</span><span class="f_CodeExample">&nbsp;=&nbsp;(</span><span class="f_Definition">TYPE</span><span class="f_CodeExample">)&nbsp;</span><span class="f_CodeExample" style="color: #333333;">temp</span><span class="f_CodeExample">[</span><span class="f_Normal" style="font-family: Arial,Helvetica,sans-serif; color: #000000; background-color: transparent;">0</span><span class="f_CodeExample">];</span></p>
</td>
</tr>
</table>
</div>
<p class="p_Text"><span class="f_Text">I would like to draw your attention once again to the arrangement of barriers. Here you need to pay special attention to the operation of the algorithm because all threads must reach each barrier. Moreover, the sequence of their visits must also be observed.</span></p>
<p class="p_Text"><span class="f_Text">After determining the arithmetic mean, we repeat the loops and calculate the standard deviation.</span></p>
<div style="text-align: left; text-indent: 0; line-height: 1.0; page-break-inside: avoid; page-break-after: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0 0 0 0; margin: 2px 17px 2px 17px;"><table cellspacing="0" cellpadding="3" border="0" style="text-align: justify;border:none; border-spacing:0;">
<tr>
<td style="vertical-align:top; padding:3px; border:none"><p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">count</span><span class="f_CodeExample">&nbsp;=&nbsp;</span><span class="f_Normal" style="font-family: Arial,Helvetica,sans-serif; color: #000000; background-color: transparent;">0</span><span class="f_CodeExample">;</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">do</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">uint</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #333333;">shift</span><span class="f_CodeExample">&nbsp;=&nbsp;</span><span class="f_CodeExample" style="color: #333333;">count</span><span class="f_CodeExample">&nbsp;*&nbsp;</span><span class="f_CodeExample" style="color: #333333;">ls</span><span class="f_CodeExample">&nbsp;+&nbsp;</span><span class="f_CodeExample" style="color: #333333;">l</span><span class="f_CodeExample">;</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">temp</span><span class="f_CodeExample">[</span><span class="f_CodeExample" style="color: #333333;">l</span><span class="f_CodeExample">]&nbsp;=&nbsp;(</span><span class="f_CodeExample" style="color: #333333;">count</span><span class="f_CodeExample">&nbsp;&gt;&nbsp;</span><span class="f_Normal" style="font-family: Arial,Helvetica,sans-serif; color: #000000; background-color: transparent;">0</span><span class="f_CodeExample">&nbsp;?&nbsp;</span><span class="f_CodeExample" style="color: #333333;">temp</span><span class="f_CodeExample">[</span><span class="f_CodeExample" style="color: #333333;">l</span><span class="f_CodeExample">]&nbsp;:&nbsp;</span><span class="f_Normal" style="font-family: Arial,Helvetica,sans-serif; color: #000000; background-color: transparent;">0</span><span class="f_CodeExample">)&nbsp;+&nbsp;(</span><span class="f_CodeExample" style="color: #333333;">shift</span><span class="f_CodeExample">&nbsp;&lt;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">total</span><span class="f_CodeExample">&nbsp;?&nbsp;(</span><span class="f_Definition">TYPE</span><span class="f_CodeExample">)</span><span class="f_Functions">pow</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #333333;">inputs</span><span class="f_CodeExample">[</span><span class="f_CodeExample" style="color: #333333;">shift</span><span class="f_CodeExample">]&nbsp;-&nbsp;</span><span class="f_CodeExample" style="color: #333333;">mean</span><span class="f_CodeExample">,&nbsp;</span><span class="f_Normal" style="font-family: Arial,Helvetica,sans-serif; color: #000000; background-color: transparent;">2</span><span class="f_CodeExample">)&nbsp;:&nbsp;</span><span class="f_Normal" style="font-family: Arial,Helvetica,sans-serif; color: #000000; background-color: transparent;">0</span><span class="f_CodeExample">);</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">count</span><span class="f_CodeExample">++;</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">while</span><span class="f_CodeExample">((</span><span class="f_CodeExample" style="color: #333333;">count</span><span class="f_CodeExample">&nbsp;*&nbsp;</span><span class="f_CodeExample" style="color: #333333;">ls</span><span class="f_CodeExample">&nbsp;+&nbsp;</span><span class="f_CodeExample" style="color: #333333;">l</span><span class="f_CodeExample">)&nbsp;&lt;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">total</span><span class="f_CodeExample">);</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">temp</span><span class="f_CodeExample">[</span><span class="f_CodeExample" style="color: #333333;">l</span><span class="f_CodeExample">]&nbsp;/=&nbsp;(</span><span class="f_CodeExample" style="color: #333333;">TYPE</span><span class="f_CodeExample">)</span><span class="f_CodeExample" style="color: #333333;">total</span><span class="f_CodeExample">;</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_Functions">barrier</span><span class="f_CodeExample">(</span><span class="f_Definition">CLK_LOCAL_MEM_FENCE</span><span class="f_CodeExample">);</span></p>
</td>
</tr>
</table>
</div>
<div style="text-align: left; text-indent: 0; line-height: 1.0; page-break-inside: avoid; page-break-after: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0 0 0 0; margin: 2px 17px 2px 17px;"><table cellspacing="0" cellpadding="3" border="0" style="text-align: justify;border:none; border-spacing:0;">
<tr>
<td style="vertical-align:top; padding:3px; border:none"><p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">count</span><span class="f_CodeExample">&nbsp;=&nbsp;</span><span class="f_CodeExample" style="color: #333333;">ls</span><span class="f_CodeExample">;</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">do</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">count</span><span class="f_CodeExample">&nbsp;=&nbsp;(</span><span class="f_CodeExample" style="color: #333333;">count</span><span class="f_CodeExample">&nbsp;+&nbsp;</span><span class="f_Normal" style="font-family: Arial,Helvetica,sans-serif; color: #000000; background-color: transparent;">1</span><span class="f_CodeExample">)&nbsp;/&nbsp;</span><span class="f_Normal" style="font-family: Arial,Helvetica,sans-serif; color: #000000; background-color: transparent;">2</span><span class="f_CodeExample">;</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">temp</span><span class="f_CodeExample">[</span><span class="f_CodeExample" style="color: #333333;">l</span><span class="f_CodeExample">]&nbsp;+=&nbsp;(</span><span class="f_CodeExample" style="color: #333333;">l</span><span class="f_CodeExample">&nbsp;&lt;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">count</span><span class="f_CodeExample">&nbsp;?&nbsp;</span><span class="f_CodeExample" style="color: #333333;">temp</span><span class="f_CodeExample">[</span><span class="f_CodeExample" style="color: #333333;">l</span><span class="f_CodeExample">&nbsp;+&nbsp;</span><span class="f_CodeExample" style="color: #333333;">count</span><span class="f_CodeExample">]&nbsp;:&nbsp;</span><span class="f_Normal" style="font-family: Arial,Helvetica,sans-serif; color: #000000; background-color: transparent;">0</span><span class="f_CodeExample">);</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">barrier</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #333333;">CLK_LOCAL_MEM_FENCE</span><span class="f_CodeExample">);</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">while</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #333333;">count</span><span class="f_CodeExample">&nbsp;&gt;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">1</span><span class="f_CodeExample">);</span>
<br><span class="f_CodeExample" style="color: #808080;">//---</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_Definition">TYPE</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #333333;">std</span><span class="f_CodeExample">&nbsp;=&nbsp;(</span><span class="f_Definition">TYPE</span><span class="f_CodeExample">)</span><span class="f_Functions">sqrt</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #333333;">temp</span><span class="f_CodeExample">[</span><span class="f_Normal" style="font-family: Arial,Helvetica,sans-serif; color: #000000; background-color: transparent;">0</span><span class="f_CodeExample">]);</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">if</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #333333;">l</span><span class="f_CodeExample">&nbsp;==&nbsp;</span><span class="f_Normal" style="font-family: Arial,Helvetica,sans-serif; color: #000000; background-color: transparent;">0</span><span class="f_CodeExample">)</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">stds</span><span class="f_CodeExample">[</span><span class="f_CodeExample" style="color: #333333;">std_shift</span><span class="f_CodeExample">]&nbsp;=&nbsp;</span><span class="f_CodeExample" style="color: #333333;">std</span><span class="f_CodeExample">;</span></p>
</td>
</tr>
</table>
</div>
<p class="p_Text"><span class="f_Text">We save the obtained standard deviation into a buffer. To avoid simultaneous writes by all threads, we will save the value in only one thread. To achieve this, we will perform a thread index check before the operation of writing a value to the buffer.</span></p>
<p class="p_Text"><span class="f_Text">Now that we have calculated the averages, we can normalize the original data. It's important to note that the limitation of the workgroup size may not allow us to allocate a separate thread for each element of the input data buffer. Therefore, we will also implement data normalization in a loop.</span></p>
<div style="text-align: justify; text-indent: 0; padding: 0 0 0 0; margin: 7px 17px 6px 17px;"><table cellspacing="0" cellpadding="3" border="0" style="text-align: justify;border:none; border-spacing:0;">
<tr>
<td style="vertical-align:top; padding:3px; border:none"><p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">count</span><span class="f_CodeExample">&nbsp;=&nbsp;</span><span class="f_CodeExample" style="color: #333333;">0</span><span class="f_CodeExample">;</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">while</span><span class="f_CodeExample">((</span><span class="f_CodeExample" style="color: #333333;">count</span><span class="f_CodeExample">&nbsp;*&nbsp;</span><span class="f_CodeExample" style="color: #333333;">ls</span><span class="f_CodeExample">&nbsp;+&nbsp;</span><span class="f_CodeExample" style="color: #333333;">l</span><span class="f_CodeExample">)&nbsp;&lt;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">total</span><span class="f_CodeExample">)</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">uint</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #333333;">shift</span><span class="f_CodeExample">&nbsp;=&nbsp;</span><span class="f_CodeExample" style="color: #333333;">count</span><span class="f_CodeExample">&nbsp;*&nbsp;</span><span class="f_CodeExample" style="color: #333333;">ls</span><span class="f_CodeExample">&nbsp;+&nbsp;</span><span class="f_CodeExample" style="color: #333333;">l</span><span class="f_CodeExample">;</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">outputs</span><span class="f_CodeExample">[</span><span class="f_CodeExample" style="color: #333333;">shift</span><span class="f_CodeExample">]&nbsp;=&nbsp;(</span><span class="f_CodeExample" style="color: #333333;">inputs</span><span class="f_CodeExample">[</span><span class="f_CodeExample" style="color: #333333;">shift</span><span class="f_CodeExample">]&nbsp;-&nbsp;</span><span class="f_CodeExample" style="color: #333333;">mean</span><span class="f_CodeExample">)&nbsp;/&nbsp;(</span><span class="f_CodeExample" style="color: #333333;">std</span><span class="f_CodeExample">&nbsp;+&nbsp;</span><span class="f_Normal" style="font-family: Arial,Helvetica,sans-serif; color: #000000; background-color: transparent;">1e-37f</span><span class="f_CodeExample">);</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">count</span><span class="f_CodeExample">++;</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;}</span></p>
</td>
</tr>
</table>
</div>
<p class="p_Text"><span class="f_Text">This concludes our work with feed-forward kernels. Continuing our work on making additions to the OpenCL program, we move on to building a reverse pass. Its algorithm completely mirrors the path taken above but in the reverse direction. In it, we have to propagate the error gradient from the output of the </span><span class="f_Text" style="font-style: italic;">Self-Attention</span><span class="f_Text"> block to the internal neural layers </span><span class="f_li" style="font-style: italic;">m_cQuery</span><span class="f_li">, </span><span class="f_li" style="font-style: italic;">m_cKeys</span><span class="f_li">, </span><span class="f_li" style="font-style: italic;">m_cValues.</span></p>
<p class="p_Text"><span class="f_Text">The simplest seems to be the calculation of the error gradient for the internal neural layer, </span><span class="f_Text" style="font-style: italic;">m_cValues.</span><span class="f_Text"> Let me remind you that to obtain the result of the </span><span class="f_Text" style="font-style: italic;">Self-Attention </span><span class="f_Text">block, we multiplied the matrix of dependence coefficients </span><span class="f_Text" style="font-style: italic;">m_cScores</span><span class="f_Text"> by the tensor of the results of the neural layer </span><span class="f_Text" style="font-style: italic;">m_cValues</span><span class="f_Text">&#8203;&#8203;. Therefore, to obtain the error gradient at the output level of the specified neural layer, we need to multiply the gradient obtained from previous operations by the derivative of the last operation. In this case, we have to multiply the matrix of dependency coefficients by the tensor of error gradients from previous operations.</span></p>
<p class="p_Text" style="text-align: center;"><span style="display:inline-block;width:264px;height:25px;padding:0 0;overflow:visible"><svg xmlns="http://www.w3.org/2000/svg" style="width:100%;height:100%;overflow:visible" viewBox="0 0 1056 100"><path d="M30 51 C31 49,31 47,31 45 C31 44,31 43,30 43 C30 42,29 42,28 42 L28 40 L43 40 L42 42 C41 42,41 43,40 43 C40 43,39 43,39 44 C39 44,38 45,38 46 C38 47,37 49,37 51 L34 62 L31 63 L29 60 C27 62,25 62,23 63 C22 63,21 63,19 63 C14 63,11 62,9 59 C6 56,5 53,5 47 C5 44,6 39,7 35 C8 30,10 26,12 23 C14 19,17 16,21 14 C24 12,28 11,32 11 C34 11,36 11,38 12 C40 12,42 12,44 13 L42 23 L38 23 C38 20,38 18,36 16 C35 15,34 14,31 14 C29 14,27 15,25 16 C24 17,22 18,20 21 C19 23,17 25,16 29 C15 32,14 35,13 39 C12 42,12 46,12 49 C12 53,12 56,14 57 C15 59,17 60,20 60 C21 60,22 60,23 60 C24 60,25 59,26 59 C27 58,28 57,28 56 C29 55,30 54,30 53 L30 51 Z" fill="#212121"/><path d="M55 52 L55 54 C55 54,54 54,54 54 C53 55,53 55,53 55 C52 56,52 56,52 56 C52 57,52 58,52 58 C52 58,52 59,52 59 C52 60,52 60,52 61 C52 62,52 64,53 66 C53 68,53 70,53 71 C53 73,53 75,53 76 C53 78,53 79,53 80 L54 80 L64 62 C65 62,65 61,66 60 C66 60,66 59,67 59 C67 58,67 58,67 57 C67 57,67 57,67 56 C67 55,66 54,64 54 L65 52 L76 52 L76 54 C76 54,75 54,75 54 C75 54,74 55,74 55 C73 55,73 56,72 57 C72 57,71 58,70 60 L53 87 L49 87 C49 82,48 78,48 73 C48 69,47 64,47 59 C47 58,47 58,47 57 C46 56,46 56,46 56 C46 55,45 55,45 55 C45 54,44 54,43 54 L44 52 L55 52 Z" fill="#212121"/><path d="M98 80 C97 81,96 82,95 83 C94 84,93 85,92 85 C92 86,91 86,90 87 C89 87,88 87,87 87 C85 87,83 86,82 85 C81 83,80 81,80 78 C80 77,81 75,81 74 C81 72,82 71,83 69 C83 68,84 67,85 65 C86 64,87 63,88 63 C89 62,90 61,92 61 C93 60,94 60,95 60 C97 60,98 60,99 61 C100 61,101 61,102 62 L105 60 L107 61 L103 77 C103 78,103 79,102 80 C102 80,102 81,102 81 C102 82,102 82,103 83 C103 83,103 83,104 83 C104 83,105 83,105 83 C105 83,106 83,106 82 C106 82,107 82,107 81 C108 81,108 80,109 80 C109 80,109 80,109 81 C110 81,110 81,110 82 C109 83,109 83,108 84 C107 85,106 85,106 86 C105 86,104 87,104 87 C103 87,102 87,102 87 C100 87,99 87,99 86 C98 85,98 84,98 83 C98 82,98 81,98 80 L98 80 Z M99 72 C100 71,100 70,100 69 C100 68,100 68,100 67 C100 65,100 65,99 64 C98 63,97 63,96 63 C95 63,94 63,93 64 C92 64,91 65,90 66 C90 66,89 67,88 68 C88 69,87 70,87 71 C87 72,86 73,86 75 C86 76,86 77,86 78 C86 80,86 81,87 82 C87 83,88 83,89 83 C90 83,90 83,91 83 C92 83,92 82,93 82 C94 81,96 79,97 78 C98 76,99 74,99 72 L99 72 Z" fill="#212121"/><path d="M116 76 C117 73,118 70,119 66 C119 63,120 60,120 58 C121 56,121 55,121 54 C121 54,121 53,121 53 C121 53,121 53,120 53 C120 52,120 52,119 52 C119 52,118 52,118 52 L118 50 L125 50 L127 50 C126 55,125 60,124 64 C123 68,122 72,121 77 C121 78,121 79,121 80 C121 80,120 81,120 81 C120 82,121 82,121 83 C121 83,122 83,122 83 C123 83,123 83,123 83 C124 83,124 83,124 82 C125 82,125 82,125 81 C126 81,126 80,127 80 L129 81 C128 83,127 83,126 84 C125 85,125 85,124 86 C123 86,123 87,122 87 C121 87,121 87,120 87 C119 87,119 87,118 87 C118 86,117 86,117 86 C116 85,116 85,116 84 C116 84,115 83,115 82 C115 81,116 81,116 80 C116 79,116 78,116 76 L116 76 Z" fill="#212121"/><path d="M152 80 C150 83,148 84,147 85 C145 87,143 87,141 87 C140 87,138 87,137 86 C136 85,136 83,136 82 C136 81,136 81,136 80 C136 79,136 78,137 77 C137 76,137 75,137 74 C138 73,138 72,138 71 C138 70,139 69,139 68 C139 67,139 66,139 66 C139 65,139 64,138 64 C137 64,137 64,137 64 C136 64,136 65,135 65 C135 65,135 66,134 66 C134 66,133 67,133 67 L131 66 C132 65,133 64,134 63 C134 62,135 62,136 61 C136 61,137 61,138 60 C138 60,139 60,140 60 C141 60,142 61,143 61 C144 62,144 63,144 65 C144 65,144 66,144 67 C144 68,144 69,143 70 C143 72,142 75,142 76 C141 78,141 79,141 80 C141 81,141 82,142 82 C142 83,143 83,144 83 C145 83,145 83,146 82 C147 82,148 81,149 80 C150 79,151 78,152 77 C152 75,153 74,153 73 L156 60 L161 60 L157 77 C157 78,157 79,157 79 C157 80,157 81,157 81 C157 82,157 82,157 83 C157 83,158 83,158 83 C158 83,159 83,159 83 C159 83,160 83,160 82 C161 82,161 82,161 81 C162 81,162 80,163 80 L165 81 C164 83,163 83,162 84 C161 85,161 85,160 86 C159 86,159 87,158 87 C157 87,157 87,156 87 C155 87,154 87,153 86 C152 85,152 84,152 83 C152 82,152 82,152 81 C152 81,152 81,152 80 L152 80 Z" fill="#212121"/><path d="M191 81 C189 83,187 85,185 86 C183 87,181 87,178 87 C177 87,176 87,174 86 C173 86,172 86,172 85 C171 84,170 83,170 82 C170 81,169 80,169 78 C169 77,170 76,170 75 C170 74,170 73,171 72 C171 71,171 70,172 69 C173 68,173 67,174 66 C175 64,177 63,179 62 C181 61,184 60,186 60 C189 60,190 61,192 62 C193 63,193 64,193 66 C193 72,187 75,175 75 C175 76,175 76,175 77 C175 77,175 78,175 78 C175 80,175 82,176 83 C177 84,178 84,180 84 C180 84,181 84,182 84 C183 84,184 83,184 83 C185 83,186 82,187 81 C187 81,188 80,189 79 L191 81 Z M175 72 C178 72,180 72,181 72 C183 71,184 71,185 70 C186 70,187 69,188 69 C188 68,188 67,188 66 C188 65,188 65,188 64 C187 63,186 63,185 63 C184 63,183 63,182 64 C181 64,180 65,180 66 C179 66,178 67,177 68 C177 69,176 71,175 72 L175 72 Z" fill="#212121"/><path d="M223 36 L223 31 L269 31 L269 36 L223 36 Z M223 51 L223 46 L269 46 L269 51 L223 51 Z" fill="#212121"/><path d="M301 51 C301 54,302 56,303 58 C305 59,307 60,310 60 C313 60,316 59,318 57 C319 55,320 53,320 49 C320 48,320 46,320 45 C319 44,318 43,317 42 C316 41,315 40,313 38 C311 37,309 36,308 34 C307 33,306 32,305 31 C305 29,304 27,304 26 C304 23,305 20,306 18 C308 16,310 14,312 13 C315 12,318 11,321 11 C323 11,325 11,327 12 C329 12,331 12,334 13 L332 22 L328 22 C328 20,328 19,327 17 C327 16,326 15,325 15 C324 14,322 14,321 14 C319 14,317 15,315 15 C314 16,313 17,312 19 C311 20,311 22,311 24 C311 25,311 27,312 28 C313 30,315 32,318 33 C320 35,322 37,323 38 C324 39,325 41,326 42 C327 44,327 46,327 47 C327 51,326 53,325 56 C323 58,321 60,319 61 C316 62,313 63,310 63 C308 63,305 63,303 63 C300 62,298 62,296 61 L298 51 L301 51 Z" fill="#212121"/><path d="M363 36 C363 34,362 33,362 32 C362 31,361 30,361 30 C360 29,360 29,358 29 C356 29,354 30,352 32 C350 34,348 37,347 41 C346 45,345 48,345 51 C345 54,346 56,347 57 C348 58,349 59,351 59 C353 59,355 59,357 58 C358 57,360 56,362 54 L364 56 C362 59,360 60,357 61 C355 63,352 63,350 63 C346 63,343 62,342 60 C340 58,339 55,339 50 C339 48,339 45,340 42 C341 39,343 36,345 33 C346 31,349 29,351 28 C354 27,356 26,359 26 C363 26,365 26,368 27 L366 36 L363 36 Z" fill="#212121"/><path d="M386 63 C382 63,379 62,377 60 C375 58,374 55,374 50 C374 49,374 46,375 44 C376 40,377 37,379 34 C381 32,383 30,385 28 C388 27,391 26,394 26 C398 26,401 27,403 29 C405 32,406 35,406 39 C406 42,405 45,404 48 C403 51,402 54,400 56 C399 59,397 60,394 61 C392 63,389 63,386 63 L386 63 Z M380 52 C380 55,381 57,382 58 C383 59,385 60,387 60 C390 60,392 59,394 57 C395 55,397 52,398 48 C399 44,400 40,400 37 C400 35,399 33,398 31 C397 30,395 29,393 29 C391 29,388 30,387 32 C385 35,383 38,382 42 C381 46,380 49,380 52 L380 52 Z" fill="#212121"/><path d="M426 36 C429 32,431 30,433 28 C435 27,438 26,440 26 C442 26,443 26,444 26 L443 35 L439 35 C439 34,438 33,438 33 C438 32,438 32,437 31 C437 31,436 31,436 31 C435 31,434 31,433 32 C432 33,431 34,429 36 C428 37,427 39,426 40 C426 42,425 44,424 46 L421 62 L415 62 L420 38 C420 37,421 36,421 35 C421 34,421 34,421 33 C421 32,421 31,420 31 C420 30,420 30,419 30 C418 30,417 30,416 31 C416 32,414 33,413 34 L411 32 C413 30,415 28,417 27 C418 27,420 26,422 26 C423 26,424 27,425 28 C426 29,426 30,426 31 C426 33,426 34,426 35 L426 36 Z" fill="#212121"/><path d="M477 55 C474 58,472 60,469 61 C467 62,464 63,461 63 C457 63,455 62,453 60 C451 58,450 55,450 51 C450 48,450 45,451 42 C452 39,454 36,456 34 C457 31,460 29,462 28 C465 27,468 26,471 26 C474 26,476 27,478 28 C479 29,480 31,480 34 C480 38,478 41,474 43 C470 45,464 46,457 46 C456 48,456 49,456 51 C456 54,457 56,458 57 C459 58,460 59,463 59 C465 59,467 59,469 58 C470 57,472 55,474 53 L477 55 Z M457 43 C461 43,464 43,466 42 C469 42,470 41,472 39 C473 38,474 36,474 34 C474 32,473 31,473 30 C472 30,471 29,470 29 C467 29,465 30,462 33 C460 35,458 39,457 43 L457 43 Z" fill="#212121"/><path d="M490 35 L491 33 C491 33,491 33,492 33 C492 33,492 33,493 33 C493 32,493 32,493 32 C493 32,494 31,494 31 C494 31,494 30,494 29 C494 29,495 28,495 27 L500 3 L496 3 C496 3,495 3,495 3 C495 3,494 3,494 3 C493 4,493 4,493 4 C493 4,492 5,492 5 C492 6,491 6,491 7 C491 8,490 8,490 9 L487 9 L489 0 L518 0 L516 10 L513 10 L513 8 C513 8,513 8,513 7 C513 7,513 7,513 6 C513 6,513 5,513 5 C513 5,513 5,513 4 C512 4,512 4,512 4 C512 4,512 3,512 3 C511 3,511 3,511 3 C511 3,510 3,510 3 L505 3 L500 27 C500 28,500 29,500 29 C499 30,499 31,499 31 C499 31,499 32,500 32 C500 32,500 32,500 33 C500 33,501 33,501 33 C501 33,502 33,502 33 L502 35 L490 35 Z" fill="#212121"/><path d="M570 46 L568 50 L558 43 L560 55 L555 55 L556 43 L546 50 L544 46 L554 41 L544 36 L546 32 L556 39 L555 27 L560 27 L558 39 L568 32 L570 36 L560 41 L570 46 Z" fill="#212121"/><path d="M622 51 C623 49,623 47,623 45 C623 44,623 43,622 43 C622 42,621 42,620 42 L620 40 L635 40 L634 42 C633 42,633 43,632 43 C632 43,631 43,631 44 C631 44,630 45,630 46 C630 47,629 49,629 51 L626 62 L623 63 L621 60 C619 62,617 62,615 63 C614 63,613 63,611 63 C606 63,603 62,601 59 C598 56,597 53,597 47 C597 44,598 39,599 35 C600 30,602 26,604 23 C606 19,609 16,613 14 C616 12,620 11,624 11 C626 11,628 11,630 12 C632 12,634 12,636 13 L634 23 L630 23 C630 20,630 18,628 16 C627 15,626 14,623 14 C621 14,619 15,617 16 C616 17,614 18,612 21 C611 23,609 25,608 29 C607 32,606 35,605 39 C604 42,604 46,604 49 C604 53,604 56,606 57 C607 59,609 60,612 60 C613 60,614 60,615 60 C616 60,617 59,618 59 C619 58,620 57,620 56 C621 55,622 54,622 53 L622 51 Z" fill="#212121"/><path d="M641 80 C641 82,641 84,642 85 C643 86,645 86,647 86 C648 86,650 86,650 86 C651 86,652 85,653 84 C653 84,654 83,654 82 C655 82,655 81,655 80 C655 79,655 78,655 78 C654 77,654 76,654 76 C653 75,653 75,652 74 C651 73,650 73,649 72 C648 71,647 71,646 70 C645 69,645 69,644 68 C643 67,643 66,643 66 C642 65,642 64,642 63 C642 62,643 60,643 59 C644 58,645 57,646 56 C647 55,648 54,650 54 C651 53,653 53,655 53 C657 53,658 53,660 53 C661 54,663 54,665 55 L663 61 L660 61 C660 60,660 59,660 58 C660 58,659 57,659 57 C658 56,658 56,657 56 C656 56,655 55,654 55 C653 55,652 56,652 56 C651 56,650 57,649 57 C649 58,648 58,648 59 C648 60,647 60,647 61 C647 62,648 63,648 63 C648 64,648 64,649 65 C649 65,649 66,650 67 C651 67,652 68,653 68 C654 69,655 70,656 71 C657 71,658 72,658 73 C659 74,659 75,660 75 C660 76,660 77,660 78 C660 80,660 81,659 83 C658 84,658 85,656 86 C655 87,654 88,652 88 C651 89,649 89,647 89 C645 89,644 89,642 89 C640 88,638 88,636 87 L638 80 L641 80 Z" fill="#212121"/><path d="M690 82 C688 84,686 86,684 87 C682 88,680 88,677 88 C676 88,675 88,673 87 C672 87,671 87,671 86 C670 85,669 84,669 83 C669 82,668 81,668 79 C668 78,669 77,669 76 C669 75,669 74,670 73 C670 72,670 71,671 70 C672 69,672 68,673 67 C674 65,676 64,678 63 C680 62,683 61,685 61 C688 61,689 62,691 63 C692 64,692 65,692 67 C692 73,686 76,674 76 C674 77,674 77,674 78 C674 78,674 79,674 79 C674 81,674 83,675 84 C676 85,677 85,679 85 C679 85,680 85,681 85 C682 85,683 84,683 84 C684 84,685 83,686 82 C686 82,687 81,688 80 L690 82 Z M674 73 C677 73,679 73,680 73 C682 72,683 72,684 71 C685 71,686 70,687 70 C687 69,687 68,687 67 C687 66,687 66,687 65 C686 64,685 64,684 64 C683 64,682 64,681 65 C680 65,679 66,679 67 C678 67,677 68,676 69 C676 70,675 72,674 73 L674 73 Z" fill="#212121"/><path d="M700 77 C701 74,702 71,703 67 C703 64,704 61,704 59 C705 57,705 56,705 55 C705 55,705 54,705 54 C705 54,705 54,704 54 C704 53,704 53,703 53 C703 53,702 53,702 53 L702 51 L709 51 L711 51 C710 56,709 61,708 65 C707 69,706 73,705 78 C705 79,705 80,705 81 C705 81,704 82,704 82 C704 83,705 83,705 84 C705 84,706 84,706 84 C707 84,707 84,707 84 C708 84,708 84,708 83 C709 83,709 83,709 82 C710 82,710 81,711 81 L713 82 C712 84,711 84,710 85 C709 86,709 86,708 87 C707 87,707 88,706 88 C705 88,705 88,704 88 C703 88,703 88,702 88 C702 87,701 87,701 87 C700 86,700 86,700 85 C700 85,699 84,699 83 C699 82,700 82,700 81 C700 80,700 79,700 77 L700 77 Z" fill="#212121"/><path d="M728 87 C727 91,726 94,724 96 C722 98,719 99,716 99 C715 99,715 99,714 99 C714 98,715 98,715 97 C715 97,715 97,715 96 C715 96,715 96,715 96 C716 96,716 96,716 96 C717 96,718 96,718 96 C719 96,719 95,720 95 C720 94,721 93,721 92 C722 91,722 90,722 88 L728 64 L723 64 L723 62 C724 62,725 62,726 62 C726 62,727 62,727 61 C728 61,728 61,728 60 C729 57,731 55,733 53 C735 52,738 51,741 51 C742 51,743 51,744 51 C744 51,745 51,746 52 L745 57 L742 57 C742 56,742 55,741 55 C741 54,740 54,739 54 C738 54,738 54,737 55 C736 55,736 56,735 56 C735 57,734 58,734 59 C734 60,733 60,733 61 L741 61 L740 64 L733 64 L728 87 Z" fill="#212121"/><path d="M753 74 L753 70 L783 70 L783 74 L753 74 Z" fill="#212121"/><path d="M810 88 L810 86 C811 86,811 86,811 86 C812 86,812 85,812 85 C813 85,813 84,813 84 C813 84,813 83,813 82 C813 82,813 81,813 81 C813 81,813 80,813 80 C813 79,813 79,813 78 C813 78,813 78,813 77 L801 77 C800 78,800 78,800 79 C799 79,799 80,799 81 C798 81,798 82,798 82 C798 83,797 83,797 84 C797 85,798 86,800 86 L800 88 L788 88 L789 86 C789 86,789 86,790 86 C790 86,791 85,791 85 C791 84,792 84,792 83 C793 83,794 82,794 80 L811 53 L816 53 L818 81 C818 82,819 83,819 83 C819 84,819 84,819 85 C820 85,820 85,820 86 C821 86,821 86,822 86 L821 88 L810 88 Z M812 59 C810 61,809 64,807 66 C805 69,804 72,802 74 L813 74 C813 73,813 72,812 71 C812 70,812 69,812 67 C812 66,812 65,812 63 C812 62,812 61,812 59 L812 59 Z" fill="#212121"/><path d="M845 82 C844 83,843 84,842 85 C841 86,841 86,840 87 C839 87,838 88,837 88 C837 88,836 88,835 88 C833 88,831 88,830 87 C829 86,829 84,829 82 C829 82,829 81,829 80 C829 79,829 79,829 78 L832 64 L828 64 L828 62 C829 62,830 62,831 62 C832 62,832 61,832 61 C833 61,833 60,833 60 C833 60,834 59,834 59 C834 58,834 57,835 57 C835 56,835 55,836 54 L840 54 L838 61 L847 61 L847 64 L838 64 L835 75 C835 76,835 76,834 77 C834 78,834 78,834 78 C834 79,834 79,834 80 C834 80,834 80,834 81 C834 82,834 83,835 83 C835 84,836 84,837 84 C838 84,839 84,840 83 C841 83,842 82,843 80 L845 82 Z" fill="#212121"/><path d="M869 82 C868 83,867 84,866 85 C865 86,865 86,864 87 C863 87,862 88,861 88 C861 88,860 88,859 88 C857 88,855 88,854 87 C853 86,853 84,853 82 C853 82,853 81,853 80 C853 79,853 79,853 78 L856 64 L852 64 L852 62 C853 62,854 62,855 62 C856 62,856 61,856 61 C857 61,857 60,857 60 C857 60,858 59,858 59 C858 58,858 57,859 57 C859 56,859 55,860 54 L864 54 L862 61 L871 61 L871 64 L862 64 L859 75 C859 76,859 76,858 77 C858 78,858 78,858 78 C858 79,858 79,858 80 C858 80,858 80,858 81 C858 82,858 83,859 83 C859 84,860 84,861 84 C862 84,863 84,864 83 C865 83,866 82,867 80 L869 82 Z" fill="#212121"/><path d="M897 82 C895 84,893 86,891 87 C889 88,887 88,884 88 C883 88,882 88,880 87 C879 87,878 87,878 86 C877 85,876 84,876 83 C876 82,875 81,875 79 C875 78,876 77,876 76 C876 75,876 74,877 73 C877 72,877 71,878 70 C879 69,879 68,880 67 C881 65,883 64,885 63 C887 62,890 61,892 61 C895 61,896 62,898 63 C899 64,899 65,899 67 C899 73,893 76,881 76 C881 77,881 77,881 78 C881 78,881 79,881 79 C881 81,881 83,882 84 C883 85,884 85,886 85 C886 85,887 85,888 85 C889 85,890 84,890 84 C891 84,892 83,893 82 C893 82,894 81,895 80 L897 82 Z M881 73 C884 73,886 73,887 73 C889 72,890 72,891 71 C892 71,893 70,894 70 C894 69,894 68,894 67 C894 66,894 66,894 65 C893 64,892 64,891 64 C890 64,889 64,888 65 C887 65,886 66,886 67 C885 67,884 68,883 69 C883 70,882 72,881 73 L881 73 Z" fill="#212121"/><path d="M916 68 C918 66,919 64,921 63 C923 62,925 61,926 61 C928 61,930 62,931 63 C932 64,932 65,932 67 C932 67,932 68,932 69 C932 70,931 71,931 72 C931 73,931 74,930 75 C930 76,930 78,929 78 C929 79,929 80,929 81 C929 82,929 82,929 82 C929 83,929 83,929 84 C929 84,930 84,930 84 C931 84,931 84,931 84 C932 84,932 84,932 83 C933 83,933 83,933 82 C934 82,934 81,935 81 L937 82 C936 84,935 84,934 85 C934 86,933 86,932 87 C932 87,931 88,930 88 C929 88,929 88,928 88 C927 88,927 88,926 88 C926 88,925 87,925 87 C924 86,924 86,924 85 C924 85,924 84,924 83 C924 83,924 82,924 81 C924 80,924 79,924 78 C925 77,925 76,925 75 C926 74,926 73,926 72 C926 71,926 71,927 70 C927 69,927 69,927 68 C927 67,927 66,926 66 C926 65,925 65,924 65 C924 65,923 65,922 65 C922 66,921 66,920 67 C920 67,919 68,919 68 C918 69,917 70,917 70 C916 71,916 72,916 73 C915 74,915 74,915 75 L912 88 L907 88 L911 71 C911 70,911 70,911 69 C911 68,911 67,911 67 C911 66,911 65,910 65 C909 65,909 65,909 65 C908 65,908 66,908 66 C907 66,907 67,906 67 C906 67,906 68,905 68 L903 67 C904 66,905 65,906 64 C906 63,907 63,908 62 C908 62,909 62,910 61 C910 61,911 61,912 61 C913 61,914 62,915 62 C916 63,916 64,916 66 C916 66,916 67,916 67 C916 67,916 68,916 68 L916 68 Z" fill="#212121"/><path d="M959 82 C958 83,957 84,956 85 C955 86,955 86,954 87 C953 87,952 88,951 88 C951 88,950 88,949 88 C947 88,945 88,944 87 C943 86,943 84,943 82 C943 82,943 81,943 80 C943 79,943 79,943 78 L946 64 L942 64 L942 62 C943 62,944 62,945 62 C946 62,946 61,946 61 C947 61,947 60,947 60 C947 60,948 59,948 59 C948 58,948 57,949 57 C949 56,949 55,950 54 L954 54 L952 61 L961 61 L961 64 L952 64 L949 75 C949 76,949 76,948 77 C948 78,948 78,948 78 C948 79,948 79,948 80 C948 80,948 80,948 81 C948 82,948 83,949 83 C949 84,950 84,951 84 C952 84,953 84,954 83 C955 83,956 82,957 80 L959 82 Z" fill="#212121"/><path d="M979 50 L977 56 L972 56 L973 50 L979 50 Z M972 78 C972 79,972 80,972 81 C972 81,972 82,972 82 C972 83,972 83,972 84 C972 84,973 84,973 84 C974 84,974 84,974 84 C975 84,975 84,975 83 C976 83,976 83,976 82 C977 82,977 81,978 81 L980 83 C979 84,978 85,977 85 C976 86,976 86,975 87 C974 87,974 88,973 88 C972 88,972 88,971 88 C970 88,970 88,969 88 C969 88,968 87,968 87 C967 86,967 86,967 85 C967 85,966 84,966 83 C966 83,967 82,967 81 C967 80,967 79,967 78 C968 77,968 76,968 75 C968 74,969 73,969 72 C969 71,969 70,969 69 C970 68,970 67,970 66 C970 66,970 66,970 65 C970 65,970 65,970 65 C970 64,970 64,969 64 C969 63,968 63,967 63 L967 61 L975 61 L976 61 L972 78 Z" fill="#212121"/><path d="M994 88 C993 88,991 88,990 87 C989 87,988 86,987 86 C986 85,986 84,985 83 C985 82,984 80,984 79 C984 76,985 74,986 72 C987 70,988 68,989 66 C990 65,992 63,994 62 C996 62,998 61,1000 61 C1002 61,1003 61,1004 62 C1006 62,1007 63,1008 64 C1008 65,1009 66,1009 67 C1010 68,1010 69,1010 71 C1010 73,1010 76,1009 78 C1008 80,1007 82,1005 83 C1004 85,1002 86,1000 87 C998 88,996 88,994 88 L994 88 Z M990 79 C990 81,990 83,991 84 C992 85,993 85,995 85 C996 85,997 85,998 84 C999 84,999 83,1000 83 C1001 82,1001 81,1002 80 C1003 79,1003 78,1003 77 C1004 76,1004 75,1004 73 C1005 72,1005 71,1005 70 C1005 68,1004 67,1003 66 C1003 65,1001 64,1000 64 C999 64,998 64,997 65 C996 65,995 66,995 66 C994 67,993 68,993 69 C992 70,991 71,991 72 C991 73,990 75,990 76 C990 77,990 78,990 79 L990 79 Z" fill="#212121"/><path d="M1027 68 C1029 66,1030 64,1032 63 C1034 62,1036 61,1037 61 C1039 61,1041 62,1042 63 C1043 64,1043 65,1043 67 C1043 67,1043 68,1043 69 C1043 70,1042 71,1042 72 C1042 73,1042 74,1041 75 C1041 76,1041 78,1040 78 C1040 79,1040 80,1040 81 C1040 82,1040 82,1040 82 C1040 83,1040 83,1040 84 C1040 84,1041 84,1041 84 C1042 84,1042 84,1042 84 C1043 84,1043 84,1043 83 C1044 83,1044 83,1044 82 C1045 82,1045 81,1046 81 L1048 82 C1047 84,1046 84,1045 85 C1045 86,1044 86,1043 87 C1043 87,1042 88,1041 88 C1040 88,1040 88,1039 88 C1038 88,1038 88,1037 88 C1037 88,1036 87,1036 87 C1035 86,1035 86,1035 85 C1035 85,1035 84,1035 83 C1035 83,1035 82,1035 81 C1035 80,1035 79,1035 78 C1036 77,1036 76,1036 75 C1037 74,1037 73,1037 72 C1037 71,1037 71,1038 70 C1038 69,1038 69,1038 68 C1038 67,1038 66,1037 66 C1037 65,1036 65,1035 65 C1035 65,1034 65,1033 65 C1033 66,1032 66,1031 67 C1031 67,1030 68,1030 68 C1029 69,1028 70,1028 70 C1027 71,1027 72,1027 73 C1026 74,1026 74,1026 75 L1023 88 L1018 88 L1022 71 C1022 70,1022 70,1022 69 C1022 68,1022 67,1022 67 C1022 66,1022 65,1021 65 C1020 65,1020 65,1020 65 C1019 65,1019 66,1019 66 C1018 66,1018 67,1017 67 C1017 67,1017 68,1016 68 L1014 67 C1015 66,1016 65,1017 64 C1017 63,1018 63,1019 62 C1019 62,1020 62,1021 61 C1021 61,1022 61,1023 61 C1024 61,1025 62,1026 62 C1027 63,1027 64,1027 66 C1027 66,1027 67,1027 67 C1027 67,1027 68,1027 68 L1027 68 Z" fill="#212121"/></svg></span></p>
<p class="p_Text"><span class="f_Text">After determining the error gradient on the internal neural layer </span><span class="f_Text" style="font-style: italic;">m_cValues,</span><span class="f_Text"> we need to distribute the error gradient to two more internal neural layers, </span><span class="f_Text" style="font-style: italic;">m_cQuerys </span><span class="f_Text">and </span><span class="f_Text" style="font-style: italic;">m_cKeys</span><span class="f_Text">. However, in order to bring the error gradient to the level of the specified neural layers, it is necessary to pass it through the matrix of dependency coefficients.</span></p>
<p class="p_Text" style="text-align: center;"><span style="display:inline-block;width:228px;height:27px;padding:0 0;overflow:visible"><svg xmlns="http://www.w3.org/2000/svg" style="width:100%;height:100%;overflow:visible" viewBox="0 0 912 108"><path d="M30 57 C31 55,31 53,31 51 C31 50,31 49,30 49 C30 48,29 48,28 48 L28 46 L43 46 L42 48 C41 48,41 49,40 49 C40 49,39 49,39 50 C39 50,38 51,38 52 C38 53,37 55,37 57 L34 68 L31 69 L29 66 C27 68,25 68,23 69 C22 69,21 69,19 69 C14 69,11 68,9 65 C6 62,5 59,5 53 C5 50,6 45,7 41 C8 36,10 32,12 29 C14 25,17 22,21 20 C24 18,28 17,32 17 C34 17,36 17,38 18 C40 18,42 18,44 19 L42 29 L38 29 C38 26,38 24,36 22 C35 21,34 20,31 20 C29 20,27 21,25 22 C24 23,22 24,20 27 C19 29,17 31,16 35 C15 38,14 41,13 45 C12 48,12 52,12 55 C12 59,12 62,14 63 C15 65,17 66,20 66 C21 66,22 66,23 66 C24 66,25 65,26 65 C27 64,28 63,28 62 C29 61,30 60,30 59 L30 57 Z" fill="#212121"/><path d="M49 83 C49 85,49 87,50 88 C51 89,53 89,55 89 C56 89,58 89,58 89 C59 89,60 88,61 87 C61 87,62 86,62 85 C63 85,63 84,63 83 C63 82,63 81,63 81 C62 80,62 79,62 79 C61 78,61 78,60 77 C59 76,58 76,57 75 C56 74,55 74,54 73 C53 72,53 72,52 71 C51 70,51 69,51 69 C50 68,50 67,50 66 C50 65,51 63,51 62 C52 61,53 60,54 59 C55 58,56 57,58 57 C59 56,61 56,63 56 C65 56,66 56,68 56 C69 57,71 57,73 58 L71 64 L68 64 C68 63,68 62,68 61 C68 61,67 60,67 60 C66 59,66 59,65 59 C64 59,63 58,62 58 C61 58,60 59,60 59 C59 59,58 60,57 60 C57 61,56 61,56 62 C56 63,55 63,55 64 C55 65,56 66,56 66 C56 67,56 67,57 68 C57 68,57 69,58 70 C59 70,60 71,61 71 C62 72,63 73,64 74 C65 74,66 75,66 76 C67 77,67 78,68 78 C68 79,68 80,68 81 C68 83,68 84,67 86 C66 87,66 88,64 89 C63 90,62 91,60 91 C59 92,57 92,55 92 C53 92,52 92,50 92 C48 91,46 91,44 90 L46 83 L49 83 Z" fill="#212121"/><path d="M95 72 C95 71,95 70,95 70 C95 69,95 69,95 68 C94 68,94 68,94 67 C93 67,93 67,92 67 C91 67,90 67,89 68 C88 68,88 69,87 69 C86 70,85 71,85 72 C84 73,84 74,83 75 C83 76,82 78,82 79 C82 80,82 81,82 82 C82 84,82 86,83 87 C84 88,85 88,86 88 C87 88,88 88,89 88 C89 88,90 87,91 87 C91 87,92 86,93 86 C93 85,94 84,95 83 C95 84,96 84,96 85 C96 85,97 85,97 86 C95 87,93 89,91 90 C89 91,87 91,85 91 C82 91,80 90,79 89 C77 87,76 85,76 82 C76 80,77 79,77 77 C77 76,78 74,79 73 C79 72,80 71,81 69 C82 68,83 67,84 67 C86 66,87 65,88 65 C90 64,91 64,93 64 C94 64,95 64,97 64 C98 64,99 65,100 65 L98 72 L95 72 Z" fill="#212121"/><path d="M114 91 C113 91,111 91,110 90 C109 90,108 89,107 89 C106 88,106 87,105 86 C105 85,104 83,104 82 C104 79,105 77,106 75 C107 73,108 71,109 69 C110 68,112 66,114 65 C116 65,118 64,120 64 C122 64,123 64,124 65 C126 65,127 66,128 67 C128 68,129 69,129 70 C130 71,130 72,130 74 C130 76,130 79,129 81 C128 83,127 85,125 86 C124 88,122 89,120 90 C118 91,116 91,114 91 L114 91 Z M110 82 C110 84,110 86,111 87 C112 88,113 88,115 88 C116 88,117 88,118 87 C119 87,119 86,120 86 C121 85,121 84,122 83 C123 82,123 81,123 80 C124 79,124 78,124 76 C125 75,125 74,125 73 C125 71,124 70,123 69 C123 68,121 67,120 67 C119 67,118 67,117 68 C116 68,115 69,115 69 C114 70,113 71,113 72 C112 73,111 74,111 75 C111 76,110 78,110 79 C110 80,110 81,110 82 L110 82 Z" fill="#212121"/><path d="M142 74 C142 73,142 72,142 72 C142 71,142 70,142 70 C142 69,142 68,141 68 C140 68,140 68,140 68 C139 68,139 69,139 69 C138 69,138 70,137 70 C137 70,137 71,136 71 L134 70 C135 69,136 68,137 67 C137 66,138 66,139 65 C139 65,140 65,141 64 C141 64,142 64,143 64 C144 64,145 65,146 65 C147 66,147 67,147 69 C147 70,147 70,147 71 L147 71 C149 69,151 67,152 66 C154 65,156 64,158 64 C158 64,159 64,159 64 C160 64,161 64,161 64 L160 71 L157 71 C157 70,156 69,156 69 C156 68,155 68,154 68 C154 68,154 68,153 68 C152 69,152 69,151 70 C151 70,150 71,149 71 C149 72,148 73,148 74 C147 74,147 75,146 76 C146 77,146 78,146 79 L143 91 L138 91 L142 74 Z" fill="#212121"/><path d="M187 85 C185 87,183 89,181 90 C179 91,177 91,174 91 C173 91,172 91,170 90 C169 90,168 90,168 89 C167 88,166 87,166 86 C166 85,165 84,165 82 C165 81,166 80,166 79 C166 78,166 77,167 76 C167 75,167 74,168 73 C169 72,169 71,170 70 C171 68,173 67,175 66 C177 65,180 64,182 64 C185 64,186 65,188 66 C189 67,189 68,189 70 C189 76,183 79,171 79 C171 80,171 80,171 81 C171 81,171 82,171 82 C171 84,171 86,172 87 C173 88,174 88,176 88 C176 88,177 88,178 88 C179 88,180 87,180 87 C181 87,182 86,183 85 C183 85,184 84,185 83 L187 85 Z M171 76 C174 76,176 76,177 76 C179 75,180 75,181 74 C182 74,183 73,184 73 C184 72,184 71,184 70 C184 69,184 69,184 68 C183 67,182 67,181 67 C180 67,179 67,178 68 C177 68,176 69,176 70 C175 70,174 71,173 72 C173 73,172 75,171 76 L171 76 Z" fill="#212121"/><path d="M219 42 L219 37 L265 37 L265 42 L219 42 Z M219 57 L219 52 L265 52 L265 57 L219 57 Z" fill="#212121"/><path d="M321 57 C322 55,322 53,322 51 C322 50,322 49,321 49 C321 48,320 48,319 48 L319 46 L334 46 L333 48 C332 48,332 49,331 49 C331 49,330 49,330 50 C330 50,329 51,329 52 C329 53,328 55,328 57 L325 68 L322 69 L320 66 C318 68,316 68,314 69 C313 69,312 69,310 69 C305 69,302 68,300 65 C297 62,296 59,296 53 C296 50,297 45,298 41 C299 36,301 32,303 29 C305 25,308 22,312 20 C315 18,319 17,323 17 C325 17,327 17,329 18 C331 18,333 18,335 19 L333 29 L329 29 C329 26,329 24,327 22 C326 21,325 20,322 20 C320 20,318 21,316 22 C315 23,313 24,311 27 C310 29,308 31,307 35 C306 38,305 41,304 45 C303 48,303 52,303 55 C303 59,303 62,305 63 C306 65,308 66,311 66 C312 66,313 66,314 66 C315 66,316 65,317 65 C318 64,319 63,319 62 C320 61,321 60,321 59 L321 57 Z" fill="#212121"/><path d="M340 86 C340 88,340 90,341 91 C342 92,344 92,346 92 C347 92,349 92,349 92 C350 92,351 91,352 90 C352 90,353 89,353 88 C354 88,354 87,354 86 C354 85,354 84,354 84 C353 83,353 82,353 82 C352 81,352 81,351 80 C350 79,349 79,348 78 C347 77,346 77,345 76 C344 75,344 75,343 74 C342 73,342 72,342 72 C341 71,341 70,341 69 C341 68,342 66,342 65 C343 64,344 63,345 62 C346 61,347 60,349 60 C350 59,352 59,354 59 C356 59,357 59,359 59 C360 60,362 60,364 61 L362 67 L359 67 C359 66,359 65,359 64 C359 64,358 63,358 63 C357 62,357 62,356 62 C355 62,354 61,353 61 C352 61,351 62,351 62 C350 62,349 63,348 63 C348 64,347 64,347 65 C347 66,346 66,346 67 C346 68,347 69,347 69 C347 70,347 70,348 71 C348 71,348 72,349 73 C350 73,351 74,352 74 C353 75,354 76,355 77 C356 77,357 78,357 79 C358 80,358 81,359 81 C359 82,359 83,359 84 C359 86,359 87,358 89 C357 90,357 91,355 92 C354 93,353 94,351 94 C350 95,348 95,346 95 C344 95,343 95,341 95 C339 94,337 94,335 93 L337 86 L340 86 Z" fill="#212121"/><path d="M389 88 C387 90,385 92,383 93 C381 94,379 94,376 94 C375 94,374 94,372 93 C371 93,370 93,370 92 C369 91,368 90,368 89 C368 88,367 87,367 85 C367 84,368 83,368 82 C368 81,368 80,369 79 C369 78,369 77,370 76 C371 75,371 74,372 73 C373 71,375 70,377 69 C379 68,382 67,384 67 C387 67,388 68,390 69 C391 70,391 71,391 73 C391 79,385 82,373 82 C373 83,373 83,373 84 C373 84,373 85,373 85 C373 87,373 89,374 90 C375 91,376 91,378 91 C378 91,379 91,380 91 C381 91,382 90,382 90 C383 90,384 89,385 88 C385 88,386 87,387 86 L389 88 Z M373 79 C376 79,378 79,379 79 C381 78,382 78,383 77 C384 77,385 76,386 76 C386 75,386 74,386 73 C386 72,386 72,386 71 C385 70,384 70,383 70 C382 70,381 70,380 71 C379 71,378 72,378 73 C377 73,376 74,375 75 C375 76,374 78,373 79 L373 79 Z" fill="#212121"/><path d="M399 83 C400 80,401 77,402 73 C402 70,403 67,403 65 C404 63,404 62,404 61 C404 61,404 60,404 60 C404 60,404 60,403 60 C403 59,403 59,402 59 C402 59,401 59,401 59 L401 57 L408 57 L410 57 C409 62,408 67,407 71 C406 75,405 79,404 84 C404 85,404 86,404 87 C404 87,403 88,403 88 C403 89,404 89,404 90 C404 90,405 90,405 90 C406 90,406 90,406 90 C407 90,407 90,407 89 C408 89,408 89,408 88 C409 88,409 87,410 87 L412 88 C411 90,410 90,409 91 C408 92,408 92,407 93 C406 93,406 94,405 94 C404 94,404 94,403 94 C402 94,402 94,401 94 C401 93,400 93,400 93 C399 92,399 92,399 91 C399 91,398 90,398 89 C398 88,399 88,399 87 C399 86,399 85,399 83 L399 83 Z" fill="#212121"/><path d="M427 93 C426 97,425 100,423 102 C421 104,418 105,415 105 C414 105,414 105,413 105 C413 104,414 104,414 103 C414 103,414 103,414 102 C414 102,414 102,414 102 C415 102,415 102,415 102 C416 102,417 102,417 102 C418 102,418 101,419 101 C419 100,420 99,420 98 C421 97,421 96,421 94 L427 70 L422 70 L422 68 C423 68,424 68,425 68 C425 68,426 68,426 67 C427 67,427 67,427 66 C428 63,430 61,432 59 C434 58,437 57,440 57 C441 57,442 57,443 57 C443 57,444 57,445 58 L444 63 L441 63 C441 62,441 61,440 61 C440 60,439 60,438 60 C437 60,437 60,436 61 C435 61,435 62,434 62 C434 63,433 64,433 65 C433 66,432 66,432 67 L440 67 L439 70 L432 70 L427 93 Z" fill="#212121"/><path d="M452 80 L452 76 L482 76 L482 80 L452 80 Z" fill="#212121"/><path d="M509 94 L509 92 C510 92,510 92,510 92 C511 92,511 91,511 91 C512 91,512 90,512 90 C512 90,512 89,512 88 C512 88,512 87,512 87 C512 87,512 86,512 86 C512 85,512 85,512 84 C512 84,512 84,512 83 L500 83 C499 84,499 84,499 85 C498 85,498 86,498 87 C497 87,497 88,497 88 C497 89,496 89,496 90 C496 91,497 92,499 92 L499 94 L487 94 L488 92 C488 92,488 92,489 92 C489 92,490 91,490 91 C490 90,491 90,491 89 C492 89,493 88,493 86 L510 59 L515 59 L517 87 C517 88,518 89,518 89 C518 90,518 90,518 91 C519 91,519 91,519 92 C520 92,520 92,521 92 L520 94 L509 94 Z M511 65 C509 67,508 70,506 72 C504 75,503 78,501 80 L512 80 C512 79,512 78,511 77 C511 76,511 75,511 73 C511 72,511 71,511 69 C511 68,511 67,511 65 L511 65 Z" fill="#212121"/><path d="M544 88 C543 89,542 90,541 91 C540 92,540 92,539 93 C538 93,537 94,536 94 C536 94,535 94,534 94 C532 94,530 94,529 93 C528 92,528 90,528 88 C528 88,528 87,528 86 C528 85,528 85,528 84 L531 70 L527 70 L527 68 C528 68,529 68,530 68 C531 68,531 67,531 67 C532 67,532 66,532 66 C532 66,533 65,533 65 C533 64,533 63,534 63 C534 62,534 61,535 60 L539 60 L537 67 L546 67 L546 70 L537 70 L534 81 C534 82,534 82,533 83 C533 84,533 84,533 84 C533 85,533 85,533 86 C533 86,533 86,533 87 C533 88,533 89,534 89 C534 90,535 90,536 90 C537 90,538 90,539 89 C540 89,541 88,542 86 L544 88 Z" fill="#212121"/><path d="M568 88 C567 89,566 90,565 91 C564 92,564 92,563 93 C562 93,561 94,560 94 C560 94,559 94,558 94 C556 94,554 94,553 93 C552 92,552 90,552 88 C552 88,552 87,552 86 C552 85,552 85,552 84 L555 70 L551 70 L551 68 C552 68,553 68,554 68 C555 68,555 67,555 67 C556 67,556 66,556 66 C556 66,557 65,557 65 C557 64,557 63,558 63 C558 62,558 61,559 60 L563 60 L561 67 L570 67 L570 70 L561 70 L558 81 C558 82,558 82,557 83 C557 84,557 84,557 84 C557 85,557 85,557 86 C557 86,557 86,557 87 C557 88,557 89,558 89 C558 90,559 90,560 90 C561 90,562 90,563 89 C564 89,565 88,566 86 L568 88 Z" fill="#212121"/><path d="M596 88 C594 90,592 92,590 93 C588 94,586 94,583 94 C582 94,581 94,579 93 C578 93,577 93,577 92 C576 91,575 90,575 89 C575 88,574 87,574 85 C574 84,575 83,575 82 C575 81,575 80,576 79 C576 78,576 77,577 76 C578 75,578 74,579 73 C580 71,582 70,584 69 C586 68,589 67,591 67 C594 67,595 68,597 69 C598 70,598 71,598 73 C598 79,592 82,580 82 C580 83,580 83,580 84 C580 84,580 85,580 85 C580 87,580 89,581 90 C582 91,583 91,585 91 C585 91,586 91,587 91 C588 91,589 90,589 90 C590 90,591 89,592 88 C592 88,593 87,594 86 L596 88 Z M580 79 C583 79,585 79,586 79 C588 78,589 78,590 77 C591 77,592 76,593 76 C593 75,593 74,593 73 C593 72,593 72,593 71 C592 70,591 70,590 70 C589 70,588 70,587 71 C586 71,585 72,585 73 C584 73,583 74,582 75 C582 76,581 78,580 79 L580 79 Z" fill="#212121"/><path d="M615 74 C617 72,618 70,620 69 C622 68,624 67,625 67 C627 67,629 68,630 69 C631 70,631 71,631 73 C631 73,631 74,631 75 C631 76,630 77,630 78 C630 79,630 80,629 81 C629 82,629 84,628 84 C628 85,628 86,628 87 C628 88,628 88,628 88 C628 89,628 89,628 90 C628 90,629 90,629 90 C630 90,630 90,630 90 C631 90,631 90,631 89 C632 89,632 89,632 88 C633 88,633 87,634 87 L636 88 C635 90,634 90,633 91 C633 92,632 92,631 93 C631 93,630 94,629 94 C628 94,628 94,627 94 C626 94,626 94,625 94 C625 94,624 93,624 93 C623 92,623 92,623 91 C623 91,623 90,623 89 C623 89,623 88,623 87 C623 86,623 85,623 84 C624 83,624 82,624 81 C625 80,625 79,625 78 C625 77,625 77,626 76 C626 75,626 75,626 74 C626 73,626 72,625 72 C625 71,624 71,623 71 C623 71,622 71,621 71 C621 72,620 72,619 73 C619 73,618 74,618 74 C617 75,616 76,616 76 C615 77,615 78,615 79 C614 80,614 80,614 81 L611 94 L606 94 L610 77 C610 76,610 76,610 75 C610 74,610 73,610 73 C610 72,610 71,609 71 C608 71,608 71,608 71 C607 71,607 72,607 72 C606 72,606 73,605 73 C605 73,605 74,604 74 L602 73 C603 72,604 71,605 70 C605 69,606 69,607 68 C607 68,608 68,609 67 C609 67,610 67,611 67 C612 67,613 68,614 68 C615 69,615 70,615 72 C615 72,615 73,615 73 C615 73,615 74,615 74 L615 74 Z" fill="#212121"/><path d="M658 88 C657 89,656 90,655 91 C654 92,654 92,653 93 C652 93,651 94,650 94 C650 94,649 94,648 94 C646 94,644 94,643 93 C642 92,642 90,642 88 C642 88,642 87,642 86 C642 85,642 85,642 84 L645 70 L641 70 L641 68 C642 68,643 68,644 68 C645 68,645 67,645 67 C646 67,646 66,646 66 C646 66,647 65,647 65 C647 64,647 63,648 63 C648 62,648 61,649 60 L653 60 L651 67 L660 67 L660 70 L651 70 L648 81 C648 82,648 82,647 83 C647 84,647 84,647 84 C647 85,647 85,647 86 C647 86,647 86,647 87 C647 88,647 89,648 89 C648 90,649 90,650 90 C651 90,652 90,653 89 C654 89,655 88,656 86 L658 88 Z" fill="#212121"/><path d="M678 56 L676 62 L671 62 L672 56 L678 56 Z M671 84 C671 85,671 86,671 87 C671 87,671 88,671 88 C671 89,671 89,671 90 C671 90,672 90,672 90 C673 90,673 90,673 90 C674 90,674 90,674 89 C675 89,675 89,675 88 C676 88,676 87,677 87 L679 89 C678 90,677 91,676 91 C675 92,675 92,674 93 C673 93,673 94,672 94 C671 94,671 94,670 94 C669 94,669 94,668 94 C668 94,667 93,667 93 C666 92,666 92,666 91 C666 91,665 90,665 89 C665 89,666 88,666 87 C666 86,666 85,666 84 C667 83,667 82,667 81 C667 80,668 79,668 78 C668 77,668 76,668 75 C669 74,669 73,669 72 C669 72,669 72,669 71 C669 71,669 71,669 71 C669 70,669 70,668 70 C668 69,667 69,666 69 L666 67 L674 67 L675 67 L671 84 Z" fill="#212121"/><path d="M693 94 C692 94,690 94,689 93 C688 93,687 92,686 92 C685 91,685 90,684 89 C684 88,683 86,683 85 C683 82,684 80,685 78 C686 76,687 74,688 72 C689 71,691 69,693 68 C695 68,697 67,699 67 C701 67,702 67,703 68 C705 68,706 69,707 70 C707 71,708 72,708 73 C709 74,709 75,709 77 C709 79,709 82,708 84 C707 86,706 88,704 89 C703 91,701 92,699 93 C697 94,695 94,693 94 L693 94 Z M689 85 C689 87,689 89,690 90 C691 91,692 91,694 91 C695 91,696 91,697 90 C698 90,698 89,699 89 C700 88,700 87,701 86 C702 85,702 84,702 83 C703 82,703 81,703 79 C704 78,704 77,704 76 C704 74,703 73,702 72 C702 71,700 70,699 70 C698 70,697 70,696 71 C695 71,694 72,694 72 C693 73,692 74,692 75 C691 76,690 77,690 78 C690 79,689 81,689 82 C689 83,689 84,689 85 L689 85 Z" fill="#212121"/><path d="M726 74 C728 72,729 70,731 69 C733 68,735 67,736 67 C738 67,740 68,741 69 C742 70,742 71,742 73 C742 73,742 74,742 75 C742 76,741 77,741 78 C741 79,741 80,740 81 C740 82,740 84,739 84 C739 85,739 86,739 87 C739 88,739 88,739 88 C739 89,739 89,739 90 C739 90,740 90,740 90 C741 90,741 90,741 90 C742 90,742 90,742 89 C743 89,743 89,743 88 C744 88,744 87,745 87 L747 88 C746 90,745 90,744 91 C744 92,743 92,742 93 C742 93,741 94,740 94 C739 94,739 94,738 94 C737 94,737 94,736 94 C736 94,735 93,735 93 C734 92,734 92,734 91 C734 91,734 90,734 89 C734 89,734 88,734 87 C734 86,734 85,734 84 C735 83,735 82,735 81 C736 80,736 79,736 78 C736 77,736 77,737 76 C737 75,737 75,737 74 C737 73,737 72,736 72 C736 71,735 71,734 71 C734 71,733 71,732 71 C732 72,731 72,730 73 C730 73,729 74,729 74 C728 75,727 76,727 76 C726 77,726 78,726 79 C725 80,725 80,725 81 L722 94 L717 94 L721 77 C721 76,721 76,721 75 C721 74,721 73,721 73 C721 72,721 71,720 71 C719 71,719 71,719 71 C718 71,718 72,718 72 C717 72,717 73,716 73 C716 73,716 74,715 74 L713 73 C714 72,715 71,716 70 C716 69,717 69,718 68 C718 68,719 68,720 67 C720 67,721 67,722 67 C723 67,724 68,725 68 C726 69,726 70,726 72 C726 72,726 73,726 73 C726 73,726 74,726 74 L726 74 Z" fill="#212121"/><path d="M799 52 L797 56 L787 49 L789 61 L784 61 L785 49 L775 56 L773 52 L783 47 L773 42 L775 38 L785 45 L784 33 L789 33 L787 45 L797 38 L799 42 L789 47 L799 52 Z" fill="#212121"/><path d="M840 18 L840 20 C839 20,838 21,837 21 C837 22,836 22,836 23 C836 24,836 25,836 27 C836 27,836 28,836 30 L837 57 L837 60 L837 60 L853 31 C854 30,855 28,855 27 C855 26,856 25,856 24 C856 22,854 21,852 20 L852 18 L867 18 L867 20 C866 20,866 20,865 21 C864 21,864 22,863 23 C862 24,861 26,860 28 L836 69 L831 69 L829 28 C829 27,829 25,828 24 C828 23,828 22,827 21 C827 21,826 20,824 20 L825 18 L840 18 Z" fill="#212121"/><path d="M873 35 L874 33 C874 33,874 33,875 33 C875 33,875 33,876 33 C876 32,876 32,876 32 C876 32,877 31,877 31 C877 31,877 30,877 29 C877 29,878 28,878 27 L883 3 L879 3 C879 3,878 3,878 3 C878 3,877 3,877 3 C876 4,876 4,876 4 C876 4,875 5,875 5 C875 6,874 6,874 7 C874 8,873 8,873 9 L870 9 L872 0 L901 0 L899 10 L896 10 L896 8 C896 8,896 8,896 7 C896 7,896 7,896 6 C896 6,896 5,896 5 C896 5,896 5,896 4 C895 4,895 4,895 4 C895 4,895 3,895 3 C894 3,894 3,894 3 C894 3,893 3,893 3 L888 3 L883 27 C883 28,883 29,883 29 C882 30,882 31,882 31 C882 31,882 32,883 32 C883 32,883 32,883 33 C883 33,884 33,884 33 C884 33,885 33,885 33 L885 35 L873 35 Z" fill="#212121"/></svg></span></p>
<p class="p_Text"><span class="f_Text">However, when implementing in MQL5, we do not create an additional buffer for error gradients at the level of the dependency coefficient matrix. But in OpenCL there is difficulty in allocating a dynamic array for recording intermediate data about the error gradient values at the dependency coefficient matrix level. Therefore, here we will create two temporary data buffers: the first for the error gradient of the normalized data, and the second for the error gradients corrected by the derivative of the </span><span class="f_Text" style="font-style: italic;">Softmax</span><span class="f_Text"> function.</span></p>
<p class="p_Text"><span class="f_Text">Note that when we recalculate the error gradient to the level of the </span><span class="f_Text" style="font-style: italic;">m_cQuerys </span><span class="f_Text">and </span><span class="f_Text" style="font-style: italic;">m_cKeys</span><span class="f_Text"> neural layers, the same elements of the dependency coefficient error gradient matrix are used in different operation threads. Therefore, we will divide the entire backpropagation algorithm within the attention layer into two blocks. In the first block, we will propagate the error gradient to the level of the internal neural layer of </span><span class="f_Text" style="font-style: italic;">m_cValues</span><span class="f_Text"> value and the </span><span class="f_Text" style="font-style: italic;">m_cScores</span><span class="f_Text"> coefficient matrix</span><span class="f_Text" style="font-style: italic;">.</span><span class="f_Text"> In the second block, we will propagate the error gradient to two other neural layers: </span><span class="f_Text" style="font-style: italic;">m_cQuerys </span><span class="f_Text">and </span><span class="f_Text" style="font-style: italic;">m_cKeys.</span></p>
<p class="p_Text"><span class="f_Text">We implement the first block of operations in the </span><span class="f_Text" style="font-style: italic;">AttentionCalcScoreGradient</span><span class="f_Text"> kernel. In the parameters of this kernel, we pass pointers to five data buffers and one parameter:</span></p>
<ul style="list-style-type:disc">
<li class="p_li"><span class="f_li" style="font-style: italic;">scores</span><span class="f_li">  dependency coefficient matrix buffer</span></li>
<li class="p_li"><span class="f_li" style="font-style: italic;">scores_temp</span><span class="f_li">  buffer of error gradients at the level of the normalized dependency coefficient matrix</span></li>
<li class="p_li"><span class="f_li" style="font-style: italic;">scores_grad</span><span class="f_li">  buffer of error gradients at the level of the dependency coefficient matrix, adjusted to the derivative of the normalization function</span></li>
<li class="p_li"><span class="f_li" style="font-style: italic;">values</span><span class="f_li">  tensor buffer </span><span class="f_li" style="font-style: italic;">Values</span><span class="f_li"> &#8203;&#8203;(buffer of neural layer results </span><span class="f_li" style="font-style: italic;">m_cValues</span><span class="f_li">&#8203;&#8203;)</span></li>
<li class="p_li"><span class="f_li" style="font-style: italic;">values_grad</span><span class="f_li">  error gradient tensor buffer at the level of results of the </span><span class="f_li" style="font-style: italic;">m_cValues </span><span class="f_li">&#8203;&#8203;neural layer</span></li>
<li class="p_li"><span class="f_li" style="font-style: italic;">outputs_grad</span><span class="f_li"> is the buffer of error gradients at the output level of </span><span class="f_li" style="font-style: italic;">the Self-Attention</span><span class="f_li">block;</span></li>
<li class="p_li"><span class="f_li" style="font-style: italic;">window</span><span class="f_li"> is the size of the description vector of one element of the sequence in the </span><span class="f_li" style="font-style: italic;">Values</span><span class="f_li">&#8203;&#8203; tensor.</span></li>
</ul>
<p class="p_Text"><span class="f_Text">Please note that the </span><span class="f_Text" style="font-style: italic;">scores_temp</span><span class="f_Text"> and </span><span class="f_Text" style="font-style: italic;">scores_grad</span><span class="f_Text"> buffers have no counterparts on the main program side. The reason is that we only need error gradients at the level of the dependency coefficient matrix to perform the operations of the current backward pass. However, OpenCL does not have the ability to create dynamic arrays. We created the specified buffers instead.</span></p>
<div style="text-align: left; text-indent: 0; line-height: 1.0; page-break-inside: avoid; page-break-after: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0 0 0 0; margin: 2px 17px 2px 17px;"><table cellspacing="0" cellpadding="3" border="0" style="text-align: justify;border:none; border-spacing:0;">
<tr>
<td style="vertical-align:top; padding:3px; border:none"><p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample" style="color: #0000ff;">__kernel</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">void</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #333333;">AttentionCalcScoreGradient</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #0000ff;">__global</span><span class="f_CodeExample">&nbsp;</span><span class="f_Definition">TYPE</span><span class="f_CodeExample">&nbsp;*</span><span class="f_CodeExample" style="color: #333333;">scores</span><span class="f_CodeExample">,</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">__global</span><span class="f_CodeExample">&nbsp;</span><span class="f_Definition">TYPE</span><span class="f_CodeExample">&nbsp;*</span><span class="f_CodeExample" style="color: #333333;">scores_grad</span><span class="f_CodeExample">,</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">__global</span><span class="f_CodeExample">&nbsp;</span><span class="f_Definition">TYPE</span><span class="f_CodeExample">&nbsp;*</span><span class="f_CodeExample" style="color: #333333;">values</span><span class="f_CodeExample">,</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">__global</span><span class="f_CodeExample">&nbsp;</span><span class="f_Definition">TYPE</span><span class="f_CodeExample">&nbsp;*</span><span class="f_CodeExample" style="color: #333333;">values_grad</span><span class="f_CodeExample">,</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">__global</span><span class="f_CodeExample">&nbsp;</span><span class="f_Definition">TYPE</span><span class="f_CodeExample">&nbsp;*</span><span class="f_CodeExample" style="color: #333333;">outputs_grad</span><span class="f_CodeExample">,</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">__global</span><span class="f_CodeExample">&nbsp;</span><span class="f_Definition">TYPE</span><span class="f_CodeExample">&nbsp;*</span><span class="f_CodeExample" style="color: #333333;">scores_temp</span><span class="f_CodeExample">,</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">int</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #333333;">window</span><span class="f_CodeExample">)</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;{</span></p>
</td>
</tr>
</table>
</div>
<p class="p_Text"><span class="f_Text">The feed-forward algorithm involves normalizing the dependency coefficient matrix </span><span class="f_Text" style="font-style: italic;">Score</span><span class="f_Text"> with the </span><span class="f_Text" style="font-style: italic;">Softmax </span><span class="f_Text">function in the context of </span><span class="f_Text" style="font-style: italic;">Query</span><span class="f_Text"> requests. So, after determining the error gradients at the coefficient matrix level, it is necessary to adjust these values based on the derivative of the data normalization operation. Therefore, it would be logical to divide the operations into threads in the same manner. Moreover, such a distribution of operations into threads would be entirely appropriate for propagating the error gradient to the level of values within the internal neural layer.</span></p>
<p class="p_Text"><span class="f_Text">At the beginning of the kernel, we do a little preparatory work. We determine the serial number of the analyzed vector of values and rows of the matrix of dependency coefficients by the identification number of the thread. The total number of running threads will tell us the dimensions of the tensors. Let's immediately determine the offset in the data buffers to the first element of the analyzed vectors of values.</span></p>
<div style="text-align: left; text-indent: 0; line-height: 1.0; page-break-inside: avoid; page-break-after: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0 0 0 0; margin: 2px 17px 2px 17px;"><table cellspacing="0" cellpadding="3" border="0" style="text-align: justify;border:none; border-spacing:0;">
<tr>
<td style="vertical-align:top; padding:3px; border:none"><p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">const</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">int</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #333333;">q</span><span class="f_CodeExample">&nbsp;=&nbsp;</span><span class="f_Functions">get_global_id</span><span class="f_CodeExample">(</span><span class="f_Normal" style="font-family: Arial,Helvetica,sans-serif; color: #000000; background-color: transparent;">0</span><span class="f_CodeExample">);</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">const</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">int</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #333333;">units</span><span class="f_CodeExample">&nbsp;=&nbsp;</span><span class="f_Functions">get_global_size</span><span class="f_CodeExample">(</span><span class="f_Normal" style="font-family: Arial,Helvetica,sans-serif; color: #000000; background-color: transparent;">0</span><span class="f_CodeExample">);</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">int</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #333333;">shift_value</span><span class="f_CodeExample">&nbsp;=&nbsp;</span><span class="f_CodeExample" style="color: #333333;">window</span><span class="f_CodeExample">&nbsp;*&nbsp;</span><span class="f_CodeExample" style="color: #333333;">q</span><span class="f_CodeExample">;</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">int</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #333333;">shift_score</span><span class="f_CodeExample">&nbsp;=&nbsp;</span><span class="f_CodeExample" style="color: #333333;">units</span><span class="f_CodeExample">&nbsp;*&nbsp;</span><span class="f_CodeExample" style="color: #333333;">q</span><span class="f_CodeExample">;</span></p>
</td>
</tr>
</table>
</div>
<p class="p_Text"><span class="f_Text">Next, we will propagate the error gradient to the level of the internal neural layer </span><span class="f_Text" style="font-style: italic;">m_cValues.</span><span class="f_Text"> As mentioned above, to determine the error gradient, we need to multiply the transposed matrix of dependency coefficients by the gradient tensor at the output of the </span><span class="f_Text" style="font-style: italic;">Self-Attention</span><span class="f_Text"> block.</span></p>
<p class="p_Text"><span class="f_Text">Within the kernel, we will define the error gradient for only one vector of element description. As you know, with a feed-forward pass, each element of the sequence in the </span><span class="f_Text" style="font-style: italic;">Value </span><span class="f_Text">tensor leaves its mark in the formation of all elements of the sequence of results of the </span><span class="f_Text" style="font-style: italic;">Self-Attention</span><span class="f_Text"> block. Consequently, each element of the </span><span class="f_Text" style="font-style: italic;">Value</span><span class="f_Text"> tensor must receive its share of the error gradient from all elements of the results tensor of the </span><span class="f_Text" style="font-style: italic;">Self-Attention</span><span class="f_Text"> block. The measure of influence will be the corresponding dependence coefficient from the </span><span class="f_Text" style="font-style: italic;">Score</span><span class="f_Text"> matrix. Thus, each element of the sequence of the </span><span class="f_Text" style="font-style: italic;">Value</span><span class="f_Text"> tensor corresponds to one column in the dependency coefficient matrix </span><span class="f_Text" style="font-style: italic;">Score. </span><span class="f_Text">This explains the use of the transposed </span><span class="f_Text" style="font-style: italic;">Score</span><span class="f_Text"> matrix in the formula above.</span></p>
<p class="p_Text"><span class="f_Text">To organize this process, we will create a system of two nested loops. The number of iterations in the first loop is equal to the size of the vector describing one element of the sequence in the </span><span class="f_Text" style="font-style: italic;">Value</span><span class="f_Text"> tensor. It should be noted that the error gradient tensor at the output of the </span><span class="f_Text" style="font-style: italic;">Self-Attention</span><span class="f_Text"> block has the same dimensions. In the nested loop with a number of iterations equal to the number of elements in the sequence, we will iterate over the values of the corresponding column of the dependency coefficient matrix </span><span class="f_Text" style="font-style: italic;">Score</span><span class="f_Text"> and the gradient vector of errors at the level of the </span><span class="f_Text" style="font-style: italic;">Self-Attention</span><span class="f_Text"> block results. In this case, we will multiply the corresponding elements and sum the resulting products into a private variable. After completing the iterations of the inner loop, copy the accumulated sum of products to the error gradient buffer of the internal convolutional layer </span><span class="f_Text" style="font-style: italic;">m_cValues.</span></p>
<div style="text-align: left; text-indent: 0; line-height: 1.0; page-break-inside: avoid; page-break-after: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0 0 0 0; margin: 2px 17px 2px 17px;"><table cellspacing="0" cellpadding="3" border="0" style="text-align: justify;border:none; border-spacing:0;">
<tr>
<td style="vertical-align:top; padding:3px; border:none"><p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample" style="color: #808080;">//---&nbsp;Distributing&nbsp;the&nbsp;gradient&nbsp;on&nbsp;Values</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">for</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #0000ff;">int</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #333333;">i</span><span class="f_CodeExample">&nbsp;=&nbsp;</span><span class="f_Normal" style="font-family: Arial,Helvetica,sans-serif; color: #000000; background-color: transparent;">0</span><span class="f_CodeExample">;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">i</span><span class="f_CodeExample">&nbsp;&lt;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">window</span><span class="f_CodeExample">;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">i</span><span class="f_CodeExample">&nbsp;++)</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_Definition">TYPE</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #333333;">grad</span><span class="f_CodeExample">&nbsp;=&nbsp;</span><span class="f_Normal" style="font-family: Arial,Helvetica,sans-serif; color: #000000; background-color: transparent;">0</span><span class="f_CodeExample">;</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">for</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #0000ff;">int</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #333333;">g</span><span class="f_CodeExample">&nbsp;=&nbsp;</span><span class="f_Normal" style="font-family: Arial,Helvetica,sans-serif; color: #000000; background-color: transparent;">0</span><span class="f_CodeExample">;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">g</span><span class="f_CodeExample">&nbsp;&lt;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">units</span><span class="f_CodeExample">;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">g</span><span class="f_CodeExample">++)</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">grad</span><span class="f_CodeExample">&nbsp;+=&nbsp;</span><span class="f_CodeExample" style="color: #333333;">scores</span><span class="f_CodeExample">[</span><span class="f_CodeExample" style="color: #333333;">units</span><span class="f_CodeExample">&nbsp;*&nbsp;</span><span class="f_CodeExample" style="color: #333333;">g</span><span class="f_CodeExample">&nbsp;+&nbsp;</span><span class="f_CodeExample" style="color: #333333;">q</span><span class="f_CodeExample">]&nbsp;*&nbsp;</span><span class="f_CodeExample" style="color: #333333;">outputs_grad</span><span class="f_CodeExample">[</span><span class="f_CodeExample" style="color: #333333;">window</span><span class="f_CodeExample">&nbsp;*&nbsp;</span><span class="f_CodeExample" style="color: #333333;">g</span><span class="f_CodeExample">&nbsp;+&nbsp;</span><span class="f_CodeExample" style="color: #333333;">i</span><span class="f_CodeExample">];</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">values_grad</span><span class="f_CodeExample">[</span><span class="f_CodeExample" style="color: #333333;">shift_value</span><span class="f_CodeExample">&nbsp;+&nbsp;</span><span class="f_CodeExample" style="color: #333333;">i</span><span class="f_CodeExample">]&nbsp;=&nbsp;</span><span class="f_CodeExample" style="color: #333333;">grad</span><span class="f_CodeExample">;</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></p>
</td>
</tr>
</table>
</div>
<p class="p_Text"><span class="f_Text">After the execution of the loop system the first part of our task, in which we propagate the error gradients to the internal neural layer </span><span class="f_Text" style="font-style: italic;">m_cValues</span><span class="f_Text">, can be considered complete.</span></p>
<p class="p_Text"><span class="f_Text">The second part of our kernel is devoted to determining the error gradient at the level of the dependency coefficient matrix.</span></p>
<p class="p_Text"><span class="f_Text">In the feed-forward pass, each element of the </span><span class="f_Text" style="font-style: italic;">Query</span><span class="f_Text"> sequence is multiplied with all the elements of the </span><span class="f_Text" style="font-style: italic;">Key</span><span class="f_Text"> sequence to form a single dependency coefficient matrix vector </span><span class="f_Text" style="font-style: italic;">Score</span><span class="f_Text">. Each such vector is normalized by the function </span><span class="f_Text" style="font-style: italic;">Softmax. </span><span class="f_Text">After that, we multiply it by the </span><span class="f_Text" style="font-style: italic;">Value</span><span class="f_Text"> tensor. As a result of these operations, we obtain the corrected vector representation of one element of the sequence in the tensor of the </span><span class="f_Text" style="font-style: italic;">Self-Attention</span><span class="f_Text"> block results. Thus, one element of the </span><span class="f_Text" style="font-style: italic;">Query</span><span class="f_Text"> sequence interacts with all elements of the </span><span class="f_Text" style="font-style: italic;">Key</span><span class="f_Text"> and </span><span class="f_Text" style="font-style: italic;">Value </span><span class="f_Text">tensors to form a vector describing one element of the result sequence. Therefore, to distribute the error gradient to a specific vector from the </span><span class="f_Text" style="font-style: italic;">Query</span><span class="f_Text"> tensor, we need to take one corresponding error gradient vector of one element of the sequence at the level of the </span><span class="f_Text" style="font-style: italic;">Self-Attention</span><span class="f_Text"> block and first multiply it by the transposed tensor of </span><span class="f_Text" style="font-style: italic;">Value</span><span class="f_Text">. Thus, we obtain an error vector at the level of the dependency coefficient matrix </span><span class="f_Text" style="font-style: italic;">Score</span><span class="f_Text">. Next, we need to adjust the resulting vector to the derivative of the </span><span class="f_Text" style="font-style: italic;">Softmax</span><span class="f_Text"> function. It is this part of the error gradient distribution that we implement in this kernel. To further propagate the error gradient to the level of the internal neural layers </span><span class="f_Text" style="font-style: italic;">m_cQuerys </span><span class="f_Text">and </span><span class="f_Text" style="font-style: italic;">m_cKeys</span><span class="f_Text">, we will create another kernel a little later.</span></p>
<p class="p_Text"><span class="f_Text">The error gradient distribution algorithm described above in matrix form can be represented as follows:</span></p>
<ol style="list-style-type:decimal">
<li value="1" class="p_li"><span class="f_li">Error gradient at the Score matrix level.</span></li>
</ol>
<p class="p_Text" style="text-align: center;"><span style="display:inline-block;width:228px;height:27px;padding:0 0;overflow:visible"><svg xmlns="http://www.w3.org/2000/svg" style="width:100%;height:100%;overflow:visible" viewBox="0 0 912 108"><path d="M30 57 C31 55,31 53,31 51 C31 50,31 49,30 49 C30 48,29 48,28 48 L28 46 L43 46 L42 48 C41 48,41 49,40 49 C40 49,39 49,39 50 C39 50,38 51,38 52 C38 53,37 55,37 57 L34 68 L31 69 L29 66 C27 68,25 68,23 69 C22 69,21 69,19 69 C14 69,11 68,9 65 C6 62,5 59,5 53 C5 50,6 45,7 41 C8 36,10 32,12 29 C14 25,17 22,21 20 C24 18,28 17,32 17 C34 17,36 17,38 18 C40 18,42 18,44 19 L42 29 L38 29 C38 26,38 24,36 22 C35 21,34 20,31 20 C29 20,27 21,25 22 C24 23,22 24,20 27 C19 29,17 31,16 35 C15 38,14 41,13 45 C12 48,12 52,12 55 C12 59,12 62,14 63 C15 65,17 66,20 66 C21 66,22 66,23 66 C24 66,25 65,26 65 C27 64,28 63,28 62 C29 61,30 60,30 59 L30 57 Z" fill="#212121"/><path d="M49 83 C49 85,49 87,50 88 C51 89,53 89,55 89 C56 89,58 89,58 89 C59 89,60 88,61 87 C61 87,62 86,62 85 C63 85,63 84,63 83 C63 82,63 81,63 81 C62 80,62 79,62 79 C61 78,61 78,60 77 C59 76,58 76,57 75 C56 74,55 74,54 73 C53 72,53 72,52 71 C51 70,51 69,51 69 C50 68,50 67,50 66 C50 65,51 63,51 62 C52 61,53 60,54 59 C55 58,56 57,58 57 C59 56,61 56,63 56 C65 56,66 56,68 56 C69 57,71 57,73 58 L71 64 L68 64 C68 63,68 62,68 61 C68 61,67 60,67 60 C66 59,66 59,65 59 C64 59,63 58,62 58 C61 58,60 59,60 59 C59 59,58 60,57 60 C57 61,56 61,56 62 C56 63,55 63,55 64 C55 65,56 66,56 66 C56 67,56 67,57 68 C57 68,57 69,58 70 C59 70,60 71,61 71 C62 72,63 73,64 74 C65 74,66 75,66 76 C67 77,67 78,68 78 C68 79,68 80,68 81 C68 83,68 84,67 86 C66 87,66 88,64 89 C63 90,62 91,60 91 C59 92,57 92,55 92 C53 92,52 92,50 92 C48 91,46 91,44 90 L46 83 L49 83 Z" fill="#212121"/><path d="M95 72 C95 71,95 70,95 70 C95 69,95 69,95 68 C94 68,94 68,94 67 C93 67,93 67,92 67 C91 67,90 67,89 68 C88 68,88 69,87 69 C86 70,85 71,85 72 C84 73,84 74,83 75 C83 76,82 78,82 79 C82 80,82 81,82 82 C82 84,82 86,83 87 C84 88,85 88,86 88 C87 88,88 88,89 88 C89 88,90 87,91 87 C91 87,92 86,93 86 C93 85,94 84,95 83 C95 84,96 84,96 85 C96 85,97 85,97 86 C95 87,93 89,91 90 C89 91,87 91,85 91 C82 91,80 90,79 89 C77 87,76 85,76 82 C76 80,77 79,77 77 C77 76,78 74,79 73 C79 72,80 71,81 69 C82 68,83 67,84 67 C86 66,87 65,88 65 C90 64,91 64,93 64 C94 64,95 64,97 64 C98 64,99 65,100 65 L98 72 L95 72 Z" fill="#212121"/><path d="M114 91 C113 91,111 91,110 90 C109 90,108 89,107 89 C106 88,106 87,105 86 C105 85,104 83,104 82 C104 79,105 77,106 75 C107 73,108 71,109 69 C110 68,112 66,114 65 C116 65,118 64,120 64 C122 64,123 64,124 65 C126 65,127 66,128 67 C128 68,129 69,129 70 C130 71,130 72,130 74 C130 76,130 79,129 81 C128 83,127 85,125 86 C124 88,122 89,120 90 C118 91,116 91,114 91 L114 91 Z M110 82 C110 84,110 86,111 87 C112 88,113 88,115 88 C116 88,117 88,118 87 C119 87,119 86,120 86 C121 85,121 84,122 83 C123 82,123 81,123 80 C124 79,124 78,124 76 C125 75,125 74,125 73 C125 71,124 70,123 69 C123 68,121 67,120 67 C119 67,118 67,117 68 C116 68,115 69,115 69 C114 70,113 71,113 72 C112 73,111 74,111 75 C111 76,110 78,110 79 C110 80,110 81,110 82 L110 82 Z" fill="#212121"/><path d="M142 74 C142 73,142 72,142 72 C142 71,142 70,142 70 C142 69,142 68,141 68 C140 68,140 68,140 68 C139 68,139 69,139 69 C138 69,138 70,137 70 C137 70,137 71,136 71 L134 70 C135 69,136 68,137 67 C137 66,138 66,139 65 C139 65,140 65,141 64 C141 64,142 64,143 64 C144 64,145 65,146 65 C147 66,147 67,147 69 C147 70,147 70,147 71 L147 71 C149 69,151 67,152 66 C154 65,156 64,158 64 C158 64,159 64,159 64 C160 64,161 64,161 64 L160 71 L157 71 C157 70,156 69,156 69 C156 68,155 68,154 68 C154 68,154 68,153 68 C152 69,152 69,151 70 C151 70,150 71,149 71 C149 72,148 73,148 74 C147 74,147 75,146 76 C146 77,146 78,146 79 L143 91 L138 91 L142 74 Z" fill="#212121"/><path d="M187 85 C185 87,183 89,181 90 C179 91,177 91,174 91 C173 91,172 91,170 90 C169 90,168 90,168 89 C167 88,166 87,166 86 C166 85,165 84,165 82 C165 81,166 80,166 79 C166 78,166 77,167 76 C167 75,167 74,168 73 C169 72,169 71,170 70 C171 68,173 67,175 66 C177 65,180 64,182 64 C185 64,186 65,188 66 C189 67,189 68,189 70 C189 76,183 79,171 79 C171 80,171 80,171 81 C171 81,171 82,171 82 C171 84,171 86,172 87 C173 88,174 88,176 88 C176 88,177 88,178 88 C179 88,180 87,180 87 C181 87,182 86,183 85 C183 85,184 84,185 83 L187 85 Z M171 76 C174 76,176 76,177 76 C179 75,180 75,181 74 C182 74,183 73,184 73 C184 72,184 71,184 70 C184 69,184 69,184 68 C183 67,182 67,181 67 C180 67,179 67,178 68 C177 68,176 69,176 70 C175 70,174 71,173 72 C173 73,172 75,171 76 L171 76 Z" fill="#212121"/><path d="M219 42 L219 37 L265 37 L265 42 L219 42 Z M219 57 L219 52 L265 52 L265 57 L219 57 Z" fill="#212121"/><path d="M321 57 C322 55,322 53,322 51 C322 50,322 49,321 49 C321 48,320 48,319 48 L319 46 L334 46 L333 48 C332 48,332 49,331 49 C331 49,330 49,330 50 C330 50,329 51,329 52 C329 53,328 55,328 57 L325 68 L322 69 L320 66 C318 68,316 68,314 69 C313 69,312 69,310 69 C305 69,302 68,300 65 C297 62,296 59,296 53 C296 50,297 45,298 41 C299 36,301 32,303 29 C305 25,308 22,312 20 C315 18,319 17,323 17 C325 17,327 17,329 18 C331 18,333 18,335 19 L333 29 L329 29 C329 26,329 24,327 22 C326 21,325 20,322 20 C320 20,318 21,316 22 C315 23,313 24,311 27 C310 29,308 31,307 35 C306 38,305 41,304 45 C303 48,303 52,303 55 C303 59,303 62,305 63 C306 65,308 66,311 66 C312 66,313 66,314 66 C315 66,316 65,317 65 C318 64,319 63,319 62 C320 61,321 60,321 59 L321 57 Z" fill="#212121"/><path d="M340 86 C340 88,340 90,341 91 C342 92,344 92,346 92 C347 92,349 92,349 92 C350 92,351 91,352 90 C352 90,353 89,353 88 C354 88,354 87,354 86 C354 85,354 84,354 84 C353 83,353 82,353 82 C352 81,352 81,351 80 C350 79,349 79,348 78 C347 77,346 77,345 76 C344 75,344 75,343 74 C342 73,342 72,342 72 C341 71,341 70,341 69 C341 68,342 66,342 65 C343 64,344 63,345 62 C346 61,347 60,349 60 C350 59,352 59,354 59 C356 59,357 59,359 59 C360 60,362 60,364 61 L362 67 L359 67 C359 66,359 65,359 64 C359 64,358 63,358 63 C357 62,357 62,356 62 C355 62,354 61,353 61 C352 61,351 62,351 62 C350 62,349 63,348 63 C348 64,347 64,347 65 C347 66,346 66,346 67 C346 68,347 69,347 69 C347 70,347 70,348 71 C348 71,348 72,349 73 C350 73,351 74,352 74 C353 75,354 76,355 77 C356 77,357 78,357 79 C358 80,358 81,359 81 C359 82,359 83,359 84 C359 86,359 87,358 89 C357 90,357 91,355 92 C354 93,353 94,351 94 C350 95,348 95,346 95 C344 95,343 95,341 95 C339 94,337 94,335 93 L337 86 L340 86 Z" fill="#212121"/><path d="M389 88 C387 90,385 92,383 93 C381 94,379 94,376 94 C375 94,374 94,372 93 C371 93,370 93,370 92 C369 91,368 90,368 89 C368 88,367 87,367 85 C367 84,368 83,368 82 C368 81,368 80,369 79 C369 78,369 77,370 76 C371 75,371 74,372 73 C373 71,375 70,377 69 C379 68,382 67,384 67 C387 67,388 68,390 69 C391 70,391 71,391 73 C391 79,385 82,373 82 C373 83,373 83,373 84 C373 84,373 85,373 85 C373 87,373 89,374 90 C375 91,376 91,378 91 C378 91,379 91,380 91 C381 91,382 90,382 90 C383 90,384 89,385 88 C385 88,386 87,387 86 L389 88 Z M373 79 C376 79,378 79,379 79 C381 78,382 78,383 77 C384 77,385 76,386 76 C386 75,386 74,386 73 C386 72,386 72,386 71 C385 70,384 70,383 70 C382 70,381 70,380 71 C379 71,378 72,378 73 C377 73,376 74,375 75 C375 76,374 78,373 79 L373 79 Z" fill="#212121"/><path d="M399 83 C400 80,401 77,402 73 C402 70,403 67,403 65 C404 63,404 62,404 61 C404 61,404 60,404 60 C404 60,404 60,403 60 C403 59,403 59,402 59 C402 59,401 59,401 59 L401 57 L408 57 L410 57 C409 62,408 67,407 71 C406 75,405 79,404 84 C404 85,404 86,404 87 C404 87,403 88,403 88 C403 89,404 89,404 90 C404 90,405 90,405 90 C406 90,406 90,406 90 C407 90,407 90,407 89 C408 89,408 89,408 88 C409 88,409 87,410 87 L412 88 C411 90,410 90,409 91 C408 92,408 92,407 93 C406 93,406 94,405 94 C404 94,404 94,403 94 C402 94,402 94,401 94 C401 93,400 93,400 93 C399 92,399 92,399 91 C399 91,398 90,398 89 C398 88,399 88,399 87 C399 86,399 85,399 83 L399 83 Z" fill="#212121"/><path d="M427 93 C426 97,425 100,423 102 C421 104,418 105,415 105 C414 105,414 105,413 105 C413 104,414 104,414 103 C414 103,414 103,414 102 C414 102,414 102,414 102 C415 102,415 102,415 102 C416 102,417 102,417 102 C418 102,418 101,419 101 C419 100,420 99,420 98 C421 97,421 96,421 94 L427 70 L422 70 L422 68 C423 68,424 68,425 68 C425 68,426 68,426 67 C427 67,427 67,427 66 C428 63,430 61,432 59 C434 58,437 57,440 57 C441 57,442 57,443 57 C443 57,444 57,445 58 L444 63 L441 63 C441 62,441 61,440 61 C440 60,439 60,438 60 C437 60,437 60,436 61 C435 61,435 62,434 62 C434 63,433 64,433 65 C433 66,432 66,432 67 L440 67 L439 70 L432 70 L427 93 Z" fill="#212121"/><path d="M452 80 L452 76 L482 76 L482 80 L452 80 Z" fill="#212121"/><path d="M509 94 L509 92 C510 92,510 92,510 92 C511 92,511 91,511 91 C512 91,512 90,512 90 C512 90,512 89,512 88 C512 88,512 87,512 87 C512 87,512 86,512 86 C512 85,512 85,512 84 C512 84,512 84,512 83 L500 83 C499 84,499 84,499 85 C498 85,498 86,498 87 C497 87,497 88,497 88 C497 89,496 89,496 90 C496 91,497 92,499 92 L499 94 L487 94 L488 92 C488 92,488 92,489 92 C489 92,490 91,490 91 C490 90,491 90,491 89 C492 89,493 88,493 86 L510 59 L515 59 L517 87 C517 88,518 89,518 89 C518 90,518 90,518 91 C519 91,519 91,519 92 C520 92,520 92,521 92 L520 94 L509 94 Z M511 65 C509 67,508 70,506 72 C504 75,503 78,501 80 L512 80 C512 79,512 78,511 77 C511 76,511 75,511 73 C511 72,511 71,511 69 C511 68,511 67,511 65 L511 65 Z" fill="#212121"/><path d="M544 88 C543 89,542 90,541 91 C540 92,540 92,539 93 C538 93,537 94,536 94 C536 94,535 94,534 94 C532 94,530 94,529 93 C528 92,528 90,528 88 C528 88,528 87,528 86 C528 85,528 85,528 84 L531 70 L527 70 L527 68 C528 68,529 68,530 68 C531 68,531 67,531 67 C532 67,532 66,532 66 C532 66,533 65,533 65 C533 64,533 63,534 63 C534 62,534 61,535 60 L539 60 L537 67 L546 67 L546 70 L537 70 L534 81 C534 82,534 82,533 83 C533 84,533 84,533 84 C533 85,533 85,533 86 C533 86,533 86,533 87 C533 88,533 89,534 89 C534 90,535 90,536 90 C537 90,538 90,539 89 C540 89,541 88,542 86 L544 88 Z" fill="#212121"/><path d="M568 88 C567 89,566 90,565 91 C564 92,564 92,563 93 C562 93,561 94,560 94 C560 94,559 94,558 94 C556 94,554 94,553 93 C552 92,552 90,552 88 C552 88,552 87,552 86 C552 85,552 85,552 84 L555 70 L551 70 L551 68 C552 68,553 68,554 68 C555 68,555 67,555 67 C556 67,556 66,556 66 C556 66,557 65,557 65 C557 64,557 63,558 63 C558 62,558 61,559 60 L563 60 L561 67 L570 67 L570 70 L561 70 L558 81 C558 82,558 82,557 83 C557 84,557 84,557 84 C557 85,557 85,557 86 C557 86,557 86,557 87 C557 88,557 89,558 89 C558 90,559 90,560 90 C561 90,562 90,563 89 C564 89,565 88,566 86 L568 88 Z" fill="#212121"/><path d="M596 88 C594 90,592 92,590 93 C588 94,586 94,583 94 C582 94,581 94,579 93 C578 93,577 93,577 92 C576 91,575 90,575 89 C575 88,574 87,574 85 C574 84,575 83,575 82 C575 81,575 80,576 79 C576 78,576 77,577 76 C578 75,578 74,579 73 C580 71,582 70,584 69 C586 68,589 67,591 67 C594 67,595 68,597 69 C598 70,598 71,598 73 C598 79,592 82,580 82 C580 83,580 83,580 84 C580 84,580 85,580 85 C580 87,580 89,581 90 C582 91,583 91,585 91 C585 91,586 91,587 91 C588 91,589 90,589 90 C590 90,591 89,592 88 C592 88,593 87,594 86 L596 88 Z M580 79 C583 79,585 79,586 79 C588 78,589 78,590 77 C591 77,592 76,593 76 C593 75,593 74,593 73 C593 72,593 72,593 71 C592 70,591 70,590 70 C589 70,588 70,587 71 C586 71,585 72,585 73 C584 73,583 74,582 75 C582 76,581 78,580 79 L580 79 Z" fill="#212121"/><path d="M615 74 C617 72,618 70,620 69 C622 68,624 67,625 67 C627 67,629 68,630 69 C631 70,631 71,631 73 C631 73,631 74,631 75 C631 76,630 77,630 78 C630 79,630 80,629 81 C629 82,629 84,628 84 C628 85,628 86,628 87 C628 88,628 88,628 88 C628 89,628 89,628 90 C628 90,629 90,629 90 C630 90,630 90,630 90 C631 90,631 90,631 89 C632 89,632 89,632 88 C633 88,633 87,634 87 L636 88 C635 90,634 90,633 91 C633 92,632 92,631 93 C631 93,630 94,629 94 C628 94,628 94,627 94 C626 94,626 94,625 94 C625 94,624 93,624 93 C623 92,623 92,623 91 C623 91,623 90,623 89 C623 89,623 88,623 87 C623 86,623 85,623 84 C624 83,624 82,624 81 C625 80,625 79,625 78 C625 77,625 77,626 76 C626 75,626 75,626 74 C626 73,626 72,625 72 C625 71,624 71,623 71 C623 71,622 71,621 71 C621 72,620 72,619 73 C619 73,618 74,618 74 C617 75,616 76,616 76 C615 77,615 78,615 79 C614 80,614 80,614 81 L611 94 L606 94 L610 77 C610 76,610 76,610 75 C610 74,610 73,610 73 C610 72,610 71,609 71 C608 71,608 71,608 71 C607 71,607 72,607 72 C606 72,606 73,605 73 C605 73,605 74,604 74 L602 73 C603 72,604 71,605 70 C605 69,606 69,607 68 C607 68,608 68,609 67 C609 67,610 67,611 67 C612 67,613 68,614 68 C615 69,615 70,615 72 C615 72,615 73,615 73 C615 73,615 74,615 74 L615 74 Z" fill="#212121"/><path d="M658 88 C657 89,656 90,655 91 C654 92,654 92,653 93 C652 93,651 94,650 94 C650 94,649 94,648 94 C646 94,644 94,643 93 C642 92,642 90,642 88 C642 88,642 87,642 86 C642 85,642 85,642 84 L645 70 L641 70 L641 68 C642 68,643 68,644 68 C645 68,645 67,645 67 C646 67,646 66,646 66 C646 66,647 65,647 65 C647 64,647 63,648 63 C648 62,648 61,649 60 L653 60 L651 67 L660 67 L660 70 L651 70 L648 81 C648 82,648 82,647 83 C647 84,647 84,647 84 C647 85,647 85,647 86 C647 86,647 86,647 87 C647 88,647 89,648 89 C648 90,649 90,650 90 C651 90,652 90,653 89 C654 89,655 88,656 86 L658 88 Z" fill="#212121"/><path d="M678 56 L676 62 L671 62 L672 56 L678 56 Z M671 84 C671 85,671 86,671 87 C671 87,671 88,671 88 C671 89,671 89,671 90 C671 90,672 90,672 90 C673 90,673 90,673 90 C674 90,674 90,674 89 C675 89,675 89,675 88 C676 88,676 87,677 87 L679 89 C678 90,677 91,676 91 C675 92,675 92,674 93 C673 93,673 94,672 94 C671 94,671 94,670 94 C669 94,669 94,668 94 C668 94,667 93,667 93 C666 92,666 92,666 91 C666 91,665 90,665 89 C665 89,666 88,666 87 C666 86,666 85,666 84 C667 83,667 82,667 81 C667 80,668 79,668 78 C668 77,668 76,668 75 C669 74,669 73,669 72 C669 72,669 72,669 71 C669 71,669 71,669 71 C669 70,669 70,668 70 C668 69,667 69,666 69 L666 67 L674 67 L675 67 L671 84 Z" fill="#212121"/><path d="M693 94 C692 94,690 94,689 93 C688 93,687 92,686 92 C685 91,685 90,684 89 C684 88,683 86,683 85 C683 82,684 80,685 78 C686 76,687 74,688 72 C689 71,691 69,693 68 C695 68,697 67,699 67 C701 67,702 67,703 68 C705 68,706 69,707 70 C707 71,708 72,708 73 C709 74,709 75,709 77 C709 79,709 82,708 84 C707 86,706 88,704 89 C703 91,701 92,699 93 C697 94,695 94,693 94 L693 94 Z M689 85 C689 87,689 89,690 90 C691 91,692 91,694 91 C695 91,696 91,697 90 C698 90,698 89,699 89 C700 88,700 87,701 86 C702 85,702 84,702 83 C703 82,703 81,703 79 C704 78,704 77,704 76 C704 74,703 73,702 72 C702 71,700 70,699 70 C698 70,697 70,696 71 C695 71,694 72,694 72 C693 73,692 74,692 75 C691 76,690 77,690 78 C690 79,689 81,689 82 C689 83,689 84,689 85 L689 85 Z" fill="#212121"/><path d="M726 74 C728 72,729 70,731 69 C733 68,735 67,736 67 C738 67,740 68,741 69 C742 70,742 71,742 73 C742 73,742 74,742 75 C742 76,741 77,741 78 C741 79,741 80,740 81 C740 82,740 84,739 84 C739 85,739 86,739 87 C739 88,739 88,739 88 C739 89,739 89,739 90 C739 90,740 90,740 90 C741 90,741 90,741 90 C742 90,742 90,742 89 C743 89,743 89,743 88 C744 88,744 87,745 87 L747 88 C746 90,745 90,744 91 C744 92,743 92,742 93 C742 93,741 94,740 94 C739 94,739 94,738 94 C737 94,737 94,736 94 C736 94,735 93,735 93 C734 92,734 92,734 91 C734 91,734 90,734 89 C734 89,734 88,734 87 C734 86,734 85,734 84 C735 83,735 82,735 81 C736 80,736 79,736 78 C736 77,736 77,737 76 C737 75,737 75,737 74 C737 73,737 72,736 72 C736 71,735 71,734 71 C734 71,733 71,732 71 C732 72,731 72,730 73 C730 73,729 74,729 74 C728 75,727 76,727 76 C726 77,726 78,726 79 C725 80,725 80,725 81 L722 94 L717 94 L721 77 C721 76,721 76,721 75 C721 74,721 73,721 73 C721 72,721 71,720 71 C719 71,719 71,719 71 C718 71,718 72,718 72 C717 72,717 73,716 73 C716 73,716 74,715 74 L713 73 C714 72,715 71,716 70 C716 69,717 69,718 68 C718 68,719 68,720 67 C720 67,721 67,722 67 C723 67,724 68,725 68 C726 69,726 70,726 72 C726 72,726 73,726 73 C726 73,726 74,726 74 L726 74 Z" fill="#212121"/><path d="M799 52 L797 56 L787 49 L789 61 L784 61 L785 49 L775 56 L773 52 L783 47 L773 42 L775 38 L785 45 L784 33 L789 33 L787 45 L797 38 L799 42 L789 47 L799 52 Z" fill="#212121"/><path d="M840 18 L840 20 C839 20,838 21,837 21 C837 22,836 22,836 23 C836 24,836 25,836 27 C836 27,836 28,836 30 L837 57 L837 60 L837 60 L853 31 C854 30,855 28,855 27 C855 26,856 25,856 24 C856 22,854 21,852 20 L852 18 L867 18 L867 20 C866 20,866 20,865 21 C864 21,864 22,863 23 C862 24,861 26,860 28 L836 69 L831 69 L829 28 C829 27,829 25,828 24 C828 23,828 22,827 21 C827 21,826 20,824 20 L825 18 L840 18 Z" fill="#212121"/><path d="M873 35 L874 33 C874 33,874 33,875 33 C875 33,875 33,876 33 C876 32,876 32,876 32 C876 32,877 31,877 31 C877 31,877 30,877 29 C877 29,878 28,878 27 L883 3 L879 3 C879 3,878 3,878 3 C878 3,877 3,877 3 C876 4,876 4,876 4 C876 4,875 5,875 5 C875 6,874 6,874 7 C874 8,873 8,873 9 L870 9 L872 0 L901 0 L899 10 L896 10 L896 8 C896 8,896 8,896 7 C896 7,896 7,896 6 C896 6,896 5,896 5 C896 5,896 5,896 4 C895 4,895 4,895 4 C895 4,895 3,895 3 C894 3,894 3,894 3 C894 3,893 3,893 3 L888 3 L883 27 C883 28,883 29,883 29 C882 30,882 31,882 31 C882 31,882 32,883 32 C883 32,883 32,883 33 C883 33,884 33,884 33 C884 33,885 33,885 33 L885 35 L873 35 Z" fill="#212121"/></svg></span></p>
<ol style="list-style-type:decimal">
<li value="2" class="p_li"><span class="f_li">Adjusting the error gradient to the derivative of the </span><span class="f_li" style="font-style: italic;">Softmax</span><span class="f_li"> function.</span></li>
</ol>
<p class="p_li" style="text-align: center;"><span style="display:inline-block;width:218px;height:24px;padding:0 0;overflow:visible"><svg xmlns="http://www.w3.org/2000/svg" style="width:100%;height:100%;overflow:visible" viewBox="0 0 872 96"><path d="M30 58 C31 56,31 54,31 52 C31 51,31 50,30 50 C30 49,29 49,28 49 L28 47 L43 47 L42 49 C41 49,41 50,40 50 C40 50,39 50,39 51 C39 51,38 52,38 53 C38 54,37 56,37 58 L34 69 L31 70 L29 67 C27 69,25 69,23 70 C22 70,21 70,19 70 C14 70,11 69,9 66 C6 63,5 60,5 54 C5 51,6 46,7 42 C8 37,10 33,12 30 C14 26,17 23,21 21 C24 19,28 18,32 18 C34 18,36 18,38 19 C40 19,42 19,44 20 L42 30 L38 30 C38 27,38 25,36 23 C35 22,34 21,31 21 C29 21,27 22,25 23 C24 24,22 25,20 28 C19 30,17 32,16 36 C15 39,14 42,13 46 C12 49,12 53,12 56 C12 60,12 63,14 64 C15 66,17 67,20 67 C21 67,22 67,23 67 C24 67,25 66,26 66 C27 65,28 64,28 63 C29 62,30 61,30 60 L30 58 Z" fill="#212121"/><path d="M59 6 L59 8 L50 30 L47 29 L52 6 L59 6 Z" fill="#212121"/><path d="M49 84 C49 86,49 88,50 89 C51 90,53 90,55 90 C56 90,58 90,58 90 C59 90,60 89,61 88 C61 88,62 87,62 86 C63 86,63 85,63 84 C63 83,63 82,63 82 C62 81,62 80,62 80 C61 79,61 79,60 78 C59 77,58 77,57 76 C56 75,55 75,54 74 C53 73,53 73,52 72 C51 71,51 70,51 70 C50 69,50 68,50 67 C50 66,51 64,51 63 C52 62,53 61,54 60 C55 59,56 58,58 58 C59 57,61 57,63 57 C65 57,66 57,68 57 C69 58,71 58,73 59 L71 65 L68 65 C68 64,68 63,68 62 C68 62,67 61,67 61 C66 60,66 60,65 60 C64 60,63 59,62 59 C61 59,60 60,60 60 C59 60,58 61,57 61 C57 62,56 62,56 63 C56 64,55 64,55 65 C55 66,56 67,56 67 C56 68,56 68,57 69 C57 69,57 70,58 71 C59 71,60 72,61 72 C62 73,63 74,64 75 C65 75,66 76,66 77 C67 78,67 79,68 79 C68 80,68 81,68 82 C68 84,68 85,67 87 C66 88,66 89,64 90 C63 91,62 92,60 92 C59 93,57 93,55 93 C53 93,52 93,50 93 C48 92,46 92,44 91 L46 84 L49 84 Z" fill="#212121"/><path d="M95 73 C95 72,95 71,95 71 C95 70,95 70,95 69 C94 69,94 69,94 68 C93 68,93 68,92 68 C91 68,90 68,89 69 C88 69,88 70,87 70 C86 71,85 72,85 73 C84 74,84 75,83 76 C83 77,82 79,82 80 C82 81,82 82,82 83 C82 85,82 87,83 88 C84 89,85 89,86 89 C87 89,88 89,89 89 C89 89,90 88,91 88 C91 88,92 87,93 87 C93 86,94 85,95 84 C95 85,96 85,96 86 C96 86,97 86,97 87 C95 88,93 90,91 91 C89 92,87 92,85 92 C82 92,80 91,79 90 C77 88,76 86,76 83 C76 81,77 80,77 78 C77 77,78 75,79 74 C79 73,80 72,81 70 C82 69,83 68,84 68 C86 67,87 66,88 66 C90 65,91 65,93 65 C94 65,95 65,97 65 C98 65,99 66,100 66 L98 73 L95 73 Z" fill="#212121"/><path d="M114 92 C113 92,111 92,110 91 C109 91,108 90,107 90 C106 89,106 88,105 87 C105 86,104 84,104 83 C104 80,105 78,106 76 C107 74,108 72,109 70 C110 69,112 67,114 66 C116 66,118 65,120 65 C122 65,123 65,124 66 C126 66,127 67,128 68 C128 69,129 70,129 71 C130 72,130 73,130 75 C130 77,130 80,129 82 C128 84,127 86,125 87 C124 89,122 90,120 91 C118 92,116 92,114 92 L114 92 Z M110 83 C110 85,110 87,111 88 C112 89,113 89,115 89 C116 89,117 89,118 88 C119 88,119 87,120 87 C121 86,121 85,122 84 C123 83,123 82,123 81 C124 80,124 79,124 77 C125 76,125 75,125 74 C125 72,124 71,123 70 C123 69,121 68,120 68 C119 68,118 68,117 69 C116 69,115 70,115 70 C114 71,113 72,113 73 C112 74,111 75,111 76 C111 77,110 79,110 80 C110 81,110 82,110 83 L110 83 Z" fill="#212121"/><path d="M142 75 C142 74,142 73,142 73 C142 72,142 71,142 71 C142 70,142 69,141 69 C140 69,140 69,140 69 C139 69,139 70,139 70 C138 70,138 71,137 71 C137 71,137 72,136 72 L134 71 C135 70,136 69,137 68 C137 67,138 67,139 66 C139 66,140 66,141 65 C141 65,142 65,143 65 C144 65,145 66,146 66 C147 67,147 68,147 70 C147 71,147 71,147 72 L147 72 C149 70,151 68,152 67 C154 66,156 65,158 65 C158 65,159 65,159 65 C160 65,161 65,161 65 L160 72 L157 72 C157 71,156 70,156 70 C156 69,155 69,154 69 C154 69,154 69,153 69 C152 70,152 70,151 71 C151 71,150 72,149 72 C149 73,148 74,148 75 C147 75,147 76,146 77 C146 78,146 79,146 80 L143 92 L138 92 L142 75 Z" fill="#212121"/><path d="M187 86 C185 88,183 90,181 91 C179 92,177 92,174 92 C173 92,172 92,170 91 C169 91,168 91,168 90 C167 89,166 88,166 87 C166 86,165 85,165 83 C165 82,166 81,166 80 C166 79,166 78,167 77 C167 76,167 75,168 74 C169 73,169 72,170 71 C171 69,173 68,175 67 C177 66,180 65,182 65 C185 65,186 66,188 67 C189 68,189 69,189 71 C189 77,183 80,171 80 C171 81,171 81,171 82 C171 82,171 83,171 83 C171 85,171 87,172 88 C173 89,174 89,176 89 C176 89,177 89,178 89 C179 89,180 88,180 88 C181 88,182 87,183 86 C183 86,184 85,185 84 L187 86 Z M171 77 C174 77,176 77,177 77 C179 76,180 76,181 75 C182 75,183 74,184 74 C184 73,184 72,184 71 C184 70,184 70,184 69 C183 68,182 68,181 68 C180 68,179 68,178 69 C177 69,176 70,176 71 C175 71,174 72,173 73 C173 74,172 76,171 77 L171 77 Z" fill="#212121"/><path d="M219 43 L219 38 L265 38 L265 43 L219 43 Z M219 58 L219 53 L265 53 L265 58 L219 58 Z" fill="#212121"/><path d="M297 58 C297 61,298 63,299 65 C301 66,303 67,306 67 C309 67,312 66,314 64 C315 62,316 60,316 56 C316 55,316 53,316 52 C315 51,314 50,313 49 C312 48,311 47,309 45 C307 44,305 43,304 41 C303 40,302 39,301 38 C301 36,300 34,300 33 C300 30,301 27,302 25 C304 23,306 21,308 20 C311 19,314 18,317 18 C319 18,321 18,323 19 C325 19,327 19,330 20 L328 29 L324 29 C324 27,324 26,323 24 C323 23,322 22,321 22 C320 21,318 21,317 21 C315 21,313 22,311 22 C310 23,309 24,308 26 C307 27,307 29,307 31 C307 32,307 34,308 35 C309 37,311 39,314 40 C316 42,318 44,319 45 C320 46,321 48,322 49 C323 51,323 53,323 54 C323 58,322 60,321 63 C319 65,317 67,315 68 C312 69,309 70,306 70 C304 70,301 70,299 70 C296 69,294 69,292 68 L294 58 L297 58 Z" fill="#212121"/><path d="M336 35 L337 33 C337 33,337 33,338 33 C338 33,338 33,339 33 C339 32,339 32,339 32 C339 32,340 31,340 31 C340 31,340 30,340 29 C340 29,341 28,341 27 L346 3 L342 3 C342 3,341 3,341 3 C341 3,340 3,340 3 C339 4,339 4,339 4 C339 4,338 5,338 5 C338 6,337 6,337 7 C337 8,336 8,336 9 L333 9 L335 0 L364 0 L362 10 L359 10 L359 8 C359 8,359 8,359 7 C359 7,359 7,359 6 C359 6,359 5,359 5 C359 5,359 5,359 4 C358 4,358 4,358 4 C358 4,358 3,358 3 C357 3,357 3,357 3 C357 3,356 3,356 3 L351 3 L346 27 C346 28,346 29,346 29 C345 30,345 31,345 31 C345 31,345 32,346 32 C346 32,346 32,346 33 C346 33,347 33,347 33 C347 33,348 33,348 33 L348 35 L336 35 Z" fill="#212121"/><path d="M381 51 C381 59,382 67,385 72 C388 78,392 81,398 83 L397 86 C390 84,384 80,381 74 C377 68,375 60,375 51 C375 42,377 35,381 28 C384 22,390 18,397 16 L398 19 C392 21,388 25,385 30 C382 36,381 42,381 51 L381 51 Z" fill="#212121"/><path d="M444 19 L442 30 L438 30 C438 28,438 26,438 25 C438 24,437 24,437 23 C436 23,436 22,435 22 C435 22,434 22,433 22 L421 22 L417 42 L424 42 C426 42,427 42,428 41 C429 40,430 38,431 36 L434 36 L431 51 L428 51 C428 49,428 48,427 47 C427 46,427 46,426 45 C426 45,425 45,424 45 L416 45 L412 66 L423 66 C424 66,425 66,426 66 C427 65,428 65,428 64 C429 63,430 62,431 61 C431 60,432 58,433 56 L437 56 L434 69 L401 69 L401 67 C402 67,403 67,404 67 C404 66,404 66,405 65 C405 65,405 64,406 63 C406 62,406 61,407 58 L413 30 C414 28,414 26,414 24 C414 23,414 22,413 22 C412 21,412 21,410 21 L411 19 L444 19 Z" fill="#212121"/><path d="M471 50 L471 45 L517 45 L517 50 L471 50 Z" fill="#212121"/><path d="M545 58 C545 61,546 63,547 65 C549 66,551 67,554 67 C557 67,560 66,562 64 C563 62,564 60,564 56 C564 55,564 53,564 52 C563 51,562 50,561 49 C560 48,559 47,557 45 C555 44,553 43,552 41 C551 40,550 39,549 38 C549 36,548 34,548 33 C548 30,549 27,550 25 C552 23,554 21,556 20 C559 19,562 18,565 18 C567 18,569 18,571 19 C573 19,575 19,578 20 L576 29 L572 29 C572 27,572 26,571 24 C571 23,570 22,569 22 C568 21,566 21,565 21 C563 21,561 22,559 22 C558 23,557 24,556 26 C555 27,555 29,555 31 C555 32,555 34,556 35 C557 37,559 39,562 40 C564 42,566 44,567 45 C568 46,569 48,570 49 C571 51,571 53,571 54 C571 58,570 60,569 63 C567 65,565 67,563 68 C560 69,557 70,554 70 C552 70,549 70,547 70 C544 69,542 69,540 68 L542 58 L545 58 Z" fill="#212121"/><path d="M598 51 C598 42,597 36,594 30 C591 25,587 21,581 19 L582 16 C589 18,595 22,598 28 C602 35,604 42,604 51 C604 60,602 68,598 74 C595 80,589 84,582 86 L581 83 C587 81,591 78,594 72 C597 67,598 59,598 51 L598 51 Z" fill="#212121"/><path d="M644 59 C642 59,640 59,638 58 C637 57,635 55,634 53 C634 52,633 50,633 47 C633 45,634 44,634 42 C635 40,637 39,639 38 C640 37,642 36,645 36 C647 36,649 37,651 38 C652 39,654 40,655 42 C656 43,656 45,656 48 C656 50,656 52,655 53 C654 55,652 57,650 58 C649 59,647 59,644 59 L644 59 Z M644 40 C643 40,641 41,640 42 C639 44,638 45,638 48 C638 50,639 52,640 53 C641 54,643 55,644 55 C646 55,647 55,648 54 C649 54,650 53,650 51 C651 50,651 49,651 48 C651 46,651 45,650 44 C650 43,649 42,648 41 C647 40,646 40,644 40 L644 40 Z" fill="#212121"/><path d="M708 58 C709 56,709 54,709 52 C709 51,709 50,708 50 C708 49,707 49,706 49 L706 47 L721 47 L720 49 C719 49,719 50,718 50 C718 50,717 50,717 51 C717 51,716 52,716 53 C716 54,715 56,715 58 L712 69 L709 70 L707 67 C705 69,703 69,701 70 C700 70,699 70,697 70 C692 70,689 69,687 66 C684 63,683 60,683 54 C683 51,684 46,685 42 C686 37,688 33,690 30 C692 26,695 23,699 21 C702 19,706 18,710 18 C712 18,714 18,716 19 C718 19,720 19,722 20 L720 30 L716 30 C716 27,716 25,714 23 C713 22,712 21,709 21 C707 21,705 22,703 23 C702 24,700 25,698 28 C697 30,695 32,694 36 C693 39,692 42,691 46 C690 49,690 53,690 56 C690 60,690 63,692 64 C693 66,695 67,698 67 C699 67,700 67,701 67 C702 67,703 66,704 66 C705 65,706 64,706 63 C707 62,708 61,708 60 L708 58 Z" fill="#212121"/><path d="M727 84 C727 86,727 88,728 89 C729 90,731 90,733 90 C734 90,736 90,736 90 C737 90,738 89,739 88 C739 88,740 87,740 86 C741 86,741 85,741 84 C741 83,741 82,741 82 C740 81,740 80,740 80 C739 79,739 79,738 78 C737 77,736 77,735 76 C734 75,733 75,732 74 C731 73,731 73,730 72 C729 71,729 70,729 70 C728 69,728 68,728 67 C728 66,729 64,729 63 C730 62,731 61,732 60 C733 59,734 58,736 58 C737 57,739 57,741 57 C743 57,744 57,746 57 C747 58,749 58,751 59 L749 65 L746 65 C746 64,746 63,746 62 C746 62,745 61,745 61 C744 60,744 60,743 60 C742 60,741 59,740 59 C739 59,738 60,738 60 C737 60,736 61,735 61 C735 62,734 62,734 63 C734 64,733 64,733 65 C733 66,734 67,734 67 C734 68,734 68,735 69 C735 69,735 70,736 71 C737 71,738 72,739 72 C740 73,741 74,742 75 C743 75,744 76,744 77 C745 78,745 79,746 79 C746 80,746 81,746 82 C746 84,746 85,745 87 C744 88,744 89,742 90 C741 91,740 92,738 92 C737 93,735 93,733 93 C731 93,730 93,728 93 C726 92,724 92,722 91 L724 84 L727 84 Z" fill="#212121"/><path d="M773 73 C773 72,773 71,773 71 C773 70,773 70,773 69 C772 69,772 69,772 68 C771 68,771 68,770 68 C769 68,768 68,767 69 C766 69,766 70,765 70 C764 71,763 72,763 73 C762 74,762 75,761 76 C761 77,760 79,760 80 C760 81,760 82,760 83 C760 85,760 87,761 88 C762 89,763 89,764 89 C765 89,766 89,767 89 C767 89,768 88,769 88 C769 88,770 87,771 87 C771 86,772 85,773 84 C773 85,774 85,774 86 C774 86,775 86,775 87 C773 88,771 90,769 91 C767 92,765 92,763 92 C760 92,758 91,757 90 C755 88,754 86,754 83 C754 81,755 80,755 78 C755 77,756 75,757 74 C757 73,758 72,759 70 C760 69,761 68,762 68 C764 67,765 66,766 66 C768 65,769 65,771 65 C772 65,773 65,775 65 C776 65,777 66,778 66 L776 73 L773 73 Z" fill="#212121"/><path d="M792 92 C791 92,789 92,788 91 C787 91,786 90,785 90 C784 89,784 88,783 87 C783 86,782 84,782 83 C782 80,783 78,784 76 C785 74,786 72,787 70 C788 69,790 67,792 66 C794 66,796 65,798 65 C800 65,801 65,802 66 C804 66,805 67,806 68 C806 69,807 70,807 71 C808 72,808 73,808 75 C808 77,808 80,807 82 C806 84,805 86,803 87 C802 89,800 90,798 91 C796 92,794 92,792 92 L792 92 Z M788 83 C788 85,788 87,789 88 C790 89,791 89,793 89 C794 89,795 89,796 88 C797 88,797 87,798 87 C799 86,799 85,800 84 C801 83,801 82,801 81 C802 80,802 79,802 77 C803 76,803 75,803 74 C803 72,802 71,801 70 C801 69,799 68,798 68 C797 68,796 68,795 69 C794 69,793 70,793 70 C792 71,791 72,791 73 C790 74,789 75,789 76 C789 77,788 79,788 80 C788 81,788 82,788 83 L788 83 Z" fill="#212121"/><path d="M820 75 C820 74,820 73,820 73 C820 72,820 71,820 71 C820 70,820 69,819 69 C818 69,818 69,818 69 C817 69,817 70,817 70 C816 70,816 71,815 71 C815 71,815 72,814 72 L812 71 C813 70,814 69,815 68 C815 67,816 67,817 66 C817 66,818 66,819 65 C819 65,820 65,821 65 C822 65,823 66,824 66 C825 67,825 68,825 70 C825 71,825 71,825 72 L825 72 C827 70,829 68,830 67 C832 66,834 65,836 65 C836 65,837 65,837 65 C838 65,839 65,839 65 L838 72 L835 72 C835 71,834 70,834 70 C834 69,833 69,832 69 C832 69,832 69,831 69 C830 70,830 70,829 71 C829 71,828 72,827 72 C827 73,826 74,826 75 C825 75,825 76,824 77 C824 78,824 79,824 80 L821 92 L816 92 L820 75 Z" fill="#212121"/><path d="M865 86 C863 88,861 90,859 91 C857 92,855 92,852 92 C851 92,850 92,848 91 C847 91,846 91,846 90 C845 89,844 88,844 87 C844 86,843 85,843 83 C843 82,844 81,844 80 C844 79,844 78,845 77 C845 76,845 75,846 74 C847 73,847 72,848 71 C849 69,851 68,853 67 C855 66,858 65,860 65 C863 65,864 66,866 67 C867 68,867 69,867 71 C867 77,861 80,849 80 C849 81,849 81,849 82 C849 82,849 83,849 83 C849 85,849 87,850 88 C851 89,852 89,854 89 C854 89,855 89,856 89 C857 89,858 88,858 88 C859 88,860 87,861 86 C861 86,862 85,863 84 L865 86 Z M849 77 C852 77,854 77,855 77 C857 76,858 76,859 75 C860 75,861 74,862 74 C862 73,862 72,862 71 C862 70,862 70,862 69 C861 68,860 68,859 68 C858 68,857 68,856 69 C855 69,854 70,854 71 C853 71,852 72,851 73 C851 74,850 76,849 77 L849 77 Z" fill="#212121"/></svg></span></p>
<p class="p_Text"><span class="f_Text">Let's summarize the entire calculation into one formula:</span></p>
<p class="p_li" style="text-align: center;"><span style="display:inline-block;width:323px;height:27px;padding:0 0;overflow:visible"><svg xmlns="http://www.w3.org/2000/svg" style="width:100%;height:100%;overflow:visible" viewBox="0 0 1292 108"><path d="M30 58 C31 56,31 54,31 52 C31 51,31 50,30 50 C30 49,29 49,28 49 L28 47 L43 47 L42 49 C41 49,41 50,40 50 C40 50,39 50,39 51 C39 51,38 52,38 53 C38 54,37 56,37 58 L34 69 L31 70 L29 67 C27 69,25 69,23 70 C22 70,21 70,19 70 C14 70,11 69,9 66 C6 63,5 60,5 54 C5 51,6 46,7 42 C8 37,10 33,12 30 C14 26,17 23,21 21 C24 19,28 18,32 18 C34 18,36 18,38 19 C40 19,42 19,44 20 L42 30 L38 30 C38 27,38 25,36 23 C35 22,34 21,31 21 C29 21,27 22,25 23 C24 24,22 25,20 28 C19 30,17 32,16 36 C15 39,14 42,13 46 C12 49,12 53,12 56 C12 60,12 63,14 64 C15 66,17 67,20 67 C21 67,22 67,23 67 C24 67,25 66,26 66 C27 65,28 64,28 63 C29 62,30 61,30 60 L30 58 Z" fill="#212121"/><path d="M59 6 L59 8 L50 30 L47 29 L52 6 L59 6 Z" fill="#212121"/><path d="M49 84 C49 86,49 88,50 89 C51 90,53 90,55 90 C56 90,58 90,58 90 C59 90,60 89,61 88 C61 88,62 87,62 86 C63 86,63 85,63 84 C63 83,63 82,63 82 C62 81,62 80,62 80 C61 79,61 79,60 78 C59 77,58 77,57 76 C56 75,55 75,54 74 C53 73,53 73,52 72 C51 71,51 70,51 70 C50 69,50 68,50 67 C50 66,51 64,51 63 C52 62,53 61,54 60 C55 59,56 58,58 58 C59 57,61 57,63 57 C65 57,66 57,68 57 C69 58,71 58,73 59 L71 65 L68 65 C68 64,68 63,68 62 C68 62,67 61,67 61 C66 60,66 60,65 60 C64 60,63 59,62 59 C61 59,60 60,60 60 C59 60,58 61,57 61 C57 62,56 62,56 63 C56 64,55 64,55 65 C55 66,56 67,56 67 C56 68,56 68,57 69 C57 69,57 70,58 71 C59 71,60 72,61 72 C62 73,63 74,64 75 C65 75,66 76,66 77 C67 78,67 79,68 79 C68 80,68 81,68 82 C68 84,68 85,67 87 C66 88,66 89,64 90 C63 91,62 92,60 92 C59 93,57 93,55 93 C53 93,52 93,50 93 C48 92,46 92,44 91 L46 84 L49 84 Z" fill="#212121"/><path d="M95 73 C95 72,95 71,95 71 C95 70,95 70,95 69 C94 69,94 69,94 68 C93 68,93 68,92 68 C91 68,90 68,89 69 C88 69,88 70,87 70 C86 71,85 72,85 73 C84 74,84 75,83 76 C83 77,82 79,82 80 C82 81,82 82,82 83 C82 85,82 87,83 88 C84 89,85 89,86 89 C87 89,88 89,89 89 C89 89,90 88,91 88 C91 88,92 87,93 87 C93 86,94 85,95 84 C95 85,96 85,96 86 C96 86,97 86,97 87 C95 88,93 90,91 91 C89 92,87 92,85 92 C82 92,80 91,79 90 C77 88,76 86,76 83 C76 81,77 80,77 78 C77 77,78 75,79 74 C79 73,80 72,81 70 C82 69,83 68,84 68 C86 67,87 66,88 66 C90 65,91 65,93 65 C94 65,95 65,97 65 C98 65,99 66,100 66 L98 73 L95 73 Z" fill="#212121"/><path d="M114 92 C113 92,111 92,110 91 C109 91,108 90,107 90 C106 89,106 88,105 87 C105 86,104 84,104 83 C104 80,105 78,106 76 C107 74,108 72,109 70 C110 69,112 67,114 66 C116 66,118 65,120 65 C122 65,123 65,124 66 C126 66,127 67,128 68 C128 69,129 70,129 71 C130 72,130 73,130 75 C130 77,130 80,129 82 C128 84,127 86,125 87 C124 89,122 90,120 91 C118 92,116 92,114 92 L114 92 Z M110 83 C110 85,110 87,111 88 C112 89,113 89,115 89 C116 89,117 89,118 88 C119 88,119 87,120 87 C121 86,121 85,122 84 C123 83,123 82,123 81 C124 80,124 79,124 77 C125 76,125 75,125 74 C125 72,124 71,123 70 C123 69,121 68,120 68 C119 68,118 68,117 69 C116 69,115 70,115 70 C114 71,113 72,113 73 C112 74,111 75,111 76 C111 77,110 79,110 80 C110 81,110 82,110 83 L110 83 Z" fill="#212121"/><path d="M142 75 C142 74,142 73,142 73 C142 72,142 71,142 71 C142 70,142 69,141 69 C140 69,140 69,140 69 C139 69,139 70,139 70 C138 70,138 71,137 71 C137 71,137 72,136 72 L134 71 C135 70,136 69,137 68 C137 67,138 67,139 66 C139 66,140 66,141 65 C141 65,142 65,143 65 C144 65,145 66,146 66 C147 67,147 68,147 70 C147 71,147 71,147 72 L147 72 C149 70,151 68,152 67 C154 66,156 65,158 65 C158 65,159 65,159 65 C160 65,161 65,161 65 L160 72 L157 72 C157 71,156 70,156 70 C156 69,155 69,154 69 C154 69,154 69,153 69 C152 70,152 70,151 71 C151 71,150 72,149 72 C149 73,148 74,148 75 C147 75,147 76,146 77 C146 78,146 79,146 80 L143 92 L138 92 L142 75 Z" fill="#212121"/><path d="M187 86 C185 88,183 90,181 91 C179 92,177 92,174 92 C173 92,172 92,170 91 C169 91,168 91,168 90 C167 89,166 88,166 87 C166 86,165 85,165 83 C165 82,166 81,166 80 C166 79,166 78,167 77 C167 76,167 75,168 74 C169 73,169 72,170 71 C171 69,173 68,175 67 C177 66,180 65,182 65 C185 65,186 66,188 67 C189 68,189 69,189 71 C189 77,183 80,171 80 C171 81,171 81,171 82 C171 82,171 83,171 83 C171 85,171 87,172 88 C173 89,174 89,176 89 C176 89,177 89,178 89 C179 89,180 88,180 88 C181 88,182 87,183 86 C183 86,184 85,185 84 L187 86 Z M171 77 C174 77,176 77,177 77 C179 76,180 76,181 75 C182 75,183 74,184 74 C184 73,184 72,184 71 C184 70,184 70,184 69 C183 68,182 68,181 68 C180 68,179 68,178 69 C177 69,176 70,176 71 C175 71,174 72,173 73 C173 74,172 76,171 77 L171 77 Z" fill="#212121"/><path d="M219 43 L219 38 L265 38 L265 43 L219 43 Z M219 58 L219 53 L265 53 L265 58 L219 58 Z" fill="#212121"/><path d="M297 58 C297 61,298 63,299 65 C301 66,303 67,306 67 C309 67,312 66,314 64 C315 62,316 60,316 56 C316 55,316 53,316 52 C315 51,314 50,313 49 C312 48,311 47,309 45 C307 44,305 43,304 41 C303 40,302 39,301 38 C301 36,300 34,300 33 C300 30,301 27,302 25 C304 23,306 21,308 20 C311 19,314 18,317 18 C319 18,321 18,323 19 C325 19,327 19,330 20 L328 29 L324 29 C324 27,324 26,323 24 C323 23,322 22,321 22 C320 21,318 21,317 21 C315 21,313 22,311 22 C310 23,309 24,308 26 C307 27,307 29,307 31 C307 32,307 34,308 35 C309 37,311 39,314 40 C316 42,318 44,319 45 C320 46,321 48,322 49 C323 51,323 53,323 54 C323 58,322 60,321 63 C319 65,317 67,315 68 C312 69,309 70,306 70 C304 70,301 70,299 70 C296 69,294 69,292 68 L294 58 L297 58 Z" fill="#212121"/><path d="M336 35 L337 33 C337 33,337 33,338 33 C338 33,338 33,339 33 C339 32,339 32,339 32 C339 32,340 31,340 31 C340 31,340 30,340 29 C340 29,341 28,341 27 L346 3 L342 3 C342 3,341 3,341 3 C341 3,340 3,340 3 C339 4,339 4,339 4 C339 4,338 5,338 5 C338 6,337 6,337 7 C337 8,336 8,336 9 L333 9 L335 0 L364 0 L362 10 L359 10 L359 8 C359 8,359 8,359 7 C359 7,359 7,359 6 C359 6,359 5,359 5 C359 5,359 5,359 4 C358 4,358 4,358 4 C358 4,358 3,358 3 C357 3,357 3,357 3 C357 3,356 3,356 3 L351 3 L346 27 C346 28,346 29,346 29 C345 30,345 31,345 31 C345 31,345 32,346 32 C346 32,346 32,346 33 C346 33,347 33,347 33 C347 33,348 33,348 33 L348 35 L336 35 Z" fill="#212121"/><path d="M381 51 C381 59,382 67,385 72 C388 78,392 81,398 83 L397 86 C390 84,384 80,381 74 C377 68,375 60,375 51 C375 42,377 35,381 28 C384 22,390 18,397 16 L398 19 C392 21,388 25,385 30 C382 36,381 42,381 51 L381 51 Z" fill="#212121"/><path d="M444 19 L442 30 L438 30 C438 28,438 26,438 25 C438 24,437 24,437 23 C436 23,436 22,435 22 C435 22,434 22,433 22 L421 22 L417 42 L424 42 C426 42,427 42,428 41 C429 40,430 38,431 36 L434 36 L431 51 L428 51 C428 49,428 48,427 47 C427 46,427 46,426 45 C426 45,425 45,424 45 L416 45 L412 66 L423 66 C424 66,425 66,426 66 C427 65,428 65,428 64 C429 63,430 62,431 61 C431 60,432 58,433 56 L437 56 L434 69 L401 69 L401 67 C402 67,403 67,404 67 C404 66,404 66,405 65 C405 65,405 64,406 63 C406 62,406 61,407 58 L413 30 C414 28,414 26,414 24 C414 23,414 22,413 22 C412 21,412 21,410 21 L411 19 L444 19 Z" fill="#212121"/><path d="M471 50 L471 45 L517 45 L517 50 L471 50 Z" fill="#212121"/><path d="M545 58 C545 61,546 63,547 65 C549 66,551 67,554 67 C557 67,560 66,562 64 C563 62,564 60,564 56 C564 55,564 53,564 52 C563 51,562 50,561 49 C560 48,559 47,557 45 C555 44,553 43,552 41 C551 40,550 39,549 38 C549 36,548 34,548 33 C548 30,549 27,550 25 C552 23,554 21,556 20 C559 19,562 18,565 18 C567 18,569 18,571 19 C573 19,575 19,578 20 L576 29 L572 29 C572 27,572 26,571 24 C571 23,570 22,569 22 C568 21,566 21,565 21 C563 21,561 22,559 22 C558 23,557 24,556 26 C555 27,555 29,555 31 C555 32,555 34,556 35 C557 37,559 39,562 40 C564 42,566 44,567 45 C568 46,569 48,570 49 C571 51,571 53,571 54 C571 58,570 60,569 63 C567 65,565 67,563 68 C560 69,557 70,554 70 C552 70,549 70,547 70 C544 69,542 69,540 68 L542 58 L545 58 Z" fill="#212121"/><path d="M598 51 C598 42,597 36,594 30 C591 25,587 21,581 19 L582 16 C589 18,595 22,598 28 C602 35,604 42,604 51 C604 60,602 68,598 74 C595 80,589 84,582 86 L581 83 C587 81,591 78,594 72 C597 67,598 59,598 51 L598 51 Z" fill="#212121"/><path d="M644 59 C642 59,640 59,638 58 C637 57,635 55,634 53 C634 52,633 50,633 47 C633 45,634 44,634 42 C635 40,637 39,639 38 C640 37,642 36,645 36 C647 36,649 37,651 38 C652 39,654 40,655 42 C656 43,656 45,656 48 C656 50,656 52,655 53 C654 55,652 57,650 58 C649 59,647 59,644 59 L644 59 Z M644 40 C643 40,641 41,640 42 C639 44,638 45,638 48 C638 50,639 52,640 53 C641 54,643 55,644 55 C646 55,647 55,648 54 C649 54,650 53,650 51 C651 50,651 49,651 48 C651 46,651 45,650 44 C650 43,649 42,648 41 C647 40,646 40,644 40 L644 40 Z" fill="#212121"/><path d="M691 51 C691 59,692 67,695 72 C698 78,702 81,708 83 L707 86 C700 84,694 80,691 74 C687 68,685 60,685 51 C685 42,687 35,691 28 C694 22,700 18,707 16 L708 19 C702 21,698 25,695 30 C692 36,691 42,691 51 L691 51 Z" fill="#212121"/><path d="M739 58 C740 56,740 54,740 52 C740 51,740 50,739 50 C739 49,738 49,737 49 L737 47 L752 47 L751 49 C750 49,750 50,749 50 C749 50,748 50,748 51 C748 51,747 52,747 53 C747 54,746 56,746 58 L743 69 L740 70 L738 67 C736 69,734 69,732 70 C731 70,730 70,728 70 C723 70,720 69,718 66 C715 63,714 60,714 54 C714 51,715 46,716 42 C717 37,719 33,721 30 C723 26,726 23,730 21 C733 19,737 18,741 18 C743 18,745 18,747 19 C749 19,751 19,753 20 L751 30 L747 30 C747 27,747 25,745 23 C744 22,743 21,740 21 C738 21,736 22,734 23 C733 24,731 25,729 28 C728 30,726 32,725 36 C724 39,723 42,722 46 C721 49,721 53,721 56 C721 60,721 63,723 64 C724 66,726 67,729 67 C730 67,731 67,732 67 C733 67,734 66,735 66 C736 65,737 64,737 63 C738 62,739 61,739 60 L739 58 Z" fill="#212121"/><path d="M758 87 C758 89,758 91,759 92 C760 93,762 93,764 93 C765 93,767 93,767 93 C768 93,769 92,770 91 C770 91,771 90,771 89 C772 89,772 88,772 87 C772 86,772 85,772 85 C771 84,771 83,771 83 C770 82,770 82,769 81 C768 80,767 80,766 79 C765 78,764 78,763 77 C762 76,762 76,761 75 C760 74,760 73,760 73 C759 72,759 71,759 70 C759 69,760 67,760 66 C761 65,762 64,763 63 C764 62,765 61,767 61 C768 60,770 60,772 60 C774 60,775 60,777 60 C778 61,780 61,782 62 L780 68 L777 68 C777 67,777 66,777 65 C777 65,776 64,776 64 C775 63,775 63,774 63 C773 63,772 62,771 62 C770 62,769 63,769 63 C768 63,767 64,766 64 C766 65,765 65,765 66 C765 67,764 67,764 68 C764 69,765 70,765 70 C765 71,765 71,766 72 C766 72,766 73,767 74 C768 74,769 75,770 75 C771 76,772 77,773 78 C774 78,775 79,775 80 C776 81,776 82,777 82 C777 83,777 84,777 85 C777 87,777 88,776 90 C775 91,775 92,773 93 C772 94,771 95,769 95 C768 96,766 96,764 96 C762 96,761 96,759 96 C757 95,755 95,753 94 L755 87 L758 87 Z" fill="#212121"/><path d="M807 89 C805 91,803 93,801 94 C799 95,797 95,794 95 C793 95,792 95,790 94 C789 94,788 94,788 93 C787 92,786 91,786 90 C786 89,785 88,785 86 C785 85,786 84,786 83 C786 82,786 81,787 80 C787 79,787 78,788 77 C789 76,789 75,790 74 C791 72,793 71,795 70 C797 69,800 68,802 68 C805 68,806 69,808 70 C809 71,809 72,809 74 C809 80,803 83,791 83 C791 84,791 84,791 85 C791 85,791 86,791 86 C791 88,791 90,792 91 C793 92,794 92,796 92 C796 92,797 92,798 92 C799 92,800 91,800 91 C801 91,802 90,803 89 C803 89,804 88,805 87 L807 89 Z M791 80 C794 80,796 80,797 80 C799 79,800 79,801 78 C802 78,803 77,804 77 C804 76,804 75,804 74 C804 73,804 73,804 72 C803 71,802 71,801 71 C800 71,799 71,798 72 C797 72,796 73,796 74 C795 74,794 75,793 76 C793 77,792 79,791 80 L791 80 Z" fill="#212121"/><path d="M817 84 C818 81,819 78,820 74 C820 71,821 68,821 66 C822 64,822 63,822 62 C822 62,822 61,822 61 C822 61,822 61,821 61 C821 60,821 60,820 60 C820 60,819 60,819 60 L819 58 L826 58 L828 58 C827 63,826 68,825 72 C824 76,823 80,822 85 C822 86,822 87,822 88 C822 88,821 89,821 89 C821 90,822 90,822 91 C822 91,823 91,823 91 C824 91,824 91,824 91 C825 91,825 91,825 90 C826 90,826 90,826 89 C827 89,827 88,828 88 L830 89 C829 91,828 91,827 92 C826 93,826 93,825 94 C824 94,824 95,823 95 C822 95,822 95,821 95 C820 95,820 95,819 95 C819 94,818 94,818 94 C817 93,817 93,817 92 C817 92,816 91,816 90 C816 89,817 89,817 88 C817 87,817 86,817 84 L817 84 Z" fill="#212121"/><path d="M845 94 C844 98,843 101,841 103 C839 105,836 106,833 106 C832 106,832 106,831 106 C831 105,832 105,832 104 C832 104,832 104,832 103 C832 103,832 103,832 103 C833 103,833 103,833 103 C834 103,835 103,835 103 C836 103,836 102,837 102 C837 101,838 100,838 99 C839 98,839 97,839 95 L845 71 L840 71 L840 69 C841 69,842 69,843 69 C843 69,844 69,844 68 C845 68,845 68,845 67 C846 64,848 62,850 60 C852 59,855 58,858 58 C859 58,860 58,861 58 C861 58,862 58,863 59 L862 64 L859 64 C859 63,859 62,858 62 C858 61,857 61,856 61 C855 61,855 61,854 62 C853 62,853 63,852 63 C852 64,851 65,851 66 C851 67,850 67,850 68 L858 68 L857 71 L850 71 L845 94 Z" fill="#212121"/><path d="M870 81 L870 77 L900 77 L900 81 L870 81 Z" fill="#212121"/><path d="M927 95 L927 93 C928 93,928 93,928 93 C929 93,929 92,929 92 C930 92,930 91,930 91 C930 91,930 90,930 89 C930 89,930 88,930 88 C930 88,930 87,930 87 C930 86,930 86,930 85 C930 85,930 85,930 84 L918 84 C917 85,917 85,917 86 C916 86,916 87,916 88 C915 88,915 89,915 89 C915 90,914 90,914 91 C914 92,915 93,917 93 L917 95 L905 95 L906 93 C906 93,906 93,907 93 C907 93,908 92,908 92 C908 91,909 91,909 90 C910 90,911 89,911 87 L928 60 L933 60 L935 88 C935 89,936 90,936 90 C936 91,936 91,936 92 C937 92,937 92,937 93 C938 93,938 93,939 93 L938 95 L927 95 Z M929 66 C927 68,926 71,924 73 C922 76,921 79,919 81 L930 81 C930 80,930 79,929 78 C929 77,929 76,929 74 C929 73,929 72,929 70 C929 69,929 68,929 66 L929 66 Z" fill="#212121"/><path d="M962 89 C961 90,960 91,959 92 C958 93,958 93,957 94 C956 94,955 95,954 95 C954 95,953 95,952 95 C950 95,948 95,947 94 C946 93,946 91,946 89 C946 89,946 88,946 87 C946 86,946 86,946 85 L949 71 L945 71 L945 69 C946 69,947 69,948 69 C949 69,949 68,949 68 C950 68,950 67,950 67 C950 67,951 66,951 66 C951 65,951 64,952 64 C952 63,952 62,953 61 L957 61 L955 68 L964 68 L964 71 L955 71 L952 82 C952 83,952 83,951 84 C951 85,951 85,951 85 C951 86,951 86,951 87 C951 87,951 87,951 88 C951 89,951 90,952 90 C952 91,953 91,954 91 C955 91,956 91,957 90 C958 90,959 89,960 87 L962 89 Z" fill="#212121"/><path d="M986 89 C985 90,984 91,983 92 C982 93,982 93,981 94 C980 94,979 95,978 95 C978 95,977 95,976 95 C974 95,972 95,971 94 C970 93,970 91,970 89 C970 89,970 88,970 87 C970 86,970 86,970 85 L973 71 L969 71 L969 69 C970 69,971 69,972 69 C973 69,973 68,973 68 C974 68,974 67,974 67 C974 67,975 66,975 66 C975 65,975 64,976 64 C976 63,976 62,977 61 L981 61 L979 68 L988 68 L988 71 L979 71 L976 82 C976 83,976 83,975 84 C975 85,975 85,975 85 C975 86,975 86,975 87 C975 87,975 87,975 88 C975 89,975 90,976 90 C976 91,977 91,978 91 C979 91,980 91,981 90 C982 90,983 89,984 87 L986 89 Z" fill="#212121"/><path d="M1014 89 C1012 91,1010 93,1008 94 C1006 95,1004 95,1001 95 C1000 95,999 95,997 94 C996 94,995 94,995 93 C994 92,993 91,993 90 C993 89,992 88,992 86 C992 85,993 84,993 83 C993 82,993 81,994 80 C994 79,994 78,995 77 C996 76,996 75,997 74 C998 72,1000 71,1002 70 C1004 69,1007 68,1009 68 C1012 68,1013 69,1015 70 C1016 71,1016 72,1016 74 C1016 80,1010 83,998 83 C998 84,998 84,998 85 C998 85,998 86,998 86 C998 88,998 90,999 91 C1000 92,1001 92,1003 92 C1003 92,1004 92,1005 92 C1006 92,1007 91,1007 91 C1008 91,1009 90,1010 89 C1010 89,1011 88,1012 87 L1014 89 Z M998 80 C1001 80,1003 80,1004 80 C1006 79,1007 79,1008 78 C1009 78,1010 77,1011 77 C1011 76,1011 75,1011 74 C1011 73,1011 73,1011 72 C1010 71,1009 71,1008 71 C1007 71,1006 71,1005 72 C1004 72,1003 73,1003 74 C1002 74,1001 75,1000 76 C1000 77,999 79,998 80 L998 80 Z" fill="#212121"/><path d="M1033 75 C1035 73,1036 71,1038 70 C1040 69,1042 68,1043 68 C1045 68,1047 69,1048 70 C1049 71,1049 72,1049 74 C1049 74,1049 75,1049 76 C1049 77,1048 78,1048 79 C1048 80,1048 81,1047 82 C1047 83,1047 85,1046 85 C1046 86,1046 87,1046 88 C1046 89,1046 89,1046 89 C1046 90,1046 90,1046 91 C1046 91,1047 91,1047 91 C1048 91,1048 91,1048 91 C1049 91,1049 91,1049 90 C1050 90,1050 90,1050 89 C1051 89,1051 88,1052 88 L1054 89 C1053 91,1052 91,1051 92 C1051 93,1050 93,1049 94 C1049 94,1048 95,1047 95 C1046 95,1046 95,1045 95 C1044 95,1044 95,1043 95 C1043 95,1042 94,1042 94 C1041 93,1041 93,1041 92 C1041 92,1041 91,1041 90 C1041 90,1041 89,1041 88 C1041 87,1041 86,1041 85 C1042 84,1042 83,1042 82 C1043 81,1043 80,1043 79 C1043 78,1043 78,1044 77 C1044 76,1044 76,1044 75 C1044 74,1044 73,1043 73 C1043 72,1042 72,1041 72 C1041 72,1040 72,1039 72 C1039 73,1038 73,1037 74 C1037 74,1036 75,1036 75 C1035 76,1034 77,1034 77 C1033 78,1033 79,1033 80 C1032 81,1032 81,1032 82 L1029 95 L1024 95 L1028 78 C1028 77,1028 77,1028 76 C1028 75,1028 74,1028 74 C1028 73,1028 72,1027 72 C1026 72,1026 72,1026 72 C1025 72,1025 73,1025 73 C1024 73,1024 74,1023 74 C1023 74,1023 75,1022 75 L1020 74 C1021 73,1022 72,1023 71 C1023 70,1024 70,1025 69 C1025 69,1026 69,1027 68 C1027 68,1028 68,1029 68 C1030 68,1031 69,1032 69 C1033 70,1033 71,1033 73 C1033 73,1033 74,1033 74 C1033 74,1033 75,1033 75 L1033 75 Z" fill="#212121"/><path d="M1076 89 C1075 90,1074 91,1073 92 C1072 93,1072 93,1071 94 C1070 94,1069 95,1068 95 C1068 95,1067 95,1066 95 C1064 95,1062 95,1061 94 C1060 93,1060 91,1060 89 C1060 89,1060 88,1060 87 C1060 86,1060 86,1060 85 L1063 71 L1059 71 L1059 69 C1060 69,1061 69,1062 69 C1063 69,1063 68,1063 68 C1064 68,1064 67,1064 67 C1064 67,1065 66,1065 66 C1065 65,1065 64,1066 64 C1066 63,1066 62,1067 61 L1071 61 L1069 68 L1078 68 L1078 71 L1069 71 L1066 82 C1066 83,1066 83,1065 84 C1065 85,1065 85,1065 85 C1065 86,1065 86,1065 87 C1065 87,1065 87,1065 88 C1065 89,1065 90,1066 90 C1066 91,1067 91,1068 91 C1069 91,1070 91,1071 90 C1072 90,1073 89,1074 87 L1076 89 Z" fill="#212121"/><path d="M1096 57 L1094 63 L1089 63 L1090 57 L1096 57 Z M1089 85 C1089 86,1089 87,1089 88 C1089 88,1089 89,1089 89 C1089 90,1089 90,1089 91 C1089 91,1090 91,1090 91 C1091 91,1091 91,1091 91 C1092 91,1092 91,1092 90 C1093 90,1093 90,1093 89 C1094 89,1094 88,1095 88 L1097 90 C1096 91,1095 92,1094 92 C1093 93,1093 93,1092 94 C1091 94,1091 95,1090 95 C1089 95,1089 95,1088 95 C1087 95,1087 95,1086 95 C1086 95,1085 94,1085 94 C1084 93,1084 93,1084 92 C1084 92,1083 91,1083 90 C1083 90,1084 89,1084 88 C1084 87,1084 86,1084 85 C1085 84,1085 83,1085 82 C1085 81,1086 80,1086 79 C1086 78,1086 77,1086 76 C1087 75,1087 74,1087 73 C1087 73,1087 73,1087 72 C1087 72,1087 72,1087 72 C1087 71,1087 71,1086 71 C1086 70,1085 70,1084 70 L1084 68 L1092 68 L1093 68 L1089 85 Z" fill="#212121"/><path d="M1111 95 C1110 95,1108 95,1107 94 C1106 94,1105 93,1104 93 C1103 92,1103 91,1102 90 C1102 89,1101 87,1101 86 C1101 83,1102 81,1103 79 C1104 77,1105 75,1106 73 C1107 72,1109 70,1111 69 C1113 69,1115 68,1117 68 C1119 68,1120 68,1121 69 C1123 69,1124 70,1125 71 C1125 72,1126 73,1126 74 C1127 75,1127 76,1127 78 C1127 80,1127 83,1126 85 C1125 87,1124 89,1122 90 C1121 92,1119 93,1117 94 C1115 95,1113 95,1111 95 L1111 95 Z M1107 86 C1107 88,1107 90,1108 91 C1109 92,1110 92,1112 92 C1113 92,1114 92,1115 91 C1116 91,1116 90,1117 90 C1118 89,1118 88,1119 87 C1120 86,1120 85,1120 84 C1121 83,1121 82,1121 80 C1122 79,1122 78,1122 77 C1122 75,1121 74,1120 73 C1120 72,1118 71,1117 71 C1116 71,1115 71,1114 72 C1113 72,1112 73,1112 73 C1111 74,1110 75,1110 76 C1109 77,1108 78,1108 79 C1108 80,1107 82,1107 83 C1107 84,1107 85,1107 86 L1107 86 Z" fill="#212121"/><path d="M1144 75 C1146 73,1147 71,1149 70 C1151 69,1153 68,1154 68 C1156 68,1158 69,1159 70 C1160 71,1160 72,1160 74 C1160 74,1160 75,1160 76 C1160 77,1159 78,1159 79 C1159 80,1159 81,1158 82 C1158 83,1158 85,1157 85 C1157 86,1157 87,1157 88 C1157 89,1157 89,1157 89 C1157 90,1157 90,1157 91 C1157 91,1158 91,1158 91 C1159 91,1159 91,1159 91 C1160 91,1160 91,1160 90 C1161 90,1161 90,1161 89 C1162 89,1162 88,1163 88 L1165 89 C1164 91,1163 91,1162 92 C1162 93,1161 93,1160 94 C1160 94,1159 95,1158 95 C1157 95,1157 95,1156 95 C1155 95,1155 95,1154 95 C1154 95,1153 94,1153 94 C1152 93,1152 93,1152 92 C1152 92,1152 91,1152 90 C1152 90,1152 89,1152 88 C1152 87,1152 86,1152 85 C1153 84,1153 83,1153 82 C1154 81,1154 80,1154 79 C1154 78,1154 78,1155 77 C1155 76,1155 76,1155 75 C1155 74,1155 73,1154 73 C1154 72,1153 72,1152 72 C1152 72,1151 72,1150 72 C1150 73,1149 73,1148 74 C1148 74,1147 75,1147 75 C1146 76,1145 77,1145 77 C1144 78,1144 79,1144 80 C1143 81,1143 81,1143 82 L1140 95 L1135 95 L1139 78 C1139 77,1139 77,1139 76 C1139 75,1139 74,1139 74 C1139 73,1139 72,1138 72 C1137 72,1137 72,1137 72 C1136 72,1136 73,1136 73 C1135 73,1135 74,1134 74 C1134 74,1134 75,1133 75 L1131 74 C1132 73,1133 72,1134 71 C1134 70,1135 70,1136 69 C1136 69,1137 69,1138 68 C1138 68,1139 68,1140 68 C1141 68,1142 69,1143 69 C1144 70,1144 71,1144 73 C1144 73,1144 74,1144 74 C1144 74,1144 75,1144 75 L1144 75 Z" fill="#212121"/><path d="M1188 19 L1188 21 C1187 21,1186 22,1185 22 C1185 23,1184 23,1184 24 C1184 25,1184 26,1184 28 C1184 28,1184 29,1184 31 L1185 58 L1185 61 L1185 61 L1201 32 C1202 31,1203 29,1203 28 C1203 27,1204 26,1204 25 C1204 23,1202 22,1200 21 L1200 19 L1215 19 L1215 21 C1214 21,1214 21,1213 22 C1212 22,1212 23,1211 24 C1210 25,1209 27,1208 29 L1184 70 L1179 70 L1177 29 C1177 28,1177 26,1176 25 C1176 24,1176 23,1175 22 C1175 22,1174 21,1172 21 L1173 19 L1188 19 Z" fill="#212121"/><path d="M1221 36 L1222 34 C1222 34,1222 34,1223 34 C1223 34,1223 34,1224 34 C1224 33,1224 33,1224 33 C1224 33,1225 32,1225 32 C1225 32,1225 31,1225 30 C1225 30,1226 29,1226 28 L1231 4 L1227 4 C1227 4,1226 4,1226 4 C1226 4,1225 4,1225 4 C1224 5,1224 5,1224 5 C1224 5,1223 6,1223 6 C1223 7,1222 7,1222 8 C1222 9,1221 9,1221 10 L1218 10 L1220 1 L1249 1 L1247 11 L1244 11 L1244 9 C1244 9,1244 9,1244 8 C1244 8,1244 8,1244 7 C1244 7,1244 6,1244 6 C1244 6,1244 6,1244 5 C1243 5,1243 5,1243 5 C1243 5,1243 4,1243 4 C1242 4,1242 4,1242 4 C1242 4,1241 4,1241 4 L1236 4 L1231 28 C1231 29,1231 30,1231 30 C1230 31,1230 32,1230 32 C1230 32,1230 33,1231 33 C1231 33,1231 33,1231 34 C1231 34,1232 34,1232 34 C1232 34,1233 34,1233 34 L1233 36 L1221 36 Z" fill="#212121"/><path d="M1271 51 C1271 42,1270 36,1267 30 C1264 25,1260 21,1254 19 L1255 16 C1262 18,1268 22,1271 28 C1275 35,1277 42,1277 51 C1277 60,1275 68,1271 74 C1268 80,1262 84,1255 86 L1254 83 C1260 81,1264 78,1267 72 C1270 67,1271 59,1271 51 L1271 51 Z" fill="#212121"/></svg></span></p>
<p class="p_Text"><span class="f_Text">First, let's propagate the error gradient to the level of the dependency coefficient matrix </span><span class="f_Text" style="font-style: italic;">Score</span><span class="f_Text">. Since, thanks to the division of operations into parallel threads within the kernel, we will be determining the error gradient for only one row, to calculate this error gradient vector, we need to take the error gradient vector for one element of the sequence at the level of the </span><span class="f_Text" style="font-style: italic;">Self-Attention</span><span class="f_Text"> block results and multiply it by the transposed tensor of the internal layer's results, </span><span class="f_Text" style="font-style: italic;">m_cValues</span><span class="f_Text">. In practice, we will use the algorithm described above when calculating error gradients for the </span><span class="f_Text" style="font-style: italic;">m_cValues </span><span class="f_Text">layer. We will create a system of two nested loops. But this time, the number of iterations of the outer loop will be equal to the number of elements in the sequence. The nested loop will repeat its operations for the number of elements in the vector describing one element of the sequence. This difference is explained by the magnitude of the vector of results and is confirmed by the logic of the operations performed. Remember, with a forward pass, each element in the row of the dependency coefficient matrix corresponds to one vector describing the sequence element in the </span><span class="f_Text" style="font-style: italic;">Values</span><span class="f_Text"> tensor.</span></p>
<div style="text-align: left; text-indent: 0; line-height: 1.0; page-break-inside: avoid; page-break-after: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0 0 0 0; margin: 2px 17px 2px 17px;"><table cellspacing="0" cellpadding="3" border="0" style="text-align: justify;border:none; border-spacing:0;">
<tr>
<td style="vertical-align:top; padding:3px; border:none"><p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample" style="color: #808080;">//---&nbsp;Gradient&nbsp;distribution&nbsp;on&nbsp;Score</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">for</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #0000ff;">int</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #333333;">k</span><span class="f_CodeExample">&nbsp;=&nbsp;</span><span class="f_Normal" style="font-family: Arial,Helvetica,sans-serif; color: #000000; background-color: transparent;">0</span><span class="f_CodeExample">;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">k</span><span class="f_CodeExample">&nbsp;&lt;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">units</span><span class="f_CodeExample">;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">k</span><span class="f_CodeExample">++)</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_Definition">TYPE</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #333333;">grad</span><span class="f_CodeExample">&nbsp;=&nbsp;</span><span class="f_Normal" style="font-family: Arial,Helvetica,sans-serif; color: #000000; background-color: transparent;">0</span><span class="f_CodeExample">;</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">for</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #0000ff;">int</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #333333;">i</span><span class="f_CodeExample">&nbsp;=&nbsp;</span><span class="f_Normal" style="font-family: Arial,Helvetica,sans-serif; color: #000000; background-color: transparent;">0</span><span class="f_CodeExample">;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">i</span><span class="f_CodeExample">&nbsp;&lt;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">window</span><span class="f_CodeExample">;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">i</span><span class="f_CodeExample">++)</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">grad</span><span class="f_CodeExample">&nbsp;+=&nbsp;</span><span class="f_CodeExample" style="color: #333333;">outputs_grad</span><span class="f_CodeExample">[</span><span class="f_CodeExample" style="color: #333333;">shift_value</span><span class="f_CodeExample">&nbsp;+&nbsp;</span><span class="f_CodeExample" style="color: #333333;">i</span><span class="f_CodeExample">]&nbsp;*&nbsp;</span><span class="f_CodeExample" style="color: #333333;">values</span><span class="f_CodeExample">[</span><span class="f_CodeExample" style="color: #333333;">window</span><span class="f_CodeExample">&nbsp;*&nbsp;</span><span class="f_CodeExample" style="color: #333333;">k</span><span class="f_CodeExample">&nbsp;+&nbsp;</span><span class="f_CodeExample" style="color: #333333;">i</span><span class="f_CodeExample">];</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">scores_temp</span><span class="f_CodeExample">[</span><span class="f_CodeExample" style="color: #333333;">shift_score</span><span class="f_CodeExample">&nbsp;+&nbsp;</span><span class="f_CodeExample" style="color: #333333;">k</span><span class="f_CodeExample">]&nbsp;=&nbsp;</span><span class="f_CodeExample" style="color: #333333;">grad</span><span class="f_CodeExample">;</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></p>
</td>
</tr>
</table>
</div>
<p class="p_Text"><span class="f_Text">After transferring the error gradient to the level of the dependency coefficient matrix, we need to adjust the obtained values using the derivative of the </span><span class="f_Text" style="font-style: italic;">Softmax</span><span class="f_Text"> normalization function. Just like with the forward pass, when in order to obtain one normalized value it was necessary to process the entire vector of normalized values, to calculate one adjusted value we need to use all the elements of both vectors (error gradients at the level of the matrix of dependence coefficients and the normalized vector of coefficients itself).</span></p>
<p class="p_Text"><span class="f_Text">The matrix expression of the process of adjusting for the derivative of the </span><span class="f_Text" style="font-style: italic;">Softmax</span><span class="f_Text"> function is given above. For practical implementation, we will create a system of two nested loops. Both loops have the same number of iterations, which is equal to the size of the vector being normalized. In this case, it is equal to the number of elements in the sequence. When performing operations, it will be necessary to accumulate the sum of error gradients from each element of the normalized vector. To do this, we will create a private variable in the body of the outer loop </span><span class="f_Text" style="font-style: italic;">grad. </span><span class="f_Text">Besides, to reduce the number of accesses to global memory, we will store the repeated element in the private variable </span><span class="f_Text" style="font-style: italic;">score.</span><span class="f_Text"> Let me remind you that accessing global memory is more time-consuming. So, by reducing the number of accesses to global memory buffers, we reduce the overall time spent on operations. In the body of the nested loop, we will perform operations of multiplying elements and adding the resulting products into a previously created private variable </span><span class="f_Text" style="font-style: italic;">grad</span><span class="f_Text">.</span></p>
<p class="p_Text"><span class="f_Text">Please note that we have replaced the identity matrix with the expression (</span><span class="f_Text" style="font-style: italic;">int)(i==k).</span><span class="f_Text"> The logical expression will give us the true value only on the diagonal of the matrix. Translating a boolean value into an integer will substitute 1 for true values and 0 for false values. Thus, such a short notation allows us to obtain the values of the identity matrix directly in the operation thread, without the need to first generate and save it.</span></p>
<div style="text-align: left; text-indent: 0; line-height: 1.0; page-break-inside: avoid; page-break-after: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0 0 0 0; margin: 2px 17px 2px 17px;"><table cellspacing="0" cellpadding="3" border="0" style="text-align: justify;border:none; border-spacing:0;">
<tr>
<td style="vertical-align:top; padding:3px; border:none"><p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample" style="color: #808080;">//---&nbsp;Adjust&nbsp;for&nbsp;the&nbsp;Softmax&nbsp;derivative</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">for</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #0000ff;">int</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #333333;">k</span><span class="f_CodeExample">&nbsp;=&nbsp;</span><span class="f_Normal" style="font-family: Arial,Helvetica,sans-serif; color: #000000; background-color: transparent;">0</span><span class="f_CodeExample">;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">k</span><span class="f_CodeExample">&nbsp;&lt;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">units</span><span class="f_CodeExample">;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">k</span><span class="f_CodeExample">++)</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_Definition">TYPE</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #333333;">grad</span><span class="f_CodeExample">&nbsp;=&nbsp;</span><span class="f_Normal" style="font-family: Arial,Helvetica,sans-serif; color: #000000; background-color: transparent;">0</span><span class="f_CodeExample">;</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_Definition">TYPE</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #333333;">score</span><span class="f_CodeExample">&nbsp;=&nbsp;</span><span class="f_CodeExample" style="color: #333333;">scores</span><span class="f_CodeExample">[</span><span class="f_CodeExample" style="color: #333333;">shift_score</span><span class="f_CodeExample">&nbsp;+&nbsp;</span><span class="f_CodeExample" style="color: #333333;">k</span><span class="f_CodeExample">];</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">for</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #0000ff;">int</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #333333;">i</span><span class="f_CodeExample">&nbsp;=&nbsp;</span><span class="f_Normal" style="font-family: Arial,Helvetica,sans-serif; color: #000000; background-color: transparent;">0</span><span class="f_CodeExample">;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">i</span><span class="f_CodeExample">&nbsp;&lt;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">units</span><span class="f_CodeExample">;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">i</span><span class="f_CodeExample">++)</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">grad</span><span class="f_CodeExample">&nbsp;+=&nbsp;</span><span class="f_CodeExample" style="color: #333333;">scores</span><span class="f_CodeExample">[</span><span class="f_CodeExample" style="color: #333333;">shift_score</span><span class="f_CodeExample">&nbsp;+&nbsp;</span><span class="f_CodeExample" style="color: #333333;">i</span><span class="f_CodeExample">]&nbsp;*</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((</span><span class="f_CodeExample" style="color: #0000ff;">int</span><span class="f_CodeExample">)(</span><span class="f_CodeExample" style="color: #333333;">i</span><span class="f_CodeExample">&nbsp;==&nbsp;</span><span class="f_CodeExample" style="color: #333333;">k</span><span class="f_CodeExample">)&nbsp;-&nbsp;</span><span class="f_CodeExample" style="color: #333333;">score</span><span class="f_CodeExample">)&nbsp;*&nbsp;</span><span class="f_CodeExample" style="color: #333333;">scores_temp</span><span class="f_CodeExample">[</span><span class="f_CodeExample" style="color: #333333;">shift_score</span><span class="f_CodeExample">&nbsp;+&nbsp;</span><span class="f_CodeExample" style="color: #333333;">i</span><span class="f_CodeExample">];</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">scores_grad</span><span class="f_CodeExample">[</span><span class="f_CodeExample" style="color: #333333;">shift_score</span><span class="f_CodeExample">&nbsp;+&nbsp;</span><span class="f_CodeExample" style="color: #333333;">k</span><span class="f_CodeExample">]&nbsp;=&nbsp;</span><span class="f_CodeExample" style="color: #333333;">grad</span><span class="f_CodeExample">;</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;}</span></p>
</td>
</tr>
</table>
</div>
<p class="p_Text"><span class="f_Text">After completing the iterations of the loop system, we will obtain the error gradients at the level of the dependency coefficient matrix, adjusted for the derivative of the </span><span class="f_Text" style="font-style: italic;">Softmax</span><span class="f_Text"> function.</span></p>
<p class="p_Text"><span class="f_Text">With that, we conclude the first backpropagation kernel and move on to creating the second kernel </span><span class="f_Text" style="font-style: italic;">AttentionCalcHiddenGradient</span><span class="f_Text">, in which we will propagate the error gradient to the internal neural layers </span><span class="f_Text" style="font-style: italic;">m_cQuerys </span><span class="f_Text">and </span><span class="f_Text" style="font-style: italic;">m_cKeys</span><span class="f_Text">. To do this, in the kernel parameters we need to pass pointers to five data buffers and one constant:</span></p>
<ul style="list-style-type:disc">
<li class="p_li"><span class="f_li" style="font-style: italic;">querys</span><span class="f_li">  buffer of results of the internal neural layer </span><span class="f_li" style="font-style: italic;">m_cQuerys</span></li>
<li class="p_li"><span class="f_li" style="font-style: italic;">queries_grad</span><span class="f_li">  buffer of error gradients of the internal neural layer </span><span class="f_li" style="font-style: italic;">m_cQuerys</span></li>
<li class="p_li"><span class="f_li" style="font-style: italic;">keys</span><span class="f_li">  buffer of results of the internal neural layer </span><span class="f_li" style="font-style: italic;">m_cKeys</span></li>
<li class="p_li"><span class="f_li" style="font-style: italic;">keys_grad</span><span class="f_li">  buffer of error gradients of the internal neural layer </span><span class="f_li" style="font-style: italic;">m_cKeys</span></li>
<li class="p_li"><span class="f_li" style="font-style: italic;">scores_grad</span><span class="f_li">  buffer of error gradients of dependency coefficient matrix </span><span class="f_li" style="font-style: italic;">m_cScores</span></li>
<li class="p_li"><span class="f_li" style="font-style: italic;">key_size</span><span class="f_li">  size of the key vector of one element</span></li>
</ul>
<div style="text-align: left; text-indent: 0; line-height: 1.0; page-break-inside: avoid; page-break-after: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0 0 0 0; margin: 2px 17px 2px 17px;"><table cellspacing="0" cellpadding="3" border="0" style="text-align: justify;border:none; border-spacing:0;">
<tr>
<td style="vertical-align:top; padding:3px; border:none"><p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample" style="color: #0000ff;">__kernel</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">void</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #333333;">AttentionCalcHiddenGradient</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #0000ff;">__global</span><span class="f_CodeExample">&nbsp;</span><span class="f_Definition">TYPE</span><span class="f_CodeExample">&nbsp;*</span><span class="f_CodeExample" style="color: #333333;">querys</span><span class="f_CodeExample">,</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">__global</span><span class="f_CodeExample">&nbsp;</span><span class="f_Definition">TYPE</span><span class="f_CodeExample">&nbsp;*</span><span class="f_CodeExample" style="color: #333333;">querys_grad</span><span class="f_CodeExample">,</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">__global</span><span class="f_CodeExample">&nbsp;</span><span class="f_Definition">TYPE</span><span class="f_CodeExample">&nbsp;*</span><span class="f_CodeExample" style="color: #333333;">keys</span><span class="f_CodeExample">,</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">__global</span><span class="f_CodeExample">&nbsp;</span><span class="f_Definition">TYPE</span><span class="f_CodeExample">&nbsp;*</span><span class="f_CodeExample" style="color: #333333;">keys_grad</span><span class="f_CodeExample">,</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">__global</span><span class="f_CodeExample">&nbsp;</span><span class="f_Definition">TYPE</span><span class="f_CodeExample">&nbsp;*</span><span class="f_CodeExample" style="color: #333333;">scores_grad</span><span class="f_CodeExample">,</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">int</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #333333;">key_size</span><span class="f_CodeExample">)</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;{</span></p>
</td>
</tr>
</table>
</div>
<p class="p_Text"><span class="f_Text">Following the analogy with all the kernels discussed earlier, we will distribute the operations into threads in the context of a single element of the sequence. At the beginning of the kernel, we will perform preparatory work and determine the offsets in the data buffers to the first element of the vector of the analyzed element.</span></p>
<div style="text-align: left; text-indent: 0; line-height: 1.0; page-break-inside: avoid; page-break-after: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0 0 0 0; margin: 2px 17px 2px 17px;"><table cellspacing="0" cellpadding="3" border="0" style="text-align: justify;border:none; border-spacing:0;">
<tr>
<td style="vertical-align:top; padding:3px; border:none"><p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">const</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">int</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #333333;">q</span><span class="f_CodeExample">&nbsp;=&nbsp;</span><span class="f_Functions">get_global_id</span><span class="f_CodeExample">(</span><span class="f_Normal" style="font-family: Arial,Helvetica,sans-serif; color: #000000; background-color: transparent;">0</span><span class="f_CodeExample">);</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">const</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">int</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #333333;">units</span><span class="f_CodeExample">&nbsp;=&nbsp;</span><span class="f_Functions">get_global_size</span><span class="f_CodeExample">(</span><span class="f_Normal" style="font-family: Arial,Helvetica,sans-serif; color: #000000; background-color: transparent;">0</span><span class="f_CodeExample">);</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">int</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #333333;">shift_query</span><span class="f_CodeExample">&nbsp;=&nbsp;</span><span class="f_CodeExample" style="color: #333333;">key_size</span><span class="f_CodeExample">&nbsp;*&nbsp;</span><span class="f_CodeExample" style="color: #333333;">q</span><span class="f_CodeExample">;</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">int</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #333333;">shift_score</span><span class="f_CodeExample">&nbsp;=&nbsp;</span><span class="f_CodeExample" style="color: #333333;">units</span><span class="f_CodeExample">&nbsp;*&nbsp;</span><span class="f_CodeExample" style="color: #333333;">q</span><span class="f_CodeExample">;</span></p>
</td>
</tr>
</table>
</div>
<p class="p_Text"><span class="f_Text">In the </span><span class="f_Text" style="font-style: italic;">AttentionCalcScoreGradient</span><span class="f_Text"> kernel discussed above, we have already adjusted the error gradient of the dependency coefficient matrix to the derivative of the </span><span class="f_Text" style="font-style: italic;">Softmax</span><span class="f_Text"> normalization function. However, during the feed-forward pass, before normalizing the matrix, we divided all its elements by the square root of the dimension of the key vector. Now we need to adjust the error gradient for the derivative of the mentioned operation. Similar to the multiplication operation, we will need to divide all the values of the error gradient buffer of the dependency coefficient matrix by the same constant.</span></p>
<p class="p_Text" style="text-align: center;"><span style="display:inline-block;width:343px;height:40px;padding:0 0;overflow:visible"><svg xmlns="http://www.w3.org/2000/svg" style="width:100%;height:100%;overflow:visible" viewBox="0 0 1372 160"><path d="M6 87 C6 68,9 52,14 39 C19 27,25 18,32 12 L34 15 C28 20,23 29,19 41 C15 54,13 69,13 87 C13 105,15 120,19 132 C23 144,28 153,34 159 L32 161 C25 156,19 146,14 134 C9 121,6 106,6 87 L6 87 Z" fill="#212121"/><path d="M188 34 C188 32,188 31,187 29 C187 27,187 25,186 24 C186 22,185 21,185 20 C185 20,185 20,184 19 C184 19,184 19,183 19 C183 19,182 19,182 19 C181 20,181 20,180 21 C180 21,179 22,178 23 L176 21 C178 19,179 18,180 17 C182 16,184 15,185 15 C186 15,187 15,187 15 C188 16,189 16,189 16 C189 17,190 17,190 18 C191 18,191 19,191 20 C192 21,192 22,192 24 C192 25,193 27,193 28 L193 28 C196 25,197 22,198 21 C200 19,201 18,202 17 C202 16,203 16,204 16 C205 15,206 15,207 15 C208 15,209 15,210 16 L208 23 L206 23 C206 22,205 21,205 21 C204 21,204 21,204 21 C204 21,203 21,203 22 C203 22,202 22,201 23 C201 24,200 25,199 26 C198 27,197 28,196 29 L194 32 C194 35,195 37,195 38 C196 40,196 42,196 43 C197 44,197 45,197 46 C197 46,198 47,198 47 C198 48,198 48,199 48 C199 48,199 48,200 48 C200 48,201 48,201 47 C202 47,203 46,204 44 L207 46 C205 48,203 50,202 51 C201 52,199 52,197 52 C196 52,195 52,194 51 C194 51,193 50,192 50 C192 49,191 47,191 46 C190 42,190 40,190 38 L189 38 C187 42,185 45,183 46 C182 48,181 49,180 50 C180 51,179 51,178 52 C177 52,176 52,175 52 C174 52,173 52,172 52 L174 44 L176 44 C176 45,177 46,177 46 C178 46,178 46,179 46 C179 46,179 45,180 44 C181 44,182 43,183 41 C184 40,186 37,188 34 L188 34 Z" fill="#212121"/><path d="M81 109 L78 118 L75 118 C75 115,74 113,73 112 C72 111,70 110,68 110 C64 110,61 112,58 115 C55 119,53 123,51 129 C50 135,49 140,49 145 C49 149,50 152,51 153 C52 155,54 156,57 156 C59 156,60 156,62 155 C63 155,64 154,66 152 C67 151,68 149,69 146 L73 146 L70 157 C66 158,61 159,56 159 C51 159,48 158,46 155 C43 152,42 149,42 143 C42 140,43 135,44 131 C45 126,47 122,49 118 C52 115,54 112,58 110 C61 108,64 107,68 107 C70 107,72 107,74 107 C76 108,78 108,81 109 L81 109 Z" fill="#212121"/><path d="M98 159 C94 159,91 158,89 156 C87 154,86 151,86 146 C86 145,86 142,87 140 C88 136,89 133,91 130 C93 128,95 126,97 124 C100 123,103 122,106 122 C110 122,113 123,115 125 C117 128,118 131,118 135 C118 138,117 141,116 144 C115 147,114 150,112 152 C111 155,109 156,106 157 C104 159,101 159,98 159 L98 159 Z M92 148 C92 151,93 153,94 154 C95 155,97 156,99 156 C102 156,104 155,106 153 C107 151,109 148,110 144 C111 140,112 136,112 133 C112 131,111 129,110 127 C109 126,107 125,105 125 C103 125,100 126,99 128 C97 131,95 134,94 138 C93 142,92 145,92 148 L92 148 Z" fill="#212121"/><path d="M132 134 C133 132,133 130,133 129 C133 128,133 127,132 127 C132 126,132 126,131 126 C130 126,129 126,128 127 C128 128,126 129,125 130 L123 128 C125 126,127 124,129 123 C130 123,132 122,134 122 C135 122,136 123,137 124 C138 125,139 126,139 127 C139 129,138 130,138 132 L138 132 C140 128,143 126,145 124 C147 123,149 122,152 122 C154 122,156 123,157 124 C158 125,159 127,159 130 C159 131,158 134,158 136 L155 146 C155 149,154 151,154 152 C154 153,154 154,155 154 C155 155,156 155,156 155 C157 155,158 155,159 154 C159 154,161 153,162 151 L164 153 C162 155,160 157,159 158 C157 159,155 159,153 159 C152 159,151 158,150 157 C149 156,148 155,148 153 C148 151,149 149,149 146 L151 139 C152 137,152 135,152 134 C152 133,152 132,152 131 C152 129,152 128,152 127 C151 126,150 126,149 126 C148 126,147 127,145 127 C144 128,143 129,142 131 C140 133,139 134,138 136 C138 138,137 140,136 142 L133 158 L127 158 L132 134 Z" fill="#212121"/><path d="M193 132 C192 130,192 128,190 127 C189 126,188 125,185 125 C183 125,182 126,180 127 C179 128,179 129,179 131 C179 132,179 132,179 133 C179 134,180 135,181 135 C182 136,183 137,185 138 C187 139,188 140,189 141 C190 142,191 143,191 143 C192 144,192 145,192 146 C192 147,193 148,193 149 C193 151,192 153,191 154 C190 156,188 157,186 158 C184 159,182 159,179 159 C177 159,175 159,173 159 C171 158,169 158,167 157 L169 149 L171 149 C172 151,172 153,173 154 C175 156,177 156,179 156 C182 156,183 156,185 155 C186 154,187 152,187 150 C187 149,186 148,186 147 C186 146,185 146,184 145 C183 144,182 143,180 142 C178 141,177 140,176 139 C175 138,174 137,174 136 C173 135,173 133,173 132 C173 130,173 128,174 127 C175 125,177 124,179 123 C181 123,183 122,185 122 C188 122,190 122,192 123 C194 123,195 123,197 124 L196 132 L193 132 Z" fill="#212121"/><path d="M225 151 C223 154,221 156,219 157 C217 158,215 159,213 159 C208 159,206 157,206 151 C206 150,206 148,206 146 L210 127 L204 127 L205 125 C206 125,207 125,208 125 C209 125,209 124,210 124 C210 124,211 123,211 122 C212 122,212 121,213 120 C213 119,214 117,214 114 L219 114 L217 123 L228 123 L228 127 L217 127 L213 141 C213 144,212 146,212 148 C212 149,212 150,212 150 C212 154,213 155,216 155 C217 155,218 155,219 154 C220 153,222 151,223 149 L225 151 Z" fill="#212121"/><path d="M261 125 L265 122 L267 123 L262 147 C261 149,261 151,261 152 C261 153,261 154,261 154 C262 155,262 155,263 155 C264 155,265 155,265 154 C266 154,267 153,269 151 L271 153 C269 155,267 157,265 158 C264 159,262 159,260 159 C259 159,258 159,257 158 C256 157,255 155,255 154 C255 153,256 151,256 150 L256 149 C253 153,251 155,249 157 C247 158,245 159,242 159 C240 159,238 158,236 156 C235 154,234 151,234 147 C234 143,235 139,236 135 C238 131,240 128,243 126 C246 123,249 122,253 122 C254 122,256 122,257 123 C259 123,260 124,261 125 L261 125 Z M258 136 C258 135,259 134,259 133 C259 132,259 132,259 131 C259 129,258 127,258 126 C257 126,255 125,253 125 C251 125,249 126,247 128 C245 130,243 133,242 137 C241 140,240 144,240 147 C240 150,241 152,241 153 C242 154,243 155,245 155 C247 155,248 154,250 153 C251 152,253 149,254 147 C256 144,257 141,258 137 L258 136 Z" fill="#212121"/><path d="M282 134 C283 132,283 130,283 129 C283 128,283 127,282 127 C282 126,282 126,281 126 C280 126,279 126,278 127 C278 128,276 129,275 130 L273 128 C275 126,277 124,279 123 C280 123,282 122,284 122 C285 122,286 123,287 124 C288 125,289 126,289 127 C289 129,288 130,288 132 L288 132 C290 128,293 126,295 124 C297 123,299 122,302 122 C304 122,306 123,307 124 C308 125,309 127,309 130 C309 131,308 134,308 136 L305 146 C305 149,304 151,304 152 C304 153,304 154,305 154 C305 155,306 155,306 155 C307 155,308 155,309 154 C309 154,311 153,312 151 L314 153 C312 155,310 157,309 158 C307 159,305 159,303 159 C302 159,301 158,300 157 C299 156,298 155,298 153 C298 151,299 149,299 146 L301 139 C302 137,302 135,302 134 C302 133,302 132,302 131 C302 129,302 128,302 127 C301 126,300 126,299 126 C298 126,297 127,295 127 C294 128,293 129,292 131 C290 133,289 134,288 136 C288 138,287 140,286 142 L283 158 L277 158 L282 134 Z" fill="#212121"/><path d="M340 151 C338 154,336 156,334 157 C332 158,330 159,328 159 C323 159,321 157,321 151 C321 150,321 148,321 146 L325 127 L319 127 L320 125 C321 125,322 125,323 125 C324 125,324 124,325 124 C325 124,326 123,326 122 C327 122,327 121,328 120 C328 119,329 117,329 114 L334 114 L332 123 L343 123 L343 127 L332 127 L328 141 C328 144,327 146,327 148 C327 149,327 150,327 150 C327 154,328 155,331 155 C332 155,333 155,334 154 C335 153,337 151,338 149 L340 151 Z" fill="#212121"/><rect x="37" y="84" width="308" height="5" fill="#212121"/><path d="M376 87 C376 106,373 121,368 134 C363 146,357 156,350 161 L348 159 C354 153,359 144,363 132 C367 120,369 105,369 87 C369 69,367 54,363 41 C359 29,354 20,348 15 L350 12 C357 18,363 27,368 39 C373 52,376 68,376 87 L376 87 Z" fill="#212121"/><path d="M393 0 L393 2 L384 24 L381 23 L386 0 L393 0 Z" fill="#212121"/><path d="M424 82 L424 77 L470 77 L470 82 L424 82 Z M424 97 L424 92 L470 92 L470 97 L424 97 Z" fill="#212121"/><path d="M502 87 C502 68,505 52,510 39 C515 27,521 18,528 12 L530 15 C524 20,519 29,515 41 C511 54,509 69,509 87 C509 105,511 120,515 132 C519 144,524 153,530 159 L528 161 C521 156,515 146,510 134 C505 121,502 106,502 87 L502 87 Z" fill="#212121"/><path d="M692 41 C692 43,692 44,692 44 C692 45,693 46,693 46 C693 47,694 47,695 47 C696 48,696 48,698 48 C699 48,700 48,702 48 L702 51 L675 51 L675 48 C678 48,680 48,681 48 C682 47,683 47,683 47 C684 46,684 46,685 45 C685 44,685 43,685 41 L685 11 C685 10,685 10,685 9 C684 9,684 9,683 9 C682 9,681 9,680 10 C678 11,677 12,675 13 L673 10 L690 0 L692 0 C692 2,692 6,692 10 L692 41 Z" fill="#212121"/><path d="M577 109 L574 118 L571 118 C571 115,570 113,569 112 C568 111,566 110,564 110 C560 110,557 112,554 115 C551 119,549 123,547 129 C546 135,545 140,545 145 C545 149,546 152,547 153 C548 155,550 156,553 156 C555 156,556 156,558 155 C559 155,560 154,562 152 C563 151,564 149,565 146 L569 146 L566 157 C562 158,557 159,552 159 C547 159,544 158,542 155 C539 152,538 149,538 143 C538 140,539 135,540 131 C541 126,543 122,545 118 C548 115,550 112,554 110 C557 108,560 107,564 107 C566 107,568 107,570 107 C572 108,574 108,577 109 L577 109 Z" fill="#212121"/><path d="M594 159 C590 159,587 158,585 156 C583 154,582 151,582 146 C582 145,582 142,583 140 C584 136,585 133,587 130 C589 128,591 126,593 124 C596 123,599 122,602 122 C606 122,609 123,611 125 C613 128,614 131,614 135 C614 138,613 141,612 144 C611 147,610 150,608 152 C607 155,605 156,602 157 C600 159,597 159,594 159 L594 159 Z M588 148 C588 151,589 153,590 154 C591 155,593 156,595 156 C598 156,600 155,602 153 C603 151,605 148,606 144 C607 140,608 136,608 133 C608 131,607 129,606 127 C605 126,603 125,601 125 C599 125,596 126,595 128 C593 131,591 134,590 138 C589 142,588 145,588 148 L588 148 Z" fill="#212121"/><path d="M628 134 C629 132,629 130,629 129 C629 128,629 127,628 127 C628 126,628 126,627 126 C626 126,625 126,624 127 C624 128,622 129,621 130 L619 128 C621 126,623 124,625 123 C626 123,628 122,630 122 C631 122,632 123,633 124 C634 125,635 126,635 127 C635 129,634 130,634 132 L634 132 C636 128,639 126,641 124 C643 123,645 122,648 122 C650 122,652 123,653 124 C654 125,655 127,655 130 C655 131,654 134,654 136 L651 146 C651 149,650 151,650 152 C650 153,650 154,651 154 C651 155,652 155,652 155 C653 155,654 155,655 154 C655 154,657 153,658 151 L660 153 C658 155,656 157,655 158 C653 159,651 159,649 159 C648 159,647 158,646 157 C645 156,644 155,644 153 C644 151,645 149,645 146 L647 139 C648 137,648 135,648 134 C648 133,648 132,648 131 C648 129,648 128,648 127 C647 126,646 126,645 126 C644 126,643 127,641 127 C640 128,639 129,638 131 C636 133,635 134,634 136 C634 138,633 140,632 142 L629 158 L623 158 L628 134 Z" fill="#212121"/><path d="M689 132 C688 130,688 128,686 127 C685 126,684 125,681 125 C679 125,678 126,676 127 C675 128,675 129,675 131 C675 132,675 132,675 133 C675 134,676 135,677 135 C678 136,679 137,681 138 C683 139,684 140,685 141 C686 142,687 143,687 143 C688 144,688 145,688 146 C688 147,689 148,689 149 C689 151,688 153,687 154 C686 156,684 157,682 158 C680 159,678 159,675 159 C673 159,671 159,669 159 C667 158,665 158,663 157 L665 149 L667 149 C668 151,668 153,669 154 C671 156,673 156,675 156 C678 156,679 156,681 155 C682 154,683 152,683 150 C683 149,682 148,682 147 C682 146,681 146,680 145 C679 144,678 143,676 142 C674 141,673 140,672 139 C671 138,670 137,670 136 C669 135,669 133,669 132 C669 130,669 128,670 127 C671 125,673 124,675 123 C677 123,679 122,681 122 C684 122,686 122,688 123 C690 123,691 123,693 124 L692 132 L689 132 Z" fill="#212121"/><path d="M721 151 C719 154,717 156,715 157 C713 158,711 159,709 159 C704 159,702 157,702 151 C702 150,702 148,702 146 L706 127 L700 127 L701 125 C702 125,703 125,704 125 C705 125,705 124,706 124 C706 124,707 123,707 122 C708 122,708 121,709 120 C709 119,710 117,710 114 L715 114 L713 123 L724 123 L724 127 L713 127 L709 141 C709 144,708 146,708 148 C708 149,708 150,708 150 C708 154,709 155,712 155 C713 155,714 155,715 154 C716 153,718 151,719 149 L721 151 Z" fill="#212121"/><path d="M757 125 L761 122 L763 123 L758 147 C757 149,757 151,757 152 C757 153,757 154,757 154 C758 155,758 155,759 155 C760 155,761 155,761 154 C762 154,763 153,765 151 L767 153 C765 155,763 157,761 158 C760 159,758 159,756 159 C755 159,754 159,753 158 C752 157,751 155,751 154 C751 153,752 151,752 150 L752 149 C749 153,747 155,745 157 C743 158,741 159,738 159 C736 159,734 158,732 156 C731 154,730 151,730 147 C730 143,731 139,732 135 C734 131,736 128,739 126 C742 123,745 122,749 122 C750 122,752 122,753 123 C755 123,756 124,757 125 L757 125 Z M754 136 C754 135,755 134,755 133 C755 132,755 132,755 131 C755 129,754 127,754 126 C753 126,751 125,749 125 C747 125,745 126,743 128 C741 130,739 133,738 137 C737 140,736 144,736 147 C736 150,737 152,737 153 C738 154,739 155,741 155 C743 155,744 154,746 153 C747 152,749 149,750 147 C752 144,753 141,754 137 L754 136 Z" fill="#212121"/><path d="M778 134 C779 132,779 130,779 129 C779 128,779 127,778 127 C778 126,778 126,777 126 C776 126,775 126,774 127 C774 128,772 129,771 130 L769 128 C771 126,773 124,775 123 C776 123,778 122,780 122 C781 122,782 123,783 124 C784 125,785 126,785 127 C785 129,784 130,784 132 L784 132 C786 128,789 126,791 124 C793 123,795 122,798 122 C800 122,802 123,803 124 C804 125,805 127,805 130 C805 131,804 134,804 136 L801 146 C801 149,800 151,800 152 C800 153,800 154,801 154 C801 155,802 155,802 155 C803 155,804 155,805 154 C805 154,807 153,808 151 L810 153 C808 155,806 157,805 158 C803 159,801 159,799 159 C798 159,797 158,796 157 C795 156,794 155,794 153 C794 151,795 149,795 146 L797 139 C798 137,798 135,798 134 C798 133,798 132,798 131 C798 129,798 128,798 127 C797 126,796 126,795 126 C794 126,793 127,791 127 C790 128,789 129,788 131 C786 133,785 134,784 136 C784 138,783 140,782 142 L779 158 L773 158 L778 134 Z" fill="#212121"/><path d="M836 151 C834 154,832 156,830 157 C828 158,826 159,824 159 C819 159,817 157,817 151 C817 150,817 148,817 146 L821 127 L815 127 L816 125 C817 125,818 125,819 125 C820 125,820 124,821 124 C821 124,822 123,822 122 C823 122,823 121,824 120 C824 119,825 117,825 114 L830 114 L828 123 L839 123 L839 127 L828 127 L824 141 C824 144,823 146,823 148 C823 149,823 150,823 150 C823 154,824 155,827 155 C828 155,829 155,830 154 C831 153,833 151,834 149 L836 151 Z" fill="#212121"/><rect x="533" y="84" width="308" height="5" fill="#212121"/><path d="M871 91 C871 89,871 88,870 86 C870 84,870 82,869 81 C869 79,868 78,868 77 C868 77,868 77,867 76 C867 76,867 76,866 76 C866 76,865 76,865 76 C864 77,864 77,863 78 C863 78,862 79,861 80 L859 78 C861 76,862 75,863 74 C865 73,867 72,868 72 C869 72,870 72,870 72 C871 73,872 73,872 73 C872 74,873 74,873 75 C874 75,874 76,874 77 C875 78,875 79,875 81 C875 82,876 84,876 85 L876 85 C879 82,880 79,881 78 C883 76,884 75,885 74 C885 73,886 73,887 73 C888 72,889 72,890 72 C891 72,892 72,893 73 L891 80 L889 80 C889 79,888 78,888 78 C887 78,887 78,887 78 C887 78,886 78,886 79 C886 79,885 79,884 80 C884 81,883 82,882 83 C881 84,880 85,879 86 L877 89 C877 92,878 94,878 95 C879 97,879 99,879 100 C880 101,880 102,880 103 C880 103,881 104,881 104 C881 105,881 105,882 105 C882 105,882 105,883 105 C883 105,884 105,884 104 C885 104,886 103,887 101 L890 103 C888 105,886 107,885 108 C884 109,882 109,880 109 C879 109,878 109,877 108 C877 108,876 107,875 107 C875 106,874 104,874 103 C873 99,873 97,873 95 L872 95 C870 99,868 102,866 103 C865 105,864 106,863 107 C863 108,862 108,861 109 C860 109,859 109,858 109 C857 109,856 109,855 109 L857 101 L859 101 C859 102,860 103,860 103 C861 103,861 103,862 103 C862 103,862 102,863 101 C864 101,865 100,866 98 C867 97,869 94,871 91 L871 91 Z" fill="#212121"/><path d="M927 87 C927 106,924 121,919 134 C914 146,908 156,901 161 L899 159 C905 153,910 144,914 132 C918 120,920 105,920 87 C920 69,918 54,914 41 C910 29,905 20,899 15 L901 12 C908 18,914 27,919 39 C924 52,927 68,927 87 L927 87 Z" fill="#212121"/><path d="M944 0 L944 2 L935 24 L932 23 L937 0 L944 0 Z" fill="#212121"/><path d="M975 82 L975 77 L1021 77 L1021 82 L975 82 Z M975 97 L975 92 L1021 92 L1021 97 L975 97 Z" fill="#212121"/><path d="M1206 41 C1206 43,1206 44,1206 44 C1206 45,1207 46,1207 46 C1207 47,1208 47,1209 47 C1210 48,1210 48,1212 48 C1213 48,1214 48,1216 48 L1216 51 L1189 51 L1189 48 C1192 48,1194 48,1195 48 C1196 47,1197 47,1197 47 C1198 46,1198 46,1199 45 C1199 44,1199 43,1199 41 L1199 11 C1199 10,1199 10,1199 9 C1198 9,1198 9,1197 9 C1196 9,1195 9,1194 10 C1192 11,1191 12,1189 13 L1187 10 L1204 0 L1206 0 C1206 2,1206 6,1206 10 L1206 41 Z" fill="#212121"/><path d="M1091 109 L1088 118 L1085 118 C1085 115,1084 113,1083 112 C1082 111,1080 110,1078 110 C1074 110,1071 112,1068 115 C1065 119,1063 123,1061 129 C1060 135,1059 140,1059 145 C1059 149,1060 152,1061 153 C1062 155,1064 156,1067 156 C1069 156,1070 156,1072 155 C1073 155,1074 154,1076 152 C1077 151,1078 149,1079 146 L1083 146 L1080 157 C1076 158,1071 159,1066 159 C1061 159,1058 158,1056 155 C1053 152,1052 149,1052 143 C1052 140,1053 135,1054 131 C1055 126,1057 122,1059 118 C1062 115,1064 112,1068 110 C1071 108,1074 107,1078 107 C1080 107,1082 107,1084 107 C1086 108,1088 108,1091 109 L1091 109 Z" fill="#212121"/><path d="M1108 159 C1104 159,1101 158,1099 156 C1097 154,1096 151,1096 146 C1096 145,1096 142,1097 140 C1098 136,1099 133,1101 130 C1103 128,1105 126,1107 124 C1110 123,1113 122,1116 122 C1120 122,1123 123,1125 125 C1127 128,1128 131,1128 135 C1128 138,1127 141,1126 144 C1125 147,1124 150,1122 152 C1121 155,1119 156,1116 157 C1114 159,1111 159,1108 159 L1108 159 Z M1102 148 C1102 151,1103 153,1104 154 C1105 155,1107 156,1109 156 C1112 156,1114 155,1116 153 C1117 151,1119 148,1120 144 C1121 140,1122 136,1122 133 C1122 131,1121 129,1120 127 C1119 126,1117 125,1115 125 C1113 125,1110 126,1109 128 C1107 131,1105 134,1104 138 C1103 142,1102 145,1102 148 L1102 148 Z" fill="#212121"/><path d="M1142 134 C1143 132,1143 130,1143 129 C1143 128,1143 127,1142 127 C1142 126,1142 126,1141 126 C1140 126,1139 126,1138 127 C1138 128,1136 129,1135 130 L1133 128 C1135 126,1137 124,1139 123 C1140 123,1142 122,1144 122 C1145 122,1146 123,1147 124 C1148 125,1149 126,1149 127 C1149 129,1148 130,1148 132 L1148 132 C1150 128,1153 126,1155 124 C1157 123,1159 122,1162 122 C1164 122,1166 123,1167 124 C1168 125,1169 127,1169 130 C1169 131,1168 134,1168 136 L1165 146 C1165 149,1164 151,1164 152 C1164 153,1164 154,1165 154 C1165 155,1166 155,1166 155 C1167 155,1168 155,1169 154 C1169 154,1171 153,1172 151 L1174 153 C1172 155,1170 157,1169 158 C1167 159,1165 159,1163 159 C1162 159,1161 158,1160 157 C1159 156,1158 155,1158 153 C1158 151,1159 149,1159 146 L1161 139 C1162 137,1162 135,1162 134 C1162 133,1162 132,1162 131 C1162 129,1162 128,1162 127 C1161 126,1160 126,1159 126 C1158 126,1157 127,1155 127 C1154 128,1153 129,1152 131 C1150 133,1149 134,1148 136 C1148 138,1147 140,1146 142 L1143 158 L1137 158 L1142 134 Z" fill="#212121"/><path d="M1203 132 C1202 130,1202 128,1200 127 C1199 126,1198 125,1195 125 C1193 125,1192 126,1190 127 C1189 128,1189 129,1189 131 C1189 132,1189 132,1189 133 C1189 134,1190 135,1191 135 C1192 136,1193 137,1195 138 C1197 139,1198 140,1199 141 C1200 142,1201 143,1201 143 C1202 144,1202 145,1202 146 C1202 147,1203 148,1203 149 C1203 151,1202 153,1201 154 C1200 156,1198 157,1196 158 C1194 159,1192 159,1189 159 C1187 159,1185 159,1183 159 C1181 158,1179 158,1177 157 L1179 149 L1181 149 C1182 151,1182 153,1183 154 C1185 156,1187 156,1189 156 C1192 156,1193 156,1195 155 C1196 154,1197 152,1197 150 C1197 149,1196 148,1196 147 C1196 146,1195 146,1194 145 C1193 144,1192 143,1190 142 C1188 141,1187 140,1186 139 C1185 138,1184 137,1184 136 C1183 135,1183 133,1183 132 C1183 130,1183 128,1184 127 C1185 125,1187 124,1189 123 C1191 123,1193 122,1195 122 C1198 122,1200 122,1202 123 C1204 123,1205 123,1207 124 L1206 132 L1203 132 Z" fill="#212121"/><path d="M1235 151 C1233 154,1231 156,1229 157 C1227 158,1225 159,1223 159 C1218 159,1216 157,1216 151 C1216 150,1216 148,1216 146 L1220 127 L1214 127 L1215 125 C1216 125,1217 125,1218 125 C1219 125,1219 124,1220 124 C1220 124,1221 123,1221 122 C1222 122,1222 121,1223 120 C1223 119,1224 117,1224 114 L1229 114 L1227 123 L1238 123 L1238 127 L1227 127 L1223 141 C1223 144,1222 146,1222 148 C1222 149,1222 150,1222 150 C1222 154,1223 155,1226 155 C1227 155,1228 155,1229 154 C1230 153,1232 151,1233 149 L1235 151 Z" fill="#212121"/><path d="M1271 125 L1275 122 L1277 123 L1272 147 C1271 149,1271 151,1271 152 C1271 153,1271 154,1271 154 C1272 155,1272 155,1273 155 C1274 155,1275 155,1275 154 C1276 154,1277 153,1279 151 L1281 153 C1279 155,1277 157,1275 158 C1274 159,1272 159,1270 159 C1269 159,1268 159,1267 158 C1266 157,1265 155,1265 154 C1265 153,1266 151,1266 150 L1266 149 C1263 153,1261 155,1259 157 C1257 158,1255 159,1252 159 C1250 159,1248 158,1246 156 C1245 154,1244 151,1244 147 C1244 143,1245 139,1246 135 C1248 131,1250 128,1253 126 C1256 123,1259 122,1263 122 C1264 122,1266 122,1267 123 C1269 123,1270 124,1271 125 L1271 125 Z M1268 136 C1268 135,1269 134,1269 133 C1269 132,1269 132,1269 131 C1269 129,1268 127,1268 126 C1267 126,1265 125,1263 125 C1261 125,1259 126,1257 128 C1255 130,1253 133,1252 137 C1251 140,1250 144,1250 147 C1250 150,1251 152,1251 153 C1252 154,1253 155,1255 155 C1257 155,1258 154,1260 153 C1261 152,1263 149,1264 147 C1266 144,1267 141,1268 137 L1268 136 Z" fill="#212121"/><path d="M1292 134 C1293 132,1293 130,1293 129 C1293 128,1293 127,1292 127 C1292 126,1292 126,1291 126 C1290 126,1289 126,1288 127 C1288 128,1286 129,1285 130 L1283 128 C1285 126,1287 124,1289 123 C1290 123,1292 122,1294 122 C1295 122,1296 123,1297 124 C1298 125,1299 126,1299 127 C1299 129,1298 130,1298 132 L1298 132 C1300 128,1303 126,1305 124 C1307 123,1309 122,1312 122 C1314 122,1316 123,1317 124 C1318 125,1319 127,1319 130 C1319 131,1318 134,1318 136 L1315 146 C1315 149,1314 151,1314 152 C1314 153,1314 154,1315 154 C1315 155,1316 155,1316 155 C1317 155,1318 155,1319 154 C1319 154,1321 153,1322 151 L1324 153 C1322 155,1320 157,1319 158 C1317 159,1315 159,1313 159 C1312 159,1311 158,1310 157 C1309 156,1308 155,1308 153 C1308 151,1309 149,1309 146 L1311 139 C1312 137,1312 135,1312 134 C1312 133,1312 132,1312 131 C1312 129,1312 128,1312 127 C1311 126,1310 126,1309 126 C1308 126,1307 127,1305 127 C1304 128,1303 129,1302 131 C1300 133,1299 134,1298 136 C1298 138,1297 140,1296 142 L1293 158 L1287 158 L1292 134 Z" fill="#212121"/><path d="M1350 151 C1348 154,1346 156,1344 157 C1342 158,1340 159,1338 159 C1333 159,1331 157,1331 151 C1331 150,1331 148,1331 146 L1335 127 L1329 127 L1330 125 C1331 125,1332 125,1333 125 C1334 125,1334 124,1335 124 C1335 124,1336 123,1336 122 C1337 122,1337 121,1338 120 C1338 119,1339 117,1339 114 L1344 114 L1342 123 L1353 123 L1353 127 L1342 127 L1338 141 C1338 144,1337 146,1337 148 C1337 149,1337 150,1337 150 C1337 154,1338 155,1341 155 C1342 155,1343 155,1344 154 C1345 153,1347 151,1348 149 L1350 151 Z" fill="#212121"/><rect x="1047" y="84" width="308" height="5" fill="#212121"/></svg></span></p>
<p class="p_Text"><span class="f_Text">Let's determine the value of the constant and store it in a private variable.</span></p>
<div style="text-align: left; text-indent: 0; line-height: 1.0; page-break-inside: avoid; page-break-after: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0 0 0 0; margin: 2px 17px 2px 17px;"><table cellspacing="0" cellpadding="3" border="0" style="text-align: justify;border:none; border-spacing:0;">
<tr>
<td style="vertical-align:top; padding:3px; border:none"><p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample" style="color: #808080;">//---&nbsp;Distribute&nbsp;the&nbsp;gradient&nbsp;on&nbsp;Querys&nbsp;and&nbsp;Keys</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">const</span><span class="f_CodeExample">&nbsp;</span><span class="f_Definition">TYPE</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #333333;">k</span><span class="f_CodeExample">&nbsp;=&nbsp;</span><span class="f_Normal" style="font-family: Arial,Helvetica,sans-serif; color: #000000; background-color: transparent;">1</span><span class="f_CodeExample">&nbsp;/&nbsp;</span><span class="f_Functions">sqrt</span><span class="f_CodeExample">((</span><span class="f_Definition">TYPE</span><span class="f_CodeExample">)</span><span class="f_CodeExample" style="color: #333333;">key_size</span><span class="f_CodeExample">);</span></p>
</td>
</tr>
</table>
</div>
<p class="p_Text"><span class="f_Text">This concludes the preparatory work. Now we can proceed directly to recalculating the error gradients. To obtain dependency coefficients, we multiplied two tensors (</span><span class="f_Text" style="font-style: italic;">Query </span><span class="f_Text"> and </span><span class="f_Text" style="font-style: italic;">Keys</span><span class="f_Text">). We have already encountered derivatives of multiplication operations more than once. To obtain error gradients for one of the tensors, we need to multiply the error gradient tensor at the level of the dependency coefficient matrix by the second tensor. Since the </span><span class="f_Text" style="font-style: italic;">Query</span><span class="f_Text"> and </span><span class="f_Text" style="font-style: italic;">Key</span><span class="f_Text"> tensors have the same dimensions, we can calculate the error gradients for both tensors in the same loop system.</span></p>
<p class="p_Text"><span class="f_Text">Let's create a system of two nested loops. The outer loop has a number of iterations equal to the size of the key vector of one sequence element. In the nested loop, we iterate through the vectors of the opposite tensor and the corresponding error gradients of the dependency coefficient matrix. Therefore, the number of its iterations will be equal to the number of elements in the analyzed sequence.</span></p>
<p class="p_Text"><span class="f_Text">As a result, the number of iterations in the nested loop will be equal to the number of elements in the analyzed sequence. The results of these products will need to be summarized. To accumulate this amount, we will create two private variables </span><span class="f_Text" style="font-style: italic;">grad_q</span><span class="f_Text"> and </span><span class="f_Text" style="font-style: italic;">grad_k</span><span class="f_Text"> before declaring the nested loop.</span></p>
<p class="p_Text"><span class="f_Text">Also, please note the following. To reduce the number of calculation operations, we will not add our previously calculated coefficient to adjust the error gradient to the products of the nested loop. We will use the mathematical properties of functions and take the constant factor out of brackets.</span></p>
<p class="p_Text" style="text-align: center;"><span style="display:inline-block;width:231px;height:17px;padding:0 0;overflow:visible"><svg xmlns="http://www.w3.org/2000/svg" style="width:100%;height:100%;overflow:visible" viewBox="0 0 924 68"><path d="M19 38 C19 37,19 36,19 36 C18 36,18 35,18 35 C17 35,17 35,16 35 L14 35 L10 53 L3 53 L13 11 C13 10,13 9,13 8 C14 7,14 7,14 6 C14 5,13 4,13 4 C12 3,11 3,9 3 L10 1 L19 1 L21 1 L14 33 L15 33 C17 33,19 32,21 31 C24 29,25 28,27 26 C28 25,29 23,29 22 C29 21,28 20,26 20 L27 18 L39 18 L39 20 C37 22,35 24,33 25 L24 33 L27 46 C28 47,28 48,28 49 C29 49,29 49,29 50 C29 50,30 50,30 50 C31 50,32 50,33 49 C33 48,34 47,36 46 L38 48 C35 50,34 52,32 53 C31 54,29 54,28 54 C26 54,25 54,24 53 C23 52,22 50,22 48 L19 38 Z" fill="#212121"/><path d="M72 20 L76 17 L78 18 L73 42 C72 44,72 46,72 47 C72 48,72 49,72 49 C73 50,73 50,74 50 C75 50,76 50,76 49 C77 49,78 48,80 46 L82 48 C80 50,78 52,76 53 C75 54,73 54,71 54 C70 54,69 54,68 53 C67 52,66 50,66 49 C66 48,67 46,67 45 L67 44 C64 48,62 50,60 52 C58 53,56 54,53 54 C51 54,49 53,47 51 C46 49,45 46,45 42 C45 38,46 34,47 30 C49 26,51 23,54 21 C57 18,60 17,64 17 C65 17,67 17,68 18 C70 18,71 19,72 20 L72 20 Z M69 31 C69 30,70 29,70 28 C70 27,70 27,70 26 C70 24,69 22,69 21 C68 21,66 20,64 20 C62 20,60 21,58 23 C56 25,54 28,53 32 C52 35,51 39,51 42 C51 45,52 47,52 48 C53 49,54 50,56 50 C58 50,59 49,61 48 C62 47,64 44,65 42 C67 39,68 36,69 32 L69 31 Z" fill="#212121"/><path d="M133 34 L133 55 L127 55 L127 34 L107 34 L107 29 L127 29 L127 8 L133 8 L133 29 L153 29 L153 34 L133 34 Z" fill="#212121"/><path d="M194 38 C194 37,194 36,194 36 C193 36,193 35,193 35 C192 35,192 35,191 35 L189 35 L185 53 L178 53 L188 11 C188 10,188 9,188 8 C189 7,189 7,189 6 C189 5,188 4,188 4 C187 3,186 3,184 3 L185 1 L194 1 L196 1 L189 33 L190 33 C192 33,194 32,196 31 C199 29,200 28,202 26 C203 25,204 23,204 22 C204 21,203 20,201 20 L202 18 L214 18 L214 20 C212 22,210 24,208 25 L199 33 L202 46 C203 47,203 48,203 49 C204 49,204 49,204 50 C204 50,205 50,205 50 C206 50,207 50,208 49 C208 48,209 47,211 46 L213 48 C210 50,209 52,207 53 C206 54,204 54,203 54 C201 54,200 54,199 53 C198 52,197 50,197 48 L194 38 Z" fill="#212121"/><path d="M225 52 L222 54 L219 53 L229 11 C229 9,230 7,230 6 C230 5,229 4,229 4 C228 3,227 3,225 3 L226 1 L235 1 L237 1 L231 26 L231 26 C234 23,236 21,238 19 C240 18,242 17,244 17 C247 17,249 18,250 20 C252 22,253 25,253 29 C253 33,252 37,250 41 C249 45,246 48,243 51 C241 53,237 54,234 54 C230 54,228 53,225 52 L225 52 Z M228 40 C228 42,228 44,228 45 C228 47,228 49,229 50 C230 51,231 51,233 51 C234 51,235 51,236 51 C237 50,238 50,239 49 C240 48,241 47,242 46 C242 45,243 43,244 41 C245 39,245 37,246 35 C246 33,246 31,246 29 C246 26,246 24,245 23 C244 22,243 21,242 21 C240 21,239 21,238 22 C237 23,236 24,234 26 C233 28,232 30,231 32 C230 33,229 36,229 39 L228 40 Z" fill="#212121"/><path d="M306 34 L306 55 L300 55 L300 34 L280 34 L280 29 L300 29 L300 8 L306 8 L306 29 L326 29 L326 34 L306 34 Z" fill="#212121"/><path d="M367 38 C367 37,367 36,367 36 C366 36,366 35,366 35 C365 35,365 35,364 35 L362 35 L358 53 L351 53 L361 11 C361 10,361 9,361 8 C362 7,362 7,362 6 C362 5,361 4,361 4 C360 3,359 3,357 3 L358 1 L367 1 L369 1 L362 33 L363 33 C365 33,367 32,369 31 C372 29,373 28,375 26 C376 25,377 23,377 22 C377 21,376 20,374 20 L375 18 L387 18 L387 20 C385 22,383 24,381 25 L372 33 L375 46 C376 47,376 48,376 49 C377 49,377 49,377 50 C377 50,378 50,378 50 C379 50,380 50,381 49 C381 48,382 47,384 46 L386 48 C383 50,382 52,380 53 C379 54,377 54,376 54 C374 54,373 54,372 53 C371 52,370 50,370 48 L367 38 Z" fill="#212121"/><path d="M417 27 C417 25,416 24,416 23 C416 22,415 21,415 21 C414 20,414 20,412 20 C410 20,408 21,406 23 C404 25,402 28,401 32 C400 36,399 39,399 42 C399 45,400 47,401 48 C402 49,403 50,405 50 C407 50,409 50,411 49 C412 48,414 47,416 45 L418 47 C416 50,414 51,411 52 C409 54,406 54,404 54 C400 54,397 53,396 51 C394 49,393 46,393 41 C393 39,393 36,394 33 C395 30,397 27,399 24 C400 22,403 20,405 19 C408 18,410 17,413 17 C417 17,419 17,422 18 L420 27 L417 27 Z" fill="#212121"/><path d="M452 27 L452 22 L498 22 L498 27 L452 27 Z M452 42 L452 37 L498 37 L498 42 L452 42 Z" fill="#212121"/><path d="M543 38 C543 37,543 36,543 36 C542 36,542 35,542 35 C541 35,541 35,540 35 L538 35 L534 53 L527 53 L537 11 C537 10,537 9,537 8 C538 7,538 7,538 6 C538 5,537 4,537 4 C536 3,535 3,533 3 L534 1 L543 1 L545 1 L538 33 L539 33 C541 33,543 32,545 31 C548 29,549 28,551 26 C552 25,553 23,553 22 C553 21,552 20,550 20 L551 18 L563 18 L563 20 C561 22,559 24,557 25 L548 33 L551 46 C552 47,552 48,552 49 C553 49,553 49,553 50 C553 50,554 50,554 50 C555 50,556 50,557 49 C557 48,558 47,560 46 L562 48 C559 50,558 52,556 53 C555 54,553 54,552 54 C550 54,549 54,548 53 C547 52,546 50,546 48 L543 38 Z" fill="#212121"/><path d="M580 35 C580 43,581 51,584 56 C587 62,591 65,597 67 L596 70 C589 68,583 64,580 58 C576 52,574 44,574 35 C574 26,576 19,580 12 C583 6,589 2,596 0 L597 3 C591 5,587 9,584 14 C581 20,580 26,580 35 L580 35 Z" fill="#212121"/><path d="M629 20 L633 17 L635 18 L630 42 C629 44,629 46,629 47 C629 48,629 49,629 49 C630 50,630 50,631 50 C632 50,633 50,633 49 C634 49,635 48,637 46 L639 48 C637 50,635 52,633 53 C632 54,630 54,628 54 C627 54,626 54,625 53 C624 52,623 50,623 49 C623 48,624 46,624 45 L624 44 C621 48,619 50,617 52 C615 53,613 54,610 54 C608 54,606 53,604 51 C603 49,602 46,602 42 C602 38,603 34,604 30 C606 26,608 23,611 21 C614 18,617 17,621 17 C622 17,624 17,625 18 C627 18,628 19,629 20 L629 20 Z M626 31 C626 30,627 29,627 28 C627 27,627 27,627 26 C627 24,626 22,626 21 C625 21,623 20,621 20 C619 20,617 21,615 23 C613 25,611 28,610 32 C609 35,608 39,608 42 C608 45,609 47,609 48 C610 49,611 50,613 50 C615 50,616 49,618 48 C619 47,621 44,622 42 C624 39,625 36,626 32 L626 31 Z" fill="#212121"/><path d="M690 34 L690 55 L684 55 L684 34 L664 34 L664 29 L684 29 L684 8 L690 8 L690 29 L710 29 L710 34 L690 34 Z" fill="#212121"/><path d="M741 52 L738 54 L735 53 L745 11 C745 9,746 7,746 6 C746 5,745 4,745 4 C744 3,743 3,741 3 L742 1 L751 1 L753 1 L747 26 L747 26 C750 23,752 21,754 19 C756 18,758 17,760 17 C763 17,765 18,766 20 C768 22,769 25,769 29 C769 33,768 37,766 41 C765 45,762 48,759 51 C757 53,753 54,750 54 C746 54,744 53,741 52 L741 52 Z M744 40 C744 42,744 44,744 45 C744 47,744 49,745 50 C746 51,747 51,749 51 C750 51,751 51,752 51 C753 50,754 50,755 49 C756 48,757 47,758 46 C758 45,759 43,760 41 C761 39,761 37,762 35 C762 33,762 31,762 29 C762 26,762 24,761 23 C760 22,759 21,758 21 C756 21,755 21,754 22 C753 23,752 24,750 26 C749 28,748 30,747 32 C746 33,745 36,745 39 L744 40 Z" fill="#212121"/><path d="M822 34 L822 55 L816 55 L816 34 L796 34 L796 29 L816 29 L816 8 L822 8 L822 29 L842 29 L842 34 L822 34 Z" fill="#212121"/><path d="M892 27 C892 25,891 24,891 23 C891 22,890 21,890 21 C889 20,889 20,887 20 C885 20,883 21,881 23 C879 25,877 28,876 32 C875 36,874 39,874 42 C874 45,875 47,876 48 C877 49,878 50,880 50 C882 50,884 50,886 49 C887 48,889 47,891 45 L893 47 C891 50,889 51,886 52 C884 54,881 54,879 54 C875 54,872 53,871 51 C869 49,868 46,868 41 C868 39,868 36,869 33 C870 30,872 27,874 24 C875 22,878 20,880 19 C883 18,885 17,888 17 C892 17,894 17,897 18 L895 27 L892 27 Z" fill="#212121"/><path d="M919 35 C919 26,918 20,915 14 C912 9,908 5,902 3 L903 0 C910 2,916 6,919 12 C923 19,925 26,925 35 C925 44,923 52,919 58 C916 64,910 68,903 70 L902 67 C908 65,912 62,915 56 C918 51,919 43,919 35 L919 35 Z" fill="#212121"/></svg></span></p>
<p class="p_Text"><span class="f_Text">Thus, there is no need to multiply the value each time by a correction factor in the body of the nested loop. Instead, we can simply multiply the total amount once by the correction factor before writing it to the data buffer.</span></p>
<div style="text-align: left; text-indent: 0; line-height: 1.0; page-break-inside: avoid; page-break-after: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0 0 0 0; margin: 2px 17px 2px 17px;"><table cellspacing="0" cellpadding="3" border="0" style="text-align: justify;border:none; border-spacing:0;">
<tr>
<td style="vertical-align:top; padding:3px; border:none"><p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">for</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #0000ff;">int</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #333333;">i</span><span class="f_CodeExample">&nbsp;=&nbsp;</span><span class="f_Normal" style="font-family: Arial,Helvetica,sans-serif; color: #000000; background-color: transparent;">0</span><span class="f_CodeExample">;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">i</span><span class="f_CodeExample">&nbsp;&lt;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">key_size</span><span class="f_CodeExample">;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">i</span><span class="f_CodeExample">++)</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_Definition">TYPE</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #333333;">grad_q</span><span class="f_CodeExample">&nbsp;=&nbsp;</span><span class="f_Normal" style="font-family: Arial,Helvetica,sans-serif; color: #000000; background-color: transparent;">0</span><span class="f_CodeExample">;</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_Definition">TYPE</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #333333;">grad_k</span><span class="f_CodeExample">&nbsp;=&nbsp;</span><span class="f_Normal" style="font-family: Arial,Helvetica,sans-serif; color: #000000; background-color: transparent;">0</span><span class="f_CodeExample">;</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">for</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #0000ff;">int</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #333333;">s</span><span class="f_CodeExample">&nbsp;=&nbsp;</span><span class="f_Normal" style="font-family: Arial,Helvetica,sans-serif; color: #000000; background-color: transparent;">0</span><span class="f_CodeExample">;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">s</span><span class="f_CodeExample">&nbsp;&lt;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">units</span><span class="f_CodeExample">;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">s</span><span class="f_CodeExample">++)</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">grad_q</span><span class="f_CodeExample">&nbsp;+=&nbsp;</span><span class="f_CodeExample" style="color: #333333;">keys</span><span class="f_CodeExample">[</span><span class="f_CodeExample" style="color: #333333;">key_size</span><span class="f_CodeExample">&nbsp;*&nbsp;</span><span class="f_CodeExample" style="color: #333333;">s</span><span class="f_CodeExample">&nbsp;+&nbsp;</span><span class="f_CodeExample" style="color: #333333;">i</span><span class="f_CodeExample">]&nbsp;*&nbsp;</span><span class="f_CodeExample" style="color: #333333;">scores_grad</span><span class="f_CodeExample">[</span><span class="f_CodeExample" style="color: #333333;">shift_score</span><span class="f_CodeExample">&nbsp;+&nbsp;</span><span class="f_CodeExample" style="color: #333333;">s</span><span class="f_CodeExample">];</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">grad_k</span><span class="f_CodeExample">&nbsp;+=&nbsp;</span><span class="f_CodeExample" style="color: #333333;">querys</span><span class="f_CodeExample">[</span><span class="f_CodeExample" style="color: #333333;">key_size</span><span class="f_CodeExample">&nbsp;*&nbsp;</span><span class="f_CodeExample" style="color: #333333;">s</span><span class="f_CodeExample">&nbsp;+&nbsp;</span><span class="f_CodeExample" style="color: #333333;">i</span><span class="f_CodeExample">]&nbsp;*&nbsp;</span><span class="f_CodeExample" style="color: #333333;">scores_grad</span><span class="f_CodeExample">[</span><span class="f_CodeExample" style="color: #333333;">units</span><span class="f_CodeExample">&nbsp;*&nbsp;</span><span class="f_CodeExample" style="color: #333333;">s</span><span class="f_CodeExample">&nbsp;+&nbsp;</span><span class="f_CodeExample" style="color: #333333;">q</span><span class="f_CodeExample">];</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">querys_grad</span><span class="f_CodeExample">[</span><span class="f_CodeExample" style="color: #333333;">shift_query</span><span class="f_CodeExample">&nbsp;+&nbsp;</span><span class="f_CodeExample" style="color: #333333;">i</span><span class="f_CodeExample">]&nbsp;=&nbsp;</span><span class="f_CodeExample" style="color: #333333;">grad_q</span><span class="f_CodeExample">&nbsp;*&nbsp;</span><span class="f_CodeExample" style="color: #333333;">k</span><span class="f_CodeExample">;</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">keys_grad</span><span class="f_CodeExample">[</span><span class="f_CodeExample" style="color: #333333;">shift_query</span><span class="f_CodeExample">&nbsp;+&nbsp;</span><span class="f_CodeExample" style="color: #333333;">i</span><span class="f_CodeExample">]&nbsp;=&nbsp;</span><span class="f_CodeExample" style="color: #333333;">grad_k</span><span class="f_CodeExample">&nbsp;*&nbsp;</span><span class="f_CodeExample" style="color: #333333;">k</span><span class="f_CodeExample">;</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;}</span></p>
</td>
</tr>
</table>
</div>
<p class="p_Text"><span class="f_Text">At the output of the loop system, we get error gradients for two nested internal neural layers </span><span class="f_Text" style="font-style: italic;">m_cQuerys</span><span class="f_Text"> and </span><span class="f_Text" style="font-style: italic;">m_cKeys</span><span class="f_Text">. That is, the task of this kernel is solved. Considering the previously discussed </span><span class="f_Text" style="font-style: italic;">AttentionCalcScoreGradient</span><span class="f_Text"> kernel, we have distributed the error gradient to all internal neural layers, and further distribution of the error gradient to the previous layer will be carried out using the well-tested methods of internal neural layers, as implemented by standard MQL5 means.</span></p>
<p class="p_Text"><span class="f_Text">The backpropagation kernels discussed above bypassed the processes of adding result buffers and data normalization that we carried out during the feed-forward pass. The derivative of two functions is equal to the sum of the derivatives of these functions. So, for the operation of adding gradients, we can use a similar feed-forward kernel. We just need to specify the correct data buffers.</span></p>
<p class="p_Text" style="text-align: center;"><span style="display:inline-block;width:285px;height:19px;padding:0 0;overflow:visible"><svg xmlns="http://www.w3.org/2000/svg" style="width:100%;height:100%;overflow:visible" viewBox="0 0 1140 76"><path d="M13 39 C13 47,14 55,17 60 C20 66,24 69,30 71 L29 74 C22 72,16 68,13 62 C9 56,7 48,7 39 C7 30,9 23,13 16 C16 10,22 6,29 4 L30 7 C24 9,20 13,17 18 C14 24,13 30,13 39 L13 39 Z" fill="#212121"/><path d="M47 58 C46 63,44 67,42 69 C39 72,36 73,33 73 C32 73,31 73,30 73 L31 70 C31 70,32 70,33 70 C34 70,35 70,36 69 C36 69,37 68,38 66 C38 65,39 63,40 61 L48 26 L41 26 L42 24 C44 24,45 24,45 24 C46 24,47 23,47 23 C48 23,48 22,48 22 C48 21,49 20,49 18 C51 14,53 11,55 8 C58 6,61 5,66 5 C68 5,70 5,72 6 L70 12 L67 12 C67 11,66 10,66 9 C65 8,64 8,63 8 C62 8,61 8,60 9 C59 10,58 11,57 12 C57 14,56 16,55 18 L54 22 L64 22 L63 26 L54 26 L47 58 Z" fill="#212121"/><path d="M87 39 C87 47,88 55,91 60 C94 66,98 69,104 71 L103 74 C96 72,90 68,87 62 C83 56,81 48,81 39 C81 30,83 23,87 16 C90 10,96 6,103 4 L104 7 C98 9,94 13,91 18 C88 24,87 30,87 39 L87 39 Z" fill="#212121"/><path d="M122 40 C122 38,122 37,121 35 C121 33,121 31,120 30 C120 28,119 27,119 26 C119 26,119 26,118 25 C118 25,118 25,117 25 C117 25,116 25,116 25 C115 26,115 26,114 27 C114 27,113 28,112 29 L110 27 C112 25,113 24,114 23 C116 22,118 21,119 21 C120 21,121 21,121 21 C122 22,123 22,123 22 C123 23,124 23,124 24 C125 24,125 25,125 26 C126 27,126 28,126 30 C126 31,127 33,127 34 L127 34 C130 31,131 28,132 27 C134 25,135 24,136 23 C136 22,137 22,138 22 C139 21,140 21,141 21 C142 21,143 21,144 22 L142 29 L140 29 C140 28,139 27,139 27 C138 27,138 27,138 27 C138 27,137 27,137 28 C137 28,136 28,135 29 C135 30,134 31,133 32 C132 33,131 34,130 35 L128 38 C128 41,129 43,129 44 C130 46,130 48,130 49 C131 50,131 51,131 52 C131 52,132 53,132 53 C132 54,132 54,133 54 C133 54,133 54,134 54 C134 54,135 54,135 53 C136 53,137 52,138 50 L141 52 C139 54,137 56,136 57 C135 58,133 58,131 58 C130 58,129 58,128 57 C128 57,127 56,126 56 C126 55,125 53,125 52 C124 48,124 46,124 44 L123 44 C121 48,119 51,117 52 C116 54,115 55,114 56 C114 57,113 57,112 58 C111 58,110 58,109 58 C108 58,107 58,106 58 L108 50 L110 50 C110 51,111 52,111 52 C112 52,112 52,113 52 C113 52,113 51,114 50 C115 50,116 49,117 47 C118 46,120 43,122 40 L122 40 Z" fill="#212121"/><path d="M165 39 C165 30,164 24,161 18 C158 13,154 9,148 7 L149 4 C156 6,162 10,165 16 C169 23,171 30,171 39 C171 48,169 56,165 62 C162 68,156 72,149 74 L148 71 C154 69,158 66,161 60 C164 55,165 47,165 39 L165 39 Z" fill="#212121"/><path d="M226 38 L226 59 L220 59 L220 38 L200 38 L200 33 L220 33 L220 12 L226 12 L226 33 L246 33 L246 38 L226 38 Z" fill="#212121"/><path d="M277 60 C277 61,276 61,276 62 C276 62,275 63,275 63 C275 64,275 64,275 65 C275 67,276 68,277 69 C278 70,280 70,283 70 C286 70,288 69,290 68 C292 67,294 65,295 62 C296 59,297 55,299 49 L298 49 C296 52,293 55,291 56 C289 57,287 58,285 58 C282 58,280 57,279 55 C277 53,276 50,276 46 C276 42,277 38,279 34 C281 30,283 27,286 25 C289 22,292 21,295 21 C297 21,298 21,300 22 C301 22,303 23,304 24 L307 21 L310 22 L306 39 C306 40,305 43,304 48 C303 53,302 57,302 59 C301 61,300 63,299 64 C298 66,297 68,296 69 C294 70,292 71,290 72 C288 73,286 73,283 73 C274 73,269 70,269 65 C269 64,270 63,270 62 C271 60,273 59,274 58 L277 60 Z M287 54 C289 54,290 54,291 53 C292 52,294 51,295 49 C297 47,298 45,298 43 C299 41,300 39,300 37 C301 34,301 32,301 30 C301 28,301 26,300 25 C299 25,298 24,296 24 C294 24,291 25,289 27 C287 29,286 32,285 36 C284 39,283 43,283 46 C283 49,283 51,284 52 C285 53,286 54,287 54 L287 54 Z" fill="#212121"/><path d="M328 39 C328 47,329 55,332 60 C335 66,339 69,345 71 L344 74 C337 72,331 68,328 62 C324 56,322 48,322 39 C322 30,324 23,328 16 C331 10,337 6,344 4 L345 7 C339 9,335 13,332 18 C329 24,328 30,328 39 L328 39 Z" fill="#212121"/><path d="M363 40 C363 38,363 37,362 35 C362 33,362 31,361 30 C361 28,360 27,360 26 C360 26,360 26,359 25 C359 25,359 25,358 25 C358 25,357 25,357 25 C356 26,356 26,355 27 C355 27,354 28,353 29 L351 27 C353 25,354 24,355 23 C357 22,359 21,360 21 C361 21,362 21,362 21 C363 22,364 22,364 22 C364 23,365 23,365 24 C366 24,366 25,366 26 C367 27,367 28,367 30 C367 31,368 33,368 34 L368 34 C371 31,372 28,373 27 C375 25,376 24,377 23 C377 22,378 22,379 22 C380 21,381 21,382 21 C383 21,384 21,385 22 L383 29 L381 29 C381 28,380 27,380 27 C379 27,379 27,379 27 C379 27,378 27,378 28 C378 28,377 28,376 29 C376 30,375 31,374 32 C373 33,372 34,371 35 L369 38 C369 41,370 43,370 44 C371 46,371 48,371 49 C372 50,372 51,372 52 C372 52,373 53,373 53 C373 54,373 54,374 54 C374 54,374 54,375 54 C375 54,376 54,376 53 C377 53,378 52,379 50 L382 52 C380 54,378 56,377 57 C376 58,374 58,372 58 C371 58,370 58,369 57 C369 57,368 56,367 56 C367 55,366 53,366 52 C365 48,365 46,365 44 L364 44 C362 48,360 51,358 52 C357 54,356 55,355 56 C355 57,354 57,353 58 C352 58,351 58,350 58 C349 58,348 58,347 58 L349 50 L351 50 C351 51,352 52,352 52 C353 52,353 52,354 52 C354 52,354 51,355 50 C356 50,357 49,358 47 C359 46,361 43,363 40 L363 40 Z" fill="#212121"/><path d="M406 39 C406 30,405 24,402 18 C399 13,395 9,389 7 L390 4 C397 6,403 10,406 16 C410 23,412 30,412 39 C412 48,410 56,406 62 C403 68,397 72,390 74 L389 71 C395 69,399 66,402 60 C405 55,406 47,406 39 L406 39 Z" fill="#212121"/><path d="M437 39 C437 30,436 24,433 18 C430 13,426 9,420 7 L421 4 C428 6,434 10,437 16 C441 23,443 30,443 39 C443 48,441 56,437 62 C434 68,428 72,421 74 L420 71 C426 69,430 66,433 60 C436 55,437 47,437 39 L437 39 Z" fill="#212121"/><path d="M466 0 L466 2 L457 23 L454 22 L459 0 L466 0 Z" fill="#212121"/><path d="M495 31 L495 26 L541 26 L541 31 L495 31 Z M495 46 L495 41 L541 41 L541 46 L495 46 Z" fill="#212121"/><path d="M580 39 C580 47,581 55,584 60 C587 66,591 69,597 71 L596 74 C589 72,583 68,580 62 C576 56,574 48,574 39 C574 30,576 23,580 16 C583 10,589 6,596 4 L597 7 C591 9,587 13,584 18 C581 24,580 30,580 39 L580 39 Z" fill="#212121"/><path d="M614 58 C613 63,611 67,609 69 C606 72,603 73,600 73 C599 73,598 73,597 73 L598 70 C598 70,599 70,600 70 C601 70,602 70,603 69 C603 69,604 68,605 66 C605 65,606 63,607 61 L615 26 L608 26 L609 24 C611 24,612 24,612 24 C613 24,614 23,614 23 C615 23,615 22,615 22 C615 21,616 20,616 18 C618 14,620 11,622 8 C625 6,628 5,633 5 C635 5,637 5,639 6 L637 12 L634 12 C634 11,633 10,633 9 C632 8,631 8,630 8 C629 8,628 8,627 9 C626 10,625 11,624 12 C624 14,623 16,622 18 L621 22 L631 22 L630 26 L621 26 L614 58 Z" fill="#212121"/><path d="M654 39 C654 47,655 55,658 60 C661 66,665 69,671 71 L670 74 C663 72,657 68,654 62 C650 56,648 48,648 39 C648 30,650 23,654 16 C657 10,663 6,670 4 L671 7 C665 9,661 13,658 18 C655 24,654 30,654 39 L654 39 Z" fill="#212121"/><path d="M689 40 C689 38,689 37,688 35 C688 33,688 31,687 30 C687 28,686 27,686 26 C686 26,686 26,685 25 C685 25,685 25,684 25 C684 25,683 25,683 25 C682 26,682 26,681 27 C681 27,680 28,679 29 L677 27 C679 25,680 24,681 23 C683 22,685 21,686 21 C687 21,688 21,688 21 C689 22,690 22,690 22 C690 23,691 23,691 24 C692 24,692 25,692 26 C693 27,693 28,693 30 C693 31,694 33,694 34 L694 34 C697 31,698 28,699 27 C701 25,702 24,703 23 C703 22,704 22,705 22 C706 21,707 21,708 21 C709 21,710 21,711 22 L709 29 L707 29 C707 28,706 27,706 27 C705 27,705 27,705 27 C705 27,704 27,704 28 C704 28,703 28,702 29 C702 30,701 31,700 32 C699 33,698 34,697 35 L695 38 C695 41,696 43,696 44 C697 46,697 48,697 49 C698 50,698 51,698 52 C698 52,699 53,699 53 C699 54,699 54,700 54 C700 54,700 54,701 54 C701 54,702 54,702 53 C703 53,704 52,705 50 L708 52 C706 54,704 56,703 57 C702 58,700 58,698 58 C697 58,696 58,695 57 C695 57,694 56,693 56 C693 55,692 53,692 52 C691 48,691 46,691 44 L690 44 C688 48,686 51,684 52 C683 54,682 55,681 56 C681 57,680 57,679 58 C678 58,677 58,676 58 C675 58,674 58,673 58 L675 50 L677 50 C677 51,678 52,678 52 C679 52,679 52,680 52 C680 52,680 51,681 50 C682 50,683 49,684 47 C685 46,687 43,689 40 L689 40 Z" fill="#212121"/><path d="M732 39 C732 30,731 24,728 18 C725 13,721 9,715 7 L716 4 C723 6,729 10,732 16 C736 23,738 30,738 39 C738 48,736 56,732 62 C729 68,723 72,716 74 L715 71 C721 69,725 66,728 60 C731 55,732 47,732 39 L732 39 Z" fill="#212121"/><path d="M763 39 C763 30,762 24,759 18 C756 13,752 9,746 7 L747 4 C754 6,760 10,763 16 C767 23,769 30,769 39 C769 48,767 56,763 62 C760 68,754 72,747 74 L746 71 C752 69,756 66,759 60 C762 55,763 47,763 39 L763 39 Z" fill="#212121"/><path d="M792 0 L792 2 L783 23 L780 22 L785 0 L792 0 Z" fill="#212121"/><path d="M843 38 L843 59 L837 59 L837 38 L817 38 L817 33 L837 33 L837 12 L843 12 L843 33 L863 33 L863 38 L843 38 Z" fill="#212121"/><path d="M898 39 C898 47,899 55,902 60 C905 66,909 69,915 71 L914 74 C907 72,901 68,898 62 C894 56,892 48,892 39 C892 30,894 23,898 16 C901 10,907 6,914 4 L915 7 C909 9,905 13,902 18 C899 24,898 30,898 39 L898 39 Z" fill="#212121"/><path d="M925 60 C925 61,924 61,924 62 C924 62,923 63,923 63 C923 64,923 64,923 65 C923 67,924 68,925 69 C926 70,928 70,931 70 C934 70,936 69,938 68 C940 67,942 65,943 62 C944 59,945 55,947 49 L946 49 C944 52,941 55,939 56 C937 57,935 58,933 58 C930 58,928 57,927 55 C925 53,924 50,924 46 C924 42,925 38,927 34 C929 30,931 27,934 25 C937 22,940 21,943 21 C945 21,946 21,948 22 C949 22,951 23,952 24 L955 21 L958 22 L954 39 C954 40,953 43,952 48 C951 53,950 57,950 59 C949 61,948 63,947 64 C946 66,945 68,944 69 C942 70,940 71,938 72 C936 73,934 73,931 73 C922 73,917 70,917 65 C917 64,918 63,918 62 C919 60,921 59,922 58 L925 60 Z M935 54 C937 54,938 54,939 53 C940 52,942 51,943 49 C945 47,946 45,946 43 C947 41,948 39,948 37 C949 34,949 32,949 30 C949 28,949 26,948 25 C947 25,946 24,944 24 C942 24,939 25,937 27 C935 29,934 32,933 36 C932 39,931 43,931 46 C931 49,931 51,932 52 C933 53,934 54,935 54 L935 54 Z" fill="#212121"/><path d="M976 39 C976 47,977 55,980 60 C983 66,987 69,993 71 L992 74 C985 72,979 68,976 62 C972 56,970 48,970 39 C970 30,972 23,976 16 C979 10,985 6,992 4 L993 7 C987 9,983 13,980 18 C977 24,976 30,976 39 L976 39 Z" fill="#212121"/><path d="M1011 40 C1011 38,1011 37,1010 35 C1010 33,1010 31,1009 30 C1009 28,1008 27,1008 26 C1008 26,1008 26,1007 25 C1007 25,1007 25,1006 25 C1006 25,1005 25,1005 25 C1004 26,1004 26,1003 27 C1003 27,1002 28,1001 29 L999 27 C1001 25,1002 24,1003 23 C1005 22,1007 21,1008 21 C1009 21,1010 21,1010 21 C1011 22,1012 22,1012 22 C1012 23,1013 23,1013 24 C1014 24,1014 25,1014 26 C1015 27,1015 28,1015 30 C1015 31,1016 33,1016 34 L1016 34 C1019 31,1020 28,1021 27 C1023 25,1024 24,1025 23 C1025 22,1026 22,1027 22 C1028 21,1029 21,1030 21 C1031 21,1032 21,1033 22 L1031 29 L1029 29 C1029 28,1028 27,1028 27 C1027 27,1027 27,1027 27 C1027 27,1026 27,1026 28 C1026 28,1025 28,1024 29 C1024 30,1023 31,1022 32 C1021 33,1020 34,1019 35 L1017 38 C1017 41,1018 43,1018 44 C1019 46,1019 48,1019 49 C1020 50,1020 51,1020 52 C1020 52,1021 53,1021 53 C1021 54,1021 54,1022 54 C1022 54,1022 54,1023 54 C1023 54,1024 54,1024 53 C1025 53,1026 52,1027 50 L1030 52 C1028 54,1026 56,1025 57 C1024 58,1022 58,1020 58 C1019 58,1018 58,1017 57 C1017 57,1016 56,1015 56 C1015 55,1014 53,1014 52 C1013 48,1013 46,1013 44 L1012 44 C1010 48,1008 51,1006 52 C1005 54,1004 55,1003 56 C1003 57,1002 57,1001 58 C1000 58,999 58,998 58 C997 58,996 58,995 58 L997 50 L999 50 C999 51,1000 52,1000 52 C1001 52,1001 52,1002 52 C1002 52,1002 51,1003 50 C1004 50,1005 49,1006 47 C1007 46,1009 43,1011 40 L1011 40 Z" fill="#212121"/><path d="M1054 39 C1054 30,1053 24,1050 18 C1047 13,1043 9,1037 7 L1038 4 C1045 6,1051 10,1054 16 C1058 23,1060 30,1060 39 C1060 48,1058 56,1054 62 C1051 68,1045 72,1038 74 L1037 71 C1043 69,1047 66,1050 60 C1053 55,1054 47,1054 39 L1054 39 Z" fill="#212121"/><path d="M1085 39 C1085 30,1084 24,1081 18 C1078 13,1074 9,1068 7 L1069 4 C1076 6,1082 10,1085 16 C1089 23,1091 30,1091 39 C1091 48,1089 56,1085 62 C1082 68,1076 72,1069 74 L1068 71 C1074 69,1078 66,1081 60 C1084 55,1085 47,1085 39 L1085 39 Z" fill="#212121"/><path d="M1114 0 L1114 2 L1105 23 L1102 22 L1107 0 L1114 0 Z" fill="#212121"/></svg></span></p>
<p class="p_Text"><span class="f_Text">In the case of adjusting the error gradient to the data normalization function, we will have to create an additional kernel. Below is the error gradient correction formulas.</span></p>
<p class="p_Text" style="text-align: center;"><span class="f_li"> </span><span style="display:inline-block;width:372px;height:61px;padding:0 0;overflow:visible"><svg xmlns="http://www.w3.org/2000/svg" style="width:100%;height:100%;overflow:visible" viewBox="0 0 1488 244"><path d="M31 46 L31 45 C31 44,31 43,31 42 C31 40,31 38,31 37 C30 35,30 34,29 33 C29 32,28 31,27 30 C26 29,25 29,23 29 C22 29,20 30,19 30 C17 31,16 32,14 34 L11 34 L11 31 C13 30,15 29,17 28 C18 27,19 27,21 27 C22 26,23 26,25 26 C29 26,32 27,34 30 C36 33,37 37,37 43 C37 45,37 48,36 51 C36 54,35 57,34 60 C33 64,32 66,31 69 C30 71,28 73,27 74 C25 76,24 77,22 78 C20 79,17 79,15 79 C12 79,10 79,8 78 C7 77,5 75,4 73 C4 71,3 69,3 66 C3 63,3 60,4 58 C5 55,6 53,8 50 C10 48,12 46,14 45 C17 44,19 43,22 43 C23 43,25 43,26 44 C28 44,29 45,31 46 L31 46 Z M29 53 C29 51,28 49,27 48 C26 47,25 46,23 46 C21 46,19 47,18 47 C17 48,15 49,14 51 C13 52,12 54,11 56 C11 58,10 60,10 61 C9 63,9 66,9 68 C9 70,9 72,10 73 C10 74,11 75,12 75 C13 76,14 76,15 76 C18 76,20 75,22 73 C24 71,26 68,27 63 C28 59,29 56,29 53 L29 53 Z" fill="#212121"/><path d="M57 79 C56 84,54 88,52 90 C49 93,46 94,43 94 C42 94,41 94,40 94 L41 91 C41 91,42 91,43 91 C44 91,45 91,46 90 C46 90,47 89,48 87 C48 86,49 84,50 82 L58 47 L51 47 L52 45 C54 45,55 45,55 45 C56 45,57 44,57 44 C58 44,58 43,58 43 C58 42,59 41,59 39 C61 35,63 32,65 29 C68 27,71 26,76 26 C78 26,80 26,82 27 L80 33 L77 33 C77 32,76 31,76 30 C75 29,74 29,73 29 C72 29,71 29,70 30 C69 31,68 32,67 33 C67 35,66 37,65 39 L64 43 L74 43 L73 47 L64 47 L57 79 Z" fill="#212121"/><path d="M97 60 C97 68,98 76,101 81 C104 87,108 90,114 92 L113 95 C106 93,100 89,97 83 C93 77,91 69,91 60 C91 51,93 44,97 37 C100 31,106 27,113 25 L114 28 C108 30,104 34,101 39 C98 45,97 51,97 60 L97 60 Z" fill="#212121"/><path d="M146 45 L150 42 L152 43 L147 67 C146 69,146 71,146 72 C146 73,146 74,146 74 C147 75,147 75,148 75 C149 75,150 75,150 74 C151 74,152 73,154 71 L156 73 C154 75,152 77,150 78 C149 79,147 79,145 79 C144 79,143 79,142 78 C141 77,140 75,140 74 C140 73,141 71,141 70 L141 69 C138 73,136 75,134 77 C132 78,130 79,127 79 C125 79,123 78,121 76 C120 74,119 71,119 67 C119 63,120 59,121 55 C123 51,125 48,128 46 C131 43,134 42,138 42 C139 42,141 42,142 43 C144 43,145 44,146 45 L146 45 Z M143 56 C143 55,144 54,144 53 C144 52,144 52,144 51 C144 49,143 47,143 46 C142 46,140 45,138 45 C136 45,134 46,132 48 C130 50,128 53,127 57 C126 60,125 64,125 67 C125 70,126 72,126 73 C127 74,128 75,130 75 C132 75,133 74,135 73 C136 72,138 69,139 67 C141 64,142 61,143 57 L143 56 Z" fill="#212121"/><path d="M169 66 L167 72 L162 72 L163 66 L169 66 Z M162 94 C162 95,162 96,162 97 C162 97,162 98,162 98 C162 99,162 99,162 100 C162 100,163 100,163 100 C164 100,164 100,164 100 C165 100,165 100,165 99 C166 99,166 99,166 98 C167 98,167 97,168 97 L170 99 C169 100,168 101,167 101 C166 102,166 102,165 103 C164 103,164 104,163 104 C162 104,162 104,161 104 C160 104,160 104,159 104 C159 104,158 103,158 103 C157 102,157 102,157 101 C157 101,156 100,156 99 C156 99,157 98,157 97 C157 96,157 95,157 94 C158 93,158 92,158 91 C158 90,159 89,159 88 C159 87,159 86,159 85 C160 84,160 83,160 82 C160 82,160 82,160 81 C160 81,160 81,160 81 C160 80,160 80,159 80 C159 79,158 79,157 79 L157 77 L165 77 L166 77 L162 94 Z" fill="#212121"/><path d="M192 60 C192 51,191 45,188 39 C185 34,181 30,175 28 L176 25 C183 27,189 31,192 37 C196 44,198 51,198 60 C198 69,196 77,192 83 C189 89,183 93,176 95 L175 92 C181 90,185 87,188 81 C191 76,192 68,192 60 L192 60 Z" fill="#212121"/><path d="M76 156 L76 155 C76 154,76 153,76 152 C76 150,76 148,76 147 C75 145,75 144,74 143 C74 142,73 141,72 140 C71 139,70 139,68 139 C67 139,65 140,64 140 C62 141,61 142,59 144 L56 144 L56 141 C58 140,60 139,62 138 C63 137,64 137,66 137 C67 136,68 136,70 136 C74 136,77 137,79 140 C81 143,82 147,82 153 C82 155,82 158,81 161 C81 164,80 167,79 170 C78 174,77 176,76 179 C75 181,73 183,72 184 C70 186,69 187,67 188 C65 189,62 189,60 189 C57 189,55 189,53 188 C52 187,50 185,49 183 C49 181,48 179,48 176 C48 173,48 170,49 168 C50 165,51 163,53 160 C55 158,57 156,59 155 C62 154,64 153,67 153 C68 153,70 153,71 154 C73 154,74 155,76 156 L76 156 Z M74 163 C74 161,73 159,72 158 C71 157,70 156,68 156 C66 156,64 157,63 157 C62 158,60 159,59 161 C58 162,57 164,56 166 C56 168,55 170,55 171 C54 173,54 176,54 178 C54 180,54 182,55 183 C55 184,56 185,57 185 C58 186,59 186,60 186 C63 186,65 185,67 183 C69 181,71 178,72 173 C73 169,74 166,74 163 L74 163 Z" fill="#212121"/><path d="M128 158 L116 158 L116 158 C118 160,119 162,119 163 C120 165,120 167,120 169 C120 173,119 176,118 179 C116 182,114 185,111 186 C108 188,105 189,102 189 C98 189,95 188,92 186 C90 184,89 181,89 176 C89 174,90 171,91 169 C91 166,93 164,94 162 C96 160,98 158,100 157 C102 156,104 155,107 154 C110 153,113 153,118 153 L129 153 L128 158 Z M112 158 C109 158,106 159,103 161 C101 163,99 165,97 168 C96 171,95 175,95 178 C95 180,95 182,96 183 C97 184,97 185,98 185 C99 186,100 186,101 186 C104 186,106 185,108 184 C110 182,111 180,112 176 C113 173,114 170,114 167 C114 163,113 160,112 158 L112 158 Z" fill="#212121"/><path d="M150 161 C150 161,151 161,152 161 C152 161,152 161,153 161 C153 160,153 160,154 160 C154 159,154 159,154 158 L157 158 C157 159,157 160,157 162 C157 163,157 164,156 165 L134 165 L134 164 C134 163,135 162,135 161 C136 160,136 159,137 158 C138 157,139 156,140 155 C140 154,141 153,143 152 C144 150,146 149,147 148 C148 146,149 145,149 144 C150 143,150 143,150 142 C151 141,151 140,151 139 C151 138,151 138,150 137 C150 136,150 135,149 135 C149 134,148 134,147 134 C147 133,146 133,145 133 C143 133,142 134,141 134 C140 135,139 136,138 138 L135 138 L135 133 C137 132,139 131,141 131 C143 130,145 130,146 130 C148 130,150 130,151 131 C152 131,153 132,154 132 C155 133,155 134,156 135 C156 136,156 137,156 138 C156 139,156 140,156 140 C156 141,156 142,156 142 C155 143,155 143,155 144 C154 145,154 145,153 146 C153 147,152 147,152 148 C151 149,150 150,149 150 C148 151,147 152,147 153 C146 154,145 155,144 156 C143 157,142 158,141 159 C141 160,140 160,140 161 L150 161 Z" fill="#212121"/><rect x="0" y="114" width="205" height="5" fill="#212121"/><path d="M231 112 L231 107 L277 107 L277 112 L231 112 Z M231 127 L231 122 L277 122 L277 127 L231 127 Z" fill="#212121"/><path d="M320 50 L364 109 L364 114 L317 177 L380 177 C383 177,385 176,387 174 C388 172,389 168,390 161 L396 161 L394 188 L304 188 L304 184 L355 115 L305 49 L305 45 L394 45 L394 67 L389 67 C389 62,387 58,386 55 C384 52,381 50,378 50 L320 50 Z" fill="#212121"/><path d="M353 27 L347 27 C348 26,348 25,348 24 C349 22,349 21,349 20 C350 18,350 17,350 16 C350 15,351 13,351 12 C351 11,351 10,352 9 C352 8,352 8,352 7 C352 6,352 5,351 5 C351 4,350 4,349 4 C348 4,347 4,346 5 C345 6,344 6,343 7 C343 9,342 10,341 11 C340 12,340 13,340 15 L337 27 L332 27 L336 10 C336 9,336 8,336 8 C336 7,336 6,336 6 C336 5,336 4,335 4 C334 4,334 4,334 4 C333 4,333 5,333 5 C332 5,332 6,331 6 C331 6,331 7,330 7 L328 6 C329 5,330 4,331 3 C331 2,332 2,333 1 C333 1,334 1,335 0 C335 0,336 0,337 0 C338 0,339 1,340 1 C341 2,341 3,341 5 C341 5,341 6,341 6 C341 6,341 7,341 7 L341 7 C343 5,344 3,346 2 C348 1,349 0,351 0 C353 0,355 1,356 2 C356 3,357 4,357 6 C357 6,357 6,357 6 C357 6,357 7,357 7 L357 7 C359 4,360 3,362 2 C364 1,365 0,367 0 C369 0,370 1,371 2 C372 3,373 4,373 6 C373 6,373 7,372 8 C372 9,372 10,372 11 C372 12,371 13,371 14 C371 15,370 16,370 17 C370 18,370 18,370 19 C370 19,370 20,370 20 C369 20,369 20,369 21 C369 21,369 21,369 21 C369 22,369 22,370 23 C370 23,370 23,371 23 C371 23,372 23,372 23 C372 23,373 23,373 22 C373 22,374 22,374 21 C375 21,375 20,376 20 L377 21 C377 23,376 23,375 24 C374 25,374 25,373 26 C372 26,372 27,371 27 C370 27,369 27,369 27 C368 27,367 27,367 27 C366 27,366 26,365 26 C365 25,365 25,365 24 C364 24,364 23,364 22 C364 21,365 19,365 17 C366 16,366 15,366 14 C366 13,367 12,367 11 C367 10,367 10,367 9 C367 8,367 8,367 7 C367 6,367 5,367 5 C366 4,366 4,365 4 C364 4,364 4,363 5 C362 5,362 5,361 6 C361 6,360 7,359 7 C359 8,358 9,358 10 C357 10,357 11,356 12 C356 13,356 14,355 15 L353 27 Z" fill="#212121"/><path d="M323 195 L321 201 L316 201 L317 195 L323 195 Z M316 223 C316 224,316 225,316 226 C316 226,316 227,316 227 C316 228,316 228,316 229 C316 229,317 229,317 229 C318 229,318 229,318 229 C319 229,319 229,319 228 C320 228,320 228,320 227 C321 227,321 226,322 226 L324 228 C323 229,322 230,321 230 C320 231,320 231,319 232 C318 232,318 233,317 233 C316 233,316 233,315 233 C314 233,314 233,313 233 C313 233,312 232,312 232 C311 231,311 231,311 230 C311 230,310 229,310 228 C310 228,311 227,311 226 C311 225,311 224,311 223 C312 222,312 221,312 220 C312 219,313 218,313 217 C313 216,313 215,313 214 C314 213,314 212,314 211 C314 211,314 211,314 210 C314 210,314 210,314 210 C314 209,314 209,313 209 C313 208,312 208,311 208 L311 206 L319 206 L320 206 L316 223 Z" fill="#212121"/><path d="M332 213 L332 209 L362 209 L362 213 L332 213 Z M332 225 L332 221 L362 221 L362 225 L332 225 Z" fill="#212121"/><path d="M387 226 C387 227,387 227,387 228 C387 228,387 229,387 229 C387 229,387 229,387 230 C387 230,388 230,388 230 C388 230,388 230,389 231 C389 231,389 231,390 231 C390 231,391 231,392 231 C393 231,394 231,395 231 L395 233 L373 233 L373 231 C374 231,375 231,376 231 C377 231,377 231,378 231 C378 231,379 231,379 231 C380 230,380 230,380 230 C380 230,381 230,381 230 C381 230,381 229,381 229 C381 229,381 228,381 228 C381 228,381 227,381 226 L381 207 C381 207,381 206,381 206 C381 206,380 205,380 205 C379 205,379 206,377 206 C376 207,375 208,373 209 C373 208,373 208,373 208 C372 207,372 207,372 206 C374 205,376 204,379 203 C381 202,383 200,385 199 L387 199 C387 200,387 201,387 202 C387 203,387 203,387 204 C387 205,387 205,387 206 L387 226 Z" fill="#212121"/><path d="M446 46 L446 45 C446 44,446 43,446 42 C446 40,446 38,446 37 C445 35,445 34,444 33 C444 32,443 31,442 30 C441 29,440 29,438 29 C437 29,435 30,434 30 C432 31,431 32,429 34 L426 34 L426 31 C428 30,430 29,432 28 C433 27,434 27,436 27 C437 26,438 26,440 26 C444 26,447 27,449 30 C451 33,452 37,452 43 C452 45,452 48,451 51 C451 54,450 57,449 60 C448 64,447 66,446 69 C445 71,443 73,442 74 C440 76,439 77,437 78 C435 79,432 79,430 79 C427 79,425 79,423 78 C422 77,420 75,419 73 C419 71,418 69,418 66 C418 63,418 60,419 58 C420 55,421 53,423 50 C425 48,427 46,429 45 C432 44,434 43,437 43 C438 43,440 43,441 44 C443 44,444 45,446 46 L446 46 Z M444 53 C444 51,443 49,442 48 C441 47,440 46,438 46 C436 46,434 47,433 47 C432 48,430 49,429 51 C428 52,427 54,426 56 C426 58,425 60,425 61 C424 63,424 66,424 68 C424 70,424 72,425 73 C425 74,426 75,427 75 C428 76,429 76,430 76 C433 76,435 75,437 73 C439 71,441 68,442 63 C443 59,444 56,444 53 L444 53 Z" fill="#212121"/><path d="M472 79 C471 84,469 88,467 90 C464 93,461 94,458 94 C457 94,456 94,455 94 L456 91 C456 91,457 91,458 91 C459 91,460 91,461 90 C461 90,462 89,463 87 C463 86,464 84,465 82 L473 47 L466 47 L467 45 C469 45,470 45,470 45 C471 45,472 44,472 44 C473 44,473 43,473 43 C473 42,474 41,474 39 C476 35,478 32,480 29 C483 27,486 26,491 26 C493 26,495 26,497 27 L495 33 L492 33 C492 32,491 31,491 30 C490 29,489 29,488 29 C487 29,486 29,485 30 C484 31,483 32,482 33 C482 35,481 37,480 39 L479 43 L489 43 L488 47 L479 47 L472 79 Z" fill="#212121"/><path d="M512 60 C512 68,513 76,516 81 C519 87,523 90,529 92 L528 95 C521 93,515 89,512 83 C508 77,506 69,506 60 C506 51,508 44,512 37 C515 31,521 27,528 25 L529 28 C523 30,519 34,516 39 C513 45,512 51,512 60 L512 60 Z" fill="#212121"/><path d="M561 45 L565 42 L567 43 L562 67 C561 69,561 71,561 72 C561 73,561 74,561 74 C562 75,562 75,563 75 C564 75,565 75,565 74 C566 74,567 73,569 71 L571 73 C569 75,567 77,565 78 C564 79,562 79,560 79 C559 79,558 79,557 78 C556 77,555 75,555 74 C555 73,556 71,556 70 L556 69 C553 73,551 75,549 77 C547 78,545 79,542 79 C540 79,538 78,536 76 C535 74,534 71,534 67 C534 63,535 59,536 55 C538 51,540 48,543 46 C546 43,549 42,553 42 C554 42,556 42,557 43 C559 43,560 44,561 45 L561 45 Z M558 56 C558 55,559 54,559 53 C559 52,559 52,559 51 C559 49,558 47,558 46 C557 46,555 45,553 45 C551 45,549 46,547 48 C545 50,543 53,542 57 C541 60,540 64,540 67 C540 70,541 72,541 73 C542 74,543 75,545 75 C547 75,548 74,550 73 C551 72,553 69,554 67 C556 64,557 61,558 57 L558 56 Z" fill="#212121"/><path d="M584 66 L582 72 L577 72 L578 66 L584 66 Z M577 94 C577 95,577 96,577 97 C577 97,577 98,577 98 C577 99,577 99,577 100 C577 100,578 100,578 100 C579 100,579 100,579 100 C580 100,580 100,580 99 C581 99,581 99,581 98 C582 98,582 97,583 97 L585 99 C584 100,583 101,582 101 C581 102,581 102,580 103 C579 103,579 104,578 104 C577 104,577 104,576 104 C575 104,575 104,574 104 C574 104,573 103,573 103 C572 102,572 102,572 101 C572 101,571 100,571 99 C571 99,572 98,572 97 C572 96,572 95,572 94 C573 93,573 92,573 91 C573 90,574 89,574 88 C574 87,574 86,574 85 C575 84,575 83,575 82 C575 82,575 82,575 81 C575 81,575 81,575 81 C575 80,575 80,574 80 C574 79,573 79,572 79 L572 77 L580 77 L581 77 L577 94 Z" fill="#212121"/><path d="M607 60 C607 51,606 45,603 39 C600 34,596 30,590 28 L591 25 C598 27,604 31,607 37 C611 44,613 51,613 60 C613 69,611 77,607 83 C604 89,598 93,591 95 L590 92 C596 90,600 87,603 81 C606 76,607 68,607 60 L607 60 Z" fill="#212121"/><path d="M498 156 L498 155 C498 154,498 153,498 152 C498 150,498 148,498 147 C497 145,497 144,496 143 C496 142,495 141,494 140 C493 139,492 139,490 139 C489 139,487 140,486 140 C484 141,483 142,481 144 L478 144 L478 141 C480 140,482 139,484 138 C485 137,486 137,488 137 C489 136,490 136,492 136 C496 136,499 137,501 140 C503 143,504 147,504 153 C504 155,504 158,503 161 C503 164,502 167,501 170 C500 174,499 176,498 179 C497 181,495 183,494 184 C492 186,491 187,489 188 C487 189,484 189,482 189 C479 189,477 189,475 188 C474 187,472 185,471 183 C471 181,470 179,470 176 C470 173,470 170,471 168 C472 165,473 163,475 160 C477 158,479 156,481 155 C484 154,486 153,489 153 C490 153,492 153,493 154 C495 154,496 155,498 156 L498 156 Z M496 163 C496 161,495 159,494 158 C493 157,492 156,490 156 C488 156,486 157,485 157 C484 158,482 159,481 161 C480 162,479 164,478 166 C478 168,477 170,477 171 C476 173,476 176,476 178 C476 180,476 182,477 183 C477 184,478 185,479 185 C480 186,481 186,482 186 C485 186,487 185,489 183 C491 181,493 178,494 173 C495 169,496 166,496 163 L496 163 Z" fill="#212121"/><path d="M539 155 L543 152 L545 153 L540 177 C539 179,539 181,539 182 C539 183,539 184,539 184 C540 185,540 185,541 185 C542 185,543 185,543 184 C544 184,545 183,547 181 L549 183 C547 185,545 187,543 188 C542 189,540 189,538 189 C537 189,536 189,535 188 C534 187,533 185,533 184 C533 183,534 181,534 180 L534 179 C531 183,529 185,527 187 C525 188,523 189,520 189 C518 189,516 188,514 186 C513 184,512 181,512 177 C512 173,513 169,514 165 C516 161,518 158,521 156 C524 153,527 152,531 152 C532 152,534 152,535 153 C537 153,538 154,539 155 L539 155 Z M536 166 C536 165,537 164,537 163 C537 162,537 162,537 161 C537 159,536 157,536 156 C535 156,533 155,531 155 C529 155,527 156,525 158 C523 160,521 163,520 167 C519 170,518 174,518 177 C518 180,519 182,519 183 C520 184,521 185,523 185 C525 185,526 184,528 183 C529 182,531 179,532 177 C534 174,535 171,536 167 L536 166 Z" fill="#212121"/><path d="M536 135 L544 147 L541 149 L534 140 L534 140 L525 149 L523 147 L531 135 L536 135 Z" fill="#212121"/><path d="M562 176 L560 182 L555 182 L556 176 L562 176 Z M555 204 C555 205,555 206,555 207 C555 207,555 208,555 208 C555 209,555 209,555 210 C555 210,556 210,556 210 C557 210,557 210,557 210 C558 210,558 210,558 209 C559 209,559 209,559 208 C560 208,560 207,561 207 L563 209 C562 210,561 211,560 211 C559 212,559 212,558 213 C557 213,557 214,556 214 C555 214,555 214,554 214 C553 214,553 214,552 214 C552 214,551 213,551 213 C550 212,550 212,550 211 C550 211,549 210,549 209 C549 209,550 208,550 207 C550 206,550 205,550 204 C551 203,551 202,551 201 C551 200,552 199,552 198 C552 197,552 196,552 195 C553 194,553 193,553 192 C553 192,553 192,553 191 C553 191,553 191,553 191 C553 190,553 190,552 190 C552 189,551 189,550 189 L550 187 L558 187 L559 187 L555 204 Z" fill="#212121"/><rect x="415" y="114" width="205" height="5" fill="#212121"/><path d="M668 122 L666 126 L656 119 L658 131 L653 131 L654 119 L644 126 L642 122 L652 117 L642 112 L644 108 L654 115 L653 103 L658 103 L656 115 L666 108 L668 112 L658 117 L668 122 Z" fill="#212121"/><path d="M703 120 C703 128,704 136,707 141 C710 147,714 150,720 152 L719 155 C712 153,706 149,703 143 C699 137,697 129,697 120 C697 111,699 104,703 97 C706 91,712 87,719 85 L720 88 C714 90,710 94,707 99 C704 105,703 111,703 120 L703 120 Z" fill="#212121"/><path d="M752 105 L756 102 L758 103 L753 127 C752 129,752 131,752 132 C752 133,752 134,752 134 C753 135,753 135,754 135 C755 135,756 135,756 134 C757 134,758 133,760 131 L762 133 C760 135,758 137,756 138 C755 139,753 139,751 139 C750 139,749 139,748 138 C747 137,746 135,746 134 C746 133,747 131,747 130 L747 129 C744 133,742 135,740 137 C738 138,736 139,733 139 C731 139,729 138,727 136 C726 134,725 131,725 127 C725 123,726 119,727 115 C729 111,731 108,734 106 C737 103,740 102,744 102 C745 102,747 102,748 103 C750 103,751 104,752 105 L752 105 Z M749 116 C749 115,750 114,750 113 C750 112,750 112,750 111 C750 109,749 107,749 106 C748 106,746 105,744 105 C742 105,740 106,738 108 C736 110,734 113,733 117 C732 120,731 124,731 127 C731 130,732 132,732 133 C733 134,734 135,736 135 C738 135,739 134,741 133 C742 132,744 129,745 127 C747 124,748 121,749 117 L749 116 Z" fill="#212121"/><path d="M775 126 L773 132 L768 132 L769 126 L775 126 Z M768 154 C768 155,768 156,768 157 C768 157,768 158,768 158 C768 159,768 159,768 160 C768 160,769 160,769 160 C770 160,770 160,770 160 C771 160,771 160,771 159 C772 159,772 159,772 158 C773 158,773 157,774 157 L776 159 C775 160,774 161,773 161 C772 162,772 162,771 163 C770 163,770 164,769 164 C768 164,768 164,767 164 C766 164,766 164,765 164 C765 164,764 163,764 163 C763 162,763 162,763 161 C763 161,762 160,762 159 C762 159,763 158,763 157 C763 156,763 155,763 154 C764 153,764 152,764 151 C764 150,765 149,765 148 C765 147,765 146,765 145 C766 144,766 143,766 142 C766 142,766 142,766 141 C766 141,766 141,766 141 C766 140,766 140,765 140 C765 139,764 139,763 139 L763 137 L771 137 L772 137 L768 154 Z" fill="#212121"/><path d="M802 119 L802 114 L848 114 L848 119 L802 119 Z" fill="#212121"/><path d="M901 105 L905 102 L907 103 L902 127 C901 129,901 131,901 132 C901 133,901 134,901 134 C902 135,902 135,903 135 C904 135,905 135,905 134 C906 134,907 133,909 131 L911 133 C909 135,907 137,905 138 C904 139,902 139,900 139 C899 139,898 139,897 138 C896 137,895 135,895 134 C895 133,896 131,896 130 L896 129 C893 133,891 135,889 137 C887 138,885 139,882 139 C880 139,878 138,876 136 C875 134,874 131,874 127 C874 123,875 119,876 115 C878 111,880 108,883 106 C886 103,889 102,893 102 C894 102,896 102,897 103 C899 103,900 104,901 105 L901 105 Z M898 116 C898 115,899 114,899 113 C899 112,899 112,899 111 C899 109,898 107,898 106 C897 106,895 105,893 105 C891 105,889 106,887 108 C885 110,883 113,882 117 C881 120,880 124,880 127 C880 130,881 132,881 133 C882 134,883 135,885 135 C887 135,888 134,890 133 C891 132,893 129,894 127 C896 124,897 121,898 117 L898 116 Z" fill="#212121"/><path d="M905 94 L886 94 L886 90 L905 90 L905 94 Z" fill="#212121"/><path d="M932 120 C932 111,931 105,928 99 C925 94,921 90,915 88 L916 85 C923 87,929 91,932 97 C936 104,938 111,938 120 C938 129,936 137,932 143 C929 149,923 153,916 155 L915 152 C921 150,925 147,928 141 C931 136,932 128,932 120 L932 120 Z" fill="#212121"/><path d="M993 122 L991 126 L981 119 L983 131 L978 131 L979 119 L969 126 L967 122 L977 117 L967 112 L969 108 L979 115 L978 103 L983 103 L981 115 L991 108 L993 112 L983 117 L993 122 Z" fill="#212121"/><path d="M1020 62 L1020 57 L1066 57 L1066 62 L1020 62 Z" fill="#212121"/><path d="M1114 71 C1114 73,1114 74,1114 74 C1114 75,1115 76,1115 76 C1115 77,1116 77,1117 77 C1118 78,1118 78,1120 78 C1121 78,1122 78,1124 78 L1124 81 L1097 81 L1097 78 C1100 78,1102 78,1103 78 C1104 77,1105 77,1105 77 C1106 76,1106 76,1107 75 C1107 74,1107 73,1107 71 L1107 41 C1107 40,1107 40,1107 39 C1106 39,1106 39,1105 39 C1104 39,1103 39,1102 40 C1100 41,1099 42,1097 43 L1095 40 L1112 30 L1114 30 C1114 32,1114 36,1114 40 L1114 71 Z" fill="#212121"/><path d="M1077 182 C1078 182,1079 182,1080 182 C1081 182,1082 181,1082 181 C1082 181,1083 180,1083 180 C1083 179,1084 178,1084 177 L1087 177 L1086 188 L1056 188 L1056 186 C1057 184,1059 181,1060 178 C1062 176,1065 172,1068 169 C1071 165,1073 163,1074 161 C1075 160,1076 158,1077 157 C1078 156,1078 154,1079 153 C1079 152,1079 151,1079 150 C1079 148,1079 146,1078 145 C1077 143,1077 142,1075 141 C1074 141,1072 140,1071 140 C1066 140,1063 143,1061 148 L1057 148 L1057 141 C1060 139,1063 139,1065 138 C1068 137,1070 137,1072 137 C1077 137,1080 138,1083 140 C1085 142,1086 145,1086 148 C1086 150,1086 151,1086 152 C1085 153,1085 154,1084 155 C1084 157,1083 158,1082 159 C1081 160,1080 161,1079 163 C1078 164,1076 166,1073 169 C1069 174,1065 178,1063 182 L1077 182 Z" fill="#212121"/><rect x="1015" y="114" width="115" height="5" fill="#212121"/><path d="M1156 120 C1156 128,1157 136,1160 141 C1163 147,1167 150,1173 152 L1172 155 C1165 153,1159 149,1156 143 C1152 137,1150 129,1150 120 C1150 111,1152 104,1156 97 C1159 91,1165 87,1172 85 L1173 88 C1167 90,1163 94,1160 99 C1157 105,1156 111,1156 120 L1156 120 Z" fill="#212121"/><path d="M1216 108 L1204 108 L1204 108 C1206 110,1207 112,1207 113 C1208 115,1208 117,1208 119 C1208 123,1207 126,1206 129 C1204 132,1202 135,1199 136 C1196 138,1193 139,1190 139 C1186 139,1183 138,1180 136 C1178 134,1177 131,1177 126 C1177 124,1178 121,1179 119 C1179 116,1181 114,1182 112 C1184 110,1186 108,1188 107 C1190 106,1192 105,1195 104 C1198 103,1201 103,1206 103 L1217 103 L1216 108 Z M1200 108 C1197 108,1194 109,1191 111 C1189 113,1187 115,1185 118 C1184 121,1183 125,1183 128 C1183 130,1183 132,1184 133 C1185 134,1185 135,1186 135 C1187 136,1188 136,1189 136 C1192 136,1194 135,1196 134 C1198 132,1199 130,1200 126 C1201 123,1202 120,1202 117 C1202 113,1201 110,1200 108 L1200 108 Z" fill="#212121"/><path d="M1238 107 C1238 107,1239 107,1240 107 C1240 107,1240 107,1241 107 C1241 106,1241 106,1242 106 C1242 105,1242 105,1242 104 L1245 104 C1245 105,1245 106,1245 108 C1245 109,1245 110,1244 111 L1222 111 L1222 110 C1222 109,1223 108,1223 107 C1224 106,1224 105,1225 104 C1226 103,1227 102,1228 101 C1228 100,1229 99,1231 98 C1232 96,1234 95,1235 94 C1236 92,1237 91,1237 90 C1238 89,1238 89,1238 88 C1239 87,1239 86,1239 85 C1239 84,1239 84,1238 83 C1238 82,1238 81,1237 81 C1237 80,1236 80,1235 80 C1235 79,1234 79,1233 79 C1231 79,1230 80,1229 80 C1228 81,1227 82,1226 84 L1223 84 L1223 79 C1225 78,1227 77,1229 77 C1231 76,1233 76,1234 76 C1236 76,1238 76,1239 77 C1240 77,1241 78,1242 78 C1243 79,1243 80,1244 81 C1244 82,1244 83,1244 84 C1244 85,1244 86,1244 86 C1244 87,1244 88,1244 88 C1243 89,1243 89,1243 90 C1242 91,1242 91,1241 92 C1241 93,1240 93,1240 94 C1239 95,1238 96,1237 96 C1236 97,1235 98,1235 99 C1234 100,1233 101,1232 102 C1231 103,1230 104,1229 105 C1229 106,1228 106,1228 107 L1238 107 Z" fill="#212121"/><path d="M1296 119 L1296 140 L1290 140 L1290 119 L1270 119 L1270 114 L1290 114 L1290 93 L1296 93 L1296 114 L1316 114 L1316 119 L1296 119 Z" fill="#212121"/><path d="M1370 111 L1366 111 C1366 107,1364 105,1360 105 C1358 105,1356 106,1354 107 C1353 108,1352 110,1352 113 C1352 114,1353 116,1354 117 C1355 118,1357 118,1359 118 L1364 118 L1364 122 L1360 122 C1358 122,1357 122,1355 122 C1354 123,1353 123,1352 124 C1351 124,1350 125,1350 125 C1349 126,1348 127,1348 127 C1348 128,1348 129,1348 130 C1348 132,1348 133,1349 134 C1351 135,1352 135,1355 135 C1356 135,1358 135,1360 134 C1362 134,1364 133,1366 131 L1368 134 C1366 136,1363 137,1361 138 C1358 139,1356 139,1353 139 C1350 139,1348 139,1347 138 C1345 137,1343 136,1343 135 C1342 133,1341 132,1341 130 C1341 128,1342 126,1344 124 C1346 122,1349 121,1353 120 L1353 120 C1348 118,1346 116,1346 112 C1346 110,1347 109,1348 107 C1349 106,1350 105,1352 104 C1355 103,1357 102,1360 102 C1364 102,1367 103,1371 104 L1370 111 Z" fill="#212121"/><path d="M1392 120 C1392 111,1391 105,1388 99 C1385 94,1381 90,1375 88 L1376 85 C1383 87,1389 91,1392 97 C1396 104,1398 111,1398 120 C1398 129,1396 137,1392 143 C1389 149,1383 153,1376 155 L1375 152 C1381 150,1385 147,1388 141 C1391 136,1392 128,1392 120 L1392 120 Z" fill="#212121"/><path d="M1405 87 L1405 83 L1435 83 L1435 87 L1405 87 Z" fill="#212121"/><path d="M1444 49 L1444 45 C1448 44,1451 43,1454 43 C1455 43,1457 43,1458 44 C1459 44,1460 45,1461 46 C1462 46,1462 47,1462 49 C1462 50,1462 51,1461 52 C1461 52,1460 53,1459 54 C1458 54,1457 55,1456 55 L1456 56 C1458 56,1459 57,1461 58 C1462 59,1463 60,1463 62 C1463 63,1463 64,1462 66 C1461 67,1460 68,1458 68 C1457 69,1455 69,1452 69 C1451 69,1449 69,1448 69 C1447 68,1445 68,1444 68 L1444 63 L1447 63 C1448 65,1448 66,1449 66 C1450 67,1451 67,1452 67 C1454 67,1456 67,1457 66 C1458 65,1458 64,1458 62 C1458 61,1457 59,1456 58 C1455 58,1453 57,1450 57 L1448 57 L1448 55 C1450 55,1452 55,1453 54 C1455 54,1456 53,1456 52 C1457 51,1457 50,1457 49 C1457 48,1457 47,1456 46 C1455 45,1454 45,1452 45 C1451 45,1450 45,1449 46 C1448 47,1447 48,1447 49 L1444 49 Z" fill="#212121"/><path d="M1456 125 C1457 125,1458 125,1458 125 C1458 125,1459 125,1459 125 C1459 124,1459 124,1460 124 C1460 124,1460 123,1460 122 L1462 122 L1462 129 L1443 129 L1443 128 C1444 126,1445 125,1446 124 C1447 122,1449 121,1450 119 C1452 117,1454 116,1455 115 C1455 114,1456 113,1456 112 C1457 111,1457 110,1457 110 C1457 108,1457 107,1456 106 C1455 106,1454 105,1452 105 C1451 105,1450 105,1449 106 C1448 107,1447 108,1447 109 L1444 109 L1444 105 C1446 104,1448 104,1449 104 C1451 103,1452 103,1453 103 C1455 103,1457 103,1458 104 C1459 104,1460 104,1460 105 C1461 106,1461 106,1462 107 C1462 108,1462 108,1462 109 C1462 110,1462 111,1461 112 C1461 113,1460 114,1459 115 C1458 116,1457 118,1454 120 C1451 122,1450 124,1448 125 L1456 125 Z" fill="#212121"/><rect x="1440" y="84" width="27" height="4" fill="#212121"/></svg></span></p>
<p class="p_Text" style="text-align: center;"><span style="display:inline-block;width:500px;height:86px;padding:0 0;overflow:visible"><svg xmlns="http://www.w3.org/2000/svg" style="width:100%;height:100%;overflow:visible" viewBox="0 0 2000 344"><path d="M31 100 L31 99 C31 98,31 97,31 96 C31 94,31 92,31 91 C30 89,30 88,29 87 C29 86,28 85,27 84 C26 83,25 83,23 83 C22 83,20 84,19 84 C17 85,16 86,14 88 L11 88 L11 85 C13 84,15 83,17 82 C18 81,19 81,21 81 C22 80,23 80,25 80 C29 80,32 81,34 84 C36 87,37 91,37 97 C37 99,37 102,36 105 C36 108,35 111,34 114 C33 118,32 120,31 123 C30 125,28 127,27 128 C25 130,24 131,22 132 C20 133,17 133,15 133 C12 133,10 133,8 132 C7 131,5 129,4 127 C4 125,3 123,3 120 C3 117,3 114,4 112 C5 109,6 107,8 104 C10 102,12 100,14 99 C17 98,19 97,22 97 C23 97,25 97,26 98 C28 98,29 99,31 100 L31 100 Z M29 107 C29 105,28 103,27 102 C26 101,25 100,23 100 C21 100,19 101,18 101 C17 102,15 103,14 105 C13 106,12 108,11 110 C11 112,10 114,10 115 C9 117,9 120,9 122 C9 124,9 126,10 127 C10 128,11 129,12 129 C13 130,14 130,15 130 C18 130,20 129,22 127 C24 125,26 122,27 117 C28 113,29 110,29 107 L29 107 Z" fill="#212121"/><path d="M57 133 C56 138,54 142,52 144 C49 147,46 148,43 148 C42 148,41 148,40 148 L41 145 C41 145,42 145,43 145 C44 145,45 145,46 144 C46 144,47 143,48 141 C48 140,49 138,50 136 L58 101 L51 101 L52 99 C54 99,55 99,55 99 C56 99,57 98,57 98 C58 98,58 97,58 97 C58 96,59 95,59 93 C61 89,63 86,65 83 C68 81,71 80,76 80 C78 80,80 80,82 81 L80 87 L77 87 C77 86,76 85,76 84 C75 83,74 83,73 83 C72 83,71 83,70 84 C69 85,68 86,67 87 C67 89,66 91,65 93 L64 97 L74 97 L73 101 L64 101 L57 133 Z" fill="#212121"/><path d="M97 114 C97 122,98 130,101 135 C104 141,108 144,114 146 L113 149 C106 147,100 143,97 137 C93 131,91 123,91 114 C91 105,93 98,97 91 C100 85,106 81,113 79 L114 82 C108 84,104 88,101 93 C98 99,97 105,97 114 L97 114 Z" fill="#212121"/><path d="M146 99 L150 96 L152 97 L147 121 C146 123,146 125,146 126 C146 127,146 128,146 128 C147 129,147 129,148 129 C149 129,150 129,150 128 C151 128,152 127,154 125 L156 127 C154 129,152 131,150 132 C149 133,147 133,145 133 C144 133,143 133,142 132 C141 131,140 129,140 128 C140 127,141 125,141 124 L141 123 C138 127,136 129,134 131 C132 132,130 133,127 133 C125 133,123 132,121 130 C120 128,119 125,119 121 C119 117,120 113,121 109 C123 105,125 102,128 100 C131 97,134 96,138 96 C139 96,141 96,142 97 C144 97,145 98,146 99 L146 99 Z M143 110 C143 109,144 108,144 107 C144 106,144 106,144 105 C144 103,143 101,143 100 C142 100,140 99,138 99 C136 99,134 100,132 102 C130 104,128 107,127 111 C126 114,125 118,125 121 C125 124,126 126,126 127 C127 128,128 129,130 129 C132 129,133 128,135 127 C136 126,138 123,139 121 C141 118,142 115,143 111 L143 110 Z" fill="#212121"/><path d="M169 120 L167 126 L162 126 L163 120 L169 120 Z M162 148 C162 149,162 150,162 151 C162 151,162 152,162 152 C162 153,162 153,162 154 C162 154,163 154,163 154 C164 154,164 154,164 154 C165 154,165 154,165 153 C166 153,166 153,166 152 C167 152,167 151,168 151 L170 153 C169 154,168 155,167 155 C166 156,166 156,165 157 C164 157,164 158,163 158 C162 158,162 158,161 158 C160 158,160 158,159 158 C159 158,158 157,158 157 C157 156,157 156,157 155 C157 155,156 154,156 153 C156 153,157 152,157 151 C157 150,157 149,157 148 C158 147,158 146,158 145 C158 144,159 143,159 142 C159 141,159 140,159 139 C160 138,160 137,160 136 C160 136,160 136,160 135 C160 135,160 135,160 135 C160 134,160 134,159 134 C159 133,158 133,157 133 L157 131 L165 131 L166 131 L162 148 Z" fill="#212121"/><path d="M192 114 C192 105,191 99,188 93 C185 88,181 84,175 82 L176 79 C183 81,189 85,192 91 C196 98,198 105,198 114 C198 123,196 131,192 137 C189 143,183 147,176 149 L175 146 C181 144,185 141,188 135 C191 130,192 122,192 114 L192 114 Z" fill="#212121"/><path d="M92 210 L92 209 C92 208,92 207,92 206 C92 204,92 202,92 201 C91 199,91 198,90 197 C90 196,89 195,88 194 C87 193,86 193,84 193 C83 193,81 194,80 194 C78 195,77 196,75 198 L72 198 L72 195 C74 194,76 193,78 192 C79 191,80 191,82 191 C83 190,84 190,86 190 C90 190,93 191,95 194 C97 197,98 201,98 207 C98 209,98 212,97 215 C97 218,96 221,95 224 C94 228,93 230,92 233 C91 235,89 237,88 238 C86 240,85 241,83 242 C81 243,78 243,76 243 C73 243,71 243,69 242 C68 241,66 239,65 237 C65 235,64 233,64 230 C64 227,64 224,65 222 C66 219,67 217,69 214 C71 212,73 210,75 209 C78 208,80 207,83 207 C84 207,86 207,87 208 C89 208,90 209,92 210 L92 210 Z M90 217 C90 215,89 213,88 212 C87 211,86 210,84 210 C82 210,80 211,79 211 C78 212,76 213,75 215 C74 216,73 218,72 220 C72 222,71 224,71 225 C70 227,70 230,70 232 C70 234,70 236,71 237 C71 238,72 239,73 239 C74 240,75 240,76 240 C79 240,81 239,83 237 C85 235,87 232,88 227 C89 223,90 220,90 217 L90 217 Z" fill="#212121"/><path d="M133 209 L137 206 L139 207 L134 231 C133 233,133 235,133 236 C133 237,133 238,133 238 C134 239,134 239,135 239 C136 239,137 239,137 238 C138 238,139 237,141 235 L143 237 C141 239,139 241,137 242 C136 243,134 243,132 243 C131 243,130 243,129 242 C128 241,127 239,127 238 C127 237,128 235,128 234 L128 233 C125 237,123 239,121 241 C119 242,117 243,114 243 C112 243,110 242,108 240 C107 238,106 235,106 231 C106 227,107 223,108 219 C110 215,112 212,115 210 C118 207,121 206,125 206 C126 206,128 206,129 207 C131 207,132 208,133 209 L133 209 Z M130 220 C130 219,131 218,131 217 C131 216,131 216,131 215 C131 213,130 211,130 210 C129 210,127 209,125 209 C123 209,121 210,119 212 C117 214,115 217,114 221 C113 224,112 228,112 231 C112 234,113 236,113 237 C114 238,115 239,117 239 C119 239,120 238,122 237 C123 236,125 233,126 231 C128 228,129 225,130 221 L130 220 Z" fill="#212121"/><path d="M137 198 L118 198 L118 194 L137 194 L137 198 Z" fill="#212121"/><rect x="0" y="168" width="205" height="5" fill="#212121"/><path d="M231 166 L231 161 L277 161 L277 166 L231 166 Z M231 181 L231 176 L277 176 L277 181 L231 181 Z" fill="#212121"/><path d="M346 63 C336 74,329 89,324 107 C319 126,316 147,316 170 C316 194,319 215,324 234 C329 253,336 267,346 278 L344 281 C333 270,324 256,318 237 C312 218,309 196,309 170 C309 145,312 123,318 104 C324 86,333 71,344 60 L346 63 Z" fill="#212121"/><path d="M366 104 L410 163 L410 168 L363 231 L426 231 C429 231,431 230,433 228 C434 226,435 222,436 215 L442 215 L440 242 L350 242 L350 238 L401 169 L351 103 L351 99 L440 99 L440 121 L435 121 C435 116,433 112,432 109 C430 106,427 104,424 104 L366 104 Z" fill="#212121"/><path d="M399 81 L393 81 C394 80,394 79,394 78 C395 76,395 75,395 74 C396 72,396 71,396 70 C396 69,397 67,397 66 C397 65,397 64,398 63 C398 62,398 62,398 61 C398 60,398 59,397 59 C397 58,396 58,395 58 C394 58,393 58,392 59 C391 60,390 60,389 61 C389 63,388 64,387 65 C386 66,386 67,386 69 L383 81 L378 81 L382 64 C382 63,382 62,382 62 C382 61,382 60,382 60 C382 59,382 58,381 58 C380 58,380 58,380 58 C379 58,379 59,379 59 C378 59,378 60,377 60 C377 60,377 61,376 61 L374 60 C375 59,376 58,377 57 C377 56,378 56,379 55 C379 55,380 55,381 54 C381 54,382 54,383 54 C384 54,385 55,386 55 C387 56,387 57,387 59 C387 59,387 60,387 60 C387 60,387 61,387 61 L387 61 C389 59,390 57,392 56 C394 55,395 54,397 54 C399 54,401 55,402 56 C402 57,403 58,403 60 C403 60,403 60,403 60 C403 60,403 61,403 61 L403 61 C405 58,406 57,408 56 C410 55,411 54,413 54 C415 54,416 55,417 56 C418 57,419 58,419 60 C419 60,419 61,418 62 C418 63,418 64,418 65 C418 66,417 67,417 68 C417 69,416 70,416 71 C416 72,416 72,416 73 C416 73,416 74,416 74 C415 74,415 74,415 75 C415 75,415 75,415 75 C415 76,415 76,416 77 C416 77,416 77,417 77 C417 77,418 77,418 77 C418 77,419 77,419 76 C419 76,420 76,420 75 C421 75,421 74,422 74 L423 75 C423 77,422 77,421 78 C420 79,420 79,419 80 C418 80,418 81,417 81 C416 81,415 81,415 81 C414 81,413 81,413 81 C412 81,412 80,411 80 C411 79,411 79,411 78 C410 78,410 77,410 76 C410 75,411 73,411 71 C412 70,412 69,412 68 C412 67,413 66,413 65 C413 64,413 64,413 63 C413 62,413 62,413 61 C413 60,413 59,413 59 C412 58,412 58,411 58 C410 58,410 58,409 59 C408 59,408 59,407 60 C407 60,406 61,405 61 C405 62,404 63,404 64 C403 64,403 65,402 66 C402 67,402 68,401 69 L399 81 Z" fill="#212121"/><path d="M369 249 L367 255 L362 255 L363 249 L369 249 Z M362 277 C362 278,362 279,362 280 C362 280,362 281,362 281 C362 282,362 282,362 283 C362 283,363 283,363 283 C364 283,364 283,364 283 C365 283,365 283,365 282 C366 282,366 282,366 281 C367 281,367 280,368 280 L370 282 C369 283,368 284,367 284 C366 285,366 285,365 286 C364 286,364 287,363 287 C362 287,362 287,361 287 C360 287,360 287,359 287 C359 287,358 286,358 286 C357 285,357 285,357 284 C357 284,356 283,356 282 C356 282,357 281,357 280 C357 279,357 278,357 277 C358 276,358 275,358 274 C358 273,359 272,359 271 C359 270,359 269,359 268 C360 267,360 266,360 265 C360 265,360 265,360 264 C360 264,360 264,360 264 C360 263,360 263,359 263 C359 262,358 262,357 262 L357 260 L365 260 L366 260 L362 277 Z" fill="#212121"/><path d="M378 267 L378 263 L408 263 L408 267 L378 267 Z M378 279 L378 275 L408 275 L408 279 L378 279 Z" fill="#212121"/><path d="M433 280 C433 281,433 281,433 282 C433 282,433 283,433 283 C433 283,433 283,433 284 C433 284,434 284,434 284 C434 284,434 284,435 285 C435 285,435 285,436 285 C436 285,437 285,438 285 C439 285,440 285,441 285 L441 287 L419 287 L419 285 C420 285,421 285,422 285 C423 285,423 285,424 285 C424 285,425 285,425 285 C426 284,426 284,426 284 C426 284,427 284,427 284 C427 284,427 283,427 283 C427 283,427 282,427 282 C427 282,427 281,427 280 L427 261 C427 261,427 260,427 260 C427 260,426 259,426 259 C425 259,425 260,423 260 C422 261,421 262,419 263 C419 262,419 262,419 262 C418 261,418 261,418 260 C420 259,422 258,425 257 C427 256,429 254,431 253 L433 253 C433 254,433 255,433 256 C433 257,433 257,433 258 C433 259,433 259,433 260 L433 280 Z" fill="#212121"/><path d="M492 100 L492 99 C492 98,492 97,492 96 C492 94,492 92,492 91 C491 89,491 88,490 87 C490 86,489 85,488 84 C487 83,486 83,484 83 C483 83,481 84,480 84 C478 85,477 86,475 88 L472 88 L472 85 C474 84,476 83,478 82 C479 81,480 81,482 81 C483 80,484 80,486 80 C490 80,493 81,495 84 C497 87,498 91,498 97 C498 99,498 102,497 105 C497 108,496 111,495 114 C494 118,493 120,492 123 C491 125,489 127,488 128 C486 130,485 131,483 132 C481 133,478 133,476 133 C473 133,471 133,469 132 C468 131,466 129,465 127 C465 125,464 123,464 120 C464 117,464 114,465 112 C466 109,467 107,469 104 C471 102,473 100,475 99 C478 98,480 97,483 97 C484 97,486 97,487 98 C489 98,490 99,492 100 L492 100 Z M490 107 C490 105,489 103,488 102 C487 101,486 100,484 100 C482 100,480 101,479 101 C478 102,476 103,475 105 C474 106,473 108,472 110 C472 112,471 114,471 115 C470 117,470 120,470 122 C470 124,470 126,471 127 C471 128,472 129,473 129 C474 130,475 130,476 130 C479 130,481 129,483 127 C485 125,487 122,488 117 C489 113,490 110,490 107 L490 107 Z" fill="#212121"/><path d="M518 133 C517 138,515 142,513 144 C510 147,507 148,504 148 C503 148,502 148,501 148 L502 145 C502 145,503 145,504 145 C505 145,506 145,507 144 C507 144,508 143,509 141 C509 140,510 138,511 136 L519 101 L512 101 L513 99 C515 99,516 99,516 99 C517 99,518 98,518 98 C519 98,519 97,519 97 C519 96,520 95,520 93 C522 89,524 86,526 83 C529 81,532 80,537 80 C539 80,541 80,543 81 L541 87 L538 87 C538 86,537 85,537 84 C536 83,535 83,534 83 C533 83,532 83,531 84 C530 85,529 86,528 87 C528 89,527 91,526 93 L525 97 L535 97 L534 101 L525 101 L518 133 Z" fill="#212121"/><path d="M558 114 C558 122,559 130,562 135 C565 141,569 144,575 146 L574 149 C567 147,561 143,558 137 C554 131,552 123,552 114 C552 105,554 98,558 91 C561 85,567 81,574 79 L575 82 C569 84,565 88,562 93 C559 99,558 105,558 114 L558 114 Z" fill="#212121"/><path d="M607 99 L611 96 L613 97 L608 121 C607 123,607 125,607 126 C607 127,607 128,607 128 C608 129,608 129,609 129 C610 129,611 129,611 128 C612 128,613 127,615 125 L617 127 C615 129,613 131,611 132 C610 133,608 133,606 133 C605 133,604 133,603 132 C602 131,601 129,601 128 C601 127,602 125,602 124 L602 123 C599 127,597 129,595 131 C593 132,591 133,588 133 C586 133,584 132,582 130 C581 128,580 125,580 121 C580 117,581 113,582 109 C584 105,586 102,589 100 C592 97,595 96,599 96 C600 96,602 96,603 97 C605 97,606 98,607 99 L607 99 Z M604 110 C604 109,605 108,605 107 C605 106,605 106,605 105 C605 103,604 101,604 100 C603 100,601 99,599 99 C597 99,595 100,593 102 C591 104,589 107,588 111 C587 114,586 118,586 121 C586 124,587 126,587 127 C588 128,589 129,591 129 C593 129,594 128,596 127 C597 126,599 123,600 121 C602 118,603 115,604 111 L604 110 Z" fill="#212121"/><path d="M630 120 L628 126 L623 126 L624 120 L630 120 Z M623 148 C623 149,623 150,623 151 C623 151,623 152,623 152 C623 153,623 153,623 154 C623 154,624 154,624 154 C625 154,625 154,625 154 C626 154,626 154,626 153 C627 153,627 153,627 152 C628 152,628 151,629 151 L631 153 C630 154,629 155,628 155 C627 156,627 156,626 157 C625 157,625 158,624 158 C623 158,623 158,622 158 C621 158,621 158,620 158 C620 158,619 157,619 157 C618 156,618 156,618 155 C618 155,617 154,617 153 C617 153,618 152,618 151 C618 150,618 149,618 148 C619 147,619 146,619 145 C619 144,620 143,620 142 C620 141,620 140,620 139 C621 138,621 137,621 136 C621 136,621 136,621 135 C621 135,621 135,621 135 C621 134,621 134,620 134 C620 133,619 133,618 133 L618 131 L626 131 L627 131 L623 148 Z" fill="#212121"/><path d="M653 114 C653 105,652 99,649 93 C646 88,642 84,636 82 L637 79 C644 81,650 85,653 91 C657 98,659 105,659 114 C659 123,657 131,653 137 C650 143,644 147,637 149 L636 146 C642 144,646 141,649 135 C652 130,653 122,653 114 L653 114 Z" fill="#212121"/><path d="M544 210 L544 209 C544 208,544 207,544 206 C544 204,544 202,544 201 C543 199,543 198,542 197 C542 196,541 195,540 194 C539 193,538 193,536 193 C535 193,533 194,532 194 C530 195,529 196,527 198 L524 198 L524 195 C526 194,528 193,530 192 C531 191,532 191,534 191 C535 190,536 190,538 190 C542 190,545 191,547 194 C549 197,550 201,550 207 C550 209,550 212,549 215 C549 218,548 221,547 224 C546 228,545 230,544 233 C543 235,541 237,540 238 C538 240,537 241,535 242 C533 243,530 243,528 243 C525 243,523 243,521 242 C520 241,518 239,517 237 C517 235,516 233,516 230 C516 227,516 224,517 222 C518 219,519 217,521 214 C523 212,525 210,527 209 C530 208,532 207,535 207 C536 207,538 207,539 208 C541 208,542 209,544 210 L544 210 Z M542 217 C542 215,541 213,540 212 C539 211,538 210,536 210 C534 210,532 211,531 211 C530 212,528 213,527 215 C526 216,525 218,524 220 C524 222,523 224,523 225 C522 227,522 230,522 232 C522 234,522 236,523 237 C523 238,524 239,525 239 C526 240,527 240,528 240 C531 240,533 239,535 237 C537 235,539 232,540 227 C541 223,542 220,542 217 L542 217 Z" fill="#212121"/><path d="M585 209 L589 206 L591 207 L586 231 C585 233,585 235,585 236 C585 237,585 238,585 238 C586 239,586 239,587 239 C588 239,589 239,589 238 C590 238,591 237,593 235 L595 237 C593 239,591 241,589 242 C588 243,586 243,584 243 C583 243,582 243,581 242 C580 241,579 239,579 238 C579 237,580 235,580 234 L580 233 C577 237,575 239,573 241 C571 242,569 243,566 243 C564 243,562 242,560 240 C559 238,558 235,558 231 C558 227,559 223,560 219 C562 215,564 212,567 210 C570 207,573 206,577 206 C578 206,580 206,581 207 C583 207,584 208,585 209 L585 209 Z M582 220 C582 219,583 218,583 217 C583 216,583 216,583 215 C583 213,582 211,582 210 C581 210,579 209,577 209 C575 209,573 210,571 212 C569 214,567 217,566 221 C565 224,564 228,564 231 C564 234,565 236,565 237 C566 238,567 239,569 239 C571 239,572 238,574 237 C575 236,577 233,578 231 C580 228,581 225,582 221 L582 220 Z" fill="#212121"/><path d="M582 189 L590 201 L587 203 L580 194 L580 194 L571 203 L569 201 L577 189 L582 189 Z" fill="#212121"/><path d="M608 230 L606 236 L601 236 L602 230 L608 230 Z M601 258 C601 259,601 260,601 261 C601 261,601 262,601 262 C601 263,601 263,601 264 C601 264,602 264,602 264 C603 264,603 264,603 264 C604 264,604 264,604 263 C605 263,605 263,605 262 C606 262,606 261,607 261 L609 263 C608 264,607 265,606 265 C605 266,605 266,604 267 C603 267,603 268,602 268 C601 268,601 268,600 268 C599 268,599 268,598 268 C598 268,597 267,597 267 C596 266,596 266,596 265 C596 265,595 264,595 263 C595 263,596 262,596 261 C596 260,596 259,596 258 C597 257,597 256,597 255 C597 254,598 253,598 252 C598 251,598 250,598 249 C599 248,599 247,599 246 C599 246,599 246,599 245 C599 245,599 245,599 245 C599 244,599 244,598 244 C598 243,597 243,596 243 L596 241 L604 241 L605 241 L601 258 Z" fill="#212121"/><rect x="461" y="168" width="205" height="5" fill="#212121"/><path d="M714 176 L712 180 L702 173 L704 185 L699 185 L700 173 L690 180 L688 176 L698 171 L688 166 L690 162 L700 169 L699 157 L704 157 L702 169 L712 162 L714 166 L704 171 L714 176 Z" fill="#212121"/><path d="M807 116 L807 111 L853 111 L853 116 L807 116 Z" fill="#212121"/><path d="M901 125 C901 127,901 128,901 128 C901 129,902 130,902 130 C902 131,903 131,904 131 C905 132,905 132,907 132 C908 132,909 132,911 132 L911 135 L884 135 L884 132 C887 132,889 132,890 132 C891 131,892 131,892 131 C893 130,893 130,894 129 C894 128,894 127,894 125 L894 95 C894 94,894 94,894 93 C893 93,893 93,892 93 C891 93,890 93,889 94 C887 95,886 96,884 97 L882 94 L899 84 L901 84 C901 86,901 90,901 94 L901 125 Z" fill="#212121"/><path d="M749 222 L762 250 L780 188 L790 188 L790 193 L783 193 L763 260 L760 260 L745 228 L738 230 L737 228 L749 222 Z" fill="#212121"/><path d="M827 228 L815 228 L815 228 C817 230,818 232,818 233 C819 235,819 237,819 239 C819 243,818 246,817 249 C815 252,813 255,810 256 C807 258,804 259,801 259 C797 259,794 258,791 256 C789 254,788 251,788 246 C788 244,789 241,790 239 C790 236,792 234,793 232 C795 230,797 228,799 227 C801 226,803 225,806 224 C809 223,812 223,817 223 L828 223 L827 228 Z M811 228 C808 228,805 229,802 231 C800 233,798 235,796 238 C795 241,794 245,794 248 C794 250,794 252,795 253 C796 254,796 255,797 255 C798 256,799 256,800 256 C803 256,805 255,807 254 C809 252,810 250,811 246 C812 243,813 240,813 237 C813 233,812 230,811 228 L811 228 Z" fill="#212121"/><path d="M849 231 C849 231,850 231,851 231 C851 231,851 231,852 231 C852 230,852 230,853 230 C853 229,853 229,853 228 L856 228 C856 229,856 230,856 232 C856 233,856 234,855 235 L833 235 L833 234 C833 233,834 232,834 231 C835 230,835 229,836 228 C837 227,838 226,839 225 C839 224,840 223,842 222 C843 220,845 219,846 218 C847 216,848 215,848 214 C849 213,849 213,849 212 C850 211,850 210,850 209 C850 208,850 208,849 207 C849 206,849 205,848 205 C848 204,847 204,846 204 C846 203,845 203,844 203 C842 203,841 204,840 204 C839 205,838 206,837 208 L834 208 L834 203 C836 202,838 201,840 201 C842 200,844 200,845 200 C847 200,849 200,850 201 C851 201,852 202,853 202 C854 203,854 204,855 205 C855 206,855 207,855 208 C855 209,855 210,855 210 C855 211,855 212,855 212 C854 213,854 213,854 214 C853 215,853 215,852 216 C852 217,851 217,851 218 C850 219,849 220,848 220 C847 221,846 222,846 223 C845 224,844 225,843 226 C842 227,841 228,840 229 C840 230,839 230,839 231 L849 231 Z" fill="#212121"/><path d="M907 239 L907 260 L901 260 L901 239 L881 239 L881 234 L901 234 L901 213 L907 213 L907 234 L927 234 L927 239 L907 239 Z" fill="#212121"/><path d="M981 231 L977 231 C977 227,975 225,971 225 C969 225,967 226,965 227 C964 228,963 230,963 233 C963 234,964 236,965 237 C966 238,968 238,970 238 L975 238 L975 242 L971 242 C969 242,968 242,966 242 C965 243,964 243,963 244 C962 244,961 245,961 245 C960 246,959 247,959 247 C959 248,959 249,959 250 C959 252,959 253,960 254 C962 255,963 255,966 255 C967 255,969 255,971 254 C973 254,975 253,977 251 L979 254 C977 256,974 257,972 258 C969 259,967 259,964 259 C961 259,959 259,958 258 C956 257,954 256,954 255 C953 253,952 252,952 250 C952 248,953 246,955 244 C957 242,960 241,964 240 L964 240 C959 238,957 236,957 232 C957 230,958 229,959 227 C960 226,961 225,963 224 C966 223,968 222,971 222 C975 222,978 223,982 224 L981 231 Z" fill="#212121"/><rect x="785" y="188" width="198" height="5" fill="#212121"/><rect x="736" y="168" width="247" height="5" fill="#212121"/><path d="M987 60 C998 71,1007 86,1013 104 C1019 123,1022 145,1022 170 C1022 196,1019 218,1013 237 C1007 256,998 270,987 281 L985 278 C995 267,1002 253,1007 234 C1013 215,1015 194,1015 170 C1015 147,1013 126,1007 107 C1002 89,995 74,985 63 L987 60 Z" fill="#212121"/><path d="M1077 173 L1077 194 L1071 194 L1071 173 L1051 173 L1051 168 L1071 168 L1071 147 L1077 147 L1077 168 L1097 168 L1097 173 L1077 173 Z" fill="#212121"/><path d="M1136 166 L1136 177 C1136 209,1140 239,1146 268 C1153 297,1163 320,1175 338 L1172 340 C1159 323,1148 299,1140 270 C1132 242,1128 210,1128 177 L1128 166 L1136 166 Z M1128 174 L1128 163 C1128 130,1132 99,1140 70 C1148 42,1159 19,1172 1 L1175 3 C1163 21,1153 44,1146 73 C1140 102,1136 132,1136 163 L1136 174 L1128 174 Z" fill="#212121"/><path d="M1207 100 L1207 99 C1207 98,1207 97,1207 96 C1207 94,1207 92,1207 91 C1206 89,1206 88,1205 87 C1205 86,1204 85,1203 84 C1202 83,1201 83,1199 83 C1198 83,1196 84,1195 84 C1193 85,1192 86,1190 88 L1187 88 L1187 85 C1189 84,1191 83,1193 82 C1194 81,1195 81,1197 81 C1198 80,1199 80,1201 80 C1205 80,1208 81,1210 84 C1212 87,1213 91,1213 97 C1213 99,1213 102,1212 105 C1212 108,1211 111,1210 114 C1209 118,1208 120,1207 123 C1206 125,1204 127,1203 128 C1201 130,1200 131,1198 132 C1196 133,1193 133,1191 133 C1188 133,1186 133,1184 132 C1183 131,1181 129,1180 127 C1180 125,1179 123,1179 120 C1179 117,1179 114,1180 112 C1181 109,1182 107,1184 104 C1186 102,1188 100,1190 99 C1193 98,1195 97,1198 97 C1199 97,1201 97,1202 98 C1204 98,1205 99,1207 100 L1207 100 Z M1205 107 C1205 105,1204 103,1203 102 C1202 101,1201 100,1199 100 C1197 100,1195 101,1194 101 C1193 102,1191 103,1190 105 C1189 106,1188 108,1187 110 C1187 112,1186 114,1186 115 C1185 117,1185 120,1185 122 C1185 124,1185 126,1186 127 C1186 128,1187 129,1188 129 C1189 130,1190 130,1191 130 C1194 130,1196 129,1198 127 C1200 125,1202 122,1203 117 C1204 113,1205 110,1205 107 L1205 107 Z" fill="#212121"/><path d="M1233 133 C1232 138,1230 142,1228 144 C1225 147,1222 148,1219 148 C1218 148,1217 148,1216 148 L1217 145 C1217 145,1218 145,1219 145 C1220 145,1221 145,1222 144 C1222 144,1223 143,1224 141 C1224 140,1225 138,1226 136 L1234 101 L1227 101 L1228 99 C1230 99,1231 99,1231 99 C1232 99,1233 98,1233 98 C1234 98,1234 97,1234 97 C1234 96,1235 95,1235 93 C1237 89,1239 86,1241 83 C1244 81,1247 80,1252 80 C1254 80,1256 80,1258 81 L1256 87 L1253 87 C1253 86,1252 85,1252 84 C1251 83,1250 83,1249 83 C1248 83,1247 83,1246 84 C1245 85,1244 86,1243 87 C1243 89,1242 91,1241 93 L1240 97 L1250 97 L1249 101 L1240 101 L1233 133 Z" fill="#212121"/><path d="M1273 114 C1273 122,1274 130,1277 135 C1280 141,1284 144,1290 146 L1289 149 C1282 147,1276 143,1273 137 C1269 131,1267 123,1267 114 C1267 105,1269 98,1273 91 C1276 85,1282 81,1289 79 L1290 82 C1284 84,1280 88,1277 93 C1274 99,1273 105,1273 114 L1273 114 Z" fill="#212121"/><path d="M1322 99 L1326 96 L1328 97 L1323 121 C1322 123,1322 125,1322 126 C1322 127,1322 128,1322 128 C1323 129,1323 129,1324 129 C1325 129,1326 129,1326 128 C1327 128,1328 127,1330 125 L1332 127 C1330 129,1328 131,1326 132 C1325 133,1323 133,1321 133 C1320 133,1319 133,1318 132 C1317 131,1316 129,1316 128 C1316 127,1317 125,1317 124 L1317 123 C1314 127,1312 129,1310 131 C1308 132,1306 133,1303 133 C1301 133,1299 132,1297 130 C1296 128,1295 125,1295 121 C1295 117,1296 113,1297 109 C1299 105,1301 102,1304 100 C1307 97,1310 96,1314 96 C1315 96,1317 96,1318 97 C1320 97,1321 98,1322 99 L1322 99 Z M1319 110 C1319 109,1320 108,1320 107 C1320 106,1320 106,1320 105 C1320 103,1319 101,1319 100 C1318 100,1316 99,1314 99 C1312 99,1310 100,1308 102 C1306 104,1304 107,1303 111 C1302 114,1301 118,1301 121 C1301 124,1302 126,1302 127 C1303 128,1304 129,1306 129 C1308 129,1309 128,1311 127 C1312 126,1314 123,1315 121 C1317 118,1318 115,1319 111 L1319 110 Z" fill="#212121"/><path d="M1345 120 L1343 126 L1338 126 L1339 120 L1345 120 Z M1338 148 C1338 149,1338 150,1338 151 C1338 151,1338 152,1338 152 C1338 153,1338 153,1338 154 C1338 154,1339 154,1339 154 C1340 154,1340 154,1340 154 C1341 154,1341 154,1341 153 C1342 153,1342 153,1342 152 C1343 152,1343 151,1344 151 L1346 153 C1345 154,1344 155,1343 155 C1342 156,1342 156,1341 157 C1340 157,1340 158,1339 158 C1338 158,1338 158,1337 158 C1336 158,1336 158,1335 158 C1335 158,1334 157,1334 157 C1333 156,1333 156,1333 155 C1333 155,1332 154,1332 153 C1332 153,1333 152,1333 151 C1333 150,1333 149,1333 148 C1334 147,1334 146,1334 145 C1334 144,1335 143,1335 142 C1335 141,1335 140,1335 139 C1336 138,1336 137,1336 136 C1336 136,1336 136,1336 135 C1336 135,1336 135,1336 135 C1336 134,1336 134,1335 134 C1335 133,1334 133,1333 133 L1333 131 L1341 131 L1342 131 L1338 148 Z" fill="#212121"/><path d="M1368 114 C1368 105,1367 99,1364 93 C1361 88,1357 84,1351 82 L1352 79 C1359 81,1365 85,1368 91 C1372 98,1374 105,1374 114 C1374 123,1372 131,1368 137 C1365 143,1359 147,1352 149 L1351 146 C1357 144,1361 141,1364 135 C1367 130,1368 122,1368 114 L1368 114 Z" fill="#212121"/><path d="M1252 210 L1252 209 C1252 208,1252 207,1252 206 C1252 204,1252 202,1252 201 C1251 199,1251 198,1250 197 C1250 196,1249 195,1248 194 C1247 193,1246 193,1244 193 C1243 193,1241 194,1240 194 C1238 195,1237 196,1235 198 L1232 198 L1232 195 C1234 194,1236 193,1238 192 C1239 191,1240 191,1242 191 C1243 190,1244 190,1246 190 C1250 190,1253 191,1255 194 C1257 197,1258 201,1258 207 C1258 209,1258 212,1257 215 C1257 218,1256 221,1255 224 C1254 228,1253 230,1252 233 C1251 235,1249 237,1248 238 C1246 240,1245 241,1243 242 C1241 243,1238 243,1236 243 C1233 243,1231 243,1229 242 C1228 241,1226 239,1225 237 C1225 235,1224 233,1224 230 C1224 227,1224 224,1225 222 C1226 219,1227 217,1229 214 C1231 212,1233 210,1235 209 C1238 208,1240 207,1243 207 C1244 207,1246 207,1247 208 C1249 208,1250 209,1252 210 L1252 210 Z M1250 217 C1250 215,1249 213,1248 212 C1247 211,1246 210,1244 210 C1242 210,1240 211,1239 211 C1238 212,1236 213,1235 215 C1234 216,1233 218,1232 220 C1232 222,1231 224,1231 225 C1230 227,1230 230,1230 232 C1230 234,1230 236,1231 237 C1231 238,1232 239,1233 239 C1234 240,1235 240,1236 240 C1239 240,1241 239,1243 237 C1245 235,1247 232,1248 227 C1249 223,1250 220,1250 217 L1250 217 Z" fill="#212121"/><path d="M1304 212 L1292 212 L1292 212 C1294 214,1295 216,1295 217 C1296 219,1296 221,1296 223 C1296 227,1295 230,1294 233 C1292 236,1290 239,1287 240 C1284 242,1281 243,1278 243 C1274 243,1271 242,1268 240 C1266 238,1265 235,1265 230 C1265 228,1266 225,1267 223 C1267 220,1269 218,1270 216 C1272 214,1274 212,1276 211 C1278 210,1280 209,1283 208 C1286 207,1289 207,1294 207 L1305 207 L1304 212 Z M1288 212 C1285 212,1282 213,1279 215 C1277 217,1275 219,1273 222 C1272 225,1271 229,1271 232 C1271 234,1271 236,1272 237 C1273 238,1273 239,1274 239 C1275 240,1276 240,1277 240 C1280 240,1282 239,1284 238 C1286 236,1287 234,1288 230 C1289 227,1290 224,1290 221 C1290 217,1289 214,1288 212 L1288 212 Z" fill="#212121"/><path d="M1326 215 C1326 215,1327 215,1328 215 C1328 215,1328 215,1329 215 C1329 214,1329 214,1330 214 C1330 213,1330 213,1330 212 L1333 212 C1333 213,1333 214,1333 216 C1333 217,1333 218,1332 219 L1310 219 L1310 218 C1310 217,1311 216,1311 215 C1312 214,1312 213,1313 212 C1314 211,1315 210,1316 209 C1316 208,1317 207,1319 206 C1320 204,1322 203,1323 202 C1324 200,1325 199,1325 198 C1326 197,1326 197,1326 196 C1327 195,1327 194,1327 193 C1327 192,1327 192,1326 191 C1326 190,1326 189,1325 189 C1325 188,1324 188,1323 188 C1323 187,1322 187,1321 187 C1319 187,1318 188,1317 188 C1316 189,1315 190,1314 192 L1311 192 L1311 187 C1313 186,1315 185,1317 185 C1319 184,1321 184,1322 184 C1324 184,1326 184,1327 185 C1328 185,1329 186,1330 186 C1331 187,1331 188,1332 189 C1332 190,1332 191,1332 192 C1332 193,1332 194,1332 194 C1332 195,1332 196,1332 196 C1331 197,1331 197,1331 198 C1330 199,1330 199,1329 200 C1329 201,1328 201,1328 202 C1327 203,1326 204,1325 204 C1324 205,1323 206,1323 207 C1322 208,1321 209,1320 210 C1319 211,1318 212,1317 213 C1317 214,1316 214,1316 215 L1326 215 Z" fill="#212121"/><rect x="1176" y="168" width="205" height="5" fill="#212121"/><path d="M1429 176 L1427 180 L1417 173 L1419 185 L1414 185 L1415 173 L1405 180 L1403 176 L1413 171 L1403 166 L1405 162 L1415 169 L1414 157 L1419 157 L1417 169 L1427 162 L1429 166 L1419 171 L1429 176 Z" fill="#212121"/><path d="M1456 78 L1456 73 L1502 73 L1502 78 L1456 78 Z" fill="#212121"/><path d="M1550 91 C1551 91,1552 91,1553 91 C1554 91,1555 90,1555 90 C1555 90,1556 89,1556 89 C1556 88,1557 87,1557 86 L1560 86 L1559 97 L1529 97 L1529 95 C1530 93,1532 90,1533 87 C1535 85,1538 81,1541 78 C1544 74,1546 72,1547 70 C1548 69,1549 67,1550 66 C1551 65,1551 63,1552 62 C1552 61,1552 60,1552 59 C1552 57,1552 55,1551 54 C1550 52,1550 51,1548 50 C1547 50,1545 49,1544 49 C1539 49,1536 52,1534 57 L1530 57 L1530 50 C1533 48,1536 48,1538 47 C1541 46,1543 46,1545 46 C1550 46,1553 47,1556 49 C1558 51,1559 54,1559 57 C1559 59,1559 60,1559 61 C1558 62,1558 63,1557 64 C1557 66,1556 67,1555 68 C1554 69,1553 70,1552 72 C1551 73,1549 75,1546 78 C1542 83,1538 87,1536 91 L1550 91 Z" fill="#212121"/><path d="M1612 49 L1629 76 L1629 79 L1610 106 L1634 106 C1635 106,1636 106,1637 106 C1638 106,1639 105,1639 105 C1640 104,1640 104,1641 103 C1641 102,1641 101,1642 100 C1642 99,1643 97,1643 95 L1647 95 L1646 113 L1600 113 L1600 111 L1622 80 L1601 47 L1601 45 L1646 45 L1646 61 L1642 61 C1641 59,1641 57,1640 56 C1640 54,1639 53,1639 52 C1638 52,1638 51,1637 50 C1636 50,1636 50,1635 49 C1634 49,1633 49,1632 49 L1612 49 Z" fill="#212121"/><path d="M1626 27 L1620 27 C1621 26,1621 25,1621 24 C1622 22,1622 21,1622 20 C1623 18,1623 17,1623 16 C1623 15,1624 13,1624 12 C1624 11,1624 10,1625 9 C1625 8,1625 8,1625 7 C1625 6,1625 5,1624 5 C1624 4,1623 4,1622 4 C1621 4,1620 4,1619 5 C1618 6,1617 6,1616 7 C1616 9,1615 10,1614 11 C1613 12,1613 13,1613 15 L1610 27 L1605 27 L1609 10 C1609 9,1609 8,1609 8 C1609 7,1609 6,1609 6 C1609 5,1609 4,1608 4 C1607 4,1607 4,1607 4 C1606 4,1606 5,1606 5 C1605 5,1605 6,1604 6 C1604 6,1604 7,1603 7 L1601 6 C1602 5,1603 4,1604 3 C1604 2,1605 2,1606 1 C1606 1,1607 1,1608 0 C1608 0,1609 0,1610 0 C1611 0,1612 1,1613 1 C1614 2,1614 3,1614 5 C1614 5,1614 6,1614 6 C1614 6,1614 7,1614 7 L1614 7 C1616 5,1617 3,1619 2 C1621 1,1622 0,1624 0 C1626 0,1628 1,1629 2 C1629 3,1630 4,1630 6 C1630 6,1630 6,1630 6 C1630 6,1630 7,1630 7 L1630 7 C1632 4,1633 3,1635 2 C1637 1,1638 0,1640 0 C1642 0,1643 1,1644 2 C1645 3,1646 4,1646 6 C1646 6,1646 7,1645 8 C1645 9,1645 10,1645 11 C1645 12,1644 13,1644 14 C1644 15,1643 16,1643 17 C1643 18,1643 18,1643 19 C1643 19,1643 20,1643 20 C1642 20,1642 20,1642 21 C1642 21,1642 21,1642 21 C1642 22,1642 22,1643 23 C1643 23,1643 23,1644 23 C1644 23,1645 23,1645 23 C1645 23,1646 23,1646 22 C1646 22,1647 22,1647 21 C1648 21,1648 20,1649 20 L1650 21 C1650 23,1649 23,1648 24 C1647 25,1647 25,1646 26 C1645 26,1645 27,1644 27 C1643 27,1642 27,1642 27 C1641 27,1640 27,1640 27 C1639 27,1639 26,1638 26 C1638 25,1638 25,1638 24 C1637 24,1637 23,1637 22 C1637 21,1638 19,1638 17 C1639 16,1639 15,1639 14 C1639 13,1640 12,1640 11 C1640 10,1640 10,1640 9 C1640 8,1640 8,1640 7 C1640 6,1640 5,1640 5 C1639 4,1639 4,1638 4 C1637 4,1637 4,1636 5 C1635 5,1635 5,1634 6 C1634 6,1633 7,1632 7 C1632 8,1631 9,1631 10 C1630 10,1630 11,1629 12 C1629 13,1629 14,1628 15 L1626 27 Z" fill="#212121"/><path d="M1596 120 L1594 126 L1589 126 L1590 120 L1596 120 Z M1589 148 C1589 149,1589 150,1589 151 C1589 151,1589 152,1589 152 C1589 153,1589 153,1589 154 C1589 154,1590 154,1590 154 C1591 154,1591 154,1591 154 C1592 154,1592 154,1592 153 C1593 153,1593 153,1593 152 C1594 152,1594 151,1595 151 L1597 153 C1596 154,1595 155,1594 155 C1593 156,1593 156,1592 157 C1591 157,1591 158,1590 158 C1589 158,1589 158,1588 158 C1587 158,1587 158,1586 158 C1586 158,1585 157,1585 157 C1584 156,1584 156,1584 155 C1584 155,1583 154,1583 153 C1583 153,1584 152,1584 151 C1584 150,1584 149,1584 148 C1585 147,1585 146,1585 145 C1585 144,1586 143,1586 142 C1586 141,1586 140,1586 139 C1587 138,1587 137,1587 136 C1587 136,1587 136,1587 135 C1587 135,1587 135,1587 135 C1587 134,1587 134,1586 134 C1586 133,1585 133,1584 133 L1584 131 L1592 131 L1593 131 L1589 148 Z" fill="#212121"/><path d="M1605 138 L1605 134 L1635 134 L1635 138 L1605 138 Z M1605 150 L1605 146 L1635 146 L1635 150 L1605 150 Z" fill="#212121"/><path d="M1660 151 C1660 152,1660 152,1660 153 C1660 153,1660 154,1660 154 C1660 154,1660 154,1660 155 C1660 155,1661 155,1661 155 C1661 155,1661 155,1662 156 C1662 156,1662 156,1663 156 C1663 156,1664 156,1665 156 C1666 156,1667 156,1668 156 L1668 158 L1646 158 L1646 156 C1647 156,1648 156,1649 156 C1650 156,1650 156,1651 156 C1651 156,1652 156,1652 156 C1653 155,1653 155,1653 155 C1653 155,1654 155,1654 155 C1654 155,1654 154,1654 154 C1654 154,1654 153,1654 153 C1654 153,1654 152,1654 151 L1654 132 C1654 132,1654 131,1654 131 C1654 131,1653 130,1653 130 C1652 130,1652 131,1650 131 C1649 132,1648 133,1646 134 C1646 133,1646 133,1646 133 C1645 132,1645 132,1645 131 C1647 130,1649 129,1652 128 C1654 127,1656 125,1658 124 L1660 124 C1660 125,1660 126,1660 127 C1660 128,1660 128,1660 129 C1660 130,1660 130,1660 131 L1660 151 Z" fill="#212121"/><path d="M1685 79 C1685 87,1686 95,1689 100 C1692 106,1696 109,1702 111 L1701 114 C1694 112,1688 108,1685 102 C1681 96,1679 88,1679 79 C1679 70,1681 63,1685 56 C1688 50,1694 46,1701 44 L1702 47 C1696 49,1692 53,1689 58 C1686 64,1685 70,1685 79 L1685 79 Z" fill="#212121"/><path d="M1734 64 L1738 61 L1740 62 L1735 86 C1734 88,1734 90,1734 91 C1734 92,1734 93,1734 93 C1735 94,1735 94,1736 94 C1737 94,1738 94,1738 93 C1739 93,1740 92,1742 90 L1744 92 C1742 94,1740 96,1738 97 C1737 98,1735 98,1733 98 C1732 98,1731 98,1730 97 C1729 96,1728 94,1728 93 C1728 92,1729 90,1729 89 L1729 88 C1726 92,1724 94,1722 96 C1720 97,1718 98,1715 98 C1713 98,1711 97,1709 95 C1708 93,1707 90,1707 86 C1707 82,1708 78,1709 74 C1711 70,1713 67,1716 65 C1719 62,1722 61,1726 61 C1727 61,1729 61,1730 62 C1732 62,1733 63,1734 64 L1734 64 Z M1731 75 C1731 74,1732 73,1732 72 C1732 71,1732 71,1732 70 C1732 68,1731 66,1731 65 C1730 65,1728 64,1726 64 C1724 64,1722 65,1720 67 C1718 69,1716 72,1715 76 C1714 79,1713 83,1713 86 C1713 89,1714 91,1714 92 C1715 93,1716 94,1718 94 C1720 94,1721 93,1723 92 C1724 91,1726 88,1727 86 C1729 83,1730 80,1731 76 L1731 75 Z" fill="#212121"/><path d="M1757 85 L1755 91 L1750 91 L1751 85 L1757 85 Z M1750 113 C1750 114,1750 115,1750 116 C1750 116,1750 117,1750 117 C1750 118,1750 118,1750 119 C1750 119,1751 119,1751 119 C1752 119,1752 119,1752 119 C1753 119,1753 119,1753 118 C1754 118,1754 118,1754 117 C1755 117,1755 116,1756 116 L1758 118 C1757 119,1756 120,1755 120 C1754 121,1754 121,1753 122 C1752 122,1752 123,1751 123 C1750 123,1750 123,1749 123 C1748 123,1748 123,1747 123 C1747 123,1746 122,1746 122 C1745 121,1745 121,1745 120 C1745 120,1744 119,1744 118 C1744 118,1745 117,1745 116 C1745 115,1745 114,1745 113 C1746 112,1746 111,1746 110 C1746 109,1747 108,1747 107 C1747 106,1747 105,1747 104 C1748 103,1748 102,1748 101 C1748 101,1748 101,1748 100 C1748 100,1748 100,1748 100 C1748 99,1748 99,1747 99 C1747 98,1746 98,1745 98 L1745 96 L1753 96 L1754 96 L1750 113 Z" fill="#212121"/><path d="M1784 78 L1784 73 L1830 73 L1830 78 L1784 78 Z" fill="#212121"/><path d="M1883 64 L1887 61 L1889 62 L1884 86 C1883 88,1883 90,1883 91 C1883 92,1883 93,1883 93 C1884 94,1884 94,1885 94 C1886 94,1887 94,1887 93 C1888 93,1889 92,1891 90 L1893 92 C1891 94,1889 96,1887 97 C1886 98,1884 98,1882 98 C1881 98,1880 98,1879 97 C1878 96,1877 94,1877 93 C1877 92,1878 90,1878 89 L1878 88 C1875 92,1873 94,1871 96 C1869 97,1867 98,1864 98 C1862 98,1860 97,1858 95 C1857 93,1856 90,1856 86 C1856 82,1857 78,1858 74 C1860 70,1862 67,1865 65 C1868 62,1871 61,1875 61 C1876 61,1878 61,1879 62 C1881 62,1882 63,1883 64 L1883 64 Z M1880 75 C1880 74,1881 73,1881 72 C1881 71,1881 71,1881 70 C1881 68,1880 66,1880 65 C1879 65,1877 64,1875 64 C1873 64,1871 65,1869 67 C1867 69,1865 72,1864 76 C1863 79,1862 83,1862 86 C1862 89,1863 91,1863 92 C1864 93,1865 94,1867 94 C1869 94,1870 93,1872 92 C1873 91,1875 88,1876 86 C1878 83,1879 80,1880 76 L1880 75 Z" fill="#212121"/><path d="M1887 53 L1868 53 L1868 49 L1887 49 L1887 53 Z" fill="#212121"/><path d="M1914 79 C1914 70,1913 64,1910 58 C1907 53,1903 49,1897 47 L1898 44 C1905 46,1911 50,1914 56 C1918 63,1920 70,1920 79 C1920 88,1918 96,1914 102 C1911 108,1905 112,1898 114 L1897 111 C1903 109,1907 106,1910 100 C1913 95,1914 87,1914 79 L1914 79 Z" fill="#212121"/><path d="M1673 216 C1675 212,1678 210,1680 208 C1682 207,1684 206,1687 206 C1689 206,1691 207,1692 208 C1693 209,1694 211,1694 214 L1694 214 C1694 214,1694 214,1694 215 C1696 212,1698 210,1700 208 C1702 207,1704 206,1706 206 C1709 206,1710 207,1712 208 C1713 209,1714 211,1714 214 C1714 215,1713 218,1712 220 L1710 230 C1709 233,1709 235,1709 236 C1709 237,1709 238,1710 238 C1710 239,1710 239,1711 239 C1712 239,1713 239,1713 238 C1714 238,1715 237,1717 235 L1719 237 C1717 239,1715 241,1714 242 C1712 243,1710 243,1708 243 C1707 243,1705 242,1704 241 C1703 240,1703 239,1703 237 C1703 235,1703 233,1704 230 L1706 223 C1706 221,1707 219,1707 218 C1707 217,1707 216,1707 215 C1707 213,1707 212,1706 211 C1706 210,1705 210,1704 210 C1703 210,1701 211,1700 211 C1699 212,1698 213,1697 215 C1695 217,1694 218,1693 220 C1693 221,1692 223,1691 226 L1688 242 L1682 242 L1686 223 C1687 221,1687 219,1687 218 C1687 217,1687 216,1687 215 C1687 213,1687 212,1686 211 C1686 210,1685 210,1683 210 C1683 210,1682 211,1680 211 C1679 212,1678 213,1677 215 C1675 217,1674 218,1673 220 C1673 222,1672 224,1671 226 L1668 242 L1662 242 L1667 218 C1668 216,1668 214,1668 213 C1668 212,1668 211,1667 211 C1667 210,1667 210,1666 210 C1665 210,1664 210,1663 211 C1663 212,1661 213,1660 214 L1658 212 C1660 210,1662 209,1663 208 C1665 207,1667 206,1669 206 C1670 206,1671 207,1672 208 C1673 209,1674 210,1674 211 C1674 213,1673 214,1673 216 L1673 216 Z" fill="#212121"/><rect x="1451" y="168" width="476" height="5" fill="#212121"/><path d="M1975 166 L1975 177 C1975 210,1971 242,1963 270 C1955 299,1944 323,1931 340 L1928 338 C1940 320,1950 297,1957 268 C1964 239,1967 209,1967 177 L1967 166 L1975 166 Z M1967 174 L1967 163 C1967 132,1964 102,1957 73 C1950 45,1940 21,1928 3 L1931 1 C1944 19,1955 42,1963 70 C1971 99,1975 130,1975 163 L1975 174 L1967 174 Z" fill="#212121"/></svg></span></p>
<p class="p_Text" style="text-align: center;"><span style="display:inline-block;width:484px;height:46px;padding:0 0;overflow:visible"><svg xmlns="http://www.w3.org/2000/svg" style="width:100%;height:100%;overflow:visible" viewBox="0 0 1936 184"><path d="M31 21 L31 20 C31 19,31 18,31 17 C31 15,31 13,31 12 C30 10,30 9,29 8 C29 7,28 6,27 5 C26 4,25 4,23 4 C22 4,20 5,19 5 C17 6,16 7,14 9 L11 9 L11 6 C13 5,15 4,17 3 C18 2,19 2,21 2 C22 1,23 1,25 1 C29 1,32 2,34 5 C36 8,37 12,37 18 C37 20,37 23,36 26 C36 29,35 32,34 35 C33 39,32 41,31 44 C30 46,28 48,27 49 C25 51,24 52,22 53 C20 54,17 54,15 54 C12 54,10 54,8 53 C7 52,5 50,4 48 C4 46,3 44,3 41 C3 38,3 35,4 33 C5 30,6 28,8 25 C10 23,12 21,14 20 C17 19,19 18,22 18 C23 18,25 18,26 19 C28 19,29 20,31 21 L31 21 Z M29 28 C29 26,28 24,27 23 C26 22,25 21,23 21 C21 21,19 22,18 22 C17 23,15 24,14 26 C13 27,12 29,11 31 C11 33,10 35,10 36 C9 38,9 41,9 43 C9 45,9 47,10 48 C10 49,11 50,12 50 C13 51,14 51,15 51 C18 51,20 50,22 48 C24 46,26 43,27 38 C28 34,29 31,29 28 L29 28 Z" fill="#212121"/><path d="M57 54 C56 59,54 63,52 65 C49 68,46 69,43 69 C42 69,41 69,40 69 L41 66 C41 66,42 66,43 66 C44 66,45 66,46 65 C46 65,47 64,48 62 C48 61,49 59,50 57 L58 22 L51 22 L52 20 C54 20,55 20,55 20 C56 20,57 19,57 19 C58 19,58 18,58 18 C58 17,59 16,59 14 C61 10,63 7,65 4 C68 2,71 1,76 1 C78 1,80 1,82 2 L80 8 L77 8 C77 7,76 6,76 5 C75 4,74 4,73 4 C72 4,71 4,70 5 C69 6,68 7,67 8 C67 10,66 12,65 14 L64 18 L74 18 L73 22 L64 22 L57 54 Z" fill="#212121"/><path d="M97 35 C97 43,98 51,101 56 C104 62,108 65,114 67 L113 70 C106 68,100 64,97 58 C93 52,91 44,91 35 C91 26,93 19,97 12 C100 6,106 2,113 0 L114 3 C108 5,104 9,101 14 C98 20,97 26,97 35 L97 35 Z" fill="#212121"/><path d="M146 20 L150 17 L152 18 L147 42 C146 44,146 46,146 47 C146 48,146 49,146 49 C147 50,147 50,148 50 C149 50,150 50,150 49 C151 49,152 48,154 46 L156 48 C154 50,152 52,150 53 C149 54,147 54,145 54 C144 54,143 54,142 53 C141 52,140 50,140 49 C140 48,141 46,141 45 L141 44 C138 48,136 50,134 52 C132 53,130 54,127 54 C125 54,123 53,121 51 C120 49,119 46,119 42 C119 38,120 34,121 30 C123 26,125 23,128 21 C131 18,134 17,138 17 C139 17,141 17,142 18 C144 18,145 19,146 20 L146 20 Z M143 31 C143 30,144 29,144 28 C144 27,144 27,144 26 C144 24,143 22,143 21 C142 21,140 20,138 20 C136 20,134 21,132 23 C130 25,128 28,127 32 C126 35,125 39,125 42 C125 45,126 47,126 48 C127 49,128 50,130 50 C132 50,133 49,135 48 C136 47,138 44,139 42 C141 39,142 36,143 32 L143 31 Z" fill="#212121"/><path d="M169 41 L167 47 L162 47 L163 41 L169 41 Z M162 69 C162 70,162 71,162 72 C162 72,162 73,162 73 C162 74,162 74,162 75 C162 75,163 75,163 75 C164 75,164 75,164 75 C165 75,165 75,165 74 C166 74,166 74,166 73 C167 73,167 72,168 72 L170 74 C169 75,168 76,167 76 C166 77,166 77,165 78 C164 78,164 79,163 79 C162 79,162 79,161 79 C160 79,160 79,159 79 C159 79,158 78,158 78 C157 77,157 77,157 76 C157 76,156 75,156 74 C156 74,157 73,157 72 C157 71,157 70,157 69 C158 68,158 67,158 66 C158 65,159 64,159 63 C159 62,159 61,159 60 C160 59,160 58,160 57 C160 57,160 57,160 56 C160 56,160 56,160 56 C160 55,160 55,159 55 C159 54,158 54,157 54 L157 52 L165 52 L166 52 L162 69 Z" fill="#212121"/><path d="M192 35 C192 26,191 20,188 14 C185 9,181 5,175 3 L176 0 C183 2,189 6,192 12 C196 19,198 26,198 35 C198 44,196 52,192 58 C189 64,183 68,176 70 L175 67 C181 65,185 62,188 56 C191 51,192 43,192 35 L192 35 Z" fill="#212121"/><path d="M83 131 L83 130 C83 129,83 128,83 127 C83 125,83 123,83 122 C82 120,82 119,81 118 C81 117,80 116,79 115 C78 114,77 114,75 114 C74 114,72 115,71 115 C69 116,68 117,66 119 L63 119 L63 116 C65 115,67 114,69 113 C70 112,71 112,73 112 C74 111,75 111,77 111 C81 111,84 112,86 115 C88 118,89 122,89 128 C89 130,89 133,88 136 C88 139,87 142,86 145 C85 149,84 151,83 154 C82 156,80 158,79 159 C77 161,76 162,74 163 C72 164,69 164,67 164 C64 164,62 164,60 163 C59 162,57 160,56 158 C56 156,55 154,55 151 C55 148,55 145,56 143 C57 140,58 138,60 135 C62 133,64 131,66 130 C69 129,71 128,74 128 C75 128,77 128,78 129 C80 129,81 130,83 131 L83 131 Z M81 138 C81 136,80 134,79 133 C78 132,77 131,75 131 C73 131,71 132,70 132 C69 133,67 134,66 136 C65 137,64 139,63 141 C63 143,62 145,62 146 C61 148,61 151,61 153 C61 155,61 157,62 158 C62 159,63 160,64 160 C65 161,66 161,67 161 C70 161,72 160,74 158 C76 156,78 153,79 148 C80 144,81 141,81 138 L81 138 Z" fill="#212121"/><path d="M124 130 L128 127 L130 128 L125 152 C124 154,124 156,124 157 C124 158,124 159,124 159 C125 160,125 160,126 160 C127 160,128 160,128 159 C129 159,130 158,132 156 L134 158 C132 160,130 162,128 163 C127 164,125 164,123 164 C122 164,121 164,120 163 C119 162,118 160,118 159 C118 158,119 156,119 155 L119 154 C116 158,114 160,112 162 C110 163,108 164,105 164 C103 164,101 163,99 161 C98 159,97 156,97 152 C97 148,98 144,99 140 C101 136,103 133,106 131 C109 128,112 127,116 127 C117 127,119 127,120 128 C122 128,123 129,124 130 L124 130 Z M121 141 C121 140,122 139,122 138 C122 137,122 137,122 136 C122 134,121 132,121 131 C120 131,118 130,116 130 C114 130,112 131,110 133 C108 135,106 138,105 142 C104 145,103 149,103 152 C103 155,104 157,104 158 C105 159,106 160,108 160 C110 160,111 159,113 158 C114 157,116 154,117 152 C119 149,120 146,121 142 L121 141 Z" fill="#212121"/><path d="M147 151 L145 157 L140 157 L141 151 L147 151 Z M140 179 C140 180,140 181,140 182 C140 182,140 183,140 183 C140 184,140 184,140 185 C140 185,141 185,141 185 C142 185,142 185,142 185 C143 185,143 185,143 184 C144 184,144 184,144 183 C145 183,145 182,146 182 L148 184 C147 185,146 186,145 186 C144 187,144 187,143 188 C142 188,142 189,141 189 C140 189,140 189,139 189 C138 189,138 189,137 189 C137 189,136 188,136 188 C135 187,135 187,135 186 C135 186,134 185,134 184 C134 184,135 183,135 182 C135 181,135 180,135 179 C136 178,136 177,136 176 C136 175,137 174,137 173 C137 172,137 171,137 170 C138 169,138 168,138 167 C138 167,138 167,138 166 C138 166,138 166,138 166 C138 165,138 165,137 165 C137 164,136 164,135 164 L135 162 L143 162 L144 162 L140 179 Z" fill="#212121"/><rect x="0" y="89" width="205" height="5" fill="#212121"/><path d="M231 87 L231 82 L277 82 L277 87 L231 87 Z M231 102 L231 97 L277 97 L277 102 L231 102 Z" fill="#212121"/><path d="M334 21 L334 20 C334 19,334 18,334 17 C334 15,334 13,334 12 C333 10,333 9,332 8 C332 7,331 6,330 5 C329 4,328 4,326 4 C325 4,323 5,322 5 C320 6,319 7,317 9 L314 9 L314 6 C316 5,318 4,320 3 C321 2,322 2,324 2 C325 1,326 1,328 1 C332 1,335 2,337 5 C339 8,340 12,340 18 C340 20,340 23,339 26 C339 29,338 32,337 35 C336 39,335 41,334 44 C333 46,331 48,330 49 C328 51,327 52,325 53 C323 54,320 54,318 54 C315 54,313 54,311 53 C310 52,308 50,307 48 C307 46,306 44,306 41 C306 38,306 35,307 33 C308 30,309 28,311 25 C313 23,315 21,317 20 C320 19,322 18,325 18 C326 18,328 18,329 19 C331 19,332 20,334 21 L334 21 Z M332 28 C332 26,331 24,330 23 C329 22,328 21,326 21 C324 21,322 22,321 22 C320 23,318 24,317 26 C316 27,315 29,314 31 C314 33,313 35,313 36 C312 38,312 41,312 43 C312 45,312 47,313 48 C313 49,314 50,315 50 C316 51,317 51,318 51 C321 51,323 50,325 48 C327 46,329 43,330 38 C331 34,332 31,332 28 L332 28 Z" fill="#212121"/><path d="M360 54 C359 59,357 63,355 65 C352 68,349 69,346 69 C345 69,344 69,343 69 L344 66 C344 66,345 66,346 66 C347 66,348 66,349 65 C349 65,350 64,351 62 C351 61,352 59,353 57 L361 22 L354 22 L355 20 C357 20,358 20,358 20 C359 20,360 19,360 19 C361 19,361 18,361 18 C361 17,362 16,362 14 C364 10,366 7,368 4 C371 2,374 1,379 1 C381 1,383 1,385 2 L383 8 L380 8 C380 7,379 6,379 5 C378 4,377 4,376 4 C375 4,374 4,373 5 C372 6,371 7,370 8 C370 10,369 12,368 14 L367 18 L377 18 L376 22 L367 22 L360 54 Z" fill="#212121"/><path d="M400 35 C400 43,401 51,404 56 C407 62,411 65,417 67 L416 70 C409 68,403 64,400 58 C396 52,394 44,394 35 C394 26,396 19,400 12 C403 6,409 2,416 0 L417 3 C411 5,407 9,404 14 C401 20,400 26,400 35 L400 35 Z" fill="#212121"/><path d="M449 20 L453 17 L455 18 L450 42 C449 44,449 46,449 47 C449 48,449 49,449 49 C450 50,450 50,451 50 C452 50,453 50,453 49 C454 49,455 48,457 46 L459 48 C457 50,455 52,453 53 C452 54,450 54,448 54 C447 54,446 54,445 53 C444 52,443 50,443 49 C443 48,444 46,444 45 L444 44 C441 48,439 50,437 52 C435 53,433 54,430 54 C428 54,426 53,424 51 C423 49,422 46,422 42 C422 38,423 34,424 30 C426 26,428 23,431 21 C434 18,437 17,441 17 C442 17,444 17,445 18 C447 18,448 19,449 20 L449 20 Z M446 31 C446 30,447 29,447 28 C447 27,447 27,447 26 C447 24,446 22,446 21 C445 21,443 20,441 20 C439 20,437 21,435 23 C433 25,431 28,430 32 C429 35,428 39,428 42 C428 45,429 47,429 48 C430 49,431 50,433 50 C435 50,436 49,438 48 C439 47,441 44,442 42 C444 39,445 36,446 32 L446 31 Z" fill="#212121"/><path d="M472 41 L470 47 L465 47 L466 41 L472 41 Z M465 69 C465 70,465 71,465 72 C465 72,465 73,465 73 C465 74,465 74,465 75 C465 75,466 75,466 75 C467 75,467 75,467 75 C468 75,468 75,468 74 C469 74,469 74,469 73 C470 73,470 72,471 72 L473 74 C472 75,471 76,470 76 C469 77,469 77,468 78 C467 78,467 79,466 79 C465 79,465 79,464 79 C463 79,463 79,462 79 C462 79,461 78,461 78 C460 77,460 77,460 76 C460 76,459 75,459 74 C459 74,460 73,460 72 C460 71,460 70,460 69 C461 68,461 67,461 66 C461 65,462 64,462 63 C462 62,462 61,462 60 C463 59,463 58,463 57 C463 57,463 57,463 56 C463 56,463 56,463 56 C463 55,463 55,462 55 C462 54,461 54,460 54 L460 52 L468 52 L469 52 L465 69 Z" fill="#212121"/><path d="M495 35 C495 26,494 20,491 14 C488 9,484 5,478 3 L479 0 C486 2,492 6,495 12 C499 19,501 26,501 35 C501 44,499 52,495 58 C492 64,486 68,479 70 L478 67 C484 65,488 62,491 56 C494 51,495 43,495 35 L495 35 Z" fill="#212121"/><path d="M386 131 L386 130 C386 129,386 128,386 127 C386 125,386 123,386 122 C385 120,385 119,384 118 C384 117,383 116,382 115 C381 114,380 114,378 114 C377 114,375 115,374 115 C372 116,371 117,369 119 L366 119 L366 116 C368 115,370 114,372 113 C373 112,374 112,376 112 C377 111,378 111,380 111 C384 111,387 112,389 115 C391 118,392 122,392 128 C392 130,392 133,391 136 C391 139,390 142,389 145 C388 149,387 151,386 154 C385 156,383 158,382 159 C380 161,379 162,377 163 C375 164,372 164,370 164 C367 164,365 164,363 163 C362 162,360 160,359 158 C359 156,358 154,358 151 C358 148,358 145,359 143 C360 140,361 138,363 135 C365 133,367 131,369 130 C372 129,374 128,377 128 C378 128,380 128,381 129 C383 129,384 130,386 131 L386 131 Z M384 138 C384 136,383 134,382 133 C381 132,380 131,378 131 C376 131,374 132,373 132 C372 133,370 134,369 136 C368 137,367 139,366 141 C366 143,365 145,365 146 C364 148,364 151,364 153 C364 155,364 157,365 158 C365 159,366 160,367 160 C368 161,369 161,370 161 C373 161,375 160,377 158 C379 156,381 153,382 148 C383 144,384 141,384 138 L384 138 Z" fill="#212121"/><path d="M427 130 L431 127 L433 128 L428 152 C427 154,427 156,427 157 C427 158,427 159,427 159 C428 160,428 160,429 160 C430 160,431 160,431 159 C432 159,433 158,435 156 L437 158 C435 160,433 162,431 163 C430 164,428 164,426 164 C425 164,424 164,423 163 C422 162,421 160,421 159 C421 158,422 156,422 155 L422 154 C419 158,417 160,415 162 C413 163,411 164,408 164 C406 164,404 163,402 161 C401 159,400 156,400 152 C400 148,401 144,402 140 C404 136,406 133,409 131 C412 128,415 127,419 127 C420 127,422 127,423 128 C425 128,426 129,427 130 L427 130 Z M424 141 C424 140,425 139,425 138 C425 137,425 137,425 136 C425 134,424 132,424 131 C423 131,421 130,419 130 C417 130,415 131,413 133 C411 135,409 138,408 142 C407 145,406 149,406 152 C406 155,407 157,407 158 C408 159,409 160,411 160 C413 160,414 159,416 158 C417 157,419 154,420 152 C422 149,423 146,424 142 L424 141 Z" fill="#212121"/><path d="M424 110 L432 122 L429 124 L422 115 L422 115 L413 124 L411 122 L419 110 L424 110 Z" fill="#212121"/><path d="M450 151 L448 157 L443 157 L444 151 L450 151 Z M443 179 C443 180,443 181,443 182 C443 182,443 183,443 183 C443 184,443 184,443 185 C443 185,444 185,444 185 C445 185,445 185,445 185 C446 185,446 185,446 184 C447 184,447 184,447 183 C448 183,448 182,449 182 L451 184 C450 185,449 186,448 186 C447 187,447 187,446 188 C445 188,445 189,444 189 C443 189,443 189,442 189 C441 189,441 189,440 189 C440 189,439 188,439 188 C438 187,438 187,438 186 C438 186,437 185,437 184 C437 184,438 183,438 182 C438 181,438 180,438 179 C439 178,439 177,439 176 C439 175,440 174,440 173 C440 172,440 171,440 170 C441 169,441 168,441 167 C441 167,441 167,441 166 C441 166,441 166,441 166 C441 165,441 165,440 165 C440 164,439 164,438 164 L438 162 L446 162 L447 162 L443 179 Z" fill="#212121"/><rect x="303" y="89" width="205" height="5" fill="#212121"/><path d="M556 97 L554 101 L544 94 L546 106 L541 106 L542 94 L532 101 L530 97 L540 92 L530 87 L532 83 L542 90 L541 78 L546 78 L544 90 L554 83 L556 87 L546 92 L556 97 Z" fill="#212121"/><path d="M706 46 C706 48,706 49,706 49 C706 50,707 51,707 51 C707 52,708 52,709 52 C710 53,710 53,712 53 C713 53,714 53,716 53 L716 56 L689 56 L689 53 C692 53,694 53,695 53 C696 52,697 52,697 52 C698 51,698 51,699 50 C699 49,699 48,699 46 L699 16 C699 15,699 15,699 14 C698 14,698 14,697 14 C696 14,695 14,694 15 C692 16,691 17,689 18 L687 15 L704 5 L706 5 C706 7,706 11,706 15 L706 46 Z" fill="#212121"/><path d="M591 143 L604 171 L622 109 L632 109 L632 114 L625 114 L605 181 L602 181 L587 149 L580 151 L579 149 L591 143 Z" fill="#212121"/><path d="M669 149 L657 149 L657 149 C659 151,660 153,660 154 C661 156,661 158,661 160 C661 164,660 167,659 170 C657 173,655 176,652 177 C649 179,646 180,643 180 C639 180,636 179,633 177 C631 175,630 172,630 167 C630 165,631 162,632 160 C632 157,634 155,635 153 C637 151,639 149,641 148 C643 147,645 146,648 145 C651 144,654 144,659 144 L670 144 L669 149 Z M653 149 C650 149,647 150,644 152 C642 154,640 156,638 159 C637 162,636 166,636 169 C636 171,636 173,637 174 C638 175,638 176,639 176 C640 177,641 177,642 177 C645 177,647 176,649 175 C651 173,652 171,653 167 C654 164,655 161,655 158 C655 154,654 151,653 149 L653 149 Z" fill="#212121"/><path d="M691 152 C691 152,692 152,693 152 C693 152,693 152,694 152 C694 151,694 151,695 151 C695 150,695 150,695 149 L698 149 C698 150,698 151,698 153 C698 154,698 155,697 156 L675 156 L675 155 C675 154,676 153,676 152 C677 151,677 150,678 149 C679 148,680 147,681 146 C681 145,682 144,684 143 C685 141,687 140,688 139 C689 137,690 136,690 135 C691 134,691 134,691 133 C692 132,692 131,692 130 C692 129,692 129,691 128 C691 127,691 126,690 126 C690 125,689 125,688 125 C688 124,687 124,686 124 C684 124,683 125,682 125 C681 126,680 127,679 129 L676 129 L676 124 C678 123,680 122,682 122 C684 121,686 121,687 121 C689 121,691 121,692 122 C693 122,694 123,695 123 C696 124,696 125,697 126 C697 127,697 128,697 129 C697 130,697 131,697 131 C697 132,697 133,697 133 C696 134,696 134,696 135 C695 136,695 136,694 137 C694 138,693 138,693 139 C692 140,691 141,690 141 C689 142,688 143,688 144 C687 145,686 146,685 147 C684 148,683 149,682 150 C682 151,681 151,681 152 L691 152 Z" fill="#212121"/><path d="M749 160 L749 181 L743 181 L743 160 L723 160 L723 155 L743 155 L743 134 L749 134 L749 155 L769 155 L769 160 L749 160 Z" fill="#212121"/><path d="M823 152 L819 152 C819 148,817 146,813 146 C811 146,809 147,807 148 C806 149,805 151,805 154 C805 155,806 157,807 158 C808 159,810 159,812 159 L817 159 L817 163 L813 163 C811 163,810 163,808 163 C807 164,806 164,805 165 C804 165,803 166,803 166 C802 167,801 168,801 168 C801 169,801 170,801 171 C801 173,801 174,802 175 C804 176,805 176,808 176 C809 176,811 176,813 175 C815 175,817 174,819 172 L821 175 C819 177,816 178,814 179 C811 180,809 180,806 180 C803 180,801 180,800 179 C798 178,796 177,796 176 C795 174,794 173,794 171 C794 169,795 167,797 165 C799 163,802 162,806 161 L806 161 C801 159,799 157,799 153 C799 151,800 150,801 148 C802 147,803 146,805 145 C808 144,810 143,813 143 C817 143,820 144,824 145 L823 152 Z" fill="#212121"/><rect x="627" y="109" width="198" height="5" fill="#212121"/><rect x="578" y="89" width="247" height="5" fill="#212121"/><path d="M873 94 L873 115 L867 115 L867 94 L847 94 L847 89 L867 89 L867 68 L873 68 L873 89 L893 89 L893 94 L873 94 Z" fill="#212121"/><path d="M946 21 L946 20 C946 19,946 18,946 17 C946 15,946 13,946 12 C945 10,945 9,944 8 C944 7,943 6,942 5 C941 4,940 4,938 4 C937 4,935 5,934 5 C932 6,931 7,929 9 L926 9 L926 6 C928 5,930 4,932 3 C933 2,934 2,936 2 C937 1,938 1,940 1 C944 1,947 2,949 5 C951 8,952 12,952 18 C952 20,952 23,951 26 C951 29,950 32,949 35 C948 39,947 41,946 44 C945 46,943 48,942 49 C940 51,939 52,937 53 C935 54,932 54,930 54 C927 54,925 54,923 53 C922 52,920 50,919 48 C919 46,918 44,918 41 C918 38,918 35,919 33 C920 30,921 28,923 25 C925 23,927 21,929 20 C932 19,934 18,937 18 C938 18,940 18,941 19 C943 19,944 20,946 21 L946 21 Z M944 28 C944 26,943 24,942 23 C941 22,940 21,938 21 C936 21,934 22,933 22 C932 23,930 24,929 26 C928 27,927 29,926 31 C926 33,925 35,925 36 C924 38,924 41,924 43 C924 45,924 47,925 48 C925 49,926 50,927 50 C928 51,929 51,930 51 C933 51,935 50,937 48 C939 46,941 43,942 38 C943 34,944 31,944 28 L944 28 Z" fill="#212121"/><path d="M972 54 C971 59,969 63,967 65 C964 68,961 69,958 69 C957 69,956 69,955 69 L956 66 C956 66,957 66,958 66 C959 66,960 66,961 65 C961 65,962 64,963 62 C963 61,964 59,965 57 L973 22 L966 22 L967 20 C969 20,970 20,970 20 C971 20,972 19,972 19 C973 19,973 18,973 18 C973 17,974 16,974 14 C976 10,978 7,980 4 C983 2,986 1,991 1 C993 1,995 1,997 2 L995 8 L992 8 C992 7,991 6,991 5 C990 4,989 4,988 4 C987 4,986 4,985 5 C984 6,983 7,982 8 C982 10,981 12,980 14 L979 18 L989 18 L988 22 L979 22 L972 54 Z" fill="#212121"/><path d="M1012 35 C1012 43,1013 51,1016 56 C1019 62,1023 65,1029 67 L1028 70 C1021 68,1015 64,1012 58 C1008 52,1006 44,1006 35 C1006 26,1008 19,1012 12 C1015 6,1021 2,1028 0 L1029 3 C1023 5,1019 9,1016 14 C1013 20,1012 26,1012 35 L1012 35 Z" fill="#212121"/><path d="M1061 20 L1065 17 L1067 18 L1062 42 C1061 44,1061 46,1061 47 C1061 48,1061 49,1061 49 C1062 50,1062 50,1063 50 C1064 50,1065 50,1065 49 C1066 49,1067 48,1069 46 L1071 48 C1069 50,1067 52,1065 53 C1064 54,1062 54,1060 54 C1059 54,1058 54,1057 53 C1056 52,1055 50,1055 49 C1055 48,1056 46,1056 45 L1056 44 C1053 48,1051 50,1049 52 C1047 53,1045 54,1042 54 C1040 54,1038 53,1036 51 C1035 49,1034 46,1034 42 C1034 38,1035 34,1036 30 C1038 26,1040 23,1043 21 C1046 18,1049 17,1053 17 C1054 17,1056 17,1057 18 C1059 18,1060 19,1061 20 L1061 20 Z M1058 31 C1058 30,1059 29,1059 28 C1059 27,1059 27,1059 26 C1059 24,1058 22,1058 21 C1057 21,1055 20,1053 20 C1051 20,1049 21,1047 23 C1045 25,1043 28,1042 32 C1041 35,1040 39,1040 42 C1040 45,1041 47,1041 48 C1042 49,1043 50,1045 50 C1047 50,1048 49,1050 48 C1051 47,1053 44,1054 42 C1056 39,1057 36,1058 32 L1058 31 Z" fill="#212121"/><path d="M1084 41 L1082 47 L1077 47 L1078 41 L1084 41 Z M1077 69 C1077 70,1077 71,1077 72 C1077 72,1077 73,1077 73 C1077 74,1077 74,1077 75 C1077 75,1078 75,1078 75 C1079 75,1079 75,1079 75 C1080 75,1080 75,1080 74 C1081 74,1081 74,1081 73 C1082 73,1082 72,1083 72 L1085 74 C1084 75,1083 76,1082 76 C1081 77,1081 77,1080 78 C1079 78,1079 79,1078 79 C1077 79,1077 79,1076 79 C1075 79,1075 79,1074 79 C1074 79,1073 78,1073 78 C1072 77,1072 77,1072 76 C1072 76,1071 75,1071 74 C1071 74,1072 73,1072 72 C1072 71,1072 70,1072 69 C1073 68,1073 67,1073 66 C1073 65,1074 64,1074 63 C1074 62,1074 61,1074 60 C1075 59,1075 58,1075 57 C1075 57,1075 57,1075 56 C1075 56,1075 56,1075 56 C1075 55,1075 55,1074 55 C1074 54,1073 54,1072 54 L1072 52 L1080 52 L1081 52 L1077 69 Z" fill="#212121"/><path d="M1107 35 C1107 26,1106 20,1103 14 C1100 9,1096 5,1090 3 L1091 0 C1098 2,1104 6,1107 12 C1111 19,1113 26,1113 35 C1113 44,1111 52,1107 58 C1104 64,1098 68,1091 70 L1090 67 C1096 65,1100 62,1103 56 C1106 51,1107 43,1107 35 L1107 35 Z" fill="#212121"/><path d="M991 131 L991 130 C991 129,991 128,991 127 C991 125,991 123,991 122 C990 120,990 119,989 118 C989 117,988 116,987 115 C986 114,985 114,983 114 C982 114,980 115,979 115 C977 116,976 117,974 119 L971 119 L971 116 C973 115,975 114,977 113 C978 112,979 112,981 112 C982 111,983 111,985 111 C989 111,992 112,994 115 C996 118,997 122,997 128 C997 130,997 133,996 136 C996 139,995 142,994 145 C993 149,992 151,991 154 C990 156,988 158,987 159 C985 161,984 162,982 163 C980 164,977 164,975 164 C972 164,970 164,968 163 C967 162,965 160,964 158 C964 156,963 154,963 151 C963 148,963 145,964 143 C965 140,966 138,968 135 C970 133,972 131,974 130 C977 129,979 128,982 128 C983 128,985 128,986 129 C988 129,989 130,991 131 L991 131 Z M989 138 C989 136,988 134,987 133 C986 132,985 131,983 131 C981 131,979 132,978 132 C977 133,975 134,974 136 C973 137,972 139,971 141 C971 143,970 145,970 146 C969 148,969 151,969 153 C969 155,969 157,970 158 C970 159,971 160,972 160 C973 161,974 161,975 161 C978 161,980 160,982 158 C984 156,986 153,987 148 C988 144,989 141,989 138 L989 138 Z" fill="#212121"/><path d="M1043 133 L1031 133 L1031 133 C1033 135,1034 137,1034 138 C1035 140,1035 142,1035 144 C1035 148,1034 151,1033 154 C1031 157,1029 160,1026 161 C1023 163,1020 164,1017 164 C1013 164,1010 163,1007 161 C1005 159,1004 156,1004 151 C1004 149,1005 146,1006 144 C1006 141,1008 139,1009 137 C1011 135,1013 133,1015 132 C1017 131,1019 130,1022 129 C1025 128,1028 128,1033 128 L1044 128 L1043 133 Z M1027 133 C1024 133,1021 134,1018 136 C1016 138,1014 140,1012 143 C1011 146,1010 150,1010 153 C1010 155,1010 157,1011 158 C1012 159,1012 160,1013 160 C1014 161,1015 161,1016 161 C1019 161,1021 160,1023 159 C1025 157,1026 155,1027 151 C1028 148,1029 145,1029 142 C1029 138,1028 135,1027 133 L1027 133 Z" fill="#212121"/><path d="M1065 136 C1065 136,1066 136,1067 136 C1067 136,1067 136,1068 136 C1068 135,1068 135,1069 135 C1069 134,1069 134,1069 133 L1072 133 C1072 134,1072 135,1072 137 C1072 138,1072 139,1071 140 L1049 140 L1049 139 C1049 138,1050 137,1050 136 C1051 135,1051 134,1052 133 C1053 132,1054 131,1055 130 C1055 129,1056 128,1058 127 C1059 125,1061 124,1062 123 C1063 121,1064 120,1064 119 C1065 118,1065 118,1065 117 C1066 116,1066 115,1066 114 C1066 113,1066 113,1065 112 C1065 111,1065 110,1064 110 C1064 109,1063 109,1062 109 C1062 108,1061 108,1060 108 C1058 108,1057 109,1056 109 C1055 110,1054 111,1053 113 L1050 113 L1050 108 C1052 107,1054 106,1056 106 C1058 105,1060 105,1061 105 C1063 105,1065 105,1066 106 C1067 106,1068 107,1069 107 C1070 108,1070 109,1071 110 C1071 111,1071 112,1071 113 C1071 114,1071 115,1071 115 C1071 116,1071 117,1071 117 C1070 118,1070 118,1070 119 C1069 120,1069 120,1068 121 C1068 122,1067 122,1067 123 C1066 124,1065 125,1064 125 C1063 126,1062 127,1062 128 C1061 129,1060 130,1059 131 C1058 132,1057 133,1056 134 C1056 135,1055 135,1055 136 L1065 136 Z" fill="#212121"/><rect x="915" y="89" width="205" height="5" fill="#212121"/><path d="M1168 97 L1166 101 L1156 94 L1158 106 L1153 106 L1154 94 L1144 101 L1142 97 L1152 92 L1142 87 L1144 83 L1154 90 L1153 78 L1158 78 L1156 90 L1166 83 L1168 87 L1158 92 L1168 97 Z" fill="#212121"/><path d="M1216 47 C1217 47,1218 47,1219 47 C1220 47,1221 46,1221 46 C1221 46,1222 45,1222 45 C1222 44,1223 43,1223 42 L1226 42 L1225 53 L1195 53 L1195 51 C1196 49,1198 46,1199 43 C1201 41,1204 37,1207 34 C1210 30,1212 28,1213 26 C1214 25,1215 23,1216 22 C1217 21,1217 19,1218 18 C1218 17,1218 16,1218 15 C1218 13,1218 11,1217 10 C1216 8,1216 7,1214 6 C1213 6,1211 5,1210 5 C1205 5,1202 8,1200 13 L1196 13 L1196 6 C1199 4,1202 4,1204 3 C1207 2,1209 2,1211 2 C1216 2,1219 3,1222 5 C1224 7,1225 10,1225 13 C1225 15,1225 16,1225 17 C1224 18,1224 19,1223 20 C1223 22,1222 23,1221 24 C1220 25,1219 26,1218 28 C1217 29,1215 31,1212 34 C1208 39,1204 43,1202 47 L1216 47 Z" fill="#212121"/><path d="M1245 35 C1245 43,1246 51,1249 56 C1252 62,1256 65,1262 67 L1261 70 C1254 68,1248 64,1245 58 C1241 52,1239 44,1239 35 C1239 26,1241 19,1245 12 C1248 6,1254 2,1261 0 L1262 3 C1256 5,1252 9,1249 14 C1246 20,1245 26,1245 35 L1245 35 Z" fill="#212121"/><path d="M1294 20 L1298 17 L1300 18 L1295 42 C1294 44,1294 46,1294 47 C1294 48,1294 49,1294 49 C1295 50,1295 50,1296 50 C1297 50,1298 50,1298 49 C1299 49,1300 48,1302 46 L1304 48 C1302 50,1300 52,1298 53 C1297 54,1295 54,1293 54 C1292 54,1291 54,1290 53 C1289 52,1288 50,1288 49 C1288 48,1289 46,1289 45 L1289 44 C1286 48,1284 50,1282 52 C1280 53,1278 54,1275 54 C1273 54,1271 53,1269 51 C1268 49,1267 46,1267 42 C1267 38,1268 34,1269 30 C1271 26,1273 23,1276 21 C1279 18,1282 17,1286 17 C1287 17,1289 17,1290 18 C1292 18,1293 19,1294 20 L1294 20 Z M1291 31 C1291 30,1292 29,1292 28 C1292 27,1292 27,1292 26 C1292 24,1291 22,1291 21 C1290 21,1288 20,1286 20 C1284 20,1282 21,1280 23 C1278 25,1276 28,1275 32 C1274 35,1273 39,1273 42 C1273 45,1274 47,1274 48 C1275 49,1276 50,1278 50 C1280 50,1281 49,1283 48 C1284 47,1286 44,1287 42 C1289 39,1290 36,1291 32 L1291 31 Z" fill="#212121"/><path d="M1317 41 L1315 47 L1310 47 L1311 41 L1317 41 Z M1310 69 C1310 70,1310 71,1310 72 C1310 72,1310 73,1310 73 C1310 74,1310 74,1310 75 C1310 75,1311 75,1311 75 C1312 75,1312 75,1312 75 C1313 75,1313 75,1313 74 C1314 74,1314 74,1314 73 C1315 73,1315 72,1316 72 L1318 74 C1317 75,1316 76,1315 76 C1314 77,1314 77,1313 78 C1312 78,1312 79,1311 79 C1310 79,1310 79,1309 79 C1308 79,1308 79,1307 79 C1307 79,1306 78,1306 78 C1305 77,1305 77,1305 76 C1305 76,1304 75,1304 74 C1304 74,1305 73,1305 72 C1305 71,1305 70,1305 69 C1306 68,1306 67,1306 66 C1306 65,1307 64,1307 63 C1307 62,1307 61,1307 60 C1308 59,1308 58,1308 57 C1308 57,1308 57,1308 56 C1308 56,1308 56,1308 56 C1308 55,1308 55,1307 55 C1307 54,1306 54,1305 54 L1305 52 L1313 52 L1314 52 L1310 69 Z" fill="#212121"/><path d="M1344 34 L1344 29 L1390 29 L1390 34 L1344 34 Z" fill="#212121"/><path d="M1443 20 L1447 17 L1449 18 L1444 42 C1443 44,1443 46,1443 47 C1443 48,1443 49,1443 49 C1444 50,1444 50,1445 50 C1446 50,1447 50,1447 49 C1448 49,1449 48,1451 46 L1453 48 C1451 50,1449 52,1447 53 C1446 54,1444 54,1442 54 C1441 54,1440 54,1439 53 C1438 52,1437 50,1437 49 C1437 48,1438 46,1438 45 L1438 44 C1435 48,1433 50,1431 52 C1429 53,1427 54,1424 54 C1422 54,1420 53,1418 51 C1417 49,1416 46,1416 42 C1416 38,1417 34,1418 30 C1420 26,1422 23,1425 21 C1428 18,1431 17,1435 17 C1436 17,1438 17,1439 18 C1441 18,1442 19,1443 20 L1443 20 Z M1440 31 C1440 30,1441 29,1441 28 C1441 27,1441 27,1441 26 C1441 24,1440 22,1440 21 C1439 21,1437 20,1435 20 C1433 20,1431 21,1429 23 C1427 25,1425 28,1424 32 C1423 35,1422 39,1422 42 C1422 45,1423 47,1423 48 C1424 49,1425 50,1427 50 C1429 50,1430 49,1432 48 C1433 47,1435 44,1436 42 C1438 39,1439 36,1440 32 L1440 31 Z" fill="#212121"/><path d="M1447 9 L1428 9 L1428 5 L1447 5 L1447 9 Z" fill="#212121"/><path d="M1474 35 C1474 26,1473 20,1470 14 C1467 9,1463 5,1457 3 L1458 0 C1465 2,1471 6,1474 12 C1478 19,1480 26,1480 35 C1480 44,1478 52,1474 58 C1471 64,1465 68,1458 70 L1457 67 C1463 65,1467 62,1470 56 C1473 51,1474 43,1474 35 L1474 35 Z" fill="#212121"/><path d="M1323 137 C1325 133,1328 131,1330 129 C1332 128,1334 127,1337 127 C1339 127,1341 128,1342 129 C1343 130,1344 132,1344 135 L1344 135 C1344 135,1344 135,1344 136 C1346 133,1348 131,1350 129 C1352 128,1354 127,1356 127 C1359 127,1360 128,1362 129 C1363 130,1364 132,1364 135 C1364 136,1363 139,1362 141 L1360 151 C1359 154,1359 156,1359 157 C1359 158,1359 159,1360 159 C1360 160,1360 160,1361 160 C1362 160,1363 160,1363 159 C1364 159,1365 158,1367 156 L1369 158 C1367 160,1365 162,1364 163 C1362 164,1360 164,1358 164 C1357 164,1355 163,1354 162 C1353 161,1353 160,1353 158 C1353 156,1353 154,1354 151 L1356 144 C1356 142,1357 140,1357 139 C1357 138,1357 137,1357 136 C1357 134,1357 133,1356 132 C1356 131,1355 131,1354 131 C1353 131,1351 132,1350 132 C1349 133,1348 134,1347 136 C1345 138,1344 139,1343 141 C1343 142,1342 144,1341 147 L1338 163 L1332 163 L1336 144 C1337 142,1337 140,1337 139 C1337 138,1337 137,1337 136 C1337 134,1337 133,1336 132 C1336 131,1335 131,1333 131 C1333 131,1332 132,1330 132 C1329 133,1328 134,1327 136 C1325 138,1324 139,1323 141 C1323 143,1322 145,1321 147 L1318 163 L1312 163 L1317 139 C1318 137,1318 135,1318 134 C1318 133,1318 132,1317 132 C1317 131,1317 131,1316 131 C1315 131,1314 131,1313 132 C1313 133,1311 134,1310 135 L1308 133 C1310 131,1312 130,1313 129 C1315 128,1317 127,1319 127 C1320 127,1321 128,1322 129 C1323 130,1324 131,1324 132 C1324 134,1323 135,1323 137 L1323 137 Z" fill="#212121"/><rect x="1190" y="89" width="297" height="5" fill="#212121"/><path d="M1535 94 L1535 115 L1529 115 L1529 94 L1509 94 L1509 89 L1529 89 L1529 68 L1535 68 L1535 89 L1555 89 L1555 94 L1535 94 Z" fill="#212121"/><path d="M1608 21 L1608 20 C1608 19,1608 18,1608 17 C1608 15,1608 13,1608 12 C1607 10,1607 9,1606 8 C1606 7,1605 6,1604 5 C1603 4,1602 4,1600 4 C1599 4,1597 5,1596 5 C1594 6,1593 7,1591 9 L1588 9 L1588 6 C1590 5,1592 4,1594 3 C1595 2,1596 2,1598 2 C1599 1,1600 1,1602 1 C1606 1,1609 2,1611 5 C1613 8,1614 12,1614 18 C1614 20,1614 23,1613 26 C1613 29,1612 32,1611 35 C1610 39,1609 41,1608 44 C1607 46,1605 48,1604 49 C1602 51,1601 52,1599 53 C1597 54,1594 54,1592 54 C1589 54,1587 54,1585 53 C1584 52,1582 50,1581 48 C1581 46,1580 44,1580 41 C1580 38,1580 35,1581 33 C1582 30,1583 28,1585 25 C1587 23,1589 21,1591 20 C1594 19,1596 18,1599 18 C1600 18,1602 18,1603 19 C1605 19,1606 20,1608 21 L1608 21 Z M1606 28 C1606 26,1605 24,1604 23 C1603 22,1602 21,1600 21 C1598 21,1596 22,1595 22 C1594 23,1592 24,1591 26 C1590 27,1589 29,1588 31 C1588 33,1587 35,1587 36 C1586 38,1586 41,1586 43 C1586 45,1586 47,1587 48 C1587 49,1588 50,1589 50 C1590 51,1591 51,1592 51 C1595 51,1597 50,1599 48 C1601 46,1603 43,1604 38 C1605 34,1606 31,1606 28 L1606 28 Z" fill="#212121"/><path d="M1634 54 C1633 59,1631 63,1629 65 C1626 68,1623 69,1620 69 C1619 69,1618 69,1617 69 L1618 66 C1618 66,1619 66,1620 66 C1621 66,1622 66,1623 65 C1623 65,1624 64,1625 62 C1625 61,1626 59,1627 57 L1635 22 L1628 22 L1629 20 C1631 20,1632 20,1632 20 C1633 20,1634 19,1634 19 C1635 19,1635 18,1635 18 C1635 17,1636 16,1636 14 C1638 10,1640 7,1642 4 C1645 2,1648 1,1653 1 C1655 1,1657 1,1659 2 L1657 8 L1654 8 C1654 7,1653 6,1653 5 C1652 4,1651 4,1650 4 C1649 4,1648 4,1647 5 C1646 6,1645 7,1644 8 C1644 10,1643 12,1642 14 L1641 18 L1651 18 L1650 22 L1641 22 L1634 54 Z" fill="#212121"/><path d="M1674 35 C1674 43,1675 51,1678 56 C1681 62,1685 65,1691 67 L1690 70 C1683 68,1677 64,1674 58 C1670 52,1668 44,1668 35 C1668 26,1670 19,1674 12 C1677 6,1683 2,1690 0 L1691 3 C1685 5,1681 9,1678 14 C1675 20,1674 26,1674 35 L1674 35 Z" fill="#212121"/><path d="M1723 20 L1727 17 L1729 18 L1724 42 C1723 44,1723 46,1723 47 C1723 48,1723 49,1723 49 C1724 50,1724 50,1725 50 C1726 50,1727 50,1727 49 C1728 49,1729 48,1731 46 L1733 48 C1731 50,1729 52,1727 53 C1726 54,1724 54,1722 54 C1721 54,1720 54,1719 53 C1718 52,1717 50,1717 49 C1717 48,1718 46,1718 45 L1718 44 C1715 48,1713 50,1711 52 C1709 53,1707 54,1704 54 C1702 54,1700 53,1698 51 C1697 49,1696 46,1696 42 C1696 38,1697 34,1698 30 C1700 26,1702 23,1705 21 C1708 18,1711 17,1715 17 C1716 17,1718 17,1719 18 C1721 18,1722 19,1723 20 L1723 20 Z M1720 31 C1720 30,1721 29,1721 28 C1721 27,1721 27,1721 26 C1721 24,1720 22,1720 21 C1719 21,1717 20,1715 20 C1713 20,1711 21,1709 23 C1707 25,1705 28,1704 32 C1703 35,1702 39,1702 42 C1702 45,1703 47,1703 48 C1704 49,1705 50,1707 50 C1709 50,1710 49,1712 48 C1713 47,1715 44,1716 42 C1718 39,1719 36,1720 32 L1720 31 Z" fill="#212121"/><path d="M1746 41 L1744 47 L1739 47 L1740 41 L1746 41 Z M1739 69 C1739 70,1739 71,1739 72 C1739 72,1739 73,1739 73 C1739 74,1739 74,1739 75 C1739 75,1740 75,1740 75 C1741 75,1741 75,1741 75 C1742 75,1742 75,1742 74 C1743 74,1743 74,1743 73 C1744 73,1744 72,1745 72 L1747 74 C1746 75,1745 76,1744 76 C1743 77,1743 77,1742 78 C1741 78,1741 79,1740 79 C1739 79,1739 79,1738 79 C1737 79,1737 79,1736 79 C1736 79,1735 78,1735 78 C1734 77,1734 77,1734 76 C1734 76,1733 75,1733 74 C1733 74,1734 73,1734 72 C1734 71,1734 70,1734 69 C1735 68,1735 67,1735 66 C1735 65,1736 64,1736 63 C1736 62,1736 61,1736 60 C1737 59,1737 58,1737 57 C1737 57,1737 57,1737 56 C1737 56,1737 56,1737 56 C1737 55,1737 55,1736 55 C1736 54,1735 54,1734 54 L1734 52 L1742 52 L1743 52 L1739 69 Z" fill="#212121"/><path d="M1769 35 C1769 26,1768 20,1765 14 C1762 9,1758 5,1752 3 L1753 0 C1760 2,1766 6,1769 12 C1773 19,1775 26,1775 35 C1775 44,1773 52,1769 58 C1766 64,1760 68,1753 70 L1752 67 C1758 65,1762 62,1765 56 C1768 51,1769 43,1769 35 L1769 35 Z" fill="#212121"/><path d="M1669 131 L1669 130 C1669 129,1669 128,1669 127 C1669 125,1669 123,1669 122 C1668 120,1668 119,1667 118 C1667 117,1666 116,1665 115 C1664 114,1663 114,1661 114 C1660 114,1658 115,1657 115 C1655 116,1654 117,1652 119 L1649 119 L1649 116 C1651 115,1653 114,1655 113 C1656 112,1657 112,1659 112 C1660 111,1661 111,1663 111 C1667 111,1670 112,1672 115 C1674 118,1675 122,1675 128 C1675 130,1675 133,1674 136 C1674 139,1673 142,1672 145 C1671 149,1670 151,1669 154 C1668 156,1666 158,1665 159 C1663 161,1662 162,1660 163 C1658 164,1655 164,1653 164 C1650 164,1648 164,1646 163 C1645 162,1643 160,1642 158 C1642 156,1641 154,1641 151 C1641 148,1641 145,1642 143 C1643 140,1644 138,1646 135 C1648 133,1650 131,1652 130 C1655 129,1657 128,1660 128 C1661 128,1663 128,1664 129 C1666 129,1667 130,1669 131 L1669 131 Z M1667 138 C1667 136,1666 134,1665 133 C1664 132,1663 131,1661 131 C1659 131,1657 132,1656 132 C1655 133,1653 134,1652 136 C1651 137,1650 139,1649 141 C1649 143,1648 145,1648 146 C1647 148,1647 151,1647 153 C1647 155,1647 157,1648 158 C1648 159,1649 160,1650 160 C1651 161,1652 161,1653 161 C1656 161,1658 160,1660 158 C1662 156,1664 153,1665 148 C1666 144,1667 141,1667 138 L1667 138 Z" fill="#212121"/><path d="M1710 130 L1714 127 L1716 128 L1711 152 C1710 154,1710 156,1710 157 C1710 158,1710 159,1710 159 C1711 160,1711 160,1712 160 C1713 160,1714 160,1714 159 C1715 159,1716 158,1718 156 L1720 158 C1718 160,1716 162,1714 163 C1713 164,1711 164,1709 164 C1708 164,1707 164,1706 163 C1705 162,1704 160,1704 159 C1704 158,1705 156,1705 155 L1705 154 C1702 158,1700 160,1698 162 C1696 163,1694 164,1691 164 C1689 164,1687 163,1685 161 C1684 159,1683 156,1683 152 C1683 148,1684 144,1685 140 C1687 136,1689 133,1692 131 C1695 128,1698 127,1702 127 C1703 127,1705 127,1706 128 C1708 128,1709 129,1710 130 L1710 130 Z M1707 141 C1707 140,1708 139,1708 138 C1708 137,1708 137,1708 136 C1708 134,1707 132,1707 131 C1706 131,1704 130,1702 130 C1700 130,1698 131,1696 133 C1694 135,1692 138,1691 142 C1690 145,1689 149,1689 152 C1689 155,1690 157,1690 158 C1691 159,1692 160,1694 160 C1696 160,1697 159,1699 158 C1700 157,1702 154,1703 152 C1705 149,1706 146,1707 142 L1707 141 Z" fill="#212121"/><path d="M1714 119 L1695 119 L1695 115 L1714 115 L1714 119 Z" fill="#212121"/><rect x="1577" y="89" width="205" height="5" fill="#212121"/><path d="M1830 97 L1828 101 L1818 94 L1820 106 L1815 106 L1816 94 L1806 101 L1804 97 L1814 92 L1804 87 L1806 83 L1816 90 L1815 78 L1820 78 L1818 90 L1828 83 L1830 87 L1820 92 L1830 97 Z" fill="#212121"/><path d="M1888 46 C1888 48,1888 49,1888 49 C1888 50,1889 51,1889 51 C1889 52,1890 52,1891 52 C1892 53,1892 53,1894 53 C1895 53,1896 53,1898 53 L1898 56 L1871 56 L1871 53 C1874 53,1876 53,1877 53 C1878 52,1879 52,1879 52 C1880 51,1880 51,1881 50 C1881 49,1881 48,1881 46 L1881 16 C1881 15,1881 15,1881 14 C1880 14,1880 14,1879 14 C1878 14,1877 14,1876 15 C1874 16,1873 17,1871 18 L1869 15 L1886 5 L1888 5 C1888 7,1888 11,1888 15 L1888 46 Z" fill="#212121"/><path d="M1868 137 C1870 133,1873 131,1875 129 C1877 128,1879 127,1882 127 C1884 127,1886 128,1887 129 C1888 130,1889 132,1889 135 L1889 135 C1889 135,1889 135,1889 136 C1891 133,1893 131,1895 129 C1897 128,1899 127,1901 127 C1904 127,1905 128,1907 129 C1908 130,1909 132,1909 135 C1909 136,1908 139,1907 141 L1905 151 C1904 154,1904 156,1904 157 C1904 158,1904 159,1905 159 C1905 160,1905 160,1906 160 C1907 160,1908 160,1908 159 C1909 159,1910 158,1912 156 L1914 158 C1912 160,1910 162,1909 163 C1907 164,1905 164,1903 164 C1902 164,1900 163,1899 162 C1898 161,1898 160,1898 158 C1898 156,1898 154,1899 151 L1901 144 C1901 142,1902 140,1902 139 C1902 138,1902 137,1902 136 C1902 134,1902 133,1901 132 C1901 131,1900 131,1899 131 C1898 131,1896 132,1895 132 C1894 133,1893 134,1892 136 C1890 138,1889 139,1888 141 C1888 142,1887 144,1886 147 L1883 163 L1877 163 L1881 144 C1882 142,1882 140,1882 139 C1882 138,1882 137,1882 136 C1882 134,1882 133,1881 132 C1881 131,1880 131,1878 131 C1878 131,1877 132,1875 132 C1874 133,1873 134,1872 136 C1870 138,1869 139,1868 141 C1868 143,1867 145,1866 147 L1863 163 L1857 163 L1862 139 C1863 137,1863 135,1863 134 C1863 133,1863 132,1862 132 C1862 131,1862 131,1861 131 C1860 131,1859 131,1858 132 C1858 133,1856 134,1855 135 L1853 133 C1855 131,1857 130,1858 129 C1860 128,1862 127,1864 127 C1865 127,1866 128,1867 129 C1868 130,1869 131,1869 132 C1869 134,1868 135,1868 137 L1868 137 Z" fill="#212121"/><rect x="1852" y="89" width="63" height="5" fill="#212121"/></svg></span></p>
<p class="p_Text"><span class="f_Text">As you can see, in the formulas provided above, when calculating derivatives with respect to the means, the sum of values across the entire value buffer is used. However, unlike the forward pass, we have the ability to calculate all three sums in parallel.</span></p>
<p class="p_Text"><span class="f_Text">In the kernel parameters, we pass pointers to four data buffers:</span></p>
<ul style="list-style-type:disc">
<li class="p_li"><span class="f_li" style="font-style: italic;">outputs</span><span class="f_li">  buffer of forward pass normalization results</span></li>
<li class="p_li"><span class="f_li" style="font-style: italic;">out_gradient</span><span class="f_li">  buffer of gradients at the output of the normalization block</span></li>
<li class="p_li"><span class="f_li" style="font-style: italic;">inp_gradient</span><span class="f_li">  buffer for writing adjusted gradients</span></li>
<li class="p_li"><span class="f_li" style="font-style: italic;">stds</span><span class="f_li">  buffer of standard deviations calculated during the feed-forward pass</span></li>
</ul>
<p class="p_Text"><span class="f_Text">Also, in the parameters we will indicate the size of the buffers and the offset in the standard deviation buffer.</span></p>
<div style="text-align: left; text-indent: 0; line-height: 1.0; page-break-inside: avoid; page-break-after: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0 0 0 0; margin: 2px 17px 2px 17px;"><table cellspacing="0" cellpadding="3" border="0" style="text-align: justify;border:none; border-spacing:0;">
<tr>
<td style="vertical-align:top; padding:3px; border:none"><p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample" style="color: #0000ff;">__kernel</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">void</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #333333;">LayerNormalizeGradient</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #0000ff;">__global</span><span class="f_CodeExample">&nbsp;</span><span class="f_Definition">TYPE</span><span class="f_CodeExample">*&nbsp;</span><span class="f_CodeExample" style="color: #333333;">outputs</span><span class="f_CodeExample">,</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">__global</span><span class="f_CodeExample">&nbsp;</span><span class="f_Definition">TYPE</span><span class="f_CodeExample">*&nbsp;</span><span class="f_CodeExample" style="color: #333333;">out_gradient</span><span class="f_CodeExample">,</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">__global</span><span class="f_CodeExample">&nbsp;</span><span class="f_Definition">TYPE</span><span class="f_CodeExample">*&nbsp;</span><span class="f_CodeExample" style="color: #333333;">inp_gradient</span><span class="f_CodeExample">,</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">__global</span><span class="f_CodeExample">&nbsp;</span><span class="f_Definition">TYPE</span><span class="f_CodeExample">*&nbsp;</span><span class="f_CodeExample" style="color: #333333;">stds</span><span class="f_CodeExample">,</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">const</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">int</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #333333;">total</span><span class="f_CodeExample">,</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">const</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">int</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #333333;">std_shift</span><span class="f_CodeExample">)</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;{</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">uint</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #333333;">i</span><span class="f_CodeExample">&nbsp;=&nbsp;(</span><span class="f_CodeExample" style="color: #0000ff;">uint</span><span class="f_CodeExample">)</span><span class="f_Functions">get_global_id</span><span class="f_CodeExample">(</span><span class="f_Normal" style="font-family: Arial,Helvetica,sans-serif; color: #000000; background-color: transparent;">0</span><span class="f_CodeExample">);</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">uint</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #333333;">l</span><span class="f_CodeExample">&nbsp;=&nbsp;(</span><span class="f_CodeExample" style="color: #0000ff;">uint</span><span class="f_CodeExample">)</span><span class="f_Functions">get_local_id</span><span class="f_CodeExample">(</span><span class="f_Normal" style="font-family: Arial,Helvetica,sans-serif; color: #000000; background-color: transparent;">0</span><span class="f_CodeExample">);</span></p>
</td>
</tr>
</table>
</div>
<p class="p_Text"><span class="f_Text">In the kernel body we define thread identifiers and at the same time declare local data arrays. There will be three of them. In one, we will collect the derivative of the root mean square deviation, and the other two are intended for the terms in the derivative formula of the arithmetic mean.</span></p>
<div style="text-align: left; text-indent: 0; line-height: 1.0; page-break-inside: avoid; page-break-after: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0 0 0 0; margin: 2px 17px 2px 17px;"><table cellspacing="0" cellpadding="3" border="0" style="text-align: justify;border:none; border-spacing:0;">
<tr>
<td style="vertical-align:top; padding:3px; border:none"><p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">uint</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #333333;">ls</span><span class="f_CodeExample">&nbsp;=&nbsp;</span><span class="f_CodeExample" style="color: #333333;">min</span><span class="f_CodeExample">((</span><span class="f_CodeExample" style="color: #0000ff;">uint</span><span class="f_CodeExample">)</span><span class="f_Functions">get_local_size</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #333333;">0</span><span class="f_CodeExample">),&nbsp;(</span><span class="f_CodeExample" style="color: #0000ff;">uint</span><span class="f_CodeExample">)</span><span class="f_Definition">LOCAL_SIZE</span><span class="f_CodeExample">);</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">__local</span><span class="f_CodeExample">&nbsp;</span><span class="f_Definition">TYPE</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #333333;">dSTD</span><span class="f_CodeExample">[</span><span class="f_Definition">LOCAL_SIZE</span><span class="f_CodeExample">];</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">__local</span><span class="f_CodeExample">&nbsp;</span><span class="f_Definition">TYPE</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #333333;">dMean1</span><span class="f_CodeExample">[</span><span class="f_Definition">LOCAL_SIZE</span><span class="f_CodeExample">];</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">__local</span><span class="f_CodeExample">&nbsp;</span><span class="f_Definition">TYPE</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #333333;">dMean2</span><span class="f_CodeExample">[</span><span class="f_Definition">LOCAL_SIZE</span><span class="f_CodeExample">];</span></p>
</td>
</tr>
</table>
</div>
<p class="p_Text"><span class="f_Text">As with the feed-forward pass, each thread will first collect its share of the total.</span></p>
<div style="text-align: left; text-indent: 0; line-height: 1.0; page-break-inside: avoid; page-break-after: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0 0 0 0; margin: 2px 17px 2px 17px;"><table cellspacing="0" cellpadding="3" border="0" style="text-align: justify;border:none; border-spacing:0;">
<tr>
<td style="vertical-align:top; padding:3px; border:none"><p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">uint</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #333333;">count</span><span class="f_CodeExample">&nbsp;=&nbsp;</span><span class="f_Normal" style="font-family: Arial,Helvetica,sans-serif; color: #000000; background-color: transparent;">0</span><span class="f_CodeExample">;</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">do</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">uint</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #333333;">shift</span><span class="f_CodeExample">&nbsp;=&nbsp;</span><span class="f_CodeExample" style="color: #333333;">count</span><span class="f_CodeExample">&nbsp;*&nbsp;</span><span class="f_CodeExample" style="color: #333333;">ls</span><span class="f_CodeExample">&nbsp;+&nbsp;</span><span class="f_CodeExample" style="color: #333333;">l</span><span class="f_CodeExample">;</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">dSTD</span><span class="f_CodeExample">[</span><span class="f_CodeExample" style="color: #333333;">l</span><span class="f_CodeExample">]&nbsp;=&nbsp;(</span><span class="f_CodeExample" style="color: #333333;">count</span><span class="f_CodeExample">&nbsp;&gt;&nbsp;</span><span class="f_Normal" style="font-family: Arial,Helvetica,sans-serif; color: #000000; background-color: transparent;">0</span><span class="f_CodeExample">&nbsp;?&nbsp;</span><span class="f_CodeExample" style="color: #333333;">dSTD</span><span class="f_CodeExample">[</span><span class="f_CodeExample" style="color: #333333;">l</span><span class="f_CodeExample">]&nbsp;:&nbsp;</span><span class="f_Normal" style="font-family: Arial,Helvetica,sans-serif; color: #000000; background-color: transparent;">0</span><span class="f_CodeExample">)&nbsp;-&nbsp;</span><br>
<span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(</span><span class="f_CodeExample" style="color: #333333;">shift</span><span class="f_CodeExample">&nbsp;&lt;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">total</span><span class="f_CodeExample">&nbsp;?&nbsp;</span><span class="f_CodeExample" style="color: #333333;">out_gradient</span><span class="f_CodeExample">[</span><span class="f_CodeExample" style="color: #333333;">shift</span><span class="f_CodeExample">]&nbsp;*&nbsp;</span><span class="f_CodeExample" style="color: #333333;">outputs</span><span class="f_CodeExample">[</span><span class="f_CodeExample" style="color: #333333;">shift</span><span class="f_CodeExample">]&nbsp;/</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(</span><span class="f_Normal" style="font-family: Arial,Helvetica,sans-serif; color: #000000; background-color: transparent;">2</span><span class="f_CodeExample">&nbsp;*&nbsp;(</span><span class="f_Functions">pow</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #333333;">stds</span><span class="f_CodeExample">[</span><span class="f_CodeExample" style="color: #333333;">std_shift</span><span class="f_CodeExample">],&nbsp;(</span><span class="f_Definition">TYPE</span><span class="f_CodeExample">)</span><span class="f_Normal" style="font-family: Arial,Helvetica,sans-serif; color: #000000; background-color: transparent;">2</span><span class="f_CodeExample">)&nbsp;+&nbsp;</span><span class="f_Normal" style="font-family: Arial,Helvetica,sans-serif; color: #000000; background-color: transparent;">1e-37f</span><span class="f_CodeExample">))&nbsp;:&nbsp;</span><span class="f_Normal" style="font-family: Arial,Helvetica,sans-serif; color: #000000; background-color: transparent;">0</span><span class="f_CodeExample">);</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">dMean1</span><span class="f_CodeExample">[</span><span class="f_CodeExample" style="color: #333333;">l</span><span class="f_CodeExample">]&nbsp;=&nbsp;(</span><span class="f_CodeExample" style="color: #333333;">count</span><span class="f_CodeExample">&nbsp;&gt;&nbsp;</span><span class="f_Normal" style="font-family: Arial,Helvetica,sans-serif; color: #000000; background-color: transparent;">0</span><span class="f_CodeExample">&nbsp;?&nbsp;</span><span class="f_CodeExample" style="color: #333333;">dMean1</span><span class="f_CodeExample">[</span><span class="f_CodeExample" style="color: #333333;">l</span><span class="f_CodeExample">]&nbsp;:&nbsp;</span><span class="f_Normal" style="font-family: Arial,Helvetica,sans-serif; color: #000000; background-color: transparent;">0</span><span class="f_CodeExample">)&nbsp;-&nbsp;</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(</span><span class="f_CodeExample" style="color: #333333;">shift</span><span class="f_CodeExample">&nbsp;&lt;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">total</span><span class="f_CodeExample">&nbsp;?&nbsp;</span><span class="f_CodeExample" style="color: #333333;">out_gradient</span><span class="f_CodeExample">[</span><span class="f_CodeExample" style="color: #333333;">shift</span><span class="f_CodeExample">]&nbsp;/</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(</span><span class="f_CodeExample" style="color: #333333;">stds</span><span class="f_CodeExample">[</span><span class="f_CodeExample" style="color: #333333;">std_shift</span><span class="f_CodeExample">]&nbsp;+&nbsp;</span><span class="f_Normal" style="font-family: Arial,Helvetica,sans-serif; color: #000000; background-color: transparent;">1e-37f</span><span class="f_CodeExample">)&nbsp;:&nbsp;</span><span class="f_Normal" style="font-family: Arial,Helvetica,sans-serif; color: #000000; background-color: transparent;">0</span><span class="f_CodeExample">);</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">dMean2</span><span class="f_CodeExample">[</span><span class="f_CodeExample" style="color: #333333;">l</span><span class="f_CodeExample">]&nbsp;=&nbsp;(</span><span class="f_CodeExample" style="color: #333333;">count</span><span class="f_CodeExample">&nbsp;&gt;&nbsp;</span><span class="f_Normal" style="font-family: Arial,Helvetica,sans-serif; color: #000000; background-color: transparent;">0</span><span class="f_CodeExample">&nbsp;?&nbsp;</span><span class="f_CodeExample" style="color: #333333;">dMean2</span><span class="f_CodeExample">[</span><span class="f_CodeExample" style="color: #333333;">l</span><span class="f_CodeExample">]&nbsp;:&nbsp;</span><span class="f_Normal" style="font-family: Arial,Helvetica,sans-serif; color: #000000; background-color: transparent;">0</span><span class="f_CodeExample">)&nbsp;-</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(</span><span class="f_CodeExample" style="color: #333333;">shift</span><span class="f_CodeExample">&nbsp;&lt;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">total</span><span class="f_CodeExample">&nbsp;?&nbsp;</span><span class="f_Normal" style="font-family: Arial,Helvetica,sans-serif; color: #000000; background-color: transparent;">2</span><span class="f_CodeExample">&nbsp;*&nbsp;</span><span class="f_CodeExample" style="color: #333333;">outputs</span><span class="f_CodeExample">[</span><span class="f_CodeExample" style="color: #333333;">shift</span><span class="f_CodeExample">]&nbsp;*&nbsp;</span><span class="f_CodeExample" style="color: #333333;">stds</span><span class="f_CodeExample">[</span><span class="f_CodeExample" style="color: #333333;">std_shift</span><span class="f_CodeExample">]&nbsp;/</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(</span><span class="f_Definition">TYPE</span><span class="f_CodeExample">)</span><span class="f_CodeExample" style="color: #333333;">total</span><span class="f_CodeExample">&nbsp;:&nbsp;</span><span class="f_Normal" style="font-family: Arial,Helvetica,sans-serif; color: #000000; background-color: transparent;">0</span><span class="f_CodeExample">);</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">count</span><span class="f_CodeExample">++;</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">while</span><span class="f_CodeExample">((</span><span class="f_CodeExample" style="color: #333333;">count</span><span class="f_CodeExample">&nbsp;*&nbsp;</span><span class="f_CodeExample" style="color: #333333;">ls</span><span class="f_CodeExample">&nbsp;+&nbsp;</span><span class="f_CodeExample" style="color: #333333;">l</span><span class="f_CodeExample">)&nbsp;&lt;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">total</span><span class="f_CodeExample">);</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_Functions">barrier</span><span class="f_CodeExample">(</span><span class="f_Definition">CLK_LOCAL_MEM_FENCE</span><span class="f_CodeExample">);</span></p>
</td>
</tr>
</table>
</div>
<p class="p_Text"><span class="f_Text">In the next loop, we will collect the sum in the first elements of the array.</span></p>
<div style="text-align: left; text-indent: 0; line-height: 1.0; page-break-inside: avoid; page-break-after: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0 0 0 0; margin: 2px 17px 2px 17px;"><table cellspacing="0" cellpadding="3" border="0" style="text-align: justify;border:none; border-spacing:0;">
<tr>
<td style="vertical-align:top; padding:3px; border:none"><p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">count</span><span class="f_CodeExample">&nbsp;=&nbsp;</span><span class="f_CodeExample" style="color: #333333;">ls</span><span class="f_CodeExample">;</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">do</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">count</span><span class="f_CodeExample">&nbsp;=&nbsp;(</span><span class="f_CodeExample" style="color: #333333;">count</span><span class="f_CodeExample">&nbsp;+&nbsp;</span><span class="f_Normal" style="font-family: Arial,Helvetica,sans-serif; color: #000000; background-color: transparent;">1</span><span class="f_CodeExample">)&nbsp;/&nbsp;</span><span class="f_Normal" style="font-family: Arial,Helvetica,sans-serif; color: #000000; background-color: transparent;">2</span><span class="f_CodeExample">;</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">dSTD</span><span class="f_CodeExample">[</span><span class="f_CodeExample" style="color: #333333;">l</span><span class="f_CodeExample">]&nbsp;+=&nbsp;(</span><span class="f_CodeExample" style="color: #333333;">l</span><span class="f_CodeExample">&nbsp;&lt;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">count</span><span class="f_CodeExample">&nbsp;?&nbsp;</span><span class="f_CodeExample" style="color: #333333;">dSTD</span><span class="f_CodeExample">[</span><span class="f_CodeExample" style="color: #333333;">l</span><span class="f_CodeExample">&nbsp;+&nbsp;</span><span class="f_CodeExample" style="color: #333333;">count</span><span class="f_CodeExample">]&nbsp;:&nbsp;</span><span class="f_Normal" style="font-family: Arial,Helvetica,sans-serif; color: #000000; background-color: transparent;">0</span><span class="f_CodeExample">);</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">dMean1</span><span class="f_CodeExample">[</span><span class="f_CodeExample" style="color: #333333;">l</span><span class="f_CodeExample">]&nbsp;+=&nbsp;(</span><span class="f_CodeExample" style="color: #333333;">l</span><span class="f_CodeExample">&nbsp;&lt;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">count</span><span class="f_CodeExample">&nbsp;?&nbsp;</span><span class="f_CodeExample" style="color: #333333;">dMean1</span><span class="f_CodeExample">[</span><span class="f_CodeExample" style="color: #333333;">l</span><span class="f_CodeExample">&nbsp;+&nbsp;</span><span class="f_CodeExample" style="color: #333333;">count</span><span class="f_CodeExample">]&nbsp;:&nbsp;</span><span class="f_CodeExample" style="color: #333333;">0</span><span class="f_CodeExample">);</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">dMean2</span><span class="f_CodeExample">[</span><span class="f_CodeExample" style="color: #333333;">l</span><span class="f_CodeExample">]&nbsp;+=&nbsp;(</span><span class="f_CodeExample" style="color: #333333;">l</span><span class="f_CodeExample">&nbsp;&lt;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">count</span><span class="f_CodeExample">&nbsp;?&nbsp;</span><span class="f_CodeExample" style="color: #333333;">dMean2</span><span class="f_CodeExample">[</span><span class="f_CodeExample" style="color: #333333;">l</span><span class="f_CodeExample">&nbsp;+&nbsp;</span><span class="f_CodeExample" style="color: #333333;">count</span><span class="f_CodeExample">]&nbsp;:&nbsp;</span><span class="f_Normal" style="font-family: Arial,Helvetica,sans-serif; color: #000000; background-color: transparent;">0</span><span class="f_CodeExample">);</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_Functions">barrier</span><span class="f_CodeExample">(</span><span class="f_Definition">CLK_LOCAL_MEM_FENCE</span><span class="f_CodeExample">);</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">while</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #333333;">count</span><span class="f_CodeExample">&nbsp;&gt;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">1</span><span class="f_CodeExample">);</span>
<br><span class="f_CodeExample" style="color: #808080;">//---</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">TYPE</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #333333;">dstd</span><span class="f_CodeExample">&nbsp;=&nbsp;</span><span class="f_CodeExample" style="color: #333333;">dSTD</span><span class="f_CodeExample">[</span><span class="f_Normal" style="font-family: Arial,Helvetica,sans-serif; color: #000000; background-color: transparent;">0</span><span class="f_CodeExample">];</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">TYPE</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #333333;">dmean</span><span class="f_CodeExample">&nbsp;=&nbsp;</span><span class="f_CodeExample" style="color: #333333;">dMean1</span><span class="f_CodeExample">[</span><span class="f_Normal" style="font-family: Arial,Helvetica,sans-serif; color: #000000; background-color: transparent;">0</span><span class="f_CodeExample">]&nbsp;+&nbsp;</span><span class="f_CodeExample" style="color: #333333;">dstd</span><span class="f_CodeExample">&nbsp;*&nbsp;</span><span class="f_CodeExample" style="color: #333333;">dMean2</span><span class="f_CodeExample">[</span><span class="f_Normal" style="font-family: Arial,Helvetica,sans-serif; color: #000000; background-color: transparent;">0</span><span class="f_CodeExample">];</span></p>
</td>
</tr>
</table>
</div>
<p class="p_Text"><span class="f_Text">We will transfer the resulting values to private variables. When calculating the derivative of the arithmetic mean deviation, we multiply the value of the right term by the derivative of the standard deviation and add it to the left term.</span></p>
<p class="p_Text"><span class="f_Text">At this stage, we have enough data to adjust the error gradient for each buffer element. Let's organize another loop, in the body of which this work will be performed.</span></p>
<div style="text-align: left; text-indent: 0; line-height: 1.0; page-break-inside: avoid; page-break-after: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0 0 0 0; margin: 2px 17px 2px 17px;"><table cellspacing="0" cellpadding="3" border="0" style="text-align: justify;border:none; border-spacing:0;">
<tr>
<td style="vertical-align:top; padding:3px; border:none"><p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample" style="color: #808080;">//---</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">count</span><span class="f_CodeExample">&nbsp;=&nbsp;</span><span class="f_Normal" style="font-family: Arial,Helvetica,sans-serif; color: #000000; background-color: transparent;">0</span><span class="f_CodeExample">;</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">while</span><span class="f_CodeExample">((</span><span class="f_CodeExample" style="color: #333333;">count</span><span class="f_CodeExample">&nbsp;*&nbsp;</span><span class="f_CodeExample" style="color: #333333;">ls</span><span class="f_CodeExample">&nbsp;+&nbsp;</span><span class="f_CodeExample" style="color: #333333;">l</span><span class="f_CodeExample">)&nbsp;&lt;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">total</span><span class="f_CodeExample">)</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">uint</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #333333;">shift</span><span class="f_CodeExample">&nbsp;=&nbsp;</span><span class="f_CodeExample" style="color: #333333;">count</span><span class="f_CodeExample">&nbsp;*&nbsp;</span><span class="f_CodeExample" style="color: #333333;">ls</span><span class="f_CodeExample">&nbsp;+&nbsp;</span><span class="f_CodeExample" style="color: #333333;">l</span><span class="f_CodeExample">;</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">inp_gradient</span><span class="f_CodeExample">[</span><span class="f_CodeExample" style="color: #333333;">shift</span><span class="f_CodeExample">]&nbsp;=&nbsp;</span><span class="f_CodeExample" style="color: #333333;">out_gradient</span><span class="f_CodeExample">[</span><span class="f_CodeExample" style="color: #333333;">shift</span><span class="f_CodeExample">]&nbsp;/&nbsp;(</span><span class="f_CodeExample" style="color: #333333;">stds</span><span class="f_CodeExample">[</span><span class="f_CodeExample" style="color: #333333;">std_shift</span><span class="f_CodeExample">]&nbsp;+&nbsp;</span><span class="f_Normal" style="font-family: Arial,Helvetica,sans-serif; color: #000000; background-color: transparent;">1e-32f</span><span class="f_CodeExample">)&nbsp;+&nbsp;</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(</span><span class="f_Normal" style="font-family: Arial,Helvetica,sans-serif; color: #000000; background-color: transparent;">2</span><span class="f_CodeExample">&nbsp;*&nbsp;</span><span class="f_CodeExample" style="color: #333333;">dstd</span><span class="f_CodeExample">&nbsp;*&nbsp;</span><span class="f_CodeExample" style="color: #333333;">outputs</span><span class="f_CodeExample">[</span><span class="f_CodeExample" style="color: #333333;">shift</span><span class="f_CodeExample">]&nbsp;*&nbsp;</span><span class="f_CodeExample" style="color: #333333;">stds</span><span class="f_CodeExample">[</span><span class="f_CodeExample" style="color: #333333;">std_shift</span><span class="f_CodeExample">]&nbsp;&nbsp;+&nbsp;</span><span class="f_CodeExample" style="color: #333333;">dmean</span><span class="f_CodeExample">)&nbsp;/&nbsp;</span><span class="f_CodeExample" style="color: #333333;">total</span><span class="f_CodeExample">;</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">count</span><span class="f_CodeExample">++;</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;}</span></p>
</td>
</tr>
</table>
</div>
<p class="p_Text"><span class="f_Text">This concludes our work with the OpenCL program. Now we need to proceed with the second part and set up the preparatory work for launching multi-threaded computations on the main program side.</span></p>
<p class="p_Text"><span class="f_Text">First, let's add constants for working with kernels to the </span><span class="f_Text" style="font-style: italic;">defines.mqh</span><span class="f_Text"> file. We need to add constants for identifying the kernels themselves and their variables. To name the constants, we use the previously agreed rules that apply to all constants within our project:</span></p>
<ul style="list-style-type:disc">
<li class="p_li"><span class="f_li">All constants begin with the prefix </span><span class="f_li" style="font-style: italic;">def</span><span class="f_li">.</span></li>
<li class="p_li"><span class="f_li">Kernels begin with the prefix </span><span class="f_li" style="font-style: italic;">def_k</span><span class="f_li">.</span></li>
<li class="p_li"><span class="f_li">Parameter constants after the </span><span class="f_li" style="font-style: italic;">def</span><span class="f_li"> prefix contain a pointer to the kernel.</span></li>
</ul>
<div style="text-align: left; text-indent: 0; line-height: 1.0; page-break-inside: avoid; page-break-after: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0 0 0 0; margin: 2px 17px 2px 17px;"><table cellspacing="0" cellpadding="3" border="0" style="text-align: justify;border:none; border-spacing:0;">
<tr>
<td style="vertical-align:top; padding:3px; border:none"><p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample" style="color: #0000ff;">#define</span><span class="f_CodeExample">&nbsp;</span><span class="f_Definition">def_k_AttentionFeedForward</span><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_Normal" style="font-family: Arial,Helvetica,sans-serif; color: #000000; background-color: transparent;">28</span>
<br><span class="f_CodeExample" style="color: #0000ff;">#define</span><span class="f_CodeExample">&nbsp;</span><span class="f_Definition">def_k_AttentionScoreGradients</span><span class="f_CodeExample">&nbsp;&nbsp;</span><span class="f_Normal" style="font-family: Arial,Helvetica,sans-serif; color: #000000; background-color: transparent;">29</span>
<br><span class="f_CodeExample" style="color: #0000ff;">#define</span><span class="f_CodeExample">&nbsp;</span><span class="f_Definition">def_k_AttentionHiddenGradients</span><span class="f_CodeExample">&nbsp;</span><span class="f_Normal" style="font-family: Arial,Helvetica,sans-serif; color: #000000; background-color: transparent;">30</span>
<br><span class="f_CodeExample" style="color: #0000ff;">#define</span><span class="f_CodeExample">&nbsp;</span><span class="f_Definition">def_k_Sum</span><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_Normal" style="font-family: Arial,Helvetica,sans-serif; color: #000000; background-color: transparent;">31</span>
<br><span class="f_CodeExample" style="color: #0000ff;">#define</span><span class="f_CodeExample">&nbsp;</span><span class="f_Definition">def_k_LayerNormalize</span><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_Normal" style="font-family: Arial,Helvetica,sans-serif; color: #000000; background-color: transparent;">32</span>
<br><span class="f_CodeExample" style="color: #0000ff;">#define</span><span class="f_CodeExample">&nbsp;</span><span class="f_Definition">def_k_LayerNormalizeGradient</span><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_Normal" style="font-family: Arial,Helvetica,sans-serif; color: #000000; background-color: transparent;">33</span></p>
</td>
</tr>
</table>
</div>
<div style="text-align: left; text-indent: 0; line-height: 1.0; page-break-inside: avoid; page-break-after: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0 0 0 0; margin: 2px 17px 2px 17px;"><table cellspacing="0" cellpadding="3" border="0" style="text-align: justify;border:none; border-spacing:0;">
<tr>
<td style="vertical-align:top; padding:3px; border:none"><p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample" style="color: #808080;">//---&nbsp;feed-forward&nbsp;pass&nbsp;of&nbsp;the&nbsp;attention&nbsp;block</span>
<br><span class="f_CodeExample" style="color: #0000ff;">#define</span><span class="f_CodeExample">&nbsp;</span><span class="f_Definition">def_attff_querys</span><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_Normal" style="font-family: Arial,Helvetica,sans-serif; color: #000000; background-color: transparent;">0</span>
<br><span class="f_CodeExample" style="color: #0000ff;">#define</span><span class="f_CodeExample">&nbsp;</span><span class="f_Definition">def_attff_keys</span><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_Normal" style="font-family: Arial,Helvetica,sans-serif; color: #000000; background-color: transparent;">1</span>
<br><span class="f_CodeExample" style="color: #0000ff;">#define</span><span class="f_CodeExample">&nbsp;</span><span class="f_Definition">def_attff_scores</span><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_Normal" style="font-family: Arial,Helvetica,sans-serif; color: #000000; background-color: transparent;">2</span>
<br><span class="f_CodeExample" style="color: #0000ff;">#define</span><span class="f_CodeExample">&nbsp;</span><span class="f_Definition">def_attff_values</span><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_Normal" style="font-family: Arial,Helvetica,sans-serif; color: #000000; background-color: transparent;">3</span>
<br><span class="f_CodeExample" style="color: #0000ff;">#define</span><span class="f_CodeExample">&nbsp;</span><span class="f_Definition">def_attff_outputs</span><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_Normal" style="font-family: Arial,Helvetica,sans-serif; color: #000000; background-color: transparent;">4</span>
<br><span class="f_CodeExample" style="color: #0000ff;">#define</span><span class="f_CodeExample">&nbsp;</span><span class="f_Definition">def_attff_window</span><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_Normal" style="font-family: Arial,Helvetica,sans-serif; color: #000000; background-color: transparent;">5</span>
<br><span class="f_CodeExample" style="color: #0000ff;">#define</span><span class="f_CodeExample">&nbsp;</span><span class="f_Definition">def_attff_key_size</span><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_Normal" style="font-family: Arial,Helvetica,sans-serif; color: #000000; background-color: transparent;">6</span></p>
</td>
</tr>
</table>
</div>
<div style="text-align: left; text-indent: 0; line-height: 1.0; page-break-inside: avoid; page-break-after: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0 0 0 0; margin: 2px 17px 2px 17px;"><table cellspacing="0" cellpadding="3" border="0" style="text-align: justify;border:none; border-spacing:0;">
<tr>
<td style="vertical-align:top; padding:3px; border:none"><p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample" style="color: #808080;">//---&nbsp;determine&nbsp;the&nbsp;gradient&nbsp;on&nbsp;the&nbsp;matrix&nbsp;of&nbsp;dependence&nbsp;coefficients&nbsp;of&nbsp;the&nbsp;attention&nbsp;block</span>
<br><span class="f_CodeExample" style="color: #0000ff;">#define</span><span class="f_CodeExample">&nbsp;</span><span class="f_Definition">def_attscr_scores</span><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_Normal" style="font-family: Arial,Helvetica,sans-serif; color: #000000; background-color: transparent;">0</span>
<br><span class="f_CodeExample" style="color: #0000ff;">#define</span><span class="f_CodeExample">&nbsp;</span><span class="f_Definition">def_attscr_scores_grad</span><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_Normal" style="font-family: Arial,Helvetica,sans-serif; color: #000000; background-color: transparent;">1</span>
<br><span class="f_CodeExample" style="color: #0000ff;">#define</span><span class="f_CodeExample">&nbsp;</span><span class="f_Definition">def_attscr_values</span><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_Normal" style="font-family: Arial,Helvetica,sans-serif; color: #000000; background-color: transparent;">2</span>
<br><span class="f_CodeExample" style="color: #0000ff;">#define</span><span class="f_CodeExample">&nbsp;</span><span class="f_Definition">def_attscr_values_grad</span><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_Normal" style="font-family: Arial,Helvetica,sans-serif; color: #000000; background-color: transparent;">3</span>
<br><span class="f_CodeExample" style="color: #0000ff;">#define</span><span class="f_CodeExample">&nbsp;</span><span class="f_Definition">def_attscr_outputs_grad</span><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_Normal" style="font-family: Arial,Helvetica,sans-serif; color: #000000; background-color: transparent;">4</span>
<br><span class="f_CodeExample" style="color: #0000ff;">#define</span><span class="f_CodeExample">&nbsp;</span><span class="f_Definition">def_attscr_scores_temp</span><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_Normal" style="font-family: Arial,Helvetica,sans-serif; color: #000000; background-color: transparent;">5</span>
<br><span class="f_CodeExample" style="color: #0000ff;">#define</span><span class="f_CodeExample">&nbsp;</span><span class="f_Definition">def_attscr_window</span><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_Normal" style="font-family: Arial,Helvetica,sans-serif; color: #000000; background-color: transparent;">6</span></p>
</td>
</tr>
</table>
</div>
<div style="text-align: left; text-indent: 0; line-height: 1.0; page-break-inside: avoid; page-break-after: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0 0 0 0; margin: 2px 17px 2px 17px;"><table cellspacing="0" cellpadding="3" border="0" style="text-align: justify;border:none; border-spacing:0;">
<tr>
<td style="vertical-align:top; padding:3px; border:none"><p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample" style="color: #808080;">//---&nbsp;gradient&nbsp;distribution&nbsp;through&nbsp;the&nbsp;attention&nbsp;block</span>
<br><span class="f_CodeExample" style="color: #0000ff;">#define</span><span class="f_CodeExample">&nbsp;</span><span class="f_Definition">def_atthgr_querys</span><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_Normal" style="font-family: Arial,Helvetica,sans-serif; color: #000000; background-color: transparent;">0</span>
<br><span class="f_CodeExample" style="color: #0000ff;">#define</span><span class="f_CodeExample">&nbsp;</span><span class="f_Definition">def_atthgr_querys_grad</span><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_Normal" style="font-family: Arial,Helvetica,sans-serif; color: #000000; background-color: transparent;">1</span>
<br><span class="f_CodeExample" style="color: #0000ff;">#define</span><span class="f_CodeExample">&nbsp;</span><span class="f_Definition">def_atthgr_keys</span><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_Normal" style="font-family: Arial,Helvetica,sans-serif; color: #000000; background-color: transparent;">2</span>
<br><span class="f_CodeExample" style="color: #0000ff;">#define</span><span class="f_CodeExample">&nbsp;</span><span class="f_Definition">def_atthgr_keys_grad</span><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_Normal" style="font-family: Arial,Helvetica,sans-serif; color: #000000; background-color: transparent;">3</span>
<br><span class="f_CodeExample" style="color: #0000ff;">#define</span><span class="f_CodeExample">&nbsp;</span><span class="f_Definition">def_atthgr_scores_grad</span><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_Normal" style="font-family: Arial,Helvetica,sans-serif; color: #000000; background-color: transparent;">4</span>
<br><span class="f_CodeExample" style="color: #0000ff;">#define</span><span class="f_CodeExample">&nbsp;</span><span class="f_Definition">def_atthgr_key_size</span><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_Normal" style="font-family: Arial,Helvetica,sans-serif; color: #000000; background-color: transparent;">5</span></p>
</td>
</tr>
</table>
</div>
<div style="text-align: justify; text-indent: 0; padding: 0 0 0 0; margin: 7px 17px 6px 17px;"><table cellspacing="0" cellpadding="3" border="0" style="text-align: justify;border:none; border-spacing:0;">
<tr>
<td style="vertical-align:top; padding:3px; border:none"><p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample" style="color: #808080;">//---&nbsp;sum&nbsp;of&nbsp;vectors&nbsp;</span>
<br><span class="f_CodeExample" style="color: #0000ff;">#define</span><span class="f_CodeExample">&nbsp;</span><span class="f_Definition">def_sum_inputs1</span><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_Normal" style="font-family: Arial,Helvetica,sans-serif; color: #000000; background-color: transparent;">0</span>
<br><span class="f_CodeExample" style="color: #0000ff;">#define</span><span class="f_CodeExample">&nbsp;</span><span class="f_Definition">def_sum_inputs2</span><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_Normal" style="font-family: Arial,Helvetica,sans-serif; color: #000000; background-color: transparent;">1</span>
<br><span class="f_CodeExample" style="color: #0000ff;">#define</span><span class="f_CodeExample">&nbsp;</span><span class="f_Definition">def_sum_outputs</span><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_Normal" style="font-family: Arial,Helvetica,sans-serif; color: #000000; background-color: transparent;">2</span></p>
</td>
</tr>
</table>
</div>
<div style="text-align: left; text-indent: 0; line-height: 1.0; page-break-inside: avoid; page-break-after: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0 0 0 0; margin: 2px 17px 2px 17px;"><table cellspacing="0" cellpadding="3" border="0" style="text-align: justify;border:none; border-spacing:0;">
<tr>
<td style="vertical-align:top; padding:3px; border:none"><p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample" style="color: #808080;">//---&nbsp;vector&nbsp;normalization</span>
<br><span class="f_CodeExample" style="color: #0000ff;">#define</span><span class="f_CodeExample">&nbsp;</span><span class="f_Definition">def_layernorm_inputs</span><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_Normal" style="font-family: Arial,Helvetica,sans-serif; color: #000000; background-color: transparent;">0</span>
<br><span class="f_CodeExample" style="color: #0000ff;">#define</span><span class="f_CodeExample">&nbsp;</span><span class="f_Definition">def_layernorm_outputs</span><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_Normal" style="font-family: Arial,Helvetica,sans-serif; color: #000000; background-color: transparent;">1</span>
<br><span class="f_CodeExample" style="color: #0000ff;">#define</span><span class="f_CodeExample">&nbsp;</span><span class="f_Definition">def_layernorm_std</span><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_Normal" style="font-family: Arial,Helvetica,sans-serif; color: #000000; background-color: transparent;">2</span>
<br><span class="f_CodeExample" style="color: #0000ff;">#define</span><span class="f_CodeExample">&nbsp;</span><span class="f_Definition">def_layernorm_vector_size</span><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_Normal" style="font-family: Arial,Helvetica,sans-serif; color: #000000; background-color: transparent;">3</span>
<br><span class="f_CodeExample" style="color: #0000ff;">#define</span><span class="f_CodeExample">&nbsp;</span><span class="f_Definition">def_layernorm_std_shift</span><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_Normal" style="font-family: Arial,Helvetica,sans-serif; color: #000000; background-color: transparent;">4</span></p>
</td>
</tr>
</table>
</div>
<div style="text-align: left; text-indent: 0; line-height: 1.0; page-break-inside: avoid; page-break-after: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0 0 0 0; margin: 2px 17px 2px 17px;"><table cellspacing="0" cellpadding="3" border="0" style="text-align: justify;border:none; border-spacing:0;">
<tr>
<td style="vertical-align:top; padding:3px; border:none"><p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample" style="color: #808080;">//---&nbsp;vector&nbsp;normalization&nbsp;gradient</span>
<br><span class="f_CodeExample" style="color: #0000ff;">#define</span><span class="f_CodeExample">&nbsp;</span><span class="f_Definition">def_layernormgr_outputs</span><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_Normal" style="font-family: Arial,Helvetica,sans-serif; color: #000000; background-color: transparent;">0</span>
<br><span class="f_CodeExample" style="color: #0000ff;">#define</span><span class="f_CodeExample">&nbsp;</span><span class="f_Definition">def_layernormgr_out_grad</span><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_Normal" style="font-family: Arial,Helvetica,sans-serif; color: #000000; background-color: transparent;">1</span>
<br><span class="f_CodeExample" style="color: #0000ff;">#define</span><span class="f_CodeExample">&nbsp;</span><span class="f_Definition">def_layernormgr_inp_grad</span><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_Normal" style="font-family: Arial,Helvetica,sans-serif; color: #000000; background-color: transparent;">2</span>
<br><span class="f_CodeExample" style="color: #0000ff;">#define</span><span class="f_CodeExample">&nbsp;</span><span class="f_Definition">def_layernormgr_std</span><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_Normal" style="font-family: Arial,Helvetica,sans-serif; color: #000000; background-color: transparent;">3</span>
<br><span class="f_CodeExample" style="color: #0000ff;">#define</span><span class="f_CodeExample">&nbsp;</span><span class="f_Definition">def_layernormgr_vector_size</span><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_Normal" style="font-family: Arial,Helvetica,sans-serif; color: #000000; background-color: transparent;">4</span>
<br><span class="f_CodeExample" style="color: #0000ff;">#define</span><span class="f_CodeExample">&nbsp;</span><span class="f_Definition">def_layernormgr_std_shift</span><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_Normal" style="font-family: Arial,Helvetica,sans-serif; color: #000000; background-color: transparent;">5</span></p>
</td>
</tr>
</table>
</div>
<p class="p_Text"><span class="f_Text">After that, we will need to add the declaration of the new kernels to the code of the main neural network dispatcher class. Like all previously created kernels, we will add the declaration of new kernels to the </span><span class="f_Text" style="font-style: italic;">CNet::InitOpenCL</span><span class="f_Text"> method. In it, we will first update the total number of kernels used in the program.</span></p>
<div style="text-align: left; text-indent: 0; line-height: 1.0; page-break-inside: avoid; page-break-after: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0 0 0 0; margin: 2px 17px 2px 17px;"><table cellspacing="0" cellpadding="3" border="0" style="text-align: justify;border:none; border-spacing:0;">
<tr>
<td style="vertical-align:top; padding:3px; border:none"><p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">if</span><span class="f_CodeExample">(!</span><span class="f_CodeExample" style="color: #333333;">m_cOpenCL</span><span class="f_CodeExample">.</span><span class="f_CodeExample" style="color: #333333;">SetKernelsCount</span><span class="f_CodeExample">(</span><span class="f_Normal" style="font-family: Arial,Helvetica,sans-serif; color: #000000; background-color: transparent;">34</span><span class="f_CodeExample">))</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">m_cOpenCL</span><span class="f_CodeExample">.</span><span class="f_CodeExample" style="color: #333333;">Shutdown</span><span class="f_CodeExample">();</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">delete</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #333333;">m_cOpenCL</span><span class="f_CodeExample">;</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">return</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #ff0000;">false</span><span class="f_CodeExample">;</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></p>
</td>
</tr>
</table>
</div>
<p class="p_Text"><span class="f_Text">After this, we will declare the kernels themselves.</span></p>
<div style="text-align: left; text-indent: 0; line-height: 1.0; page-break-inside: avoid; page-break-after: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0 0 0 0; margin: 2px 17px 2px 17px;"><table cellspacing="0" cellpadding="3" border="0" style="text-align: justify;border:none; border-spacing:0;">
<tr>
<td style="vertical-align:top; padding:3px; border:none"><p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">if</span><span class="f_CodeExample">(!</span><span class="f_CodeExample" style="color: #333333;">m_cOpenCL</span><span class="f_CodeExample">.</span><span class="f_CodeExample" style="color: #333333;">KernelCreate</span><span class="f_CodeExample">(</span><span class="f_Definition">def_k_AttentionFeedForward</span><span class="f_CodeExample">,</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #008080;">&quot;AttentionFeedForward&quot;</span><span class="f_CodeExample">))</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">m_cOpenCL</span><span class="f_CodeExample">.</span><span class="f_CodeExample" style="color: #333333;">Shutdown</span><span class="f_CodeExample">();</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">delete</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #333333;">m_cOpenCL</span><span class="f_CodeExample">;</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">return</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #ff0000;">false</span><span class="f_CodeExample">;</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></p>
</td>
</tr>
</table>
</div>
<div style="text-align: left; text-indent: 0; line-height: 1.0; page-break-inside: avoid; page-break-after: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0 0 0 0; margin: 2px 17px 2px 17px;"><table cellspacing="0" cellpadding="3" border="0" style="text-align: justify;border:none; border-spacing:0;">
<tr>
<td style="vertical-align:top; padding:3px; border:none"><p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">if</span><span class="f_CodeExample">(!</span><span class="f_CodeExample" style="color: #333333;">m_cOpenCL</span><span class="f_CodeExample">.</span><span class="f_CodeExample" style="color: #333333;">KernelCreate</span><span class="f_CodeExample">(</span><span class="f_Definition">def_k_AttentionScoreGradients</span><span class="f_CodeExample">,</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #008080;">&quot;AttentionCalcScoreGradient&quot;</span><span class="f_CodeExample">))</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">m_cOpenCL</span><span class="f_CodeExample">.</span><span class="f_CodeExample" style="color: #333333;">Shutdown</span><span class="f_CodeExample">();</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">delete</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #333333;">m_cOpenCL</span><span class="f_CodeExample">;</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">return</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #ff0000;">false</span><span class="f_CodeExample">;</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></p>
</td>
</tr>
</table>
</div>
<div style="text-align: left; text-indent: 0; line-height: 1.0; page-break-inside: avoid; page-break-after: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0 0 0 0; margin: 2px 17px 2px 17px;"><table cellspacing="0" cellpadding="3" border="0" style="text-align: justify;border:none; border-spacing:0;">
<tr>
<td style="vertical-align:top; padding:3px; border:none"><p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">if</span><span class="f_CodeExample">(!</span><span class="f_CodeExample" style="color: #333333;">m_cOpenCL</span><span class="f_CodeExample">.</span><span class="f_CodeExample" style="color: #333333;">KernelCreate</span><span class="f_CodeExample">(</span><span class="f_Definition">def_k_AttentionHiddenGradients</span><span class="f_CodeExample">,</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #008080;">&quot;AttentionCalcHiddenGradient&quot;</span><span class="f_CodeExample">))</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">m_cOpenCL</span><span class="f_CodeExample">.</span><span class="f_CodeExample" style="color: #333333;">Shutdown</span><span class="f_CodeExample">();</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">delete</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #333333;">m_cOpenCL</span><span class="f_CodeExample">;</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">return</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #ff0000;">false</span><span class="f_CodeExample">;</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></p>
</td>
</tr>
</table>
</div>
<div style="text-align: left; text-indent: 0; line-height: 1.0; page-break-inside: avoid; page-break-after: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0 0 0 0; margin: 2px 17px 2px 17px;"><table cellspacing="0" cellpadding="3" border="0" style="text-align: justify;border:none; border-spacing:0;">
<tr>
<td style="vertical-align:top; padding:3px; border:none"><p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">if</span><span class="f_CodeExample">(!</span><span class="f_CodeExample" style="color: #333333;">m_cOpenCL</span><span class="f_CodeExample">.</span><span class="f_CodeExample" style="color: #333333;">KernelCreate</span><span class="f_CodeExample">(</span><span class="f_Definition">def_k_Sum</span><span class="f_CodeExample">,&nbsp;</span><span class="f_CodeExample" style="color: #008080;">&quot;Sum&quot;</span><span class="f_CodeExample">))</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">m_cOpenCL</span><span class="f_CodeExample">.</span><span class="f_CodeExample" style="color: #333333;">Shutdown</span><span class="f_CodeExample">();</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">delete</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #333333;">m_cOpenCL</span><span class="f_CodeExample">;</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">return</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #ff0000;">false</span><span class="f_CodeExample">;</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></p>
</td>
</tr>
</table>
</div>
<div style="text-align: left; text-indent: 0; line-height: 1.0; page-break-inside: avoid; page-break-after: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0 0 0 0; margin: 2px 17px 2px 17px;"><table cellspacing="0" cellpadding="3" border="0" style="text-align: justify;border:none; border-spacing:0;">
<tr>
<td style="vertical-align:top; padding:3px; border:none"><p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">if</span><span class="f_CodeExample">(!</span><span class="f_CodeExample" style="color: #333333;">m_cOpenCL</span><span class="f_CodeExample">.</span><span class="f_CodeExample" style="color: #333333;">KernelCreate</span><span class="f_CodeExample">(</span><span class="f_Definition">def_k_LayerNormalize</span><span class="f_CodeExample">,&nbsp;</span><span class="f_CodeExample" style="color: #008080;">&quot;LayerNormalize&quot;</span><span class="f_CodeExample">))</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">m_cOpenCL</span><span class="f_CodeExample">.</span><span class="f_CodeExample" style="color: #333333;">Shutdown</span><span class="f_CodeExample">();</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">delete</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #333333;">m_cOpenCL</span><span class="f_CodeExample">;</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">return</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #ff0000;">false</span><span class="f_CodeExample">;</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></p>
</td>
</tr>
</table>
</div>
<div style="text-align: left; text-indent: 0; line-height: 1.0; page-break-inside: avoid; page-break-after: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0 0 0 0; margin: 2px 17px 2px 17px;"><table cellspacing="0" cellpadding="3" border="0" style="text-align: justify;border:none; border-spacing:0;">
<tr>
<td style="vertical-align:top; padding:3px; border:none"><p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">if</span><span class="f_CodeExample">(!</span><span class="f_CodeExample" style="color: #333333;">m_cOpenCL</span><span class="f_CodeExample">.</span><span class="f_CodeExample" style="color: #333333;">KernelCreate</span><span class="f_CodeExample">(</span><span class="f_Definition">def_k_LayerNormalizeGradient</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #008080;">&quot;LayerNormalizeGradient&quot;</span><span class="f_CodeExample">))</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">m_cOpenCL</span><span class="f_CodeExample">.</span><span class="f_CodeExample" style="color: #333333;">Shutdown</span><span class="f_CodeExample">();</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">delete</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #333333;">m_cOpenCL</span><span class="f_CodeExample">;</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">return</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #ff0000;">false</span><span class="f_CodeExample">;</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></p>
</td>
</tr>
</table>
</div>
<p class="p_Text"><span class="f_Text">Then we move on to the attention mechanism class </span><span class="f_Text" style="font-style: italic;">CNeuronAttention</span><span class="f_Text"> and make changes to its methods in terms of working with OpenCL technology.</span></p>
<p class="p_Text"><span class="f_Text">Let's first add the feed-forward pass method </span><span class="f_Text" style="font-style: italic;">CNeuronAttention::FeedForward</span><span class="f_Text">. In this method, we need to organize a procedure for calling the feed-forward kernel </span><span class="f_Text" style="font-style: italic;">AttentionFeedForward</span><span class="f_Text">. We have created similar processes multiple times. So, its algorithm is as follows:</span></p>
<ol style="list-style-type:decimal">
<li value="1" class="p_li"><span class="f_li">Check the presence of data buffers in the OpenCL context.</span></li>
<li value="2" class="p_li"><span class="f_li">Pass parameters to the kernel, including pointers to data buffers.</span></li>
<li value="3" class="p_li"><span class="f_li">Queue the kernel to perform operations.</span></li>
</ol>
<p class="p_Text"><span class="f_Text">While doing so, we must ensure proper control of the operations to avoid potential critical errors during the program execution.</span></p>
<div style="text-align: left; text-indent: 0; line-height: 1.0; page-break-inside: avoid; page-break-after: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0 0 0 0; margin: 2px 17px 2px 17px;"><table cellspacing="0" cellpadding="3" border="0" style="text-align: justify;border:none; border-spacing:0;">
<tr>
<td style="vertical-align:top; padding:3px; border:none"><p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample" style="color: #0000ff;">bool</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #333333;">CNeuronAttention</span><span class="f_CodeExample">::</span><span class="f_CodeExample" style="color: #333333;">FeedForward</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #333333;">CNeuronBase</span><span class="f_CodeExample">&nbsp;*</span><span class="f_CodeExample" style="color: #333333;">prevLayer</span><span class="f_CodeExample">)</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;{</span>
<br><span class="f_CodeExample" style="color: #808080;">//---&nbsp;calculation&nbsp;of&nbsp;vectors&nbsp;Query,&nbsp;Key,&nbsp;Value</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;.....</span>
<br><span class="f_CodeExample" style="color: #808080;">//---&nbsp;Branching&nbsp;the&nbsp;algorithm&nbsp;on&nbsp;the&nbsp;computing&nbsp;device</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_Definition">MATRIX</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #333333;">out</span><span class="f_CodeExample">;</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">if</span><span class="f_CodeExample">(!</span><span class="f_CodeExample" style="color: #333333;">m_cOpenCL</span><span class="f_CodeExample">)</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #808080;">//&nbsp;MQL5&nbsp;block</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;.....</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">else</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #808080;">//&nbsp;OpenCL&nbsp;block</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #808080;">//---&nbsp;checking&nbsp;data&nbsp;buffers</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">if</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #333333;">m_cQuerys</span><span class="f_CodeExample">.</span><span class="f_CodeExample" style="color: #333333;">GetOutputs</span><span class="f_CodeExample">().</span><span class="f_CodeExample" style="color: #333333;">GetIndex</span><span class="f_CodeExample">()&nbsp;&lt;&nbsp;</span><span class="f_Normal" style="font-family: Arial,Helvetica,sans-serif; color: #000000; background-color: transparent;">0</span><span class="f_CodeExample">)</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">return</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #ff0000;">false</span><span class="f_CodeExample">;</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">if</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #333333;">m_cKeys</span><span class="f_CodeExample">.</span><span class="f_CodeExample" style="color: #333333;">GetOutputs</span><span class="f_CodeExample">().</span><span class="f_CodeExample" style="color: #333333;">GetIndex</span><span class="f_CodeExample">()&nbsp;&lt;&nbsp;</span><span class="f_Normal" style="font-family: Arial,Helvetica,sans-serif; color: #000000; background-color: transparent;">0</span><span class="f_CodeExample">)</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">return</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #ff0000;">false</span><span class="f_CodeExample">;</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">if</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #333333;">m_cValues</span><span class="f_CodeExample">.</span><span class="f_CodeExample" style="color: #333333;">GetOutputs</span><span class="f_CodeExample">().</span><span class="f_CodeExample" style="color: #333333;">GetIndex</span><span class="f_CodeExample">()&nbsp;&lt;&nbsp;</span><span class="f_Normal" style="font-family: Arial,Helvetica,sans-serif; color: #000000; background-color: transparent;">0</span><span class="f_CodeExample">)</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">return</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #ff0000;">false</span><span class="f_CodeExample">;</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">if</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #333333;">m_cScores</span><span class="f_CodeExample">.</span><span class="f_CodeExample" style="color: #333333;">GetIndex</span><span class="f_CodeExample">()&nbsp;&lt;&nbsp;</span><span class="f_Normal" style="font-family: Arial,Helvetica,sans-serif; color: #000000; background-color: transparent;">0</span><span class="f_CodeExample">)</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">return</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #ff0000;">false</span><span class="f_CodeExample">;</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">if</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #333333;">m_cAttentionOut</span><span class="f_CodeExample">.</span><span class="f_CodeExample" style="color: #333333;">GetOutputs</span><span class="f_CodeExample">().</span><span class="f_CodeExample" style="color: #333333;">GetIndex</span><span class="f_CodeExample">()&nbsp;&lt;&nbsp;</span><span class="f_Normal" style="font-family: Arial,Helvetica,sans-serif; color: #000000; background-color: transparent;">0</span><span class="f_CodeExample">)</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">return</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #ff0000;">false</span><span class="f_CodeExample">;</span></p>
</td>
</tr>
</table>
</div>
<p class="p_Text"><span class="f_Text">With all the necessary buffers in the </span><span class="f_Text" style="font-style: italic;">OpenCL</span><span class="f_Text"> context, we will set up the transfer of pointers to them as kernel parameters.</span></p>
<div style="text-align: left; text-indent: 0; line-height: 1.0; page-break-inside: avoid; page-break-after: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0 0 0 0; margin: 2px 17px 2px 17px;"><table cellspacing="0" cellpadding="3" border="0" style="text-align: justify;border:none; border-spacing:0;">
<tr>
<td style="vertical-align:top; padding:3px; border:none"><p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #808080;">//---&nbsp;pass&nbsp;parameters&nbsp;to&nbsp;the&nbsp;kernel</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">if</span><span class="f_CodeExample">(!</span><span class="f_CodeExample" style="color: #333333;">m_cOpenCL</span><span class="f_CodeExample">.</span><span class="f_CodeExample" style="color: #333333;">SetArgumentBuffer</span><span class="f_CodeExample">(</span><span class="f_Definition">def_k_AttentionFeedForward</span><span class="f_CodeExample">,&nbsp;</span><span class="f_Definition">def_attff_keys</span><span class="f_CodeExample">,</span>
<br><span class="f_CodeExample" style="color: #333333;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;m_cKeys</span><span class="f_CodeExample">.</span><span class="f_CodeExample" style="color: #333333;">GetOutputs</span><span class="f_CodeExample">().</span><span class="f_CodeExample" style="color: #333333;">GetIndex</span><span class="f_CodeExample">()))</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">return</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #ff0000;">false</span><span class="f_CodeExample">;</span></p>
</td>
</tr>
</table>
</div>
<div style="text-align: left; text-indent: 0; line-height: 1.0; page-break-inside: avoid; page-break-after: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0 0 0 0; margin: 2px 17px 2px 17px;"><table cellspacing="0" cellpadding="3" border="0" style="text-align: justify;border:none; border-spacing:0;">
<tr>
<td style="vertical-align:top; padding:3px; border:none"><p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">if</span><span class="f_CodeExample">(!</span><span class="f_CodeExample" style="color: #333333;">m_cOpenCL</span><span class="f_CodeExample">.</span><span class="f_CodeExample" style="color: #333333;">SetArgumentBuffer</span><span class="f_CodeExample">(</span><span class="f_Definition">def_k_AttentionFeedForward</span><span class="f_CodeExample">,&nbsp;</span><span class="f_Definition">def_attff_outputs</span><span class="f_CodeExample">,</span>
<br><span class="f_CodeExample" style="color: #333333;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;m_cAttentionOut</span><span class="f_CodeExample">.</span><span class="f_CodeExample" style="color: #333333;">GetOutputs</span><span class="f_CodeExample">().</span><span class="f_CodeExample" style="color: #333333;">GetIndex</span><span class="f_CodeExample">()))</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">return</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #ff0000;">false</span><span class="f_CodeExample">;</span></p>
</td>
</tr>
</table>
</div>
<div style="text-align: left; text-indent: 0; line-height: 1.0; page-break-inside: avoid; page-break-after: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0 0 0 0; margin: 2px 17px 2px 17px;"><table cellspacing="0" cellpadding="3" border="0" style="text-align: justify;border:none; border-spacing:0;">
<tr>
<td style="vertical-align:top; padding:3px; border:none"><p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">if</span><span class="f_CodeExample">(!</span><span class="f_CodeExample" style="color: #333333;">m_cOpenCL</span><span class="f_CodeExample">.</span><span class="f_CodeExample" style="color: #333333;">SetArgumentBuffer</span><span class="f_CodeExample">(</span><span class="f_Definition">def_k_AttentionFeedForward</span><span class="f_CodeExample">,&nbsp;</span><span class="f_Definition">def_attff_querys</span><span class="f_CodeExample">,</span>
<br><span class="f_CodeExample" style="color: #333333;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;m_cQuerys</span><span class="f_CodeExample">.</span><span class="f_CodeExample" style="color: #333333;">GetOutputs</span><span class="f_CodeExample">().</span><span class="f_CodeExample" style="color: #333333;">GetIndex</span><span class="f_CodeExample">()))</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">return</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #ff0000;">false</span><span class="f_CodeExample">;</span></p>
</td>
</tr>
</table>
</div>
<div style="text-align: left; text-indent: 0; line-height: 1.0; page-break-inside: avoid; page-break-after: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0 0 0 0; margin: 2px 17px 2px 17px;"><table cellspacing="0" cellpadding="3" border="0" style="text-align: justify;border:none; border-spacing:0;">
<tr>
<td style="vertical-align:top; padding:3px; border:none"><p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">if</span><span class="f_CodeExample">(!</span><span class="f_CodeExample" style="color: #333333;">m_cOpenCL</span><span class="f_CodeExample">.</span><span class="f_CodeExample" style="color: #333333;">SetArgumentBuffer</span><span class="f_CodeExample">(</span><span class="f_Definition">def_k_AttentionFeedForward</span><span class="f_CodeExample">,&nbsp;</span><span class="f_Definition">def_attff_scores</span><span class="f_CodeExample">,</span>
<br><span class="f_CodeExample" style="color: #333333;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;m_cScores</span><span class="f_CodeExample">.</span><span class="f_CodeExample" style="color: #333333;">GetIndex</span><span class="f_CodeExample">()))</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">return</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #ff0000;">false</span><span class="f_CodeExample">;</span></p>
</td>
</tr>
</table>
</div>
<div style="text-align: left; text-indent: 0; line-height: 1.0; page-break-inside: avoid; page-break-after: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0 0 0 0; margin: 2px 17px 2px 17px;"><table cellspacing="0" cellpadding="3" border="0" style="text-align: justify;border:none; border-spacing:0;">
<tr>
<td style="vertical-align:top; padding:3px; border:none"><p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">if</span><span class="f_CodeExample">(!</span><span class="f_CodeExample" style="color: #333333;">m_cOpenCL</span><span class="f_CodeExample">.</span><span class="f_CodeExample" style="color: #333333;">SetArgumentBuffer</span><span class="f_CodeExample">(</span><span class="f_Definition">def_k_AttentionFeedForward</span><span class="f_CodeExample">,&nbsp;</span><span class="f_Definition">def_attff_values</span><span class="f_CodeExample">,</span>
<br><span class="f_CodeExample" style="color: #333333;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;m_cValues</span><span class="f_CodeExample">.</span><span class="f_CodeExample" style="color: #333333;">GetOutputs</span><span class="f_CodeExample">().</span><span class="f_CodeExample" style="color: #333333;">GetIndex</span><span class="f_CodeExample">()))</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">return</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #ff0000;">false</span><span class="f_CodeExample">;</span></p>
</td>
</tr>
</table>
</div>
<div style="text-align: left; text-indent: 0; line-height: 1.0; page-break-inside: avoid; page-break-after: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0 0 0 0; margin: 2px 17px 2px 17px;"><table cellspacing="0" cellpadding="3" border="0" style="text-align: justify;border:none; border-spacing:0;">
<tr>
<td style="vertical-align:top; padding:3px; border:none"><p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">if</span><span class="f_CodeExample">(!</span><span class="f_CodeExample" style="color: #333333;">m_cOpenCL</span><span class="f_CodeExample">.</span><span class="f_CodeExample" style="color: #333333;">SetArgument</span><span class="f_CodeExample">(</span><span class="f_Definition">def_k_AttentionFeedForward</span><span class="f_CodeExample">,&nbsp;</span><span class="f_Definition">def_attff_key_size</span><span class="f_CodeExample">,</span>
<br><span class="f_CodeExample" style="color: #333333;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;m_iKeysSize</span><span class="f_CodeExample">))</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">return</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #ff0000;">false</span><span class="f_CodeExample">;</span></p>
</td>
</tr>
</table>
</div>
<div style="text-align: left; text-indent: 0; line-height: 1.0; page-break-inside: avoid; page-break-after: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0 0 0 0; margin: 2px 17px 2px 17px;"><table cellspacing="0" cellpadding="3" border="0" style="text-align: justify;border:none; border-spacing:0;">
<tr>
<td style="vertical-align:top; padding:3px; border:none"><p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">if</span><span class="f_CodeExample">(!</span><span class="f_CodeExample" style="color: #333333;">m_cOpenCL</span><span class="f_CodeExample">.</span><span class="f_CodeExample" style="color: #333333;">SetArgument</span><span class="f_CodeExample">(</span><span class="f_Definition">def_k_AttentionFeedForward</span><span class="f_CodeExample">,&nbsp;</span><span class="f_Definition">def_attff_window</span><span class="f_CodeExample">,</span>
<br><span class="f_CodeExample" style="color: #333333;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;m_iWindow</span><span class="f_CodeExample">))</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">return</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #ff0000;">false</span><span class="f_CodeExample">;</span></p>
</td>
</tr>
</table>
</div>
<p class="p_Text"><span class="f_Text">Next comes the procedure for placing the kernel in the execution queue. First, let's indicate the number of required threads to launch and the offset. Only after that, we will call the kernel launch function, providing it with information about the number of instances to be launched.</span></p>
<div style="text-align: left; text-indent: 0; line-height: 1.0; page-break-inside: avoid; page-break-after: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0 0 0 0; margin: 2px 17px 2px 17px;"><table cellspacing="0" cellpadding="3" border="0" style="text-align: justify;border:none; border-spacing:0;">
<tr>
<td style="vertical-align:top; padding:3px; border:none"><p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #808080;">//---&nbsp;put&nbsp;the&nbsp;kernel&nbsp;into&nbsp;the&nbsp;execution&nbsp;queue</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">int</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #333333;">off_set</span><span class="f_CodeExample">[]&nbsp;=&nbsp;{</span><span class="f_Normal" style="font-family: Arial,Helvetica,sans-serif; color: #000000; background-color: transparent;">0</span><span class="f_CodeExample">};</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">int</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #333333;">NDRange</span><span class="f_CodeExample">[]&nbsp;=&nbsp;{</span><span class="f_CodeExample" style="color: #333333;">m_iUnits</span><span class="f_CodeExample">};</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">if</span><span class="f_CodeExample">(!</span><span class="f_CodeExample" style="color: #333333;">m_cOpenCL</span><span class="f_CodeExample">.</span><span class="f_CodeExample" style="color: #333333;">Execute</span><span class="f_CodeExample">(</span><span class="f_Definition">def_k_AttentionFeedForward</span><span class="f_CodeExample">,&nbsp;</span><span class="f_Normal" style="font-family: Arial,Helvetica,sans-serif; color: #000000; background-color: transparent;">1</span><span class="f_CodeExample">,&nbsp;</span><span class="f_CodeExample" style="color: #333333;">off_set</span><span class="f_CodeExample">,&nbsp;</span><span class="f_CodeExample" style="color: #333333;">NDRange</span><span class="f_CodeExample">))</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">return</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #ff0000;">false</span><span class="f_CodeExample">;</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></p>
</td>
</tr>
</table>
</div>
<p class="p_Text"><span class="f_Text">This concludes the algorithm for launching the kernel of the </span><span class="f_Text" style="font-style: italic;">Self-Attention</span><span class="f_Text"> block. However, we still need to add the contents of two buffers and normalize the data in the result buffer. </span><span class="f_li">Following the algorithm, first, we find the sum of two vectors (initial data and </span><span class="f_li" style="font-style: italic;">Self-Attention</span><span class="f_li"> results). This operation is quite general and can be widely used outside of our neural attention layer class </span><span class="f_li" style="font-style: italic;">CNeuronAttention</span><span class="f_li">. Therefore, I decided to add it as a separate method to the data buffer class </span><span class="f_li" style="font-style: italic;">CBufferType::SumArray</span><span class="f_li">.</span></p>
<p class="p_Text"><span class="f_li">In the parameters to the </span><span class="f_li" style="font-style: italic;">SumArray</span><span class="f_Text"> method,</span><span class="f_li"> we will pass a pointer to the buffer to be added. Immediately in the body of the method, we check the received pointer and the size of the received buffer. To successfully complete the operation, the size of the current buffer, which will be the first addend, and the resulting buffer (the second addend) must be equal.</span></p>
<div style="text-align: left; text-indent: 0; line-height: 1.0; page-break-inside: avoid; page-break-after: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0 0 0 0; margin: 2px 17px 2px 17px;"><table cellspacing="0" cellpadding="3" border="0" style="text-align: justify;border:none; border-spacing:0;">
<tr>
<td style="vertical-align:top; padding:3px; border:none"><p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample" style="color: #0000ff;">bool</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #333333;">CBufferType</span><span class="f_CodeExample">::</span><span class="f_CodeExample" style="color: #333333;">SumArray</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #333333;">CBufferType</span><span class="f_CodeExample">&nbsp;*</span><span class="f_CodeExample" style="color: #333333;">src</span><span class="f_CodeExample">)</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;{</span>
<br><span class="f_CodeExample" style="color: #808080;">//---&nbsp;check&nbsp;the&nbsp;source&nbsp;data&nbsp;array</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">if</span><span class="f_CodeExample">(!</span><span class="f_CodeExample" style="color: #333333;">src</span><span class="f_CodeExample">&nbsp;||&nbsp;</span><span class="f_CodeExample" style="color: #333333;">src</span><span class="f_CodeExample">.</span><span class="f_CodeExample" style="color: #333333;">Total</span><span class="f_CodeExample">()&nbsp;!=&nbsp;</span><span class="f_CodeExample" style="color: #333333;">Total</span><span class="f_CodeExample">())</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">return&nbsp;</span><span class="f_CodeExample" style="color: #ff0000;">false</span><span class="f_CodeExample">;</span></p>
</td>
</tr>
</table>
</div>
<p class="p_Text"><span class="f_li">Like all the methods discussed earlier, the algorithm of this method is split into two threads depending on the execution device. In the block of performing operations using means MQL5 we will first match the matrix formats of both buffers. Then we perform the matrix addition operation. The result of the operation will be saved in the current buffer matrix.</span></p>
<div style="text-align: left; text-indent: 0; line-height: 1.0; page-break-inside: avoid; page-break-after: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0 0 0 0; margin: 2px 17px 2px 17px;"><table cellspacing="0" cellpadding="3" border="0" style="text-align: justify;border:none; border-spacing:0;">
<tr>
<td style="vertical-align:top; padding:3px; border:none"><p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">if</span><span class="f_CodeExample">(!</span><span class="f_CodeExample" style="color: #333333;">m_cOpenCL</span><span class="f_CodeExample">)</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #808080;">//---&nbsp;change&nbsp;the&nbsp;matrix&nbsp;size</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_Definition">MATRIX</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #333333;">temp</span><span class="f_CodeExample">&nbsp;=&nbsp;</span><span class="f_CodeExample" style="color: #333333;">src</span><span class="f_CodeExample">.</span><span class="f_CodeExample" style="color: #333333;">m_mMatrix</span><span class="f_CodeExample">;</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">if</span><span class="f_CodeExample">(!</span><span class="f_CodeExample" style="color: #333333;">temp</span><span class="f_CodeExample">.</span><span class="f_CodeExample" style="color: #333333;">Reshape</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #333333;">Rows</span><span class="f_CodeExample">(),&nbsp;</span><span class="f_CodeExample" style="color: #333333;">Cols</span><span class="f_CodeExample">()))</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">return&nbsp;</span><span class="f_CodeExample" style="color: #ff0000;">false</span><span class="f_CodeExample">;</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #808080;">//---&nbsp;add&nbsp;matrices</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">m_mMatrix</span><span class="f_CodeExample">&nbsp;+=&nbsp;</span><span class="f_CodeExample" style="color: #333333;">temp</span><span class="f_CodeExample">;</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></p>
</td>
</tr>
</table>
</div>
<p class="p_Text"><span class="f_li">The algorithm for the block of multi-threaded operations is similar to that discussed above. First, we check for the presence of data in the context of OpenCL and, if necessary, load the data from the resulting buffer. Please note that we only check the received buffer. Earlier, when dividing the algorithm depending on the computing device, we already checked the pointer to the current OpenCL context of the buffer. Therefore, we consider the data of the current buffer to have already been transferred to the OpenCL context.</span></p>
<p class="p_Text"><span class="f_li">The control block is followed by passing parameters to the kernel and placing it in the execution queue.</span></p>
<div style="text-align: left; text-indent: 0; line-height: 1.0; page-break-inside: avoid; page-break-after: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0 0 0 0; margin: 2px 17px 2px 17px;"><table cellspacing="0" cellpadding="3" border="0" style="text-align: justify;border:none; border-spacing:0;">
<tr>
<td style="vertical-align:top; padding:3px; border:none"><p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">else</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">if</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #333333;">src</span><span class="f_CodeExample">.</span><span class="f_CodeExample" style="color: #333333;">GetIndex</span><span class="f_CodeExample">()&nbsp;&lt;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">0</span><span class="f_CodeExample">&nbsp;&amp;&amp;&nbsp;!</span><span class="f_CodeExample" style="color: #333333;">BufferCreate</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #333333;">m_cOpenCL</span><span class="f_CodeExample">))</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">return</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #ff0000;">false</span><span class="f_CodeExample">;</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">if</span><span class="f_CodeExample">(!</span><span class="f_CodeExample" style="color: #333333;">m_cOpenCL</span><span class="f_CodeExample">.</span><span class="f_CodeExample" style="color: #333333;">SetArgumentBuffer</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #333333;">def_k_Sum</span><span class="f_CodeExample">,&nbsp;</span><span class="f_Definition">def_sum_inputs1</span><span class="f_CodeExample">,&nbsp;</span><span class="f_CodeExample" style="color: #333333;">m_myIndex</span><span class="f_CodeExample">))</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">return</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #ff0000;">false</span><span class="f_CodeExample">;</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">if</span><span class="f_CodeExample">(!</span><span class="f_CodeExample" style="color: #333333;">m_cOpenCL</span><span class="f_CodeExample">.</span><span class="f_CodeExample" style="color: #333333;">SetArgumentBuffer</span><span class="f_CodeExample">(</span><span class="f_Definition">def_k_Sum</span><span class="f_CodeExample">,&nbsp;</span><span class="f_Definition">def_sum_inputs2</span><span class="f_CodeExample">,&nbsp;</span><span class="f_CodeExample" style="color: #333333;">src</span><span class="f_CodeExample">.</span><span class="f_CodeExample" style="color: #333333;">GetIndex</span><span class="f_CodeExample">()))</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">return</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #ff0000;">false</span><span class="f_CodeExample">;</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">if</span><span class="f_CodeExample">(!</span><span class="f_CodeExample" style="color: #333333;">m_cOpenCL</span><span class="f_CodeExample">.</span><span class="f_CodeExample" style="color: #333333;">SetArgumentBuffer</span><span class="f_CodeExample">(</span><span class="f_Definition">def_k_Sum</span><span class="f_CodeExample">,&nbsp;</span><span class="f_Definition">def_sum_outputs</span><span class="f_CodeExample">,&nbsp;</span><span class="f_CodeExample" style="color: #333333;">m_myIndex</span><span class="f_CodeExample">))</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">return</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #ff0000;">false</span><span class="f_CodeExample">;</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">uint</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #333333;">off_set</span><span class="f_CodeExample">[]&nbsp;=&nbsp;{</span><span class="f_Normal" style="font-family: Arial,Helvetica,sans-serif; color: #000000; background-color: transparent;">0</span><span class="f_CodeExample">};</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">uint</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #333333;">NDRange</span><span class="f_CodeExample">[]&nbsp;=&nbsp;{(</span><span class="f_CodeExample" style="color: #0000ff;">uint</span><span class="f_CodeExample">)</span><span class="f_CodeExample" style="color: #333333;">Total</span><span class="f_CodeExample">()};</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">if</span><span class="f_CodeExample">(!</span><span class="f_CodeExample" style="color: #333333;">m_cOpenCL</span><span class="f_CodeExample">.</span><span class="f_CodeExample" style="color: #333333;">Execute</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #333333;">def_k_Sum</span><span class="f_CodeExample">,&nbsp;</span><span class="f_CodeExample" style="color: #333333;">1</span><span class="f_CodeExample">,&nbsp;</span><span class="f_CodeExample" style="color: #333333;">off_set</span><span class="f_CodeExample">,&nbsp;</span><span class="f_CodeExample" style="color: #333333;">NDRange</span><span class="f_CodeExample">))</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">return</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #ff0000;">false</span><span class="f_CodeExample">;</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span>
<br><span class="f_CodeExample" style="color: #808080;">//---</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">return&nbsp;</span><span class="f_CodeExample" style="color: #ff0000;">true</span><span class="f_CodeExample">;</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;}</span></p>
</td>
</tr>
</table>
</div>
<p class="p_Text"><span class="f_Text">The data normalization process is organized in the </span><span class="f_Text" style="font-style: italic;">CNeuronAttention::NormlizeBuffer</span><span class="f_Text"> method. However, while following the general rules for constructing the algorithm, there are two exceptions in this method. First, we eliminated the block for checking the presence of buffers in the OpenCL context. In this case, the risk of using unloaded buffers is minimal. The reason is that before calling this method, the used buffers have already been checked multiple times, and rechecking them would be unnecessary.</span></p>
<div style="text-align: left; text-indent: 0; line-height: 1.0; page-break-inside: avoid; page-break-after: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0 0 0 0; margin: 2px 17px 2px 17px;"><table cellspacing="0" cellpadding="3" border="0" style="text-align: justify;border:none; border-spacing:0;">
<tr>
<td style="vertical-align:top; padding:3px; border:none"><p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample" style="color: #0000ff;">bool</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #333333;">CNeuronAttention</span><span class="f_CodeExample">::</span><span class="f_CodeExample" style="color: #333333;">NormlizeBuffer</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #333333;">CBufferType</span><span class="f_CodeExample">&nbsp;*</span><span class="f_CodeExample" style="color: #333333;">buffer</span><span class="f_CodeExample">,</span>
<br><span class="f_CodeExample" style="color: #333333;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CBufferType</span><span class="f_CodeExample">&nbsp;*</span><span class="f_CodeExample" style="color: #333333;">std</span><span class="f_CodeExample">,&nbsp;</span>
<br><span class="f_CodeExample" style="color: #0000ff;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;uint</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #333333;">std_shift</span><span class="f_CodeExample">)</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;{</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">if</span><span class="f_CodeExample">(!</span><span class="f_CodeExample" style="color: #333333;">m_cOpenCL</span><span class="f_CodeExample">)</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #808080;">//&nbsp;MQL5&nbsp;block</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;.....</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">else</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">if</span><span class="f_CodeExample">(!</span><span class="f_CodeExample" style="color: #333333;">m_cOpenCL</span><span class="f_CodeExample">.</span><span class="f_CodeExample" style="color: #333333;">SetArgumentBuffer</span><span class="f_CodeExample">(</span><span class="f_Definition">def_k_LayerNormalize</span><span class="f_CodeExample">,</span>
<br><span class="f_Definition">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;def_layernorm_inputs</span><span class="f_CodeExample">,&nbsp;</span><span class="f_CodeExample" style="color: #333333;">buffer</span><span class="f_CodeExample">.</span><span class="f_CodeExample" style="color: #333333;">GetIndex</span><span class="f_CodeExample">()))</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">return</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #ff0000;">false</span><span class="f_CodeExample">;</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">if</span><span class="f_CodeExample">(!</span><span class="f_CodeExample" style="color: #333333;">m_cOpenCL</span><span class="f_CodeExample">.</span><span class="f_CodeExample" style="color: #333333;">SetArgumentBuffer</span><span class="f_CodeExample">(</span><span class="f_Definition">def_k_LayerNormalize</span><span class="f_CodeExample">,</span>
<br><span class="f_Definition">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;def_layernorm_outputs</span><span class="f_CodeExample">,&nbsp;</span><span class="f_CodeExample" style="color: #333333;">buffer</span><span class="f_CodeExample">.</span><span class="f_CodeExample" style="color: #333333;">GetIndex</span><span class="f_CodeExample">()))</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">return</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #ff0000;">false</span><span class="f_CodeExample">;</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">if</span><span class="f_CodeExample">(!</span><span class="f_CodeExample" style="color: #333333;">m_cOpenCL</span><span class="f_CodeExample">.</span><span class="f_CodeExample" style="color: #333333;">SetArgumentBuffer</span><span class="f_CodeExample">(</span><span class="f_Definition">def_k_LayerNormalize</span><span class="f_CodeExample">,</span>
<br><span class="f_Definition">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;def_layernorm_std</span><span class="f_CodeExample">,&nbsp;</span><span class="f_CodeExample" style="color: #333333;">std</span><span class="f_CodeExample">.</span><span class="f_CodeExample" style="color: #333333;">GetIndex</span><span class="f_CodeExample">()))</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">return</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #ff0000;">false</span><span class="f_CodeExample">;</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">if</span><span class="f_CodeExample">(!</span><span class="f_CodeExample" style="color: #333333;">m_cOpenCL</span><span class="f_CodeExample">.</span><span class="f_CodeExample" style="color: #333333;">SetArgument</span><span class="f_CodeExample">(</span><span class="f_Definition">def_k_LayerNormalize</span><span class="f_CodeExample">,</span>
<br><span class="f_Definition">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;def_layernorm_vector_size</span><span class="f_CodeExample">,&nbsp;(</span><span class="f_CodeExample" style="color: #0000ff;">int</span><span class="f_CodeExample">)</span><span class="f_CodeExample" style="color: #333333;">buffer</span><span class="f_CodeExample">.</span><span class="f_CodeExample" style="color: #333333;">Total</span><span class="f_CodeExample">()))</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">return</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #ff0000;">false</span><span class="f_CodeExample">;</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">if</span><span class="f_CodeExample">(!</span><span class="f_CodeExample" style="color: #333333;">m_cOpenCL</span><span class="f_CodeExample">.</span><span class="f_CodeExample" style="color: #333333;">SetArgument</span><span class="f_CodeExample">(</span><span class="f_Definition">def_k_LayerNormalize</span><span class="f_CodeExample">,</span>
<br><span class="f_Definition">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;def_layernorm_std_shift</span><span class="f_CodeExample">,&nbsp;</span><span class="f_CodeExample" style="color: #333333;">std_shift</span><span class="f_CodeExample">))</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">return</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #ff0000;">false</span><span class="f_CodeExample">;</span></p>
</td>
</tr>
</table>
</div>
<p class="p_Text"><span class="f_Text">The second point is related to the use of a local data array and thread synchronization. The reason is that thread synchronization is only available within a work group. We need to explicitly specify its size. The normalization algorithm in the kernel is structured in such a way that the workgroup size cannot be greater than the size of the local array. Let me remind you that the size of the local array is determined by the </span><span class="f_Text" style="font-style: italic;">LOCAL_SIZE</span><span class="f_Text"> constant. At the same time, the number of threads cannot be greater than the size of the normalized buffer. Therefore, in the array indicating the dimension of the task space, we will indicate the smaller of the two values. Since we normalize the values of the entire buffer in one batch, the dimensions of the global and local task space will be the same.</span></p>
<p class="p_Text"><span class="f_Text">Once we have determined the problem dimensions, we enqueue the kernel for execution.</span></p>
<div style="text-align: left; text-indent: 0; line-height: 1.0; page-break-inside: avoid; page-break-after: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0 0 0 0; margin: 2px 17px 2px 17px;"><table cellspacing="0" cellpadding="3" border="0" style="text-align: justify;border:none; border-spacing:0;">
<tr>
<td style="vertical-align:top; padding:3px; border:none"><p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">int</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #333333;">NDRange</span><span class="f_CodeExample">[]&nbsp;=&nbsp;{(</span><span class="f_CodeExample" style="color: #0000ff;">int</span><span class="f_CodeExample">)</span><span class="f_Functions">MathMin</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #333333;">buffer</span><span class="f_CodeExample">.</span><span class="f_CodeExample" style="color: #333333;">Total</span><span class="f_CodeExample">(),&nbsp;</span><span class="f_Definition">LOCAL_SIZE</span><span class="f_CodeExample">)};</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">int</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #333333;">off_set</span><span class="f_CodeExample">[]&nbsp;=&nbsp;{</span><span class="f_Normal" style="font-family: Arial,Helvetica,sans-serif; color: #000000; background-color: transparent;">0</span><span class="f_CodeExample">};</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">if</span><span class="f_CodeExample">(!</span><span class="f_CodeExample" style="color: #333333;">m_cOpenCL</span><span class="f_CodeExample">.</span><span class="f_CodeExample" style="color: #333333;">Execute</span><span class="f_CodeExample">(</span><span class="f_Definition">def_k_LayerNormalize</span><span class="f_CodeExample">,&nbsp;</span><span class="f_Normal" style="font-family: Arial,Helvetica,sans-serif; color: #000000; background-color: transparent;">1</span><span class="f_CodeExample">,&nbsp;</span><span class="f_CodeExample" style="color: #333333;">off_set</span><span class="f_CodeExample">,&nbsp;</span><span class="f_CodeExample" style="color: #333333;">NDRange</span><span class="f_CodeExample">,&nbsp;</span><span class="f_CodeExample" style="color: #333333;">NDRange</span><span class="f_CodeExample">))</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">return</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #ff0000;">false</span><span class="f_CodeExample">;</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span>
<br><span class="f_CodeExample" style="color: #808080;">//---</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">return</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #ff0000;">true</span><span class="f_CodeExample">;</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;}</span></p>
</td>
</tr>
</table>
</div>
<p class="p_Text"><span class="f_Text">This concludes the block of using OpenCL</span><span class="f_Text" style="font-style: italic;"> </span><span class="f_Text">technology in the feed-forward method of our attention engine class, and we are finished working on this method. Further along, its code remains unchanged. The complete code is given in the description section of <a href="5_1_2_1_tr_feedforward.htm" class="topiclink">constructing a method</a> using standard MQL5 tools.</span></p>
<p class="p_Text"><span class="f_Text">We are now moving on to working on one of the backpropagation methods  the method of distributing the error gradient through a hidden layer </span><span class="f_Text" style="font-style: italic;">CNeuronAttention::CalcHiddenGradient</span><span class="f_Text">. The algorithm of our actions remains the same. We will only make an adjustment for the use of two kernels sequentially.</span></p>
<p class="p_Text"><span class="f_Text">I would like to remind you that when creating backpropagation kernels, we determined the need to use two additional buffers for storing intermediate values of error gradients of the dependency coefficient matrix. So let's take a step back and declare additional buffers: </span><span class="f_Text" style="font-style: italic;">m_cScoreGrad</span><span class="f_Text"> and </span><span class="f_Text" style="font-style: italic;">m_cScoreTemp</span><span class="f_Text">.</span></p>
<div style="text-align: left; text-indent: 0; line-height: 1.0; page-break-inside: avoid; page-break-after: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0 0 0 0; margin: 2px 17px 2px 17px;"><table cellspacing="0" cellpadding="3" border="0" style="text-align: justify;border:none; border-spacing:0;">
<tr>
<td style="vertical-align:top; padding:3px; border:none"><p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample" style="color: #0000ff;">class</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #333333;">CNeuronAttention</span><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">public</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #333333;">CNeuronBase</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;{</span>
<br><span class="f_CodeExample" style="color: #0000ff;">protected</span><span class="f_CodeExample">:</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;.....</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">int</span><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">m_cScoreGrad</span><span class="f_CodeExample">;</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">int</span><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">m_cScoreTemp</span><span class="f_CodeExample">;</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;.....</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;};</span></p>
</td>
</tr>
</table>
</div>
<p class="p_Text"><span class="f_Text">However, in this case, we will not declare instances of buffer objects in main memory. We will not use these buffers to exchange data between the OpenCL context and the main program. They are needed only for temporary storage of data transferred between kernels. This means that their presence in the OpenCL context memory is enough for us. In the main program, we will only declare variables to store pointers to buffers.</span></p>
<p class="p_Text"><span class="f_Text">Let's get back to working on the </span><span class="f_Text" style="font-style: italic;">CNeuronAttention::CalcHiddenGradient</span><span class="f_Text"> method. First, we check the availability and, if necessary, create new data buffers in the </span><span class="f_Text" style="font-style: italic;">OpenCL</span><span class="f_Text"> context, used in the first kernel. We intentionally do not create data buffers for the second kernel right away to ensure more efficient memory usage. This will allow us to use larger data buffers when OpenCL context memory resources are limited.</span></p>
<div style="text-align: left; text-indent: 0; line-height: 1.0; page-break-inside: avoid; page-break-after: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0 0 0 0; margin: 2px 17px 2px 17px;"><table cellspacing="0" cellpadding="3" border="0" style="text-align: justify;border:none; border-spacing:0;">
<tr>
<td style="vertical-align:top; padding:3px; border:none"><p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample" style="color: #0000ff;">bool</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #333333;">CNeuronAttention</span><span class="f_CodeExample">::</span><span class="f_CodeExample" style="color: #333333;">CalcHiddenGradient</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #333333;">CNeuronBase</span><span class="f_CodeExample">&nbsp;*</span><span class="f_CodeExample" style="color: #333333;">prevLayer</span><span class="f_CodeExample">)</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;{</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;.....</span>
<br><span class="f_CodeExample" style="color: #808080;">//---&nbsp;branching&nbsp;the&nbsp;algorithm&nbsp;across&nbsp;the&nbsp;computing&nbsp;device</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">if</span><span class="f_CodeExample">(!</span><span class="f_CodeExample" style="color: #333333;">m_cOpenCL</span><span class="f_CodeExample">)</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #808080;">//&nbsp;MQL5&nbsp;block</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;.....</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">else</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #808080;">//&nbsp;OpenCL&nbsp;block</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #808080;">//---&nbsp;check&nbsp;data&nbsp;buffers</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">if</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #333333;">m_cValues</span><span class="f_CodeExample">.</span><span class="f_CodeExample" style="color: #333333;">GetOutputs</span><span class="f_CodeExample">().</span><span class="f_CodeExample" style="color: #333333;">GetIndex</span><span class="f_CodeExample">()&nbsp;&lt;&nbsp;</span><span class="f_Normal" style="font-family: Arial,Helvetica,sans-serif; color: #000000; background-color: transparent;">0</span><span class="f_CodeExample">)</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">return</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #ff0000;">false</span><span class="f_CodeExample">;</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">if</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #333333;">m_cValues</span><span class="f_CodeExample">.</span><span class="f_CodeExample" style="color: #333333;">GetGradients</span><span class="f_CodeExample">().</span><span class="f_CodeExample" style="color: #333333;">GetIndex</span><span class="f_CodeExample">()&nbsp;&lt;&nbsp;</span><span class="f_Normal" style="font-family: Arial,Helvetica,sans-serif; color: #000000; background-color: transparent;">0</span><span class="f_CodeExample">)</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">return</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #ff0000;">false</span><span class="f_CodeExample">;</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">if</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #333333;">m_cScores</span><span class="f_CodeExample">.</span><span class="f_CodeExample" style="color: #333333;">GetIndex</span><span class="f_CodeExample">()&nbsp;&lt;&nbsp;</span><span class="f_Normal" style="font-family: Arial,Helvetica,sans-serif; color: #000000; background-color: transparent;">0</span><span class="f_CodeExample">)</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">return</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #ff0000;">false</span><span class="f_CodeExample">;</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">if</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #333333;">m_cAttentionOut</span><span class="f_CodeExample">.</span><span class="f_CodeExample" style="color: #333333;">GetGradients</span><span class="f_CodeExample">().</span><span class="f_CodeExample" style="color: #333333;">GetIndex</span><span class="f_CodeExample">()&nbsp;&lt;&nbsp;</span><span class="f_Normal" style="font-family: Arial,Helvetica,sans-serif; color: #000000; background-color: transparent;">0</span><span class="f_CodeExample">)</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">return</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #ff0000;">false</span><span class="f_CodeExample">;</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">if</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #333333;">m_cScoreGrad</span><span class="f_CodeExample">&nbsp;&lt;&nbsp;</span><span class="f_Normal" style="font-family: Arial,Helvetica,sans-serif; color: #000000; background-color: transparent;">0</span><span class="f_CodeExample">)</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">return</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #ff0000;">false</span><span class="f_CodeExample">;</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">if</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #333333;">m_cScoreTemp</span><span class="f_CodeExample">&nbsp;&lt;&nbsp;</span><span class="f_Normal" style="font-family: Arial,Helvetica,sans-serif; color: #000000; background-color: transparent;">0</span><span class="f_CodeExample">)</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">return</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #ff0000;">false</span><span class="f_CodeExample">;</span></p>
</td>
</tr>
</table>
</div>
<p class="p_Text"><span class="f_Text">After checking all the necessary buffers, we will pass pointers to them to the kernel.</span></p>
<div style="text-align: left; text-indent: 0; line-height: 1.0; page-break-inside: avoid; page-break-after: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0 0 0 0; margin: 2px 17px 2px 17px;"><table cellspacing="0" cellpadding="3" border="0" style="text-align: justify;border:none; border-spacing:0;">
<tr>
<td style="vertical-align:top; padding:3px; border:none"><p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #808080;">//---&nbsp;pass&nbsp;parameters&nbsp;to&nbsp;the&nbsp;kernel</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">if</span><span class="f_CodeExample">(!</span><span class="f_CodeExample" style="color: #333333;">m_cOpenCL</span><span class="f_CodeExample">.</span><span class="f_CodeExample" style="color: #333333;">SetArgumentBuffer</span><span class="f_CodeExample">(</span><span class="f_Definition">def_k_AttentionScoreGradients</span><span class="f_CodeExample">,&nbsp;</span>
<br><span class="f_CodeExample" style="color: #333333;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_Definition">def_attscr_outputs_grad</span><span class="f_CodeExample">,&nbsp;</span><span class="f_CodeExample" style="color: #333333;">m_cAttentionOut</span><span class="f_CodeExample">.</span><span class="f_CodeExample" style="color: #333333;">GetGradients</span><span class="f_CodeExample">().</span><span class="f_CodeExample" style="color: #333333;">GetIndex</span><span class="f_CodeExample">()))</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">return</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #ff0000;">false</span><span class="f_CodeExample">;</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">if</span><span class="f_CodeExample">(!</span><span class="f_CodeExample" style="color: #333333;">m_cOpenCL</span><span class="f_CodeExample">.</span><span class="f_CodeExample" style="color: #333333;">SetArgumentBuffer</span><span class="f_CodeExample">(</span><span class="f_Definition">def_k_AttentionScoreGradients</span><span class="f_CodeExample">,</span>
<br><span class="f_CodeExample" style="color: #333333;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_Definition">def_attscr_scores</span><span class="f_CodeExample">,&nbsp;</span><span class="f_CodeExample" style="color: #333333;">m_cScores</span><span class="f_CodeExample">.</span><span class="f_CodeExample" style="color: #333333;">GetIndex</span><span class="f_CodeExample">()))</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">return</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #ff0000;">false</span><span class="f_CodeExample">;</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">if</span><span class="f_CodeExample">(!</span><span class="f_CodeExample" style="color: #333333;">m_cOpenCL</span><span class="f_CodeExample">.</span><span class="f_CodeExample" style="color: #333333;">SetArgumentBuffer</span><span class="f_CodeExample">(</span><span class="f_Definition">def_k_AttentionScoreGradients</span><span class="f_CodeExample">,</span>
<br><span class="f_CodeExample" style="color: #333333;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_Definition">def_attscr_scores_grad</span><span class="f_CodeExample">,&nbsp;</span><span class="f_CodeExample" style="color: #333333;">m_cScoreGrad</span><span class="f_CodeExample">))</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">return</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #ff0000;">false</span><span class="f_CodeExample">;</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">if</span><span class="f_CodeExample">(!</span><span class="f_CodeExample" style="color: #333333;">m_cOpenCL</span><span class="f_CodeExample">.</span><span class="f_CodeExample" style="color: #333333;">SetArgumentBuffer</span><span class="f_CodeExample">(</span><span class="f_Definition">def_k_AttentionScoreGradients</span><span class="f_CodeExample">,</span>
<br><span class="f_CodeExample" style="color: #333333;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_Definition">def_attscr_scores_temp</span><span class="f_CodeExample">,&nbsp;</span><span class="f_CodeExample" style="color: #333333;">m_cScoreTemp</span><span class="f_CodeExample">))</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">return</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #ff0000;">false</span><span class="f_CodeExample">;</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">if</span><span class="f_CodeExample">(!</span><span class="f_CodeExample" style="color: #333333;">m_cOpenCL</span><span class="f_CodeExample">.</span><span class="f_CodeExample" style="color: #333333;">SetArgumentBuffer</span><span class="f_CodeExample">(</span><span class="f_Definition">def_k_AttentionScoreGradients</span><span class="f_CodeExample">,</span>
<br><span class="f_CodeExample" style="color: #333333;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_Definition">def_attscr_values</span><span class="f_CodeExample">,&nbsp;</span><span class="f_CodeExample" style="color: #333333;">m_cValues</span><span class="f_CodeExample">.</span><span class="f_CodeExample" style="color: #333333;">GetOutputs</span><span class="f_CodeExample">().</span><span class="f_CodeExample" style="color: #333333;">GetIndex</span><span class="f_CodeExample">()))</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">return</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #ff0000;">false</span><span class="f_CodeExample">;</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">if</span><span class="f_CodeExample">(!</span><span class="f_CodeExample" style="color: #333333;">m_cOpenCL</span><span class="f_CodeExample">.</span><span class="f_CodeExample" style="color: #333333;">SetArgumentBuffer</span><span class="f_CodeExample">(</span><span class="f_Definition">def_k_AttentionScoreGradients</span><span class="f_CodeExample">,</span>
<br><span class="f_CodeExample" style="color: #333333;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_Definition">def_attscr_values_grad</span><span class="f_CodeExample">,&nbsp;</span><span class="f_CodeExample" style="color: #333333;">m_cValues</span><span class="f_CodeExample">.</span><span class="f_CodeExample" style="color: #333333;">GetGradients</span><span class="f_CodeExample">().</span><span class="f_CodeExample" style="color: #333333;">GetIndex</span><span class="f_CodeExample">()))</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">return</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #ff0000;">false</span><span class="f_CodeExample">;</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">if</span><span class="f_CodeExample">(!</span><span class="f_CodeExample" style="color: #333333;">m_cOpenCL</span><span class="f_CodeExample">.</span><span class="f_CodeExample" style="color: #333333;">SetArgument</span><span class="f_CodeExample">(</span><span class="f_Definition">def_k_AttentionScoreGradients</span><span class="f_CodeExample">,</span>
<br><span class="f_CodeExample" style="color: #333333;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_Definition">def_attscr_window</span><span class="f_CodeExample">,&nbsp;</span><span class="f_CodeExample" style="color: #333333;">m_iWindow</span><span class="f_CodeExample">))</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">return</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #ff0000;">false</span><span class="f_CodeExample">;</span></p>
</td>
</tr>
</table>
</div>
<p class="p_Text"><span class="f_Text">In addition to the pointers to data buffers, we pass the size of the vector describing one element of the sequence to the kernel.</span></p>
<p class="p_Text"><span class="f_Text">After passing all the parameters, specify the number of required parallel threads and invoke the function to enqueue the kernel.</span></p>
<div style="text-align: left; text-indent: 0; line-height: 1.0; page-break-inside: avoid; page-break-after: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0 0 0 0; margin: 2px 17px 2px 17px;"><table cellspacing="0" cellpadding="3" border="0" style="text-align: justify;border:none; border-spacing:0;">
<tr>
<td style="vertical-align:top; padding:3px; border:none"><p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #808080;">//---&nbsp;Place&nbsp;the&nbsp;kernel&nbsp;in&nbsp;the&nbsp;execution&nbsp;queue</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">int</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #333333;">off_set</span><span class="f_CodeExample">[]&nbsp;=&nbsp;{</span><span class="f_Normal" style="font-family: Arial,Helvetica,sans-serif; color: #000000; background-color: transparent;">0</span><span class="f_CodeExample">};</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">int</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #333333;">NDRange</span><span class="f_CodeExample">[]&nbsp;=&nbsp;{</span><span class="f_CodeExample" style="color: #333333;">m_iUnits</span><span class="f_CodeExample">};</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">if</span><span class="f_CodeExample">(!</span><span class="f_CodeExample" style="color: #333333;">m_cOpenCL</span><span class="f_CodeExample">.</span><span class="f_CodeExample" style="color: #333333;">Execute</span><span class="f_CodeExample">(</span><span class="f_Definition">def_k_AttentionScoreGradients</span><span class="f_CodeExample">,&nbsp;</span><span class="f_Normal" style="font-family: Arial,Helvetica,sans-serif; color: #000000; background-color: transparent;">1</span><span class="f_CodeExample">,&nbsp;</span><span class="f_CodeExample" style="color: #333333;">off_set</span><span class="f_CodeExample">,&nbsp;</span><span class="f_CodeExample" style="color: #333333;">NDRange</span><span class="f_CodeExample">))</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">return</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #ff0000;">false</span><span class="f_CodeExample">;</span></p>
</td>
</tr>
</table>
</div>
<p class="p_Text"><span class="f_Text">Now we move on to working on the next kernel. Let's check the availability of buffers required for the new kernel.</span></p>
<div style="text-align: left; text-indent: 0; line-height: 1.0; page-break-inside: avoid; page-break-after: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0 0 0 0; margin: 2px 17px 2px 17px;"><table cellspacing="0" cellpadding="3" border="0" style="text-align: justify;border:none; border-spacing:0;">
<tr>
<td style="vertical-align:top; padding:3px; border:none"><p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">if</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #333333;">m_cQuerys</span><span class="f_CodeExample">.</span><span class="f_CodeExample" style="color: #333333;">GetOutputs</span><span class="f_CodeExample">().</span><span class="f_CodeExample" style="color: #333333;">GetIndex</span><span class="f_CodeExample">()&nbsp;&lt;&nbsp;</span><span class="f_Normal" style="font-family: Arial,Helvetica,sans-serif; color: #000000; background-color: transparent;">0</span><span class="f_CodeExample">)</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">return</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #ff0000;">false</span><span class="f_CodeExample">;</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">if</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #333333;">m_cQuerys</span><span class="f_CodeExample">.</span><span class="f_CodeExample" style="color: #333333;">GetGradients</span><span class="f_CodeExample">().</span><span class="f_CodeExample" style="color: #333333;">GetIndex</span><span class="f_CodeExample">()&nbsp;&lt;&nbsp;</span><span class="f_Normal" style="font-family: Arial,Helvetica,sans-serif; color: #000000; background-color: transparent;">0</span><span class="f_CodeExample">)</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">return</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #ff0000;">false</span><span class="f_CodeExample">;</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">if</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #333333;">m_cKeys</span><span class="f_CodeExample">.</span><span class="f_CodeExample" style="color: #333333;">GetOutputs</span><span class="f_CodeExample">().</span><span class="f_CodeExample" style="color: #333333;">GetIndex</span><span class="f_CodeExample">()&nbsp;&lt;&nbsp;</span><span class="f_Normal" style="font-family: Arial,Helvetica,sans-serif; color: #000000; background-color: transparent;">0</span><span class="f_CodeExample">)</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">return</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #ff0000;">false</span><span class="f_CodeExample">;</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">if</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #333333;">m_cKeys</span><span class="f_CodeExample">.</span><span class="f_CodeExample" style="color: #333333;">GetGradients</span><span class="f_CodeExample">().</span><span class="f_CodeExample" style="color: #333333;">GetIndex</span><span class="f_CodeExample">()&nbsp;&lt;&nbsp;</span><span class="f_Normal" style="font-family: Arial,Helvetica,sans-serif; color: #000000; background-color: transparent;">0</span><span class="f_CodeExample">)</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">return</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #ff0000;">false</span><span class="f_CodeExample">;</span></p>
</td>
</tr>
</table>
</div>
<p class="p_Text"><span class="f_Text">After checking all the necessary data buffers, we will pass pointers to them to the kernel.</span></p>
<div style="text-align: left; text-indent: 0; line-height: 1.0; page-break-inside: avoid; page-break-after: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0 0 0 0; margin: 2px 17px 2px 17px;"><table cellspacing="0" cellpadding="3" border="0" style="text-align: justify;border:none; border-spacing:0;">
<tr>
<td style="vertical-align:top; padding:3px; border:none"><p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">if</span><span class="f_CodeExample">(!</span><span class="f_CodeExample" style="color: #333333;">m_cOpenCL</span><span class="f_CodeExample">.</span><span class="f_CodeExample" style="color: #333333;">SetArgumentBuffer</span><span class="f_CodeExample">(</span><span class="f_Definition">def_k_AttentionHiddenGradients</span><span class="f_CodeExample">,&nbsp;</span>
<br><span class="f_CodeExample" style="color: #333333;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_Definition">def_atthgr_keys</span><span class="f_CodeExample">,&nbsp;</span><span class="f_CodeExample" style="color: #333333;">m_cKeys</span><span class="f_CodeExample">.</span><span class="f_CodeExample" style="color: #333333;">GetOutputs</span><span class="f_CodeExample">().</span><span class="f_CodeExample" style="color: #333333;">GetIndex</span><span class="f_CodeExample">()))</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">return</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #ff0000;">false</span><span class="f_CodeExample">;</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">if</span><span class="f_CodeExample">(!</span><span class="f_CodeExample" style="color: #333333;">m_cOpenCL</span><span class="f_CodeExample">.</span><span class="f_CodeExample" style="color: #333333;">SetArgumentBuffer</span><span class="f_CodeExample">(</span><span class="f_Definition">def_k_AttentionHiddenGradients</span><span class="f_CodeExample">,</span>
<br><span class="f_CodeExample" style="color: #333333;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;def_atthgr_keys_grad</span><span class="f_CodeExample">,&nbsp;</span><span class="f_CodeExample" style="color: #333333;">m_cKeys</span><span class="f_CodeExample">.</span><span class="f_CodeExample" style="color: #333333;">GetGradients</span><span class="f_CodeExample">().</span><span class="f_CodeExample" style="color: #333333;">GetIndex</span><span class="f_CodeExample">()))</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">return</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #ff0000;">false</span><span class="f_CodeExample">;</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">if</span><span class="f_CodeExample">(!</span><span class="f_CodeExample" style="color: #333333;">m_cOpenCL</span><span class="f_CodeExample">.</span><span class="f_CodeExample" style="color: #333333;">SetArgumentBuffer</span><span class="f_CodeExample">(</span><span class="f_Definition">def_k_AttentionHiddenGradients</span><span class="f_CodeExample">,</span>
<br><span class="f_CodeExample" style="color: #333333;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_Definition">def_atthgr_querys</span><span class="f_CodeExample">,&nbsp;</span><span class="f_CodeExample" style="color: #333333;">m_cQuerys</span><span class="f_CodeExample">.</span><span class="f_CodeExample" style="color: #333333;">GetOutputs</span><span class="f_CodeExample">().</span><span class="f_CodeExample" style="color: #333333;">GetIndex</span><span class="f_CodeExample">()))</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">return</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #ff0000;">false</span><span class="f_CodeExample">;</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">if</span><span class="f_CodeExample">(!</span><span class="f_CodeExample" style="color: #333333;">m_cOpenCL</span><span class="f_CodeExample">.</span><span class="f_CodeExample" style="color: #333333;">SetArgumentBuffer</span><span class="f_CodeExample">(</span><span class="f_Definition">def_k_AttentionHiddenGradients</span><span class="f_CodeExample">,</span>
<br><span class="f_CodeExample" style="color: #333333;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_Definition">def_atthgr_querys_grad</span><span class="f_CodeExample">,&nbsp;</span><span class="f_CodeExample" style="color: #333333;">m_cQuerys</span><span class="f_CodeExample">.</span><span class="f_CodeExample" style="color: #333333;">GetGradients</span><span class="f_CodeExample">().</span><span class="f_CodeExample" style="color: #333333;">GetIndex</span><span class="f_CodeExample">()))</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">return</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #ff0000;">false</span><span class="f_CodeExample">;</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">if</span><span class="f_CodeExample">(!</span><span class="f_CodeExample" style="color: #333333;">m_cOpenCL</span><span class="f_CodeExample">.</span><span class="f_CodeExample" style="color: #333333;">SetArgumentBuffer</span><span class="f_CodeExample">(</span><span class="f_Definition">def_k_AttentionHiddenGradients</span><span class="f_CodeExample">,</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_Definition">def_atthgr_scores_grad</span><span class="f_CodeExample">,&nbsp;</span><span class="f_CodeExample" style="color: #333333;">m_cScoreGrad</span><span class="f_CodeExample">))</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">return</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #ff0000;">false</span><span class="f_CodeExample">;</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">if</span><span class="f_CodeExample">(!</span><span class="f_CodeExample" style="color: #333333;">m_cOpenCL</span><span class="f_CodeExample">.</span><span class="f_CodeExample" style="color: #333333;">SetArgument</span><span class="f_CodeExample">(</span><span class="f_Definition">def_k_AttentionHiddenGradients</span><span class="f_CodeExample">,</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_Definition">def_atthgr_key_size</span><span class="f_CodeExample">,&nbsp;</span><span class="f_CodeExample" style="color: #333333;">m_iKeysSize</span><span class="f_CodeExample">))</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">return</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #ff0000;">false</span><span class="f_CodeExample">;</span></p>
</td>
</tr>
</table>
</div>
<p class="p_Text"><span class="f_Text">In addition to the pointers to data buffers, we pass the size of the key vector for one element of the sequence to the kernel parameters.</span></p>
<p class="p_Text"><span class="f_Text">After finishing the transfer of all the necessary data to the kernel, we initialize the enqueuing of its execution. The arrays with the specified offset and the number of required kernel instances for execution are already prepared after launching the previous kernel, and we don't need to set them again. Therefore, we simply invoke the function to enqueue the kernel.</span></p>
<div style="text-align: left; text-indent: 0; line-height: 1.0; page-break-inside: avoid; page-break-after: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0 0 0 0; margin: 2px 17px 2px 17px;"><table cellspacing="0" cellpadding="3" border="0" style="text-align: justify;border:none; border-spacing:0;">
<tr>
<td style="vertical-align:top; padding:3px; border:none"><p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">if</span><span class="f_CodeExample">(!</span><span class="f_CodeExample" style="color: #333333;">m_cOpenCL</span><span class="f_CodeExample">.</span><span class="f_CodeExample" style="color: #333333;">Execute</span><span class="f_CodeExample">(</span><span class="f_Definition">def_k_AttentionHiddenGradients</span><span class="f_CodeExample">,&nbsp;</span><span class="f_Normal" style="font-family: Arial,Helvetica,sans-serif; color: #000000; background-color: transparent;">1</span><span class="f_CodeExample">,&nbsp;</span><span class="f_CodeExample" style="color: #333333;">off_set</span><span class="f_CodeExample">,&nbsp;</span><span class="f_CodeExample" style="color: #333333;">NDRange</span><span class="f_CodeExample">))</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">return</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #ff0000;">false</span><span class="f_CodeExample">;</span></p>
</td>
</tr>
</table>
</div>
<p class="p_Text"><span class="f_Text">At this point, we conclude our work on building the methods of our attention class and can proceed to test its functionality.</span></p>

</div>

</body>
</html>
