<!DOCTYPE html>
<html>
  <head>
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
  <title>1.5.3 Normalization</title>
  <meta name="keywords" content="" />
  <link type="text/css" href="default.css" rel="stylesheet" />

   <script type="text/javascript" src="jquery.js"></script>
   <script type="text/javascript" src="helpman_settings.js"></script>
   <script type="text/javascript" src="helpman_topicinit.js"></script>


</head>

<body style="background-color:#FFFFFF; font-family:'Trebuchet MS',Tahoma,Arial,Helvetica,sans-serif; margin:0px;">



<table width="100%" height="49"  border="0" cellpadding="0" cellspacing="0" style="margin-top:0px; background-color:#1660af;">
  <tr>
    <td></td>
    <td valign="middle">
      <table style="margin-top:4px; margin-bottom:5px;" width="100%"  border="0" cellspacing="0" cellpadding="5">
        <tr valign="middle">
          <td class="nav">
<a class="h_m" href="index.htm">          Neural Networks for Algorithmic Trading with MQL5 </a> / <a class="h_m" href="1_about_ai.htm"> 1. Basic principles of artificial intelligence construction </a> / <a class="h_m" href="1_5_improvement.htm"> 1.5 Techniques for improving the convergence of neural networks </a>/ 1.5.3 Normalization
          </td>
          <td width="70" align="right">
          <a href="1_5_2_dropout.htm"><img style="vertical-align:middle;" src="previous.png" alt="?????" width="27" height="27" border=0></a>&nbsp;
          <a href="1_6_ai_in_trading.htm"><img style="vertical-align:middle;" src="next.png" alt="??????" width="27" height="27" border="0"></a>
          </td>
        </tr>
      </table>
    </td>
    <td width="5"></td>
  </tr>
</table>



<div id="help">
<p class="p_H2"><span class="f_H2">1.5.3 Batch normalization</span></p>
<p class="p_Text"><span class="f_Text">The practical application of neural networks implies the use of various approaches to data normalization. All of these approaches aim to maintain the training data and the output of hidden layers of the neural network within a specified range and with certain statistical characteristics of the dataset, such as variance and median. Why is this so important? We remember that network neurons apply linear transformations which shift the sample towards the anti-gradient in the learning process.</span></p>
<p class="p_Text"><span class="f_Text">Consider a fully connected perceptron with two hidden layers. In the forward pass, each layer generates a set of data that serves as a training sample for the next layer. The output layer's results are compared with the reference data, and during the backward pass, the error gradient is propagated from the output layer through hidden layers to the input data.</span></p>
<div class="p_Text" style="text-align: center;"><div style="margin:0 auto 0 auto;width:600px"><img class="help" id="norm_2hlpercp" alt="Perceptron with two hidden layers" title="Perceptron with two hidden layers" width="600" height="400" style="width:600px;height:400px;border:none" src="norm_2hlpercp.png"/><p style="text-align:center"><span class="f_ImageCaption">Perceptron with two hidden layers</span></p></div></div>
<p class="p_Text"><span class="f_Text">Having obtained the error gradient for each neuron, we update the weights, tuning our neural network to the training samples from the last forward pass. Here arises a conflict: we are adjusting the second hidden layer (labeled as 'Bull pattern' and 'Bear pattern' in the above diagram) to the output data of the first hidden layer (labeled as 'Hidden pattern' in the diagram). However, by changing the parameters of the first hidden layer, we have already altered the data array. In other words, we are adjusting the second hidden layer to a data sample that no longer exists.</span></p>
<p class="p_Text"><span class="f_Text">The situation is similar to the output layer, which adjusts to the already modified output of the second hidden layer. If we also consider the distortion between the first and second hidden layers, the scales of error amplification increase. The deeper the neural network, the stronger the manifestation of this effect. This phenomenon is referred to as internal covariate shift.</span></p>
<p class="p_Text"><span class="f_Text">In classical neural networks, this problem was partially solved by reducing the learning rate. Small changes in the weights do not significantly alter the distribution of the output of the neural layer. However, this approach does not solve the problem of scaling with an increase in the number of layers of the neural network and reduces the learning rate. Another issue with a low learning rate is the potential stop at local minima (we already discussed this issue in the section about<a href="1_4_3_optimization.htm" class="topiclink" title="Methods for optimizing neural networks"> neural network optimization methods</a>).</span></p>
<p class="p_Text"><span class="f_Text">Here, it's also worth mentioning the necessity of normalizing the input data. Quite often, when solving various tasks, diverse input data is fed into the input layer of a neural network, which might belong to samples with different distributions. Some inputs can have values that significantly exceed the magnitudes of the others. Such values will have a greater impact on the final result of the neural network. At the same time, the actual impact of the described factor might be significantly lower, while the absolute values of the sample are determined by the nature of the metric.</span></p>
<p class="p_Text"><span class="f_Text">The below chart shows an example illustrating the reflection of a single price movement using two oscillators (MACD and RSI). When considering the indicator charts, you can notice the correlation of the curves. At the same time, the numerical values of the indicators differ by hundreds of thousands of times. This is because RSI values are normalized on a scale from 0 to 100, while MACD values depend on the accuracy of price representation on the graph, as MACD shows the distance between two moving averages. </span></p>
<p class="p_Text"><span class="f_Text">When building a trading strategy, we can utilize either of these indicators individually or consider the values of both indicators and execute trading operations only when the signals from the indicators align. In practice, this approach enables the exclusion of some false signals, which eventually can reduce the drawdown of the trading strategy. However, before we input such diverse signals into the neural network, it's advisable to normalize them to a comparable form. This is what the normalization of the initial data will help us to achieve.</span></p>
<p class="p_Text"><span class="f_Text">Of course, we can perform the normalization of the input data while preparing the training and testing datasets outside the neural network. But this approach increases the preparatory work. Moreover, during practical usage of such a neural network, we will need to consistently prepare the input data using a similar algorithm. It is much more convenient to assign this work to the neural network itself.</span></p>
<p class="p_Text"><span class="f_Text">In February 2015, Sergey Ioffe and Christian Szegedy proposed the <a href="https://arxiv.org/abs/1502.03167" target="_blank" rel="external" class="weblink" title="Batch Normalization">Batch Normalization</a> method in their work &quot;Batch Normalization: Accelerating Deep Network Training by Reducing Internal Covariate Shift&quot;. The method was proposed to address the issue of internal covariate shift. This algorithm can also be applied for normalizing input data.</span></p>
<div class="p_Text" style="text-align: center;"><div style="margin:0 auto 0 auto;width:600px"><img class="help" id="norm_chart" alt="EURUSD H1" title="EURUSD H1" width="600" height="400" style="width:600px;height:400px;border:none" src="norm_chart.png"/><p style="text-align:center"><span class="f_ImageCaption">EURUSD H1</span></p></div></div>
<p class="p_Text"><span class="f_Text">The essence of the method was to normalize each individual neuron over a certain time interval by shifting the median of the sample to zero and scaling the sample's variance to one.</span></p>
<p class="p_Text"><span class="f_Text">The normalization algorithm is as follows. First, the average value is calculated from the data sample.</span></p>
<p class="p_Text" style="text-align: center;"><span style="display:inline-block;width:108px;height:45px;padding:0 0;overflow:visible"><svg xmlns="http://www.w3.org/2000/svg" style="width:100%;height:100%;overflow:visible" viewBox="0 0 432 180"><path d="M26 99 C24 103,22 105,20 107 C18 108,16 109,14 109 C13 109,12 109,11 109 C10 108,10 108,9 107 C8 108,8 110,8 113 C8 115,8 118,8 120 C8 121,8 121,8 122 L7 124 L2 124 L1 122 C2 118,3 114,4 109 L11 74 L18 74 L13 94 C13 95,12 97,12 98 C12 99,12 100,12 101 C12 103,12 103,13 104 C14 105,15 105,16 105 C17 105,19 104,20 103 C22 101,24 99,25 97 C26 95,27 93,28 91 L31 74 L38 74 L32 98 C32 100,32 102,32 103 C32 104,32 105,32 105 C32 106,33 106,34 106 C34 106,35 106,36 105 C36 105,37 104,38 103 L40 105 C39 106,38 107,37 108 C36 109,35 109,34 110 C33 110,32 110,31 110 C29 110,28 110,27 109 C26 108,26 107,26 105 C26 104,26 102,27 100 L26 99 Z" fill="#212121"/><path d="M43 134 C44 134,44 134,44 134 C45 134,45 133,45 133 C46 133,46 132,46 131 C46 131,47 130,47 128 L51 109 C52 108,52 107,52 107 C52 106,52 106,52 105 C52 105,52 104,51 104 C51 103,50 103,49 103 L49 101 L63 101 C66 101,67 101,69 102 C70 102,72 102,72 103 C73 104,74 104,74 105 C75 106,75 107,75 108 C75 113,72 116,67 117 C67 118,67 118,67 118 C67 118,67 118,67 118 C68 119,70 120,71 121 C71 122,72 123,72 125 C72 127,72 128,71 130 C70 131,69 132,68 133 C67 134,65 135,63 135 C61 136,58 136,55 136 L43 136 L43 134 Z M59 116 C61 116,63 116,64 116 C65 115,66 115,67 114 C68 113,69 113,69 112 C69 111,70 110,70 109 C70 108,69 107,69 107 C69 106,69 106,68 105 C67 105,67 105,66 104 C65 104,64 104,62 104 C61 104,61 104,60 104 C59 104,58 104,58 104 L55 116 L59 116 Z M51 133 C52 133,52 133,53 133 C53 133,54 133,55 133 C57 133,59 133,60 133 C62 132,63 132,64 131 C65 130,65 129,66 128 C66 127,66 126,66 124 C66 123,66 123,66 122 C66 121,65 121,65 120 C64 120,63 120,62 119 C62 119,60 119,59 119 L54 119 L51 133 Z" fill="#212121"/><path d="M105 83 L105 78 L151 78 L151 83 L105 83 Z M105 98 L105 93 L151 93 L151 98 L105 98 Z" fill="#212121"/><path d="M213 42 C213 44,213 45,213 45 C213 46,214 47,214 47 C214 48,215 48,216 48 C217 49,217 49,219 49 C220 49,221 49,223 49 L223 52 L196 52 L196 49 C199 49,201 49,202 49 C203 48,204 48,204 48 C205 47,205 47,206 46 C206 45,206 44,206 42 L206 12 C206 11,206 11,206 10 C205 10,205 10,204 10 C203 10,202 10,201 11 C199 12,198 13,196 14 L194 11 L211 1 L213 1 C213 3,213 7,213 11 L213 42 Z" fill="#212121"/><path d="M193 133 C195 129,198 127,200 125 C202 124,204 123,207 123 C209 123,211 124,212 125 C213 126,214 128,214 131 L214 131 C214 131,214 131,214 132 C216 129,218 127,220 125 C222 124,224 123,226 123 C229 123,230 124,232 125 C233 126,234 128,234 131 C234 132,233 135,232 137 L230 147 C229 150,229 152,229 153 C229 154,229 155,230 155 C230 156,230 156,231 156 C232 156,233 156,233 155 C234 155,235 154,237 152 L239 154 C237 156,235 158,234 159 C232 160,230 160,228 160 C227 160,225 159,224 158 C223 157,223 156,223 154 C223 152,223 150,224 147 L226 140 C226 138,227 136,227 135 C227 134,227 133,227 132 C227 130,227 129,226 128 C226 127,225 127,224 127 C223 127,221 128,220 128 C219 129,218 130,217 132 C215 134,214 135,213 137 C213 138,212 140,211 143 L208 159 L202 159 L206 140 C207 138,207 136,207 135 C207 134,207 133,207 132 C207 130,207 129,206 128 C206 127,205 127,203 127 C203 127,202 128,200 128 C199 129,198 130,197 132 C195 134,194 135,193 137 C193 139,192 141,191 143 L188 159 L182 159 L187 135 C188 133,188 131,188 130 C188 129,188 128,187 128 C187 127,187 127,186 127 C185 127,184 127,183 128 C183 129,181 130,180 131 L178 129 C180 127,182 126,183 125 C185 124,187 123,189 123 C190 123,191 124,192 125 C193 126,194 127,194 128 C194 130,193 131,193 133 L193 133 Z" fill="#212121"/><rect x="177" y="85" width="63" height="5" fill="#212121"/><path d="M286 49 L310 84 L310 87 L283 123 L316 123 C319 123,321 122,322 120 C324 119,325 116,325 112 L329 112 L328 130 L273 130 L273 128 L303 88 L275 47 L275 45 L329 45 L329 62 L325 62 C324 58,323 55,321 53 C319 50,316 49,312 49 L286 49 Z" fill="#212121"/><path d="M300 27 L294 27 C295 26,295 25,295 24 C296 22,296 21,296 20 C297 18,297 17,297 16 C297 15,298 13,298 12 C298 11,298 10,299 9 C299 8,299 8,299 7 C299 6,299 5,298 5 C298 4,297 4,296 4 C295 4,294 4,293 5 C292 6,291 6,290 7 C290 9,289 10,288 11 C287 12,287 13,287 15 L284 27 L279 27 L283 10 C283 9,283 8,283 8 C283 7,283 6,283 6 C283 5,283 4,282 4 C281 4,281 4,281 4 C280 4,280 5,280 5 C279 5,279 6,278 6 C278 6,278 7,277 7 L275 6 C276 5,277 4,278 3 C278 2,279 2,280 1 C280 1,281 1,282 0 C282 0,283 0,284 0 C285 0,286 1,287 1 C288 2,288 3,288 5 C288 5,288 6,288 6 C288 6,288 7,288 7 L288 7 C290 5,291 3,293 2 C295 1,296 0,298 0 C300 0,302 1,303 2 C303 3,304 4,304 6 C304 6,304 6,304 6 C304 6,304 7,304 7 L304 7 C306 4,307 3,309 2 C311 1,312 0,314 0 C316 0,317 1,318 2 C319 3,320 4,320 6 C320 6,320 7,319 8 C319 9,319 10,319 11 C319 12,318 13,318 14 C318 15,317 16,317 17 C317 18,317 18,317 19 C317 19,317 20,317 20 C316 20,316 20,316 21 C316 21,316 21,316 21 C316 22,316 22,317 23 C317 23,317 23,318 23 C318 23,319 23,319 23 C319 23,320 23,320 22 C320 22,321 22,321 21 C322 21,322 20,323 20 L324 21 C324 23,323 23,322 24 C321 25,321 25,320 26 C319 26,319 27,318 27 C317 27,316 27,316 27 C315 27,314 27,314 27 C313 27,313 26,312 26 C312 25,312 25,312 24 C311 24,311 23,311 22 C311 21,312 19,312 17 C313 16,313 15,313 14 C313 13,314 12,314 11 C314 10,314 10,314 9 C314 8,314 8,314 7 C314 6,314 5,314 5 C313 4,313 4,312 4 C311 4,311 4,310 5 C309 5,309 5,308 6 C308 6,307 7,306 7 C306 8,305 9,305 10 C304 10,304 11,303 12 C303 13,303 14,302 15 L300 27 Z" fill="#212121"/><path d="M270 137 L268 143 L263 143 L264 137 L270 137 Z M263 165 C263 166,263 167,263 168 C263 168,263 169,263 169 C263 170,263 170,263 171 C263 171,264 171,264 171 C265 171,265 171,265 171 C266 171,266 171,266 170 C267 170,267 170,267 169 C268 169,268 168,269 168 L271 170 C270 171,269 172,268 172 C267 173,267 173,266 174 C265 174,265 175,264 175 C263 175,263 175,262 175 C261 175,261 175,260 175 C260 175,259 174,259 174 C258 173,258 173,258 172 C258 172,257 171,257 170 C257 170,258 169,258 168 C258 167,258 166,258 165 C259 164,259 163,259 162 C259 161,260 160,260 159 C260 158,260 157,260 156 C261 155,261 154,261 153 C261 153,261 153,261 152 C261 152,261 152,261 152 C261 151,261 151,260 151 C260 150,259 150,258 150 L258 148 L266 148 L267 148 L263 165 Z" fill="#212121"/><path d="M279 155 L279 151 L309 151 L309 155 L279 155 Z M279 167 L279 163 L309 163 L309 167 L279 167 Z" fill="#212121"/><path d="M334 168 C334 169,334 169,334 170 C334 170,334 171,334 171 C334 171,334 171,334 172 C334 172,335 172,335 172 C335 172,335 172,336 173 C336 173,336 173,337 173 C337 173,338 173,339 173 C340 173,341 173,342 173 L342 175 L320 175 L320 173 C321 173,322 173,323 173 C324 173,324 173,325 173 C325 173,326 173,326 173 C327 172,327 172,327 172 C327 172,328 172,328 172 C328 172,328 171,328 171 C328 171,328 170,328 170 C328 170,328 169,328 168 L328 149 C328 149,328 148,328 148 C328 148,327 147,327 147 C326 147,326 148,324 148 C323 149,322 150,320 151 C320 150,320 150,320 150 C319 149,319 149,319 148 C321 147,323 146,326 145 C328 144,330 142,332 141 L334 141 C334 142,334 143,334 144 C334 145,334 145,334 146 C334 147,334 147,334 148 L334 168 Z" fill="#212121"/><path d="M376 92 C376 90,376 89,375 87 C375 85,375 83,374 82 C374 80,373 79,373 78 C373 78,373 78,372 77 C372 77,372 77,371 77 C371 77,370 77,370 77 C369 78,369 78,368 79 C368 79,367 80,366 81 L364 79 C366 77,367 76,368 75 C370 74,372 73,373 73 C374 73,375 73,375 73 C376 74,377 74,377 74 C377 75,378 75,378 76 C379 76,379 77,379 78 C380 79,380 80,380 82 C380 83,381 85,381 86 L381 86 C384 83,385 80,386 79 C388 77,389 76,390 75 C390 74,391 74,392 74 C393 73,394 73,395 73 C396 73,397 73,398 74 L396 81 L394 81 C394 80,393 79,393 79 C392 79,392 79,392 79 C392 79,391 79,391 80 C391 80,390 80,389 81 C389 82,388 83,387 84 C386 85,385 86,384 87 L382 90 C382 93,383 95,383 96 C384 98,384 100,384 101 C385 102,385 103,385 104 C385 104,386 105,386 105 C386 106,386 106,387 106 C387 106,387 106,388 106 C388 106,389 106,389 105 C390 105,391 104,392 102 L395 104 C393 106,391 108,390 109 C389 110,387 110,385 110 C384 110,383 110,382 109 C382 109,381 108,380 108 C380 107,379 105,379 104 C378 100,378 98,378 96 L377 96 C375 100,373 103,371 104 C370 106,369 107,368 108 C368 109,367 109,366 110 C365 110,364 110,363 110 C362 110,361 110,360 110 L362 102 L364 102 C364 103,365 104,365 104 C366 104,366 104,367 104 C367 104,367 103,368 102 C369 102,370 101,371 99 C372 98,374 95,376 92 L376 92 Z" fill="#212121"/><path d="M410 97 L408 103 L403 103 L404 97 L410 97 Z M403 125 C403 126,403 127,403 128 C403 128,403 129,403 129 C403 130,403 130,403 131 C403 131,404 131,404 131 C405 131,405 131,405 131 C406 131,406 131,406 130 C407 130,407 130,407 129 C408 129,408 128,409 128 L411 130 C410 131,409 132,408 132 C407 133,407 133,406 134 C405 134,405 135,404 135 C403 135,403 135,402 135 C401 135,401 135,400 135 C400 135,399 134,399 134 C398 133,398 133,398 132 C398 132,397 131,397 130 C397 130,398 129,398 128 C398 127,398 126,398 125 C399 124,399 123,399 122 C399 121,400 120,400 119 C400 118,400 117,400 116 C401 115,401 114,401 113 C401 113,401 113,401 112 C401 112,401 112,401 112 C401 111,401 111,400 111 C400 110,399 110,398 110 L398 108 L406 108 L407 108 L403 125 Z" fill="#212121"/><path d="M426 100 C427 102,427 104,427 105 C427 107,427 109,426 110 C426 111,425 113,423 114 C422 116,420 117,418 119 L416 117 C417 116,418 115,419 114 C419 113,419 112,420 110 C420 109,420 108,420 106 C420 104,420 102,420 100 L426 100 Z" fill="#212121"/></svg></span></p>
<p class="p_Text"><span class="f_Text">Where :</span></p>
<ul style="list-style-type:disc">
<li class="p_li"><span class="f_li" style="font-style: italic; font-weight: bold;">&#956;</span><span class="f_li" style="font-size: 7pt; font-style: italic; font-weight: bold; vertical-align: sub;"> B</span><span class="f_li"> = the arithmetic mean of the feature over the sample</span></li>
<li class="p_li"><span class="f_li" style="font-style: italic; font-weight: bold;">m</span><span class="f_li"> = the sample size (batch)</span></li>
</ul>
<p class="p_Text"><span class="f_Text">Then we calculate the variance of the original sample.</span></p>
<p class="p_Text" style="text-align: center;"><span style="display:inline-block;width:161px;height:61px;padding:0 0;overflow:visible"><svg xmlns="http://www.w3.org/2000/svg" style="width:100%;height:100%;overflow:visible" viewBox="0 0 644 244"><path d="M42 108 L30 108 L30 108 C32 110,33 112,33 113 C34 115,34 117,34 119 C34 123,33 126,32 129 C30 132,28 135,25 136 C22 138,19 139,16 139 C12 139,9 138,6 136 C4 134,3 131,3 126 C3 124,4 121,5 119 C5 116,7 114,8 112 C10 110,12 108,14 107 C16 106,18 105,21 104 C24 103,27 103,32 103 L43 103 L42 108 Z M26 108 C23 108,20 109,17 111 C15 113,13 115,11 118 C10 121,9 125,9 128 C9 130,9 132,10 133 C11 134,11 135,12 135 C13 136,14 136,15 136 C18 136,20 135,22 134 C24 132,25 130,26 126 C27 123,28 120,28 117 C28 113,27 110,26 108 L26 108 Z" fill="#212121"/><path d="M64 107 C64 107,65 107,66 107 C66 107,66 107,67 107 C67 106,67 106,68 106 C68 105,68 105,68 104 L71 104 C71 105,71 106,71 108 C71 109,71 110,70 111 L48 111 L48 110 C48 109,49 108,49 107 C50 106,50 105,51 104 C52 103,53 102,54 101 C54 100,55 99,57 98 C58 96,60 95,61 94 C62 92,63 91,63 90 C64 89,64 89,64 88 C65 87,65 86,65 85 C65 84,65 84,64 83 C64 82,64 81,63 81 C63 80,62 80,61 80 C61 79,60 79,59 79 C57 79,56 80,55 80 C54 81,53 82,52 84 L49 84 L49 79 C51 78,53 77,55 77 C57 76,59 76,60 76 C62 76,64 76,65 77 C66 77,67 78,68 78 C69 79,69 80,70 81 C70 82,70 83,70 84 C70 85,70 86,70 86 C70 87,70 88,70 88 C69 89,69 89,69 90 C68 91,68 91,67 92 C67 93,66 93,66 94 C65 95,64 96,63 96 C62 97,61 98,61 99 C60 100,59 101,58 102 C57 103,56 104,55 105 C55 106,54 106,54 107 L64 107 Z" fill="#212121"/><path d="M41 159 C42 159,42 159,42 159 C43 159,43 158,43 158 C44 158,44 157,44 156 C44 156,45 155,45 153 L49 134 C50 133,50 132,50 132 C50 131,50 131,50 130 C50 130,50 129,49 129 C49 128,48 128,47 128 L47 126 L61 126 C64 126,65 126,67 127 C68 127,70 127,70 128 C71 129,72 129,72 130 C73 131,73 132,73 133 C73 138,70 141,65 142 C65 143,65 143,65 143 C65 143,65 143,65 143 C66 144,68 145,69 146 C69 147,70 148,70 150 C70 152,70 153,69 155 C68 156,67 157,66 158 C65 159,63 160,61 160 C59 161,56 161,53 161 L41 161 L41 159 Z M57 141 C59 141,61 141,62 141 C63 140,64 140,65 139 C66 138,67 138,67 137 C67 136,68 135,68 134 C68 133,67 132,67 132 C67 131,67 131,66 130 C65 130,65 130,64 129 C63 129,62 129,60 129 C59 129,59 129,58 129 C57 129,56 129,56 129 L53 141 L57 141 Z M49 158 C50 158,50 158,51 158 C51 158,52 158,53 158 C55 158,57 158,58 158 C60 157,61 157,62 156 C63 155,63 154,64 153 C64 152,64 151,64 149 C64 148,64 148,64 147 C64 146,63 146,63 145 C62 145,61 145,60 144 C60 144,58 144,57 144 L52 144 L49 158 Z" fill="#212121"/><path d="M103 112 L103 107 L149 107 L149 112 L103 112 Z M103 127 L103 122 L149 122 L149 127 L103 127 Z" fill="#212121"/><path d="M211 71 C211 73,211 74,211 74 C211 75,212 76,212 76 C212 77,213 77,214 77 C215 78,215 78,217 78 C218 78,219 78,221 78 L221 81 L194 81 L194 78 C197 78,199 78,200 78 C201 77,202 77,202 77 C203 76,203 76,204 75 C204 74,204 73,204 71 L204 41 C204 40,204 40,204 39 C203 39,203 39,202 39 C201 39,200 39,199 40 C197 41,196 42,194 43 L192 40 L209 30 L211 30 C211 32,211 36,211 40 L211 71 Z" fill="#212121"/><path d="M191 162 C193 158,196 156,198 154 C200 153,202 152,205 152 C207 152,209 153,210 154 C211 155,212 157,212 160 L212 160 C212 160,212 160,212 161 C214 158,216 156,218 154 C220 153,222 152,224 152 C227 152,228 153,230 154 C231 155,232 157,232 160 C232 161,231 164,230 166 L228 176 C227 179,227 181,227 182 C227 183,227 184,228 184 C228 185,228 185,229 185 C230 185,231 185,231 184 C232 184,233 183,235 181 L237 183 C235 185,233 187,232 188 C230 189,228 189,226 189 C225 189,223 188,222 187 C221 186,221 185,221 183 C221 181,221 179,222 176 L224 169 C224 167,225 165,225 164 C225 163,225 162,225 161 C225 159,225 158,224 157 C224 156,223 156,222 156 C221 156,219 157,218 157 C217 158,216 159,215 161 C213 163,212 164,211 166 C211 167,210 169,209 172 L206 188 L200 188 L204 169 C205 167,205 165,205 164 C205 163,205 162,205 161 C205 159,205 158,204 157 C204 156,203 156,201 156 C201 156,200 157,198 157 C197 158,196 159,195 161 C193 163,192 164,191 166 C191 168,190 170,189 172 L186 188 L180 188 L185 164 C186 162,186 160,186 159 C186 158,186 157,185 157 C185 156,185 156,184 156 C183 156,182 156,181 157 C181 158,179 159,178 160 L176 158 C178 156,180 155,181 154 C183 153,185 152,187 152 C188 152,189 153,190 154 C191 155,192 156,192 157 C192 159,191 160,191 162 L191 162 Z" fill="#212121"/><rect x="175" y="114" width="63" height="5" fill="#212121"/><path d="M268 50 L312 109 L312 114 L265 177 L328 177 C331 177,333 176,335 174 C336 172,337 168,338 161 L344 161 L342 188 L252 188 L252 184 L303 115 L253 49 L253 45 L342 45 L342 67 L337 67 C337 62,335 58,334 55 C332 52,329 50,326 50 L268 50 Z" fill="#212121"/><path d="M301 27 L295 27 C296 26,296 25,296 24 C297 22,297 21,297 20 C298 18,298 17,298 16 C298 15,299 13,299 12 C299 11,299 10,300 9 C300 8,300 8,300 7 C300 6,300 5,299 5 C299 4,298 4,297 4 C296 4,295 4,294 5 C293 6,292 6,291 7 C291 9,290 10,289 11 C288 12,288 13,288 15 L285 27 L280 27 L284 10 C284 9,284 8,284 8 C284 7,284 6,284 6 C284 5,284 4,283 4 C282 4,282 4,282 4 C281 4,281 5,281 5 C280 5,280 6,279 6 C279 6,279 7,278 7 L276 6 C277 5,278 4,279 3 C279 2,280 2,281 1 C281 1,282 1,283 0 C283 0,284 0,285 0 C286 0,287 1,288 1 C289 2,289 3,289 5 C289 5,289 6,289 6 C289 6,289 7,289 7 L289 7 C291 5,292 3,294 2 C296 1,297 0,299 0 C301 0,303 1,304 2 C304 3,305 4,305 6 C305 6,305 6,305 6 C305 6,305 7,305 7 L305 7 C307 4,308 3,310 2 C312 1,313 0,315 0 C317 0,318 1,319 2 C320 3,321 4,321 6 C321 6,321 7,320 8 C320 9,320 10,320 11 C320 12,319 13,319 14 C319 15,318 16,318 17 C318 18,318 18,318 19 C318 19,318 20,318 20 C317 20,317 20,317 21 C317 21,317 21,317 21 C317 22,317 22,318 23 C318 23,318 23,319 23 C319 23,320 23,320 23 C320 23,321 23,321 22 C321 22,322 22,322 21 C323 21,323 20,324 20 L325 21 C325 23,324 23,323 24 C322 25,322 25,321 26 C320 26,320 27,319 27 C318 27,317 27,317 27 C316 27,315 27,315 27 C314 27,314 26,313 26 C313 25,313 25,313 24 C312 24,312 23,312 22 C312 21,313 19,313 17 C314 16,314 15,314 14 C314 13,315 12,315 11 C315 10,315 10,315 9 C315 8,315 8,315 7 C315 6,315 5,315 5 C314 4,314 4,313 4 C312 4,312 4,311 5 C310 5,310 5,309 6 C309 6,308 7,307 7 C307 8,306 9,306 10 C305 10,305 11,304 12 C304 13,304 14,303 15 L301 27 Z" fill="#212121"/><path d="M271 195 L269 201 L264 201 L265 195 L271 195 Z M264 223 C264 224,264 225,264 226 C264 226,264 227,264 227 C264 228,264 228,264 229 C264 229,265 229,265 229 C266 229,266 229,266 229 C267 229,267 229,267 228 C268 228,268 228,268 227 C269 227,269 226,270 226 L272 228 C271 229,270 230,269 230 C268 231,268 231,267 232 C266 232,266 233,265 233 C264 233,264 233,263 233 C262 233,262 233,261 233 C261 233,260 232,260 232 C259 231,259 231,259 230 C259 230,258 229,258 228 C258 228,259 227,259 226 C259 225,259 224,259 223 C260 222,260 221,260 220 C260 219,261 218,261 217 C261 216,261 215,261 214 C262 213,262 212,262 211 C262 211,262 211,262 210 C262 210,262 210,262 210 C262 209,262 209,261 209 C261 208,260 208,259 208 L259 206 L267 206 L268 206 L264 223 Z" fill="#212121"/><path d="M280 213 L280 209 L310 209 L310 213 L280 213 Z M280 225 L280 221 L310 221 L310 225 L280 225 Z" fill="#212121"/><path d="M335 226 C335 227,335 227,335 228 C335 228,335 229,335 229 C335 229,335 229,335 230 C335 230,336 230,336 230 C336 230,336 230,337 231 C337 231,337 231,338 231 C338 231,339 231,340 231 C341 231,342 231,343 231 L343 233 L321 233 L321 231 C322 231,323 231,324 231 C325 231,325 231,326 231 C326 231,327 231,327 231 C328 230,328 230,328 230 C328 230,329 230,329 230 C329 230,329 229,329 229 C329 229,329 228,329 228 C329 228,329 227,329 226 L329 207 C329 207,329 206,329 206 C329 206,328 205,328 205 C327 205,327 206,325 206 C324 207,323 208,321 209 C321 208,321 208,321 208 C320 207,320 207,320 206 C322 205,324 204,327 203 C329 202,331 200,333 199 L335 199 C335 200,335 201,335 202 C335 203,335 203,335 204 C335 205,335 205,335 206 L335 226 Z" fill="#212121"/><path d="M363 120 C363 128,364 136,367 141 C370 147,374 150,380 152 L379 155 C372 153,366 149,363 143 C359 137,357 129,357 120 C357 111,359 104,363 97 C366 91,372 87,379 85 L380 88 C374 90,370 94,367 99 C364 105,363 111,363 120 L363 120 Z" fill="#212121"/><path d="M398 121 C398 119,398 118,397 116 C397 114,397 112,396 111 C396 109,395 108,395 107 C395 107,395 107,394 106 C394 106,394 106,393 106 C393 106,392 106,392 106 C391 107,391 107,390 108 C390 108,389 109,388 110 L386 108 C388 106,389 105,390 104 C392 103,394 102,395 102 C396 102,397 102,397 102 C398 103,399 103,399 103 C399 104,400 104,400 105 C401 105,401 106,401 107 C402 108,402 109,402 111 C402 112,403 114,403 115 L403 115 C406 112,407 109,408 108 C410 106,411 105,412 104 C412 103,413 103,414 103 C415 102,416 102,417 102 C418 102,419 102,420 103 L418 110 L416 110 C416 109,415 108,415 108 C414 108,414 108,414 108 C414 108,413 108,413 109 C413 109,412 109,411 110 C411 111,410 112,409 113 C408 114,407 115,406 116 L404 119 C404 122,405 124,405 125 C406 127,406 129,406 130 C407 131,407 132,407 133 C407 133,408 134,408 134 C408 135,408 135,409 135 C409 135,409 135,410 135 C410 135,411 135,411 134 C412 134,413 133,414 131 L417 133 C415 135,413 137,412 138 C411 139,409 139,407 139 C406 139,405 139,404 138 C404 138,403 137,402 137 C402 136,401 134,401 133 C400 129,400 127,400 125 L399 125 C397 129,395 132,393 133 C392 135,391 136,390 137 C390 138,389 138,388 139 C387 139,386 139,385 139 C384 139,383 139,382 139 L384 131 L386 131 C386 132,387 133,387 133 C388 133,388 133,389 133 C389 133,389 132,390 131 C391 131,392 130,393 128 C394 127,396 124,398 121 L398 121 Z" fill="#212121"/><path d="M432 126 L430 132 L425 132 L426 126 L432 126 Z M425 154 C425 155,425 156,425 157 C425 157,425 158,425 158 C425 159,425 159,425 160 C425 160,426 160,426 160 C427 160,427 160,427 160 C428 160,428 160,428 159 C429 159,429 159,429 158 C430 158,430 157,431 157 L433 159 C432 160,431 161,430 161 C429 162,429 162,428 163 C427 163,427 164,426 164 C425 164,425 164,424 164 C423 164,423 164,422 164 C422 164,421 163,421 163 C420 162,420 162,420 161 C420 161,419 160,419 159 C419 159,420 158,420 157 C420 156,420 155,420 154 C421 153,421 152,421 151 C421 150,422 149,422 148 C422 147,422 146,422 145 C423 144,423 143,423 142 C423 142,423 142,423 141 C423 141,423 141,423 141 C423 140,423 140,422 140 C422 139,421 139,420 139 L420 137 L428 137 L429 137 L425 154 Z" fill="#212121"/><path d="M459 119 L459 114 L505 114 L505 119 L459 119 Z" fill="#212121"/><path d="M553 128 C551 132,549 134,547 136 C545 137,543 138,541 138 C540 138,539 138,538 138 C537 137,537 137,536 136 C535 137,535 139,535 142 C535 144,535 147,535 149 C535 150,535 150,535 151 L534 153 L529 153 L528 151 C529 147,530 143,531 138 L538 103 L545 103 L540 123 C540 124,539 126,539 127 C539 128,539 129,539 130 C539 132,539 132,540 133 C541 134,542 134,543 134 C544 134,546 133,547 132 C549 130,551 128,552 126 C553 124,554 122,555 120 L558 103 L565 103 L559 127 C559 129,559 131,559 132 C559 133,559 134,559 134 C559 135,560 135,561 135 C561 135,562 135,563 134 C563 134,564 133,565 132 L567 134 C566 135,565 136,564 137 C563 138,562 138,561 139 C560 139,559 139,558 139 C556 139,555 139,554 138 C553 137,553 136,553 134 C553 133,553 131,554 129 L553 128 Z" fill="#212121"/><path d="M570 163 C571 163,571 163,571 163 C572 163,572 162,572 162 C573 162,573 161,573 160 C573 160,574 159,574 157 L578 138 C579 137,579 136,579 136 C579 135,579 135,579 134 C579 134,579 133,578 133 C578 132,577 132,576 132 L576 130 L590 130 C593 130,594 130,596 131 C597 131,599 131,599 132 C600 133,601 133,601 134 C602 135,602 136,602 137 C602 142,599 145,594 146 C594 147,594 147,594 147 C594 147,594 147,594 147 C595 148,597 149,598 150 C598 151,599 152,599 154 C599 156,599 157,598 159 C597 160,596 161,595 162 C594 163,592 164,590 164 C588 165,585 165,582 165 L570 165 L570 163 Z M586 145 C588 145,590 145,591 145 C592 144,593 144,594 143 C595 142,596 142,596 141 C596 140,597 139,597 138 C597 137,596 136,596 136 C596 135,596 135,595 134 C594 134,594 134,593 133 C592 133,591 133,589 133 C588 133,588 133,587 133 C586 133,585 133,585 133 L582 145 L586 145 Z M578 162 C579 162,579 162,580 162 C580 162,581 162,582 162 C584 162,586 162,587 162 C589 161,590 161,591 160 C592 159,592 158,593 157 C593 156,593 155,593 153 C593 152,593 152,593 151 C593 150,592 150,592 149 C591 149,590 149,589 148 C589 148,587 148,586 148 L581 148 L578 162 Z" fill="#212121"/><path d="M624 120 C624 111,623 105,620 99 C617 94,613 90,607 88 L608 85 C615 87,621 91,624 97 C628 104,630 111,630 120 C630 129,628 137,624 143 C621 149,615 153,608 155 L607 152 C613 150,617 147,620 141 C623 136,624 128,624 120 L624 120 Z" fill="#212121"/></svg></span></p>
<p class="p_Text"><span class="f_Text">We normalize the sample data by reducing the sample to zero mean and unit variance.</span></p>
<p class="p_Text" style="text-align: center;"><span style="display:inline-block;width:100px;height:47px;padding:0 0;overflow:visible"><svg xmlns="http://www.w3.org/2000/svg" style="width:100%;height:100%;overflow:visible" viewBox="0 0 400 188"><path d="M17 80 C17 78,17 77,16 75 C16 73,16 71,15 70 C15 68,14 67,14 66 C14 66,14 66,13 65 C13 65,13 65,12 65 C12 65,11 65,11 65 C10 66,10 66,9 67 C9 67,8 68,7 69 L5 67 C7 65,8 64,9 63 C11 62,13 61,14 61 C15 61,16 61,16 61 C17 62,18 62,18 62 C18 63,19 63,19 64 C20 64,20 65,20 66 C21 67,21 68,21 70 C21 71,22 73,22 74 L22 74 C25 71,26 68,27 67 C29 65,30 64,31 63 C31 62,32 62,33 62 C34 61,35 61,36 61 C37 61,38 61,39 62 L37 69 L35 69 C35 68,34 67,34 67 C33 67,33 67,33 67 C33 67,32 67,32 68 C32 68,31 68,30 69 C30 70,29 71,28 72 C27 73,26 74,25 75 L23 78 C23 81,24 83,24 84 C25 86,25 88,25 89 C26 90,26 91,26 92 C26 92,27 93,27 93 C27 94,27 94,28 94 C28 94,28 94,29 94 C29 94,30 94,30 93 C31 93,32 92,33 90 L36 92 C34 94,32 96,31 97 C30 98,28 98,26 98 C25 98,24 98,23 97 C23 97,22 96,21 96 C21 95,20 93,20 92 C19 88,19 86,19 84 L18 84 C16 88,14 91,12 92 C11 94,10 95,9 96 C9 97,8 97,7 98 C6 98,5 98,4 98 C3 98,2 98,1 98 L3 90 L5 90 C5 91,6 92,6 92 C7 92,7 92,8 92 C8 92,8 91,9 90 C10 90,11 89,12 87 C13 86,15 83,17 80 L17 80 Z" fill="#212121"/><path d="M27 44 L35 56 L32 58 L25 49 L25 49 L16 58 L14 56 L22 44 L27 44 Z" fill="#212121"/><path d="M68 71 L68 66 L114 66 L114 71 L68 71 Z M68 86 L68 81 L114 81 L114 86 L68 86 Z" fill="#212121"/><path d="M173 19 C173 17,173 16,172 14 C172 12,172 10,171 9 C171 7,170 6,170 5 C170 5,170 5,169 4 C169 4,169 4,168 4 C168 4,167 4,167 4 C166 5,166 5,165 6 C165 6,164 7,163 8 L161 6 C163 4,164 3,165 2 C167 1,169 0,170 0 C171 0,172 0,172 0 C173 1,174 1,174 1 C174 2,175 2,175 3 C176 3,176 4,176 5 C177 6,177 7,177 9 C177 10,178 12,178 13 L178 13 C181 10,182 7,183 6 C185 4,186 3,187 2 C187 1,188 1,189 1 C190 0,191 0,192 0 C193 0,194 0,195 1 L193 8 L191 8 C191 7,190 6,190 6 C189 6,189 6,189 6 C189 6,188 6,188 7 C188 7,187 7,186 8 C186 9,185 10,184 11 C183 12,182 13,181 14 L179 17 C179 20,180 22,180 23 C181 25,181 27,181 28 C182 29,182 30,182 31 C182 31,183 32,183 32 C183 33,183 33,184 33 C184 33,184 33,185 33 C185 33,186 33,186 32 C187 32,188 31,189 29 L192 31 C190 33,188 35,187 36 C186 37,184 37,182 37 C181 37,180 37,179 36 C179 36,178 35,177 35 C177 34,176 32,176 31 C175 27,175 25,175 23 L174 23 C172 27,170 30,168 31 C167 33,166 34,165 35 C165 36,164 36,163 37 C162 37,161 37,160 37 C159 37,158 37,157 37 L159 29 L161 29 C161 30,162 31,162 31 C163 31,163 31,164 31 C164 31,164 30,165 29 C166 29,167 28,168 26 C169 25,171 22,173 19 L173 19 Z" fill="#212121"/><path d="M207 24 L205 30 L200 30 L201 24 L207 24 Z M200 52 C200 53,200 54,200 55 C200 55,200 56,200 56 C200 57,200 57,200 58 C200 58,201 58,201 58 C202 58,202 58,202 58 C203 58,203 58,203 57 C204 57,204 57,204 56 C205 56,205 55,206 55 L208 57 C207 58,206 59,205 59 C204 60,204 60,203 61 C202 61,202 62,201 62 C200 62,200 62,199 62 C198 62,198 62,197 62 C197 62,196 61,196 61 C195 60,195 60,195 59 C195 59,194 58,194 57 C194 57,195 56,195 55 C195 54,195 53,195 52 C196 51,196 50,196 49 C196 48,197 47,197 46 C197 45,197 44,197 43 C198 42,198 41,198 40 C198 40,198 40,198 39 C198 39,198 39,198 39 C198 38,198 38,197 38 C197 37,196 37,195 37 L195 35 L203 35 L204 35 L200 52 Z" fill="#212121"/><path d="M234 17 L234 12 L280 12 L280 17 L234 17 Z" fill="#212121"/><path d="M328 26 C326 30,324 32,322 34 C320 35,318 36,316 36 C315 36,314 36,313 36 C312 35,312 35,311 34 C310 35,310 37,310 40 C310 42,310 45,310 47 C310 48,310 48,310 49 L309 51 L304 51 L303 49 C304 45,305 41,306 36 L313 1 L320 1 L315 21 C315 22,314 24,314 25 C314 26,314 27,314 28 C314 30,314 30,315 31 C316 32,317 32,318 32 C319 32,321 31,322 30 C324 28,326 26,327 24 C328 22,329 20,330 18 L333 1 L340 1 L334 25 C334 27,334 29,334 30 C334 31,334 32,334 32 C334 33,335 33,336 33 C336 33,337 33,338 32 C338 32,339 31,340 30 L342 32 C341 33,340 34,339 35 C338 36,337 36,336 37 C335 37,334 37,333 37 C331 37,330 37,329 36 C328 35,328 34,328 32 C328 31,328 29,329 27 L328 26 Z" fill="#212121"/><path d="M345 61 C346 61,346 61,346 61 C347 61,347 60,347 60 C348 60,348 59,348 58 C348 58,349 57,349 55 L353 36 C354 35,354 34,354 34 C354 33,354 33,354 32 C354 32,354 31,353 31 C353 30,352 30,351 30 L351 28 L365 28 C368 28,369 28,371 29 C372 29,374 29,374 30 C375 31,376 31,376 32 C377 33,377 34,377 35 C377 40,374 43,369 44 C369 45,369 45,369 45 C369 45,369 45,369 45 C370 46,372 47,373 48 C373 49,374 50,374 52 C374 54,374 55,373 57 C372 58,371 59,370 60 C369 61,367 62,365 62 C363 63,360 63,357 63 L345 63 L345 61 Z M361 43 C363 43,365 43,366 43 C367 42,368 42,369 41 C370 40,371 40,371 39 C371 38,372 37,372 36 C372 35,371 34,371 34 C371 33,371 33,370 32 C369 32,369 32,368 31 C367 31,366 31,364 31 C363 31,363 31,362 31 C361 31,360 31,360 31 L357 43 L361 43 Z M353 60 C354 60,354 60,355 60 C355 60,356 60,357 60 C359 60,361 60,362 60 C364 59,365 59,366 58 C367 57,367 56,368 55 C368 54,368 53,368 51 C368 50,368 50,368 49 C368 48,367 48,367 47 C366 47,365 47,364 46 C364 46,362 46,361 46 L356 46 L353 60 Z" fill="#212121"/><path d="M153 148 L166 176 L188 93 L198 93 L198 98 L191 98 L167 186 L164 186 L149 154 L142 156 L141 154 L153 148 Z" fill="#212121"/><path d="M238 133 L226 133 L226 133 C228 135,229 137,229 138 C230 140,230 142,230 144 C230 148,229 151,228 154 C226 157,224 160,221 161 C218 163,215 164,212 164 C208 164,205 163,202 161 C200 159,199 156,199 151 C199 149,200 146,201 144 C201 141,203 139,204 137 C206 135,208 133,210 132 C212 131,214 130,217 129 C220 128,223 128,228 128 L239 128 L238 133 Z M222 133 C219 133,216 134,213 136 C211 138,209 140,207 143 C206 146,205 150,205 153 C205 155,205 157,206 158 C207 159,207 160,208 160 C209 161,210 161,211 161 C214 161,216 160,218 159 C220 157,221 155,222 151 C223 148,224 145,224 142 C224 138,223 135,222 133 L222 133 Z" fill="#212121"/><path d="M260 136 C260 136,261 136,262 136 C262 136,262 136,263 136 C263 135,263 135,264 135 C264 134,264 134,264 133 L267 133 C267 134,267 135,267 137 C267 138,267 139,266 140 L244 140 L244 139 C244 138,245 137,245 136 C246 135,246 134,247 133 C248 132,249 131,250 130 C250 129,251 128,253 127 C254 125,256 124,257 123 C258 121,259 120,259 119 C260 118,260 118,260 117 C261 116,261 115,261 114 C261 113,261 113,260 112 C260 111,260 110,259 110 C259 109,258 109,257 109 C257 108,256 108,255 108 C253 108,252 109,251 109 C250 110,249 111,248 113 L245 113 L245 108 C247 107,249 106,251 106 C253 105,255 105,256 105 C258 105,260 105,261 106 C262 106,263 107,264 107 C265 108,265 109,266 110 C266 111,266 112,266 113 C266 114,266 115,266 115 C266 116,266 117,266 117 C265 118,265 118,265 119 C264 120,264 120,263 121 C263 122,262 122,262 123 C261 124,260 125,259 125 C258 126,257 127,257 128 C256 129,255 130,254 131 C253 132,252 133,251 134 C251 135,250 135,250 136 L260 136 Z" fill="#212121"/><path d="M237 184 C238 184,238 184,238 184 C239 184,239 183,239 183 C240 183,240 182,240 181 C240 181,241 180,241 178 L245 159 C246 158,246 157,246 157 C246 156,246 156,246 155 C246 155,246 154,245 154 C245 153,244 153,243 153 L243 151 L257 151 C260 151,261 151,263 152 C264 152,266 152,266 153 C267 154,268 154,268 155 C269 156,269 157,269 158 C269 163,266 166,261 167 C261 168,261 168,261 168 C261 168,261 168,261 168 C262 169,264 170,265 171 C265 172,266 173,266 175 C266 177,266 178,265 180 C264 181,263 182,262 183 C261 184,259 185,257 185 C255 186,252 186,249 186 L237 186 L237 184 Z M253 166 C255 166,257 166,258 166 C259 165,260 165,261 164 C262 163,263 163,263 162 C263 161,264 160,264 159 C264 158,263 157,263 157 C263 156,263 156,262 155 C261 155,261 155,260 154 C259 154,258 154,256 154 C255 154,255 154,254 154 C253 154,252 154,252 154 L249 166 L253 166 Z M245 183 C246 183,246 183,247 183 C247 183,248 183,249 183 C251 183,253 183,254 183 C256 182,257 182,258 181 C259 180,259 179,260 178 C260 177,260 176,260 174 C260 173,260 173,260 172 C260 171,259 171,259 170 C258 170,257 170,256 169 C256 169,254 169,253 169 L248 169 L245 183 Z" fill="#212121"/><path d="M321 144 L321 165 L315 165 L315 144 L295 144 L295 139 L315 139 L315 118 L321 118 L321 139 L341 139 L341 144 L321 144 Z" fill="#212121"/><path d="M395 136 L391 136 C391 132,389 130,385 130 C383 130,381 131,379 132 C378 133,377 135,377 138 C377 139,378 141,379 142 C380 143,382 143,384 143 L389 143 L389 147 L385 147 C383 147,382 147,380 147 C379 148,378 148,377 149 C376 149,375 150,375 150 C374 151,373 152,373 152 C373 153,373 154,373 155 C373 157,373 158,374 159 C376 160,377 160,380 160 C381 160,383 160,385 159 C387 159,389 158,391 156 L393 159 C391 161,388 162,386 163 C383 164,381 164,378 164 C375 164,373 164,372 163 C370 162,368 161,368 160 C367 158,366 157,366 155 C366 153,367 151,369 149 C371 147,374 146,378 145 L378 145 C373 143,371 141,371 137 C371 135,372 134,373 132 C374 131,375 130,377 129 C380 128,382 127,385 127 C389 127,392 128,396 129 L395 136 Z" fill="#212121"/><rect x="196" y="93" width="201" height="5" fill="#212121"/><rect x="140" y="73" width="257" height="5" fill="#212121"/></svg></span></p>
<p class="p_Text"><span class="f_Text">Note that a small positive constant &#949; is added to the denominator of the sample variance to prevent division by zero.</span></p>
<p class="p_Text"><span class="f_Text">As it turned out, such normalization can distort the influence of the input data. This is why the authors of the method added one more step: scaling and offset. They introduced the variables </span><span class="f_Text" style="font-style: italic;">&#947;</span><span class="f_Text"> and </span><span class="f_Text" style="font-style: italic;">&#946;</span><span class="f_Text">, which are trained together with the neural network using the gradient descent method.</span></p>
<p class="p_Text" style="text-align: center;"><span style="display:inline-block;width:195px;height:23px;padding:0 0;overflow:visible"><svg xmlns="http://www.w3.org/2000/svg" style="width:100%;height:100%;overflow:visible" viewBox="0 0 780 92"><path d="M18 53 C17 49,16 44,15 38 C14 31,13 27,12 25 C12 23,11 22,11 22 C11 21,10 21,10 21 C9 21,8 21,7 22 C7 23,6 24,5 25 L2 23 C4 21,6 20,7 19 C9 18,10 17,12 17 C13 17,14 17,15 17 C15 18,16 18,16 19 C17 19,17 20,17 20 C18 21,18 22,18 23 C19 24,19 26,19 28 C20 31,21 34,21 38 C22 41,22 45,22 48 C25 44,27 41,29 38 C30 34,31 32,32 29 C33 27,33 25,33 23 C33 22,33 21,32 21 C32 20,31 20,30 20 L30 18 L40 18 L41 20 C39 25,37 30,33 36 C30 42,27 48,23 53 C19 58,16 62,13 65 C11 66,9 68,8 68 C7 69,5 69,4 69 C3 69,3 69,2 69 C1 69,1 69,0 69 L2 62 L5 62 C5 63,5 64,6 64 C8 64,9 63,11 61 C13 60,15 57,18 53 L18 53 Z" fill="#212121"/><path d="M47 43 L45 49 L40 49 L41 43 L47 43 Z M40 71 C40 72,40 73,40 74 C40 74,40 75,40 75 C40 76,40 76,40 77 C40 77,41 77,41 77 C42 77,42 77,42 77 C43 77,43 77,43 76 C44 76,44 76,44 75 C45 75,45 74,46 74 L48 76 C47 77,46 78,45 78 C44 79,44 79,43 80 C42 80,42 81,41 81 C40 81,40 81,39 81 C38 81,38 81,37 81 C37 81,36 80,36 80 C35 79,35 79,35 78 C35 78,34 77,34 76 C34 76,35 75,35 74 C35 73,35 72,35 71 C36 70,36 69,36 68 C36 67,37 66,37 65 C37 64,37 63,37 62 C38 61,38 60,38 59 C38 59,38 59,38 58 C38 58,38 58,38 58 C38 57,38 57,37 57 C37 56,36 56,35 56 L35 54 L43 54 L44 54 L40 71 Z" fill="#212121"/><path d="M78 27 L78 22 L124 22 L124 27 L78 27 Z M78 42 L78 37 L124 37 L124 42 L78 42 Z" fill="#212121"/><path d="M188 20 C186 23,183 28,178 34 C173 41,169 48,165 54 C164 59,163 64,162 68 L157 68 L156 66 C157 62,158 58,161 53 C161 49,161 44,161 39 C161 35,161 32,161 29 C161 27,161 25,160 24 C160 23,159 22,159 22 C159 21,158 21,157 21 C156 21,154 22,153 24 L151 22 C152 21,153 20,153 20 C154 19,155 19,155 18 C156 18,157 18,157 17 C158 17,159 17,160 17 C162 17,164 18,165 20 C166 22,167 25,167 29 C167 34,167 40,166 46 L166 46 C172 36,177 27,181 18 L189 18 L188 20 Z" fill="#212121"/><path d="M206 36 C206 34,206 33,205 31 C205 29,205 27,204 26 C204 24,203 23,203 22 C203 22,203 22,202 21 C202 21,202 21,201 21 C201 21,200 21,200 21 C199 22,199 22,198 23 C198 23,197 24,196 25 L194 23 C196 21,197 20,198 19 C200 18,202 17,203 17 C204 17,205 17,205 17 C206 18,207 18,207 18 C207 19,208 19,208 20 C209 20,209 21,209 22 C210 23,210 24,210 26 C210 27,211 29,211 30 L211 30 C214 27,215 24,216 23 C218 21,219 20,220 19 C220 18,221 18,222 18 C223 17,224 17,225 17 C226 17,227 17,228 18 L226 25 L224 25 C224 24,223 23,223 23 C222 23,222 23,222 23 C222 23,221 23,221 24 C221 24,220 24,219 25 C219 26,218 27,217 28 C216 29,215 30,214 31 L212 34 C212 37,213 39,213 40 C214 42,214 44,214 45 C215 46,215 47,215 48 C215 48,216 49,216 49 C216 50,216 50,217 50 C217 50,217 50,218 50 C218 50,219 50,219 49 C220 49,221 48,222 46 L225 48 C223 50,221 52,220 53 C219 54,217 54,215 54 C214 54,213 54,212 53 C212 53,211 52,210 52 C210 51,209 49,209 48 C208 44,208 42,208 40 L207 40 C205 44,203 47,201 48 C200 50,199 51,198 52 C198 53,197 53,196 54 C195 54,194 54,193 54 C192 54,191 54,190 54 L192 46 L194 46 C194 47,195 48,195 48 C196 48,196 48,197 48 C197 48,197 47,198 46 C199 46,200 45,201 43 C202 42,204 39,206 36 L206 36 Z" fill="#212121"/><path d="M240 41 L238 47 L233 47 L234 41 L240 41 Z M233 69 C233 70,233 71,233 72 C233 72,233 73,233 73 C233 74,233 74,233 75 C233 75,234 75,234 75 C235 75,235 75,235 75 C236 75,236 75,236 74 C237 74,237 74,237 73 C238 73,238 72,239 72 L241 74 C240 75,239 76,238 76 C237 77,237 77,236 78 C235 78,235 79,234 79 C233 79,233 79,232 79 C231 79,231 79,230 79 C230 79,229 78,229 78 C228 77,228 77,228 76 C228 76,227 75,227 74 C227 74,228 73,228 72 C228 71,228 70,228 69 C229 68,229 67,229 66 C229 65,230 64,230 63 C230 62,230 61,230 60 C231 59,231 58,231 57 C231 57,231 57,231 56 C231 56,231 56,231 56 C231 55,231 55,230 55 C230 54,229 54,228 54 L228 52 L236 52 L237 52 L233 69 Z" fill="#212121"/><path d="M216 0 L224 12 L221 14 L214 5 L214 5 L205 14 L203 12 L211 0 L216 0 Z" fill="#212121"/><path d="M293 34 L293 55 L287 55 L287 34 L267 34 L267 29 L287 29 L287 8 L293 8 L293 29 L313 29 L313 34 L293 34 Z" fill="#212121"/><path d="M363 26 C369 28,372 32,372 38 C372 41,371 43,370 46 C369 48,367 50,364 52 C362 53,359 54,356 54 C354 54,352 54,350 54 C349 53,347 53,345 52 L342 69 L336 69 L346 21 C347 16,349 13,350 10 C352 7,354 5,357 3 C359 2,362 1,365 1 C369 1,372 2,374 4 C376 5,377 8,377 11 C377 12,377 13,377 15 C376 16,376 18,375 19 C374 20,372 22,370 23 C368 24,366 25,363 26 L363 26 Z M357 25 C360 25,362 24,364 23 C366 22,368 20,369 18 C370 15,371 13,371 10 C371 8,371 7,370 6 C369 5,367 4,365 4 C362 4,359 6,357 9 C355 12,353 16,352 22 L347 45 C347 46,347 46,347 46 C347 47,347 48,347 48 C348 49,348 49,349 49 C349 50,350 50,351 51 C352 51,353 51,355 51 C357 51,359 50,360 49 C362 48,363 46,364 44 C365 42,365 39,365 36 C365 34,365 31,363 30 C362 28,359 27,357 27 L357 25 Z" fill="#212121"/><path d="M408 34 L408 29 L454 29 L454 34 L408 34 Z M408 49 L408 44 L454 44 L454 49 L408 49 Z M408 19 L408 14 L454 14 L454 19 L408 19 Z" fill="#212121"/><path d="M513 28 C516 29,517 30,519 32 C520 33,520 35,520 37 C520 41,520 43,518 46 C517 48,514 50,511 51 C508 52,504 53,498 53 L482 53 L482 51 C483 51,484 51,485 51 C485 50,485 50,486 49 C486 49,486 48,487 47 C487 46,487 45,488 42 L494 14 C495 12,495 10,495 8 C495 7,495 6,494 6 C494 5,493 5,491 5 L492 3 L510 3 C513 3,516 4,519 4 C521 5,523 6,524 8 C525 9,525 11,525 13 C525 17,524 20,522 22 C520 24,517 26,513 27 L513 28 Z M503 26 C506 26,508 26,510 25 C512 25,513 24,515 23 C516 22,517 20,517 19 C518 17,518 15,518 13 C518 12,518 11,518 10 C517 10,517 9,516 8 C515 7,514 7,513 7 C512 6,510 6,508 6 C506 6,504 6,502 6 L498 26 L503 26 Z M493 50 C494 50,496 50,498 50 C502 50,505 50,507 49 C508 48,510 47,511 44 C513 42,513 40,513 36 C513 34,513 32,511 31 C509 30,507 29,504 29 L497 29 L493 50 Z" fill="#212121"/><path d="M582 3 L581 5 C581 5,580 6,579 6 C579 6,579 6,578 7 C578 7,578 8,577 9 C577 10,577 12,576 14 L567 53 L563 53 L552 21 C551 18,549 14,548 10 L548 10 C548 11,547 14,547 17 C546 21,545 24,545 28 L541 42 C541 45,541 46,541 48 C541 49,541 50,541 50 C542 51,543 51,544 51 L544 53 L531 53 L531 51 C532 51,533 51,534 50 C534 50,534 50,535 49 C535 48,535 48,536 47 C536 46,536 44,537 42 L543 14 C543 13,543 12,544 11 C544 10,544 9,544 8 C544 7,544 6,543 6 C542 5,541 5,540 5 L541 3 L552 3 L562 32 C563 36,564 39,565 42 L566 42 C566 41,566 38,567 35 C568 31,568 28,569 26 L571 14 C572 12,572 10,572 8 C572 7,572 6,571 6 C571 5,570 5,569 5 L569 3 L582 3 Z" fill="#212121"/><path d="M609 55 C609 56,608 56,607 57 C607 59,606 60,605 61 C604 63,602 64,601 66 C600 67,599 69,598 71 C597 73,595 74,594 76 C593 78,592 79,591 80 C591 82,590 84,590 86 C590 88,589 89,589 91 L584 91 C584 91,584 91,584 90 C584 90,584 90,583 90 C584 88,584 87,585 85 C586 84,586 82,587 80 C587 79,587 77,587 75 C587 73,587 71,587 69 C587 68,587 66,587 65 C587 63,587 62,587 61 C587 60,587 60,586 59 C586 59,586 58,586 58 C586 58,585 57,585 57 C585 57,585 57,584 57 C584 57,583 57,582 58 C582 58,581 59,580 59 C580 59,580 59,580 59 C579 58,579 58,579 58 C580 57,580 56,581 55 C582 55,582 54,583 54 C584 54,584 53,585 53 C585 53,586 53,586 53 C587 53,588 53,589 54 C590 54,590 55,591 55 C591 56,592 57,592 59 C592 60,592 62,592 64 C592 66,592 67,592 69 C592 71,592 72,592 74 L592 74 C593 73,594 71,595 69 C596 67,597 65,598 63 C599 62,600 60,601 58 C602 56,603 55,603 53 L610 53 L609 55 Z" fill="#212121"/><path d="M635 59 C638 60,639 62,640 63 C641 64,642 66,642 68 C642 70,642 71,641 73 C640 74,639 76,638 77 C637 78,636 79,634 79 C633 80,631 80,629 80 C628 80,626 80,625 80 C624 80,622 79,621 78 L618 92 L613 92 L621 56 C622 51,624 47,627 45 C629 42,632 41,636 41 C638 41,639 41,640 42 C641 42,642 42,643 43 C644 44,645 44,645 45 C646 46,646 47,646 48 C646 50,646 51,645 52 C645 53,644 54,643 55 C643 56,642 56,640 57 C639 58,637 59,635 59 L635 59 Z M630 58 C631 58,633 58,634 57 C636 57,637 56,638 55 C639 54,639 53,640 52 C640 51,641 50,641 49 C641 47,640 46,639 45 C639 44,638 44,636 44 C634 44,632 45,630 47 C628 49,627 52,626 56 L622 73 C622 73,622 73,622 73 C622 74,622 74,622 74 C622 75,623 76,624 76 C625 77,626 77,628 77 C630 77,631 77,632 76 C633 76,634 75,634 74 C635 74,636 72,636 71 C636 70,636 68,636 67 C636 65,636 63,635 62 C633 61,632 60,629 60 L630 58 Z" fill="#212121"/><path d="M663 35 C663 43,664 51,667 56 C670 62,674 65,680 67 L679 70 C672 68,666 64,663 58 C659 52,657 44,657 35 C657 26,659 19,663 12 C666 6,672 2,679 0 L680 3 C674 5,670 9,667 14 C664 20,663 26,663 35 L663 35 Z" fill="#212121"/><path d="M698 36 C698 34,698 33,697 31 C697 29,697 27,696 26 C696 24,695 23,695 22 C695 22,695 22,694 21 C694 21,694 21,693 21 C693 21,692 21,692 21 C691 22,691 22,690 23 C690 23,689 24,688 25 L686 23 C688 21,689 20,690 19 C692 18,694 17,695 17 C696 17,697 17,697 17 C698 18,699 18,699 18 C699 19,700 19,700 20 C701 20,701 21,701 22 C702 23,702 24,702 26 C702 27,703 29,703 30 L703 30 C706 27,707 24,708 23 C710 21,711 20,712 19 C712 18,713 18,714 18 C715 17,716 17,717 17 C718 17,719 17,720 18 L718 25 L716 25 C716 24,715 23,715 23 C714 23,714 23,714 23 C714 23,713 23,713 24 C713 24,712 24,711 25 C711 26,710 27,709 28 C708 29,707 30,706 31 L704 34 C704 37,705 39,705 40 C706 42,706 44,706 45 C707 46,707 47,707 48 C707 48,708 49,708 49 C708 50,708 50,709 50 C709 50,709 50,710 50 C710 50,711 50,711 49 C712 49,713 48,714 46 L717 48 C715 50,713 52,712 53 C711 54,709 54,707 54 C706 54,705 54,704 53 C704 53,703 52,702 52 C702 51,701 49,701 48 C700 44,700 42,700 40 L699 40 C697 44,695 47,693 48 C692 50,691 51,690 52 C690 53,689 53,688 54 C687 54,686 54,685 54 C684 54,683 54,682 54 L684 46 L686 46 C686 47,687 48,687 48 C688 48,688 48,689 48 C689 48,689 47,690 46 C691 46,692 45,693 43 C694 42,696 39,698 36 L698 36 Z" fill="#212121"/><path d="M732 41 L730 47 L725 47 L726 41 L732 41 Z M725 69 C725 70,725 71,725 72 C725 72,725 73,725 73 C725 74,725 74,725 75 C725 75,726 75,726 75 C727 75,727 75,727 75 C728 75,728 75,728 74 C729 74,729 74,729 73 C730 73,730 72,731 72 L733 74 C732 75,731 76,730 76 C729 77,729 77,728 78 C727 78,727 79,726 79 C725 79,725 79,724 79 C723 79,723 79,722 79 C722 79,721 78,721 78 C720 77,720 77,720 76 C720 76,719 75,719 74 C719 74,720 73,720 72 C720 71,720 70,720 69 C721 68,721 67,721 66 C721 65,722 64,722 63 C722 62,722 61,722 60 C723 59,723 58,723 57 C723 57,723 57,723 56 C723 56,723 56,723 56 C723 55,723 55,722 55 C722 54,721 54,720 54 L720 52 L728 52 L729 52 L725 69 Z" fill="#212121"/><path d="M755 35 C755 26,754 20,751 14 C748 9,744 5,738 3 L739 0 C746 2,752 6,755 12 C759 19,761 26,761 35 C761 44,759 52,755 58 C752 64,746 68,739 70 L738 67 C744 65,748 62,751 56 C754 51,755 43,755 35 L755 35 Z" fill="#212121"/></svg></span></p>
<p class="p_Text"><span class="f_Text">Applying this method allows obtaining a dataset with a consistent distribution at each training step, which in practice makes the training of the neural network more stable and enables an increase in the learning rate. Overall, this enhances the training quality while reducing the time required for neural network training.</span></p>
<p class="p_Text"><span class="f_Text">However, at the same time, the cost of storing additional coefficients increases. Furthermore, calculating the moving average and variance requires storing in memory the historical data of each neuron for the entire batch size. An alternative here could be the use of Exponential Moving Average (EMA): calculating the EMA only requires the previous value of the function and the current element of the sequence.</span></p>
<p class="p_Text"><span class="f_Text">Experiments conducted by the authors of the method demonstrate that the application of Batch Normalization also serves as a form of regularization. This allows for the elimination of other regularization methods, including the previously discussed Dropout. Moreover, there are more recent works showing that the combined use of Dropout and Batch Normalization has a negative effect on the training results of a neural network.</span></p>
<p class="p_Text"><span class="f_Text">In modern architectures of neural networks, the proposed normalization algorithm can be found in various shapes. The authors suggest using Batch Normalization directly before the non-linearity (activation function). One of the variations of this algorithm is <a href="https://arxiv.org/abs/1607.06450" target="_blank" rel="external" class="weblink" title="Layer Normalization">Layer Normalization</a>, introduced by Jimmy Lei Ba, Jamie Ryan Kiros, and Geoffrey E. Hinton in July 2016 in their work &quot;Layer Normalization.&quot;</span></p>

</div>

</body>
</html>
