<!DOCTYPE html>
<html>
  <head>
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
  <title>7.4.2 Encryption, hashing and data packaging: CryptEncode</title>
  <meta name="keywords" content="" />
  <link type="text/css" href="default.css" rel="stylesheet" />

   <script type="text/javascript" src="jquery.js"></script>
   <script type="text/javascript" src="helpman_settings.js"></script>
   <script type="text/javascript" src="helpman_topicinit.js"></script>


</head>

<body style="background-color:#FFFFFF; font-family:'Trebuchet MS',Tahoma,Arial,Helvetica,sans-serif; margin:0px;">



<table width="100%" height="49"  border="0" cellpadding="0" cellspacing="0" style="margin-top:0px; background-color:#1660af;">
  <tr>
    <td></td>
    <td valign="middle">
      <table style="margin-top:4px; margin-bottom:5px;" width="100%"  border="0" cellspacing="0" cellpadding="5">
        <tr valign="middle">
          <td class="nav">
<a class="h_m" href="index.htm">          MQL5 Programming for Traders </a> / <a class="h_m" href="part7.htm"> Part 7. Advanced language tools </a> / <a class="h_m" href="7_4_crypt.htm"> 7.4 Cryptography </a>/ 7.4.2 Encryption, hashing, and data packaging: CryptEncode
          </td>
          <td width="70" align="right">
          <a href="7_4_1_crypt_overview.htm"><img style="vertical-align:middle;" src="previous.png" alt="?????" width="27" height="27" border=0></a>&nbsp;
          <a href="7_4_3_crypt_decode.htm"><img style="vertical-align:middle;" src="next.png" alt="??????" width="27" height="27" border="0"></a>
          </td>
        </tr>
      </table>
    </td>
    <td width="5"></td>
  </tr>
</table>



<div id="help">
<p class="p_H3"><span class="f_H3">7.4.2 Encryption, hashing, and data packaging: CryptEncode</span></p>
<p class="p_Text"><span class="f_Text">The MQL5 function responsible for data encryption, hashing, and compression is </span><span class="f_Text" style="font-style: italic;">CryptEncode</span><span class="f_Text">. It transforms the data of the passed source array </span><span class="f_Text" style="font-style: italic;">data</span><span class="f_Text"> to the destination array </span><span class="f_Text" style="font-style: italic;">result</span><span class="f_Text"> by the specified method.</span></p>
<p class="p_H4"><span class="f_H4">int CryptEncode(ENUM_CRYPT_METHOD method, const uchar &amp;data[], const uchar &amp;key[], uchar &amp;result[])</span></p>
<p class="p_Text"><span class="f_Text">Encryption methods also require passing a byte array </span><span class="f_Text" style="font-style: italic;">key</span><span class="f_Text"> with a private (secret) key: its length depends on the specific method and is specified in the ENUM_CRYPT_METHOD method table in the previous section. If the size of the </span><span class="f_Text" style="font-style: italic;">key</span><span class="f_Text"> array is larger, only the first bytes in the required quantity will still be used for the key.</span></p>
<p class="p_Text"><span class="f_Text">A key is not needed for hashing or compression, but there is one caveat for CRYPT_ARCH_ZIP. The fact is that the implementation of the &quot;deflate&quot; algorithm built into the terminal adds several bytes to the resulting data to control the integrity: 2 initial bytes contain the settings of the &quot;deflate&quot; algorithm, and 4 bytes at the end contain the Adler32 checksum. Because of this feature, the resulting packed container differs from the one generated by ZIP archives for each individual element of the archive (the ZIP standard stores CRC32, which is similar in meaning, in its headers). Therefore, in order to be able to create and read compatible ZIP archives based on data packed by the </span><span class="f_Text" style="font-style: italic;">CryptEncode</span><span class="f_Text"> function, MQL5 allows you to disable your own integrity check and the generation of extra bytes using a special value in the </span><span class="f_Text" style="font-style: italic;">key</span><span class="f_Text"> array.</span></p>
<div style="text-align: left; text-indent: 0; line-height: 1.0; page-break-inside: avoid; page-break-after: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0 0 0 0; margin: 2px 17px 2px 17px;"><table cellspacing="0" cellpadding="3" border="0" style="text-align: justify;border:none; border-spacing:0;">
<tr>
<td style="vertical-align:top; padding:3px; border:none"><p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample" style="color: #0000ff;">uchar</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #333333;">key</span><span class="f_CodeExample">[]&nbsp;=&nbsp;{</span><span class="f_CodeExample" style="color: #333333;">1</span><span class="f_CodeExample">,&nbsp;</span><span class="f_CodeExample" style="color: #333333;">0</span><span class="f_CodeExample">,&nbsp;</span><span class="f_CodeExample" style="color: #333333;">0</span><span class="f_CodeExample">,&nbsp;</span><span class="f_CodeExample" style="color: #333333;">0</span><span class="f_CodeExample">};</span>
<br><span class="f_CodeExample" style="color: #0000ff;">CryptEncode</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #ff0000;">CRYPT_ARCH_ZIP</span><span class="f_CodeExample">,&nbsp;</span><span class="f_CodeExample" style="color: #333333;">data</span><span class="f_CodeExample">,&nbsp;</span><span class="f_CodeExample" style="color: #333333;">key</span><span class="f_CodeExample">,&nbsp;</span><span class="f_CodeExample" style="color: #333333;">result</span><span class="f_CodeExample">);</span></p>
</td>
</tr>
</table>
</div>
<p class="p_Text"><span class="f_Text">Any key with a length of at least 4 bytes can be used. The obtained </span><span class="f_Text" style="font-style: italic;">result</span><span class="f_Text"> array can be enriched with a title according to the standard ZIP format (this question is out of the scope of the book) to create an archive accessible to other programs.</span></p>
<p class="p_Text"><span class="f_Text">The function returns the number of bytes placed in the destination array or 0 on error. The error code, as usual, will be stored in </span><span class="f_Text" style="font-style: italic;">_LastError</span><span class="f_Text">.</span></p>
<p class="p_Text"><span class="f_Text">Let's check the function performance using the script </span><span class="f_Text" style="font-style: italic;">CryptEncode.mq5</span><span class="f_Text">. It allows the user to enter text (</span><span class="f_Text" style="font-style: italic;">Text</span><span class="f_Text">) or specify a file (</span><span class="f_Text" style="font-style: italic;">File</span><span class="f_Text">) for processing. To use the file, you need to clear the </span><span class="f_Text" style="font-style: italic;">Text</span><span class="f_Text"> field.</span></p>
<p class="p_Text"><span class="f_Text">You can choose a specific </span><span class="f_Text" style="font-style: italic;">Method</span><span class="f_Text"> or loop through all the methods at once to visually see and compare different results. For such a review loop, leave the default value _CRYPT_ALL in the </span><span class="f_Text" style="font-style: italic;">Method</span><span class="f_Text"> parameter.</span></p>
<p class="p_Text"><span class="f_Text">By the way, to introduce such functionality, we again needed to extend the standard enumeration (this time ENUM_CRYPT_METHOD), but since enumerations in MQL5 cannot be inherited as classes, a new enumeration ENUM_CRYPT_METHOD_EXT is actually declared here. An added bonus of this is that we have added friendlier names for the elements (in the comments, with hints that will be displayed in the settings dialog).</span></p>
<div style="text-align: left; text-indent: 0; line-height: 1.0; page-break-inside: avoid; page-break-after: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0 0 0 0; margin: 2px 17px 2px 17px;"><table cellspacing="0" cellpadding="3" border="0" style="text-align: justify;border:none; border-spacing:0;">
<tr>
<td style="vertical-align:top; padding:3px; border:none"><p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample" style="color: #0000ff;">enum</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #333333;">ENUM_CRYPT_METHOD_EXT</span>
<br><span class="f_CodeExample">{</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">_CRYPT_ALL</span><span class="f_CodeExample">&nbsp;=&nbsp;</span><span class="f_CodeExample" style="color: #333333;">0xFF</span><span class="f_CodeExample">,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #808080;">//&nbsp;Try&nbsp;All&nbsp;in&nbsp;a&nbsp;Loop</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">_CRYPT_DES</span><span class="f_CodeExample">&nbsp;=&nbsp;</span><span class="f_CodeExample" style="color: #ff0000;">CRYPT_DES</span><span class="f_CodeExample">,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #808080;">//&nbsp;DES&nbsp;&nbsp;&nbsp;&nbsp;(key&nbsp;required,&nbsp;7&nbsp;bytes)</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">_CRYPT_AES128</span><span class="f_CodeExample">&nbsp;=&nbsp;</span><span class="f_CodeExample" style="color: #ff0000;">CRYPT_AES128</span><span class="f_CodeExample">,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #808080;">//&nbsp;AES128&nbsp;(key&nbsp;required,&nbsp;16&nbsp;bytes)</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">_CRYPT_AES256</span><span class="f_CodeExample">&nbsp;=&nbsp;</span><span class="f_CodeExample" style="color: #ff0000;">CRYPT_AES256</span><span class="f_CodeExample">,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #808080;">//&nbsp;AES256&nbsp;(key&nbsp;required,&nbsp;32&nbsp;bytes)</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">_CRYPT_HASH_MD5</span><span class="f_CodeExample">&nbsp;=&nbsp;</span><span class="f_CodeExample" style="color: #ff0000;">CRYPT_HASH_MD5</span><span class="f_CodeExample">,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #808080;">//&nbsp;MD5</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">_CRYPT_HASH_SHA1</span><span class="f_CodeExample">&nbsp;=&nbsp;</span><span class="f_CodeExample" style="color: #ff0000;">CRYPT_HASH_SHA1</span><span class="f_CodeExample">,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #808080;">//&nbsp;SHA1</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">_CRYPT_HASH_SHA256</span><span class="f_CodeExample">&nbsp;=&nbsp;</span><span class="f_CodeExample" style="color: #ff0000;">CRYPT_HASH_SHA256</span><span class="f_CodeExample">,&nbsp;</span><span class="f_CodeExample" style="color: #808080;">//&nbsp;SHA256</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">_CRYPT_ARCH_ZIP</span><span class="f_CodeExample">&nbsp;=&nbsp;</span><span class="f_CodeExample" style="color: #ff0000;">CRYPT_ARCH_ZIP</span><span class="f_CodeExample">,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #808080;">//&nbsp;ZIP</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">_CRYPT_BASE64</span><span class="f_CodeExample">&nbsp;=&nbsp;</span><span class="f_CodeExample" style="color: #ff0000;">CRYPT_BASE64</span><span class="f_CodeExample">,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #808080;">//&nbsp;BASE64</span>
<br><span class="f_CodeExample">};</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span>
<br><span class="f_CodeExample" style="color: #0000ff;">input</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">string</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #333333;">Text</span><span class="f_CodeExample">&nbsp;=&nbsp;</span><span class="f_CodeExample" style="color: #008080;">&quot;Let's&nbsp;encrypt&nbsp;this&nbsp;message&quot;</span><span class="f_CodeExample">;&nbsp;</span><span class="f_CodeExample" style="color: #808080;">//&nbsp;Text&nbsp;(empty&nbsp;to&nbsp;process&nbsp;File)</span>
<br><span class="f_CodeExample" style="color: #0000ff;">input</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">string</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #333333;">File</span><span class="f_CodeExample">&nbsp;=&nbsp;</span><span class="f_CodeExample" style="color: #008080;">&quot;MQL5Book/clock10.htm&quot;</span><span class="f_CodeExample">;&nbsp;</span><span class="f_CodeExample" style="color: #808080;">//&nbsp;File&nbsp;(used&nbsp;only&nbsp;if&nbsp;Text&nbsp;is&nbsp;empty)</span>
<br><span class="f_CodeExample" style="color: #0000ff;">input</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #333333;">ENUM_CRYPT_METHOD_EXT</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #333333;">Method</span><span class="f_CodeExample">&nbsp;=&nbsp;</span><span class="f_CodeExample" style="color: #333333;">_CRYPT_ALL</span><span class="f_CodeExample">;</span></p>
</td>
</tr>
</table>
</div>
<p class="p_Text"><span class="f_Text">By default, the </span><span class="f_Text" style="font-style: italic;">Text</span><span class="f_Text"> parameter is filled with a message that is supposed to be encrypted. You can replace it with your own. If we clear </span><span class="f_Text" style="font-style: italic;">Text</span><span class="f_Text">, the program will process the file. At least one of the parameters (</span><span class="f_Text" style="font-style: italic;">Text</span><span class="f_Text"> or </span><span class="f_Text" style="font-style: italic;">File</span><span class="f_Text">) should contain information.</span></p>
<p class="p_Text"><span class="f_Text">Since encryption requires a key, the other two options allow you to enter it directly as text (although the key does not have to be text and can contain any binary data, but they are not supported in inputs) or generate the desired length, depending on the encryption method.</span></p>
<div style="text-align: left; text-indent: 0; line-height: 1.0; page-break-inside: avoid; page-break-after: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0 0 0 0; margin: 2px 17px 2px 17px;"><table cellspacing="0" cellpadding="3" border="0" style="text-align: justify;border:none; border-spacing:0;">
<tr>
<td style="vertical-align:top; padding:3px; border:none"><p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample" style="color: #0000ff;">enum</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #333333;">DUMMY_KEY_LENGTH</span>
<br><span class="f_CodeExample">{</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">DUMMY_KEY_0</span><span class="f_CodeExample">&nbsp;=&nbsp;</span><span class="f_CodeExample" style="color: #333333;">0</span><span class="f_CodeExample">,&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #808080;">//&nbsp;0&nbsp;bytes&nbsp;(no&nbsp;key)</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">DUMMY_KEY_7</span><span class="f_CodeExample">&nbsp;=&nbsp;</span><span class="f_CodeExample" style="color: #333333;">7</span><span class="f_CodeExample">,&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #808080;">//&nbsp;7&nbsp;bytes&nbsp;(sufficient&nbsp;for&nbsp;DES)</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">DUMMY_KEY_16</span><span class="f_CodeExample">&nbsp;=&nbsp;</span><span class="f_CodeExample" style="color: #333333;">16</span><span class="f_CodeExample">,&nbsp;</span><span class="f_CodeExample" style="color: #808080;">//&nbsp;16&nbsp;bytes&nbsp;(sufficient&nbsp;for&nbsp;AES128)</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">DUMMY_KEY_32</span><span class="f_CodeExample">&nbsp;=&nbsp;</span><span class="f_CodeExample" style="color: #333333;">32</span><span class="f_CodeExample">,&nbsp;</span><span class="f_CodeExample" style="color: #808080;">//&nbsp;32&nbsp;bytes&nbsp;(sufficient&nbsp;for&nbsp;AES256)</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">DUMMY_KEY_CUSTOM</span><span class="f_CodeExample">,&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #808080;">//&nbsp;use&nbsp;CustomKey</span>
<br><span class="f_CodeExample">};</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span>
<br><span class="f_CodeExample" style="color: #0000ff;">input</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #333333;">DUMMY_KEY_LENGTH</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #333333;">GenerateKey</span><span class="f_CodeExample">&nbsp;=&nbsp;</span><span class="f_CodeExample" style="color: #333333;">DUMMY_KEY_CUSTOM</span><span class="f_CodeExample">;&nbsp;</span><span class="f_CodeExample" style="color: #808080;">//&nbsp;GenerateKey&nbsp;(length,&nbsp;or&nbsp;from&nbsp;CustomKey)</span>
<br><span class="f_CodeExample" style="color: #0000ff;">input</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">string</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #333333;">CustomKey</span><span class="f_CodeExample">&nbsp;=&nbsp;</span><span class="f_CodeExample" style="color: #008080;">&quot;My&nbsp;top&nbsp;secret&nbsp;key&nbsp;is&nbsp;very&nbsp;strong&quot;</span><span class="f_CodeExample">;</span></p>
</td>
</tr>
</table>
</div>
<p class="p_Text"><span class="f_Text">Finally, there is an option </span><span class="f_Text" style="font-style: italic;">DisableCRCinZIP</span><span class="f_Text"> to enable ZIP compatibility mode, which only affects the CRYPT_ARCH_ZIP method.</span></p>
<div style="text-align: left; text-indent: 0; line-height: 1.0; page-break-inside: avoid; page-break-after: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0 0 0 0; margin: 2px 17px 2px 17px;"><table cellspacing="0" cellpadding="3" border="0" style="text-align: justify;border:none; border-spacing:0;">
<tr>
<td style="vertical-align:top; padding:3px; border:none"><p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample" style="color: #0000ff;">input</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">bool</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #333333;">DisableCRCinZIP</span><span class="f_CodeExample">&nbsp;=&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">false</span><span class="f_CodeExample">;</span></p>
</td>
</tr>
</table>
</div>
<p class="p_Text"><span class="f_Text">To simplify checks of whether the method requires an encryption key or a hash is calculated (an irreversible one-way conversion), 2 macros are defined.</span></p>
<div style="text-align: left; text-indent: 0; line-height: 1.0; page-break-inside: avoid; page-break-after: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0 0 0 0; margin: 2px 17px 2px 17px;"><table cellspacing="0" cellpadding="3" border="0" style="text-align: justify;border:none; border-spacing:0;">
<tr>
<td style="vertical-align:top; padding:3px; border:none"><p class="p_CodeExampleCondensed" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExampleCondensed" style="color: #0000ff;">#define</span><span class="f_CodeExampleCondensed" style="color: #000000;">&nbsp;</span><span class="f_CodeExampleCondensed" style="color: #ff0000;">KEY_REQUIRED</span><span class="f_CodeExampleCondensed" style="color: #000000;">(</span><span class="f_CodeExampleCondensed" style="color: #333333;">C</span><span class="f_CodeExampleCondensed" style="color: #000000;">)&nbsp;((</span><span class="f_CodeExampleCondensed" style="color: #333333;">C</span><span class="f_CodeExampleCondensed" style="color: #000000;">)&nbsp;==&nbsp;</span><span class="f_CodeExampleCondensed" style="color: #ff0000;">CRYPT_DES</span><span class="f_CodeExampleCondensed" style="color: #000000;">&nbsp;||&nbsp;(</span><span class="f_CodeExampleCondensed" style="color: #333333;">C</span><span class="f_CodeExampleCondensed" style="color: #000000;">)&nbsp;==&nbsp;</span><span class="f_CodeExampleCondensed" style="color: #ff0000;">CRYPT_AES128</span><span class="f_CodeExampleCondensed" style="color: #000000;">&nbsp;||&nbsp;(</span><span class="f_CodeExampleCondensed" style="color: #333333;">C</span><span class="f_CodeExampleCondensed" style="color: #000000;">)&nbsp;==&nbsp;</span><span class="f_CodeExampleCondensed" style="color: #ff0000;">CRYPT_AES256</span><span class="f_CodeExampleCondensed" style="color: #000000;">)</span></p>
<p class="p_CodeExampleCondensed" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExampleCondensed" style="color: #0000ff;">#define</span><span class="f_CodeExampleCondensed" style="color: #000000;">&nbsp;</span><span class="f_CodeExampleCondensed" style="color: #ff0000;">IS_HASH</span><span class="f_CodeExampleCondensed" style="color: #000000;">(</span><span class="f_CodeExampleCondensed" style="color: #333333;">C</span><span class="f_CodeExampleCondensed" style="color: #000000;">)&nbsp;((</span><span class="f_CodeExampleCondensed" style="color: #333333;">C</span><span class="f_CodeExampleCondensed" style="color: #000000;">)&nbsp;==&nbsp;</span><span class="f_CodeExampleCondensed" style="color: #ff0000;">CRYPT_HASH_MD5</span><span class="f_CodeExampleCondensed" style="color: #000000;">&nbsp;||&nbsp;(</span><span class="f_CodeExampleCondensed" style="color: #333333;">C</span><span class="f_CodeExampleCondensed" style="color: #000000;">)&nbsp;==&nbsp;</span><span class="f_CodeExampleCondensed" style="color: #ff0000;">CRYPT_HASH_SHA1</span><span class="f_CodeExampleCondensed" style="color: #000000;">&nbsp;||&nbsp;(</span><span class="f_CodeExampleCondensed" style="color: #333333;">C</span><span class="f_CodeExampleCondensed" style="color: #000000;">)&nbsp;==&nbsp;</span><span class="f_CodeExampleCondensed" style="color: #ff0000;">CRYPT_HASH_SHA256</span><span class="f_CodeExampleCondensed" style="color: #000000;">)</span></p>
</td>
</tr>
</table>
</div>
<p class="p_Text"><span class="f_Text">The beginning of </span><span class="f_Text" style="font-style: italic;">OnStart</span><span class="f_Text"> contains a description of the required variables and arrays.</span></p>
<div style="text-align: left; text-indent: 0; line-height: 1.0; page-break-inside: avoid; page-break-after: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0 0 0 0; margin: 2px 17px 2px 17px;"><table cellspacing="0" cellpadding="3" border="0" style="text-align: justify;border:none; border-spacing:0;">
<tr>
<td style="vertical-align:top; padding:3px; border:none"><p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample" style="color: #0000ff;">void</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">OnStart</span><span class="f_CodeExample">()</span>
<br><span class="f_CodeExample">{</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">ENUM_CRYPT_METHOD</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #333333;">method</span><span class="f_CodeExample">&nbsp;=&nbsp;</span><span class="f_CodeExample" style="color: #333333;">0</span><span class="f_CodeExample">;</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">int</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #333333;">methods</span><span class="f_CodeExample">[];&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #808080;">//&nbsp;here&nbsp;we&nbsp;will&nbsp;collect&nbsp;all&nbsp;the&nbsp;elements&nbsp;of&nbsp;ENUM_CRYPT_METHOD&nbsp;for&nbsp;looping&nbsp;over&nbsp;them</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">uchar</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #333333;">key</span><span class="f_CodeExample">[]&nbsp;=&nbsp;{};&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #808080;">//&nbsp;empty&nbsp;by&nbsp;default:&nbsp;suitable&nbsp;for&nbsp;hashing,&nbsp;zip,&nbsp;base64</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">uchar</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #333333;">zip</span><span class="f_CodeExample">[],&nbsp;</span><span class="f_CodeExample" style="color: #333333;">opt</span><span class="f_CodeExample">[]&nbsp;=&nbsp;{</span><span class="f_CodeExample" style="color: #333333;">1</span><span class="f_CodeExample">,&nbsp;</span><span class="f_CodeExample" style="color: #333333;">0</span><span class="f_CodeExample">,&nbsp;</span><span class="f_CodeExample" style="color: #333333;">0</span><span class="f_CodeExample">,&nbsp;</span><span class="f_CodeExample" style="color: #333333;">0</span><span class="f_CodeExample">};&nbsp;</span><span class="f_CodeExample" style="color: #808080;">//&nbsp;&quot;options&quot;&nbsp;for&nbsp;zip</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">uchar</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #333333;">data</span><span class="f_CodeExample">[],&nbsp;</span><span class="f_CodeExample" style="color: #333333;">result</span><span class="f_CodeExample">[];&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #808080;">//&nbsp;initial&nbsp;data&nbsp;and&nbsp;result</span></p>
</td>
</tr>
</table>
</div>
<p class="p_Text"><span class="f_Text">According to </span><span class="f_Text" style="font-style: italic;">GenerateKey</span><span class="f_Text"> settings, we get the key from the </span><span class="f_Text" style="font-style: italic;">CustomKey</span><span class="f_Text"> field or just populate the </span><span class="f_Text" style="font-style: italic;">key</span><span class="f_Text"> array with monotonically increasing integer values. In reality, the key should be a secret; non-trivial, arbitrarily chosen block of values.</span></p>
<div style="text-align: left; text-indent: 0; line-height: 1.0; page-break-inside: avoid; page-break-after: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0 0 0 0; margin: 2px 17px 2px 17px;"><table cellspacing="0" cellpadding="3" border="0" style="text-align: justify;border:none; border-spacing:0;">
<tr>
<td style="vertical-align:top; padding:3px; border:none"><p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">if</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #333333;">GenerateKey</span><span class="f_CodeExample">&nbsp;==&nbsp;</span><span class="f_CodeExample" style="color: #333333;">DUMMY_KEY_CUSTOM</span><span class="f_CodeExample">)</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;{</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">if</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #0000ff;">StringLen</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #333333;">CustomKey</span><span class="f_CodeExample">))</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #ff0000;">PRTF</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #333333;">CustomKey</span><span class="f_CodeExample">);</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">StringToCharArray</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #333333;">CustomKey</span><span class="f_CodeExample">,&nbsp;</span><span class="f_CodeExample" style="color: #333333;">key</span><span class="f_CodeExample">,&nbsp;</span><span class="f_CodeExample" style="color: #333333;">0</span><span class="f_CodeExample">,&nbsp;-1,&nbsp;</span><span class="f_CodeExample" style="color: #ff0000;">CP_UTF8</span><span class="f_CodeExample">);</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">ArrayResize</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #333333;">key</span><span class="f_CodeExample">,&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">ArraySize</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #333333;">key</span><span class="f_CodeExample">)&nbsp;-&nbsp;</span><span class="f_CodeExample" style="color: #333333;">1</span><span class="f_CodeExample">);</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;}</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">else</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">if</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #333333;">GenerateKey</span><span class="f_CodeExample">&nbsp;!=&nbsp;</span><span class="f_CodeExample" style="color: #333333;">DUMMY_KEY_0</span><span class="f_CodeExample">)</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;{</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">ArrayResize</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #333333;">key</span><span class="f_CodeExample">,&nbsp;</span><span class="f_CodeExample" style="color: #333333;">GenerateKey</span><span class="f_CodeExample">);</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">for</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #0000ff;">int</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #333333;">i</span><span class="f_CodeExample">&nbsp;=&nbsp;</span><span class="f_CodeExample" style="color: #333333;">0</span><span class="f_CodeExample">;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">i</span><span class="f_CodeExample">&nbsp;&lt;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">GenerateKey</span><span class="f_CodeExample">;&nbsp;++</span><span class="f_CodeExample" style="color: #333333;">i</span><span class="f_CodeExample">)&nbsp;</span><span class="f_CodeExample" style="color: #333333;">key</span><span class="f_CodeExample">[</span><span class="f_CodeExample" style="color: #333333;">i</span><span class="f_CodeExample">]&nbsp;=&nbsp;(</span><span class="f_CodeExample" style="color: #0000ff;">uchar</span><span class="f_CodeExample">)</span><span class="f_CodeExample" style="color: #333333;">i</span><span class="f_CodeExample">;</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;}</span></p>
</td>
</tr>
</table>
</div>
<p class="p_Text"><span class="f_Text">Here and below, please note the use of </span><span class="f_Text" style="font-style: italic;">ArrayResize</span><span class="f_Text"> after </span><span class="f_Text" style="font-style: italic;">StringToCharArray</span><span class="f_Text">. Be sure to reduce the array by 1 element, because in case the function </span><span class="f_Text" style="font-style: italic;">StringToCharArray</span><span class="f_Text"> converts the string to an array of bytes, including the terminal 0, this can break the expected execution of the program. In particular, in this case, we will have an extra zero byte in the secret key, and if a program with a similar artifact is not used on the receiving side, then it will not be able to decrypt the message. Such extra zeros can also affect compatibility with data exchange protocols (if one or another integration of an MQL program with the &quot;outside world&quot; is performed).</span></p>
<p class="p_Text"><span class="f_Text">Next, we log a raw representation of the resulting key in hexadecimal format: this is done by the </span><span class="f_Text" style="font-style: italic;">ByteArrayPrint</span><span class="f_Text"> function which was used in the section <a href="4_5_2_files_save_load.htm" class="topiclink">Writing and reading files in simplified mode</a>.</span></p>
<div style="text-align: left; text-indent: 0; line-height: 1.0; page-break-inside: avoid; page-break-after: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0 0 0 0; margin: 2px 17px 2px 17px;"><table cellspacing="0" cellpadding="3" border="0" style="text-align: justify;border:none; border-spacing:0;">
<tr>
<td style="vertical-align:top; padding:3px; border:none"><p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">if</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #0000ff;">ArraySize</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #333333;">key</span><span class="f_CodeExample">))</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;&nbsp;</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">Print</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #008080;">&quot;Key&nbsp;(bytes):&quot;</span><span class="f_CodeExample">);</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">ByteArrayPrint</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #333333;">key</span><span class="f_CodeExample">);</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;}</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">else</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;{</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">Print</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #008080;">&quot;Key&nbsp;is&nbsp;not&nbsp;provided&quot;</span><span class="f_CodeExample">);</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;}</span></p>
</td>
</tr>
</table>
</div>
<p class="p_Text"><span class="f_Text">Subject to the availability of </span><span class="f_Text" style="font-style: italic;">Text</span><span class="f_Text"> or </span><span class="f_Text" style="font-style: italic;">File</span><span class="f_Text">, we populate the </span><span class="f_Text" style="font-style: italic;">data</span><span class="f_Text"> array either with text characters or with file contents.</span></p>
<div style="text-align: left; text-indent: 0; line-height: 1.0; page-break-inside: avoid; page-break-after: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0 0 0 0; margin: 2px 17px 2px 17px;"><table cellspacing="0" cellpadding="3" border="0" style="text-align: justify;border:none; border-spacing:0;">
<tr>
<td style="vertical-align:top; padding:3px; border:none"><p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">if</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #0000ff;">StringLen</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #333333;">Text</span><span class="f_CodeExample">))</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;{</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #ff0000;">PRTF</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #333333;">Text</span><span class="f_CodeExample">);</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #ff0000;">PRTF</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #0000ff;">StringToCharArray</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #333333;">Text</span><span class="f_CodeExample">,&nbsp;</span><span class="f_CodeExample" style="color: #333333;">data</span><span class="f_CodeExample">,&nbsp;</span><span class="f_CodeExample" style="color: #333333;">0</span><span class="f_CodeExample">,&nbsp;-1,&nbsp;</span><span class="f_CodeExample" style="color: #ff0000;">CP_UTF8</span><span class="f_CodeExample">));</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">ArrayResize</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #333333;">data</span><span class="f_CodeExample">,&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">ArraySize</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #333333;">data</span><span class="f_CodeExample">)&nbsp;-&nbsp;</span><span class="f_CodeExample" style="color: #333333;">1</span><span class="f_CodeExample">);</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;}</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">else</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">if</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #0000ff;">StringLen</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #333333;">File</span><span class="f_CodeExample">))</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;{</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #ff0000;">PRTF</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #333333;">File</span><span class="f_CodeExample">);</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">if</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #ff0000;">PRTF</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #0000ff;">FileLoad</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #333333;">File</span><span class="f_CodeExample">,&nbsp;</span><span class="f_CodeExample" style="color: #333333;">data</span><span class="f_CodeExample">))&nbsp;&lt;=&nbsp;</span><span class="f_CodeExample" style="color: #333333;">0</span><span class="f_CodeExample">)</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">return</span><span class="f_CodeExample">;&nbsp;</span><span class="f_CodeExample" style="color: #808080;">//&nbsp;error</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;}</span></p>
</td>
</tr>
</table>
</div>
<p class="p_Text"><span class="f_Text">Finally, we loop through all the methods or perform the transformation once with a specific method.</span></p>
<div style="text-align: left; text-indent: 0; line-height: 1.0; page-break-inside: avoid; page-break-after: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0 0 0 0; margin: 2px 17px 2px 17px;"><table cellspacing="0" cellpadding="3" border="0" style="text-align: justify;border:none; border-spacing:0;">
<tr>
<td style="vertical-align:top; padding:3px; border:none"><p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">const</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">int</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #333333;">n</span><span class="f_CodeExample">&nbsp;=&nbsp;(</span><span class="f_CodeExample" style="color: #333333;">Method</span><span class="f_CodeExample">&nbsp;==&nbsp;</span><span class="f_CodeExample" style="color: #333333;">_CRYPT_ALL</span><span class="f_CodeExample">)&nbsp;?</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">EnumToArray</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #333333;">method</span><span class="f_CodeExample">,&nbsp;</span><span class="f_CodeExample" style="color: #333333;">methods</span><span class="f_CodeExample">,&nbsp;</span><span class="f_CodeExample" style="color: #333333;">0</span><span class="f_CodeExample">,&nbsp;</span><span class="f_CodeExample" style="color: #ff0000;">UCHAR_MAX</span><span class="f_CodeExample">)&nbsp;:&nbsp;</span><span class="f_CodeExample" style="color: #333333;">1</span><span class="f_CodeExample">;</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">ResetLastError</span><span class="f_CodeExample">();</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">for</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #0000ff;">int</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #333333;">i</span><span class="f_CodeExample">&nbsp;=&nbsp;</span><span class="f_CodeExample" style="color: #333333;">0</span><span class="f_CodeExample">;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">i</span><span class="f_CodeExample">&nbsp;&lt;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">n</span><span class="f_CodeExample">;&nbsp;++</span><span class="f_CodeExample" style="color: #333333;">i</span><span class="f_CodeExample">)</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;{</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">method</span><span class="f_CodeExample">&nbsp;=&nbsp;(</span><span class="f_CodeExample" style="color: #ff0000;">ENUM_CRYPT_METHOD</span><span class="f_CodeExample">)((</span><span class="f_CodeExample" style="color: #333333;">Method</span><span class="f_CodeExample">&nbsp;==&nbsp;</span><span class="f_CodeExample" style="color: #333333;">_CRYPT_ALL</span><span class="f_CodeExample">)&nbsp;?&nbsp;</span><span class="f_CodeExample" style="color: #333333;">methods</span><span class="f_CodeExample">[</span><span class="f_CodeExample" style="color: #333333;">i</span><span class="f_CodeExample">]&nbsp;:&nbsp;</span><span class="f_CodeExample" style="color: #333333;">Method</span><span class="f_CodeExample">);</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">Print</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #008080;">&quot;-&nbsp;&quot;</span><span class="f_CodeExample">,&nbsp;</span><span class="f_CodeExample" style="color: #333333;">i</span><span class="f_CodeExample">,&nbsp;</span><span class="f_CodeExample" style="color: #008080;">&quot;&nbsp;&quot;</span><span class="f_CodeExample">,&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">EnumToString</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #333333;">method</span><span class="f_CodeExample">),&nbsp;</span><span class="f_CodeExample" style="color: #008080;">&quot;,&nbsp;key&nbsp;required:&nbsp;&quot;</span><span class="f_CodeExample">,</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #ff0000;">KEY_REQUIRED</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #333333;">method</span><span class="f_CodeExample">));</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">if</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #333333;">method</span><span class="f_CodeExample">&nbsp;==&nbsp;</span><span class="f_CodeExample" style="color: #ff0000;">CRYPT_ARCH_ZIP</span><span class="f_CodeExample">)</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">if</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #333333;">DisableCRCinZIP</span><span class="f_CodeExample">)</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">ArrayCopy</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #333333;">zip</span><span class="f_CodeExample">,&nbsp;</span><span class="f_CodeExample" style="color: #333333;">opt</span><span class="f_CodeExample">);&nbsp;</span><span class="f_CodeExample" style="color: #808080;">//&nbsp;array&nbsp;with&nbsp;additional&nbsp;option&nbsp;dynamic&nbsp;for&nbsp;ArraySwap</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">ArraySwap</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #333333;">key</span><span class="f_CodeExample">,&nbsp;</span><span class="f_CodeExample" style="color: #333333;">zip</span><span class="f_CodeExample">);&nbsp;</span><span class="f_CodeExample" style="color: #808080;">//&nbsp;change&nbsp;key&nbsp;to&nbsp;empty&nbsp;or&nbsp;option</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">if</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #ff0000;">PRTF</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #0000ff;">CryptEncode</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #333333;">method</span><span class="f_CodeExample">,&nbsp;</span><span class="f_CodeExample" style="color: #333333;">data</span><span class="f_CodeExample">,&nbsp;</span><span class="f_CodeExample" style="color: #333333;">key</span><span class="f_CodeExample">,&nbsp;</span><span class="f_CodeExample" style="color: #333333;">result</span><span class="f_CodeExample">)))</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">if</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #0000ff;">StringLen</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #333333;">Text</span><span class="f_CodeExample">))</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #808080;">//&nbsp;code&nbsp;page&nbsp;Latin&nbsp;(Western)&nbsp;to&nbsp;unify&nbsp;the&nbsp;display&nbsp;for&nbsp;all&nbsp;users</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">Print</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #0000ff;">CharArrayToString</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #333333;">result</span><span class="f_CodeExample">,&nbsp;</span><span class="f_CodeExample" style="color: #333333;">0</span><span class="f_CodeExample">,&nbsp;</span><span class="f_CodeExample" style="color: #ff0000;">WHOLE_ARRAY</span><span class="f_CodeExample">,&nbsp;</span><span class="f_CodeExample" style="color: #333333;">1252</span><span class="f_CodeExample">));</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">ByteArrayPrint</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #333333;">result</span><span class="f_CodeExample">);</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">if</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #333333;">method</span><span class="f_CodeExample">&nbsp;!=&nbsp;</span><span class="f_CodeExample" style="color: #ff0000;">CRYPT_BASE64</span><span class="f_CodeExample">)</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">const</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">uchar</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #333333;">dummy</span><span class="f_CodeExample">[]&nbsp;=&nbsp;{};</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">uchar</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #333333;">readable</span><span class="f_CodeExample">[];</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">if</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #ff0000;">PRTF</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #0000ff;">CryptEncode</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #ff0000;">CRYPT_BASE64</span><span class="f_CodeExample">,&nbsp;</span><span class="f_CodeExample" style="color: #333333;">result</span><span class="f_CodeExample">,&nbsp;</span><span class="f_CodeExample" style="color: #333333;">dummy</span><span class="f_CodeExample">,&nbsp;</span><span class="f_CodeExample" style="color: #333333;">readable</span><span class="f_CodeExample">)))</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">PrintFormat</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #008080;">&quot;Try&nbsp;to&nbsp;decode&nbsp;this&nbsp;with&nbsp;CryptDecode.mq5&nbsp;(%s):&quot;</span><span class="f_CodeExample">,</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">EnumToString</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #333333;">method</span><span class="f_CodeExample">));</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #808080;">//&nbsp;to&nbsp;receive&nbsp;encoded&nbsp;data&nbsp;back&nbsp;for&nbsp;decoding</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #808080;">//&nbsp;via&nbsp;string&nbsp;input,&nbsp;apply&nbsp;Base64&nbsp;over&nbsp;binary&nbsp;result</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">Print</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #008080;">&quot;base64:'&quot;</span><span class="f_CodeExample">&nbsp;+&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">CharArrayToString</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #333333;">readable</span><span class="f_CodeExample">,&nbsp;</span><span class="f_CodeExample" style="color: #333333;">0</span><span class="f_CodeExample">,&nbsp;</span><span class="f_CodeExample" style="color: #ff0000;">WHOLE_ARRAY</span><span class="f_CodeExample">,&nbsp;</span><span class="f_CodeExample" style="color: #333333;">1252</span><span class="f_CodeExample">)&nbsp;+&nbsp;</span><span class="f_CodeExample" style="color: #008080;">&quot;'&quot;</span><span class="f_CodeExample">);</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">else</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">string</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #333333;">parts</span><span class="f_CodeExample">[];</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">const</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">string</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #333333;">filename</span><span class="f_CodeExample">&nbsp;=&nbsp;</span><span class="f_CodeExample" style="color: #333333;">File</span><span class="f_CodeExample">&nbsp;+&nbsp;</span><span class="f_CodeExample" style="color: #008080;">&quot;.&quot;</span><span class="f_CodeExample">&nbsp;+</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">parts</span><span class="f_CodeExample">[</span><span class="f_CodeExample" style="color: #0000ff;">StringSplit</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #0000ff;">EnumToString</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #333333;">method</span><span class="f_CodeExample">),&nbsp;'</span><span class="f_CodeExample" style="color: #333333;">_</span><span class="f_CodeExample">',&nbsp;</span><span class="f_CodeExample" style="color: #333333;">parts</span><span class="f_CodeExample">)&nbsp;-&nbsp;</span><span class="f_CodeExample" style="color: #333333;">1</span><span class="f_CodeExample">];</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">if</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #ff0000;">PRTF</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #0000ff;">FileSave</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #333333;">filename</span><span class="f_CodeExample">,&nbsp;</span><span class="f_CodeExample" style="color: #333333;">result</span><span class="f_CodeExample">)))</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">Print</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #008080;">&quot;File&nbsp;saved:&nbsp;&quot;</span><span class="f_CodeExample">,&nbsp;</span><span class="f_CodeExample" style="color: #333333;">filename</span><span class="f_CodeExample">);</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">if</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #ff0000;">IS_HASH</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #333333;">method</span><span class="f_CodeExample">))</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">ByteArrayPrint</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #333333;">result</span><span class="f_CodeExample">,&nbsp;</span><span class="f_CodeExample" style="color: #333333;">1000</span><span class="f_CodeExample">,&nbsp;</span><span class="f_CodeExample" style="color: #008080;">&quot;&quot;</span><span class="f_CodeExample">);</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;}</span>
<br><span class="f_CodeExample">}</span></p>
</td>
</tr>
</table>
</div>
<p class="p_Text"><span class="f_Text">When we convert text, we log the result, but since it is almost always binary data, with the exception of the CRYPT_BASE64 method, their display will be complete gibberish (to say the truth, binary data should not be logged, but we do this for clarity). Non-printable symbols and symbols with codes greater than 128 are displayed differently on computers with different languages. Therefore, in order to unify the display of examples for all readers, when forming a line in </span><span class="f_Text" style="font-style: italic;">CharArrayToString</span><span class="f_Text">, we use an explicit code page (1252, Western European languages). True, the fonts used when publishing a book will most likely contribute to how certain characters will be displayed (the set of glyphs in fonts may be limited).</span></p>
<p class="p_Quote"><span class="f_Quote">It is important to note that we control the choice of code page only in the display method, and the bytes in the </span><span class="f_Quote" style="font-style: italic;">result</span><span class="f_Quote"> array do not change because of this (of course, the string obtained in this way should not be sent anywhere further; it is needed only for visualization to use the bytes of the result itself for data exchange).</span></p>
<p class="p_Text"><span class="f_Text">However, it is still desirable for us to provide the user with some opportunity to save the encrypted result in order to decode it later. The simplest way is to re-transform the binary data using the CRYPT_BASE64 method.</span></p>
<p class="p_Text"><span class="f_Text">In the case of file encoding, we simply save the result in a new file with a name in which the extension of the last word in the method name is added to the original one. For example, by applying CRYPT_HASH_MD5 to the file </span><span class="f_Text" style="font-style: italic;">Example.txt</span><span class="f_Text">, we will get the output file </span><span class="f_Text" style="font-style: italic;">Example.txt.MD5</span><span class="f_Text"> containing the MD5 hash of the source file. Please note that for the CRYPT_ARCH_ZIP method, we will get a file with a ZIP extension, but it is not a standard ZIP archive (due to the lack of headers with meta information and a table of contents).</span></p>
<p class="p_Text"><span class="f_Text">Let's run the script with the default settings: they correspond to checking in the loop all methods for the text &quot;Let's encrypt this message&quot;.</span></p>
<div style="text-align: left; text-indent: 0; line-height: 1.0; page-break-inside: avoid; page-break-after: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0 0 0 0; margin: 2px 17px 2px 17px;"><table cellspacing="0" cellpadding="3" border="0" style="text-align: justify;border:none; border-spacing:0;">
<tr>
<td style="vertical-align:top; padding:3px; border:none"><p class="p_CodeExampleCondensed" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExampleCondensed">CustomKey=My&nbsp;top&nbsp;secret&nbsp;key&nbsp;is&nbsp;very&nbsp;strong&nbsp;/&nbsp;ok</span></p>
<p class="p_CodeExampleCondensed" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExampleCondensed">Key&nbsp;(bytes):</span></p>
<p class="p_CodeExampleCondensed" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExampleCondensed">[00]&nbsp;4D&nbsp;|&nbsp;79&nbsp;|&nbsp;20&nbsp;|&nbsp;74&nbsp;|&nbsp;6F&nbsp;|&nbsp;70&nbsp;|&nbsp;20&nbsp;|&nbsp;73&nbsp;|&nbsp;65&nbsp;|&nbsp;63&nbsp;|&nbsp;72&nbsp;|&nbsp;65&nbsp;|&nbsp;74&nbsp;|&nbsp;20&nbsp;|&nbsp;6B&nbsp;|&nbsp;65&nbsp;|&nbsp;</span></p>
<p class="p_CodeExampleCondensed" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExampleCondensed">[16]&nbsp;79&nbsp;|&nbsp;20&nbsp;|&nbsp;69&nbsp;|&nbsp;73&nbsp;|&nbsp;20&nbsp;|&nbsp;76&nbsp;|&nbsp;65&nbsp;|&nbsp;72&nbsp;|&nbsp;79&nbsp;|&nbsp;20&nbsp;|&nbsp;73&nbsp;|&nbsp;74&nbsp;|&nbsp;72&nbsp;|&nbsp;6F&nbsp;|&nbsp;6E&nbsp;|&nbsp;67&nbsp;|&nbsp;</span></p>
<p class="p_CodeExampleCondensed" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExampleCondensed">Text=Let's&nbsp;encrypt&nbsp;this&nbsp;message&nbsp;/&nbsp;ok</span></p>
<p class="p_CodeExampleCondensed" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExampleCondensed">StringToCharArray(Text,data,0,-1,CP_UTF8)=26&nbsp;/&nbsp;ok</span></p>
<p class="p_CodeExampleCondensed" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExampleCondensed">-&nbsp;0&nbsp;CRYPT_BASE64,&nbsp;key&nbsp;required:&nbsp;false</span></p>
<p class="p_CodeExampleCondensed" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExampleCondensed">CryptEncode(method,data,key,result)=36&nbsp;/&nbsp;ok</span></p>
<p class="p_CodeExampleCondensed" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExampleCondensed">TGV0J3MgZW5jcnlwdCB0aGlzIG1lc3NhZ2U=</span></p>
<p class="p_CodeExampleCondensed" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExampleCondensed">[00]&nbsp;54&nbsp;|&nbsp;47&nbsp;|&nbsp;56&nbsp;|&nbsp;30&nbsp;|&nbsp;4A&nbsp;|&nbsp;33&nbsp;|&nbsp;4D&nbsp;|&nbsp;67&nbsp;|&nbsp;5A&nbsp;|&nbsp;57&nbsp;|&nbsp;35&nbsp;|&nbsp;6A&nbsp;|&nbsp;63&nbsp;|&nbsp;6E&nbsp;|&nbsp;6C&nbsp;|&nbsp;77&nbsp;|&nbsp;</span></p>
<p class="p_CodeExampleCondensed" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExampleCondensed">[16]&nbsp;64&nbsp;|&nbsp;43&nbsp;|&nbsp;42&nbsp;|&nbsp;30&nbsp;|&nbsp;61&nbsp;|&nbsp;47&nbsp;|&nbsp;6C&nbsp;|&nbsp;7A&nbsp;|&nbsp;49&nbsp;|&nbsp;47&nbsp;|&nbsp;31&nbsp;|&nbsp;6C&nbsp;|&nbsp;63&nbsp;|&nbsp;33&nbsp;|&nbsp;4E&nbsp;|&nbsp;68&nbsp;|&nbsp;</span></p>
<p class="p_CodeExampleCondensed" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExampleCondensed">[32]&nbsp;5A&nbsp;|&nbsp;32&nbsp;|&nbsp;55&nbsp;|&nbsp;3D&nbsp;|&nbsp;</span></p>
<p class="p_CodeExampleCondensed" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExampleCondensed">-&nbsp;1&nbsp;CRYPT_AES128,&nbsp;key&nbsp;required:&nbsp;true</span></p>
<p class="p_CodeExampleCondensed" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExampleCondensed">CryptEncode(method,data,key,result)=32&nbsp;/&nbsp;ok</span></p>
<p class="p_CodeExampleCondensed" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExampleCondensed">&macr;T*&nbsp;&Euml;[3h&szlig;&nbsp;&Atilde;/-C&nbsp;}&not;&Ntilde;&Oslash;N&uml;&reg;&Ecirc;&nbsp;&Ntilde;</span></p>
<p class="p_CodeExampleCondensed" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExampleCondensed">[00]&nbsp;01&nbsp;|&nbsp;0B&nbsp;|&nbsp;AF&nbsp;|&nbsp;54&nbsp;|&nbsp;2A&nbsp;|&nbsp;12&nbsp;|&nbsp;CB&nbsp;|&nbsp;5B&nbsp;|&nbsp;33&nbsp;|&nbsp;68&nbsp;|&nbsp;DF&nbsp;|&nbsp;0E&nbsp;|&nbsp;C3&nbsp;|&nbsp;2F&nbsp;|&nbsp;2D&nbsp;|&nbsp;43&nbsp;|&nbsp;</span></p>
<p class="p_CodeExampleCondensed" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExampleCondensed">[16]&nbsp;19&nbsp;|&nbsp;7D&nbsp;|&nbsp;AC&nbsp;|&nbsp;8A&nbsp;|&nbsp;D1&nbsp;|&nbsp;8F&nbsp;|&nbsp;D8&nbsp;|&nbsp;4E&nbsp;|&nbsp;A8&nbsp;|&nbsp;AE&nbsp;|&nbsp;CA&nbsp;|&nbsp;81&nbsp;|&nbsp;86&nbsp;|&nbsp;06&nbsp;|&nbsp;87&nbsp;|&nbsp;D1&nbsp;|&nbsp;</span></p>
<p class="p_CodeExampleCondensed" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExampleCondensed">CryptEncode(CRYPT_BASE64,result,dummy,readable)=44&nbsp;/&nbsp;ok</span></p>
<p class="p_CodeExampleCondensed" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExampleCondensed">Try&nbsp;to&nbsp;decode&nbsp;this&nbsp;with&nbsp;CryptDecode.mq5&nbsp;(CRYPT_AES128):</span></p>
<p class="p_CodeExampleCondensed" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExampleCondensed">base64:'AQuvVCoSy1szaN8Owy8tQxl9rIrRj9hOqK7KgYYGh9E='</span></p>
<p class="p_CodeExampleCondensed" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExampleCondensed">-&nbsp;2&nbsp;CRYPT_AES256,&nbsp;key&nbsp;required:&nbsp;true</span></p>
<p class="p_CodeExampleCondensed" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExampleCondensed">CryptEncode(method,data,key,result)=32&nbsp;/&nbsp;ok</span></p>
<p class="p_CodeExampleCondensed" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExampleCondensed">&oslash;UL&raquo;&Eacute;s&euml;DC&ocirc;&nbsp;&nbsp;&not;.K)&yacute;&Aacute;&nbsp;L&aacute;&cedil;&nbsp;+&lt;&nbsp;!D&iuml;</span></p>
<p class="p_CodeExampleCondensed" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExampleCondensed">[00]&nbsp;F8&nbsp;|&nbsp;91&nbsp;|&nbsp;55&nbsp;|&nbsp;4C&nbsp;|&nbsp;BB&nbsp;|&nbsp;C9&nbsp;|&nbsp;73&nbsp;|&nbsp;EB&nbsp;|&nbsp;44&nbsp;|&nbsp;43&nbsp;|&nbsp;89&nbsp;|&nbsp;F4&nbsp;|&nbsp;06&nbsp;|&nbsp;13&nbsp;|&nbsp;AC&nbsp;|&nbsp;2E&nbsp;|&nbsp;</span></p>
<p class="p_CodeExampleCondensed" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExampleCondensed">[16]&nbsp;4B&nbsp;|&nbsp;29&nbsp;|&nbsp;8C&nbsp;|&nbsp;FD&nbsp;|&nbsp;C1&nbsp;|&nbsp;11&nbsp;|&nbsp;4C&nbsp;|&nbsp;E1&nbsp;|&nbsp;B8&nbsp;|&nbsp;05&nbsp;|&nbsp;2B&nbsp;|&nbsp;3C&nbsp;|&nbsp;14&nbsp;|&nbsp;21&nbsp;|&nbsp;44&nbsp;|&nbsp;EF&nbsp;|&nbsp;</span></p>
<p class="p_CodeExampleCondensed" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExampleCondensed">CryptEncode(CRYPT_BASE64,result,dummy,readable)=44&nbsp;/&nbsp;ok</span></p>
<p class="p_CodeExampleCondensed" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExampleCondensed">Try&nbsp;to&nbsp;decode&nbsp;this&nbsp;with&nbsp;CryptDecode.mq5&nbsp;(CRYPT_AES256):</span></p>
<p class="p_CodeExampleCondensed" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExampleCondensed">base64:'+JFVTLvJc+tEQ4n0BhOsLkspjP3BEUzhuAUrPBQhRO8='</span></p>
<p class="p_CodeExampleCondensed" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExampleCondensed">-&nbsp;3&nbsp;CRYPT_DES,&nbsp;key&nbsp;required:&nbsp;true</span></p>
<p class="p_CodeExampleCondensed" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExampleCondensed">CryptEncode(method,data,key,result)=32&nbsp;/&nbsp;ok</span></p>
<p class="p_CodeExampleCondensed" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExampleCondensed">&micro;&nbsp;b&nbsp;&amp;#&Ccedil;&Aring;+&yacute;&ordm;'&yen;&nbsp;B8f&iexcl;r&Oslash;-P&egrave;&lt;6&acirc;&igrave;&Euml;&pound;</span></p>
<p class="p_CodeExampleCondensed" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExampleCondensed">[00]&nbsp;B5&nbsp;|&nbsp;06&nbsp;|&nbsp;9D&nbsp;|&nbsp;62&nbsp;|&nbsp;11&nbsp;|&nbsp;26&nbsp;|&nbsp;93&nbsp;|&nbsp;23&nbsp;|&nbsp;C7&nbsp;|&nbsp;C5&nbsp;|&nbsp;2B&nbsp;|&nbsp;FD&nbsp;|&nbsp;BA&nbsp;|&nbsp;27&nbsp;|&nbsp;A5&nbsp;|&nbsp;10&nbsp;|&nbsp;</span></p>
<p class="p_CodeExampleCondensed" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExampleCondensed">[16]&nbsp;42&nbsp;|&nbsp;38&nbsp;|&nbsp;66&nbsp;|&nbsp;A1&nbsp;|&nbsp;72&nbsp;|&nbsp;D8&nbsp;|&nbsp;2D&nbsp;|&nbsp;50&nbsp;|&nbsp;E8&nbsp;|&nbsp;3C&nbsp;|&nbsp;36&nbsp;|&nbsp;E2&nbsp;|&nbsp;EC&nbsp;|&nbsp;82&nbsp;|&nbsp;CB&nbsp;|&nbsp;A3&nbsp;|&nbsp;</span></p>
<p class="p_CodeExampleCondensed" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExampleCondensed">CryptEncode(CRYPT_BASE64,result,dummy,readable)=44&nbsp;/&nbsp;ok</span></p>
<p class="p_CodeExampleCondensed" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExampleCondensed">Try&nbsp;to&nbsp;decode&nbsp;this&nbsp;with&nbsp;CryptDecode.mq5&nbsp;(CRYPT_DES):</span></p>
<p class="p_CodeExampleCondensed" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExampleCondensed">base64:'tQadYhEmkyPHxSv9uielEEI4ZqFy2C1Q6Dw24uyCy6M='</span></p>
<p class="p_CodeExampleCondensed" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExampleCondensed">-&nbsp;4&nbsp;CRYPT_HASH_SHA1,&nbsp;key&nbsp;required:&nbsp;false</span></p>
<p class="p_CodeExampleCondensed" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExampleCondensed">CryptEncode(method,data,key,result)=20&nbsp;/&nbsp;ok</span></p>
<p class="p_CodeExampleCondensed" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExampleCondensed">&sect;&szlig;&ouml;*&copy;&ordm;&oslash;</span></p>
<p class="p_CodeExampleCondensed" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExampleCondensed">|)b&Euml;bz&Ccedil;&Iacute;&nbsp;&Ucirc;</span></p>
<p class="p_CodeExampleCondensed" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExampleCondensed">[00]&nbsp;A7&nbsp;|&nbsp;DF&nbsp;|&nbsp;F6&nbsp;|&nbsp;2A&nbsp;|&nbsp;A9&nbsp;|&nbsp;BA&nbsp;|&nbsp;F8&nbsp;|&nbsp;0A&nbsp;|&nbsp;80&nbsp;|&nbsp;7C&nbsp;|&nbsp;29&nbsp;|&nbsp;62&nbsp;|&nbsp;CB&nbsp;|&nbsp;62&nbsp;|&nbsp;7A&nbsp;|&nbsp;C7&nbsp;|&nbsp;</span></p>
<p class="p_CodeExampleCondensed" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExampleCondensed">[16]&nbsp;CD&nbsp;|&nbsp;0E&nbsp;|&nbsp;DB&nbsp;|&nbsp;80&nbsp;|&nbsp;</span></p>
<p class="p_CodeExampleCondensed" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExampleCondensed">CryptEncode(CRYPT_BASE64,result,dummy,readable)=28&nbsp;/&nbsp;ok</span></p>
<p class="p_CodeExampleCondensed" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExampleCondensed">Try&nbsp;to&nbsp;decode&nbsp;this&nbsp;with&nbsp;CryptDecode.mq5&nbsp;(CRYPT_HASH_SHA1):</span></p>
<p class="p_CodeExampleCondensed" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExampleCondensed">base64:'p9/2Kqm6+AqAfCliy2J6x80O24A='</span></p>
<p class="p_CodeExampleCondensed" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExampleCondensed">-&nbsp;5&nbsp;CRYPT_HASH_SHA256,&nbsp;key&nbsp;required:&nbsp;false</span></p>
<p class="p_CodeExampleCondensed" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExampleCondensed">CryptEncode(method,data,key,result)=32&nbsp;/&nbsp;ok</span></p>
<p class="p_CodeExampleCondensed" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExampleCondensed">&Uacute;Z2&raquo;&frac34;7&nbsp;&nbsp;&ntilde;&Auml;&Aacute;&acute;&brvbar;ome2r@&frac34;&ocirc;&reg;&sup3;</span></p>
<p class="p_CodeExampleCondensed" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExampleCondensed">[00]&nbsp;DA&nbsp;|&nbsp;5A&nbsp;|&nbsp;32&nbsp;|&nbsp;9A&nbsp;|&nbsp;80&nbsp;|&nbsp;BB&nbsp;|&nbsp;94&nbsp;|&nbsp;BE&nbsp;|&nbsp;37&nbsp;|&nbsp;0C&nbsp;|&nbsp;80&nbsp;|&nbsp;85&nbsp;|&nbsp;07&nbsp;|&nbsp;F1&nbsp;|&nbsp;96&nbsp;|&nbsp;C4&nbsp;|&nbsp;</span></p>
<p class="p_CodeExampleCondensed" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExampleCondensed">[16]&nbsp;C1&nbsp;|&nbsp;B4&nbsp;|&nbsp;98&nbsp;|&nbsp;A6&nbsp;|&nbsp;93&nbsp;|&nbsp;6F&nbsp;|&nbsp;6D&nbsp;|&nbsp;65&nbsp;|&nbsp;32&nbsp;|&nbsp;72&nbsp;|&nbsp;40&nbsp;|&nbsp;BE&nbsp;|&nbsp;F4&nbsp;|&nbsp;AE&nbsp;|&nbsp;B3&nbsp;|&nbsp;94&nbsp;|&nbsp;</span></p>
<p class="p_CodeExampleCondensed" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExampleCondensed">CryptEncode(CRYPT_BASE64,result,dummy,readable)=44&nbsp;/&nbsp;ok</span></p>
<p class="p_CodeExampleCondensed" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExampleCondensed">Try&nbsp;to&nbsp;decode&nbsp;this&nbsp;with&nbsp;CryptDecode.mq5&nbsp;(CRYPT_HASH_SHA256):</span></p>
<p class="p_CodeExampleCondensed" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExampleCondensed">base64:'2loymoC7lL43DICFB/GWxMG0mKaTb21lMnJAvvSus5Q='</span></p>
<p class="p_CodeExampleCondensed" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExampleCondensed">-&nbsp;6&nbsp;CRYPT_HASH_MD5,&nbsp;key&nbsp;required:&nbsp;false</span></p>
<p class="p_CodeExampleCondensed" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExampleCondensed">CryptEncode(method,data,key,result)=16&nbsp;/&nbsp;ok</span></p>
<p class="p_CodeExampleCondensed" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExampleCondensed">zIGT&nbsp;&nbsp;F&ucirc;;3&thorn;&egrave;&aring;</span></p>
<p class="p_CodeExampleCondensed" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExampleCondensed">[00]&nbsp;7A&nbsp;|&nbsp;49&nbsp;|&nbsp;47&nbsp;|&nbsp;54&nbsp;|&nbsp;85&nbsp;|&nbsp;1B&nbsp;|&nbsp;7F&nbsp;|&nbsp;11&nbsp;|&nbsp;46&nbsp;|&nbsp;FB&nbsp;|&nbsp;3B&nbsp;|&nbsp;97&nbsp;|&nbsp;33&nbsp;|&nbsp;FE&nbsp;|&nbsp;E8&nbsp;|&nbsp;E5&nbsp;|&nbsp;</span></p>
<p class="p_CodeExampleCondensed" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExampleCondensed">CryptEncode(CRYPT_BASE64,result,dummy,readable)=24&nbsp;/&nbsp;ok</span></p>
<p class="p_CodeExampleCondensed" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExampleCondensed">Try&nbsp;to&nbsp;decode&nbsp;this&nbsp;with&nbsp;CryptDecode.mq5&nbsp;(CRYPT_HASH_MD5):</span></p>
<p class="p_CodeExampleCondensed" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExampleCondensed">base64:'eklHVIUbfxFG+zuXM/7o5Q=='</span></p>
<p class="p_CodeExampleCondensed" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExampleCondensed">-&nbsp;7&nbsp;CRYPT_ARCH_ZIP,&nbsp;key&nbsp;required:&nbsp;false</span></p>
<p class="p_CodeExampleCondensed" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExampleCondensed">CryptEncode(method,data,key,result)=34&nbsp;/&nbsp;ok</span></p>
<p class="p_CodeExampleCondensed" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExampleCondensed">x^&oacute;I-Q/VH&Iacute;K.&ordf;,(Q(&Eacute;&Egrave;,V&Egrave;M-.NLO&nbsp;</span></p>
<p class="p_CodeExampleCondensed" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExampleCondensed">[00]&nbsp;78&nbsp;|&nbsp;5E&nbsp;|&nbsp;F3&nbsp;|&nbsp;49&nbsp;|&nbsp;2D&nbsp;|&nbsp;51&nbsp;|&nbsp;2F&nbsp;|&nbsp;56&nbsp;|&nbsp;48&nbsp;|&nbsp;CD&nbsp;|&nbsp;4B&nbsp;|&nbsp;2E&nbsp;|&nbsp;AA&nbsp;|&nbsp;2C&nbsp;|&nbsp;28&nbsp;|&nbsp;51&nbsp;|&nbsp;</span></p>
<p class="p_CodeExampleCondensed" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExampleCondensed">[16]&nbsp;28&nbsp;|&nbsp;C9&nbsp;|&nbsp;C8&nbsp;|&nbsp;2C&nbsp;|&nbsp;56&nbsp;|&nbsp;C8&nbsp;|&nbsp;4D&nbsp;|&nbsp;2D&nbsp;|&nbsp;2E&nbsp;|&nbsp;4E&nbsp;|&nbsp;4C&nbsp;|&nbsp;4F&nbsp;|&nbsp;05&nbsp;|&nbsp;00&nbsp;|&nbsp;80&nbsp;|&nbsp;07&nbsp;|&nbsp;</span></p>
<p class="p_CodeExampleCondensed" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExampleCondensed">[32]&nbsp;09&nbsp;|&nbsp;C2&nbsp;|&nbsp;</span></p>
<p class="p_CodeExampleCondensed" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExampleCondensed">CryptEncode(CRYPT_BASE64,result,dummy,readable)=48&nbsp;/&nbsp;ok</span></p>
<p class="p_CodeExampleCondensed" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExampleCondensed">Try&nbsp;to&nbsp;decode&nbsp;this&nbsp;with&nbsp;CryptDecode.mq5&nbsp;(CRYPT_ARCH_ZIP):</span></p>
<p class="p_CodeExampleCondensed" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExampleCondensed">base64:'eF7zSS1RL1ZIzUsuqiwoUSjJyCxWyE0tLk5MTwUAgAcJwg=='</span></p>
</td>
</tr>
</table>
</div>
<p class="p_Text"><span class="f_Text">The key in this case is of sufficient length for all three encryption methods, and other methods for which it is not needed simply ignore it. Therefore, all function calls have been completed successfully.</span></p>
<p class="p_Text"><span class="f_Text">In the next section, we will learn how to decode encryptions and we can check if the </span><span class="f_Text" style="font-style: italic;">CryptDecode</span><span class="f_Text"> function returns the original message. Please note this piece of the log.</span></p>
<p class="p_Text"><span class="f_Text">The enabled </span><span class="f_Text" style="font-style: italic;">DisableCRCinZIP</span><span class="f_Text"> option will reduce the result of the CRYPT_ARCH_ZIP method by a few overhead bytes.</span></p>
<div style="text-align: left; text-indent: 0; line-height: 1.0; page-break-inside: avoid; page-break-after: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0 0 0 0; margin: 2px 17px 2px 17px;"><table cellspacing="0" cellpadding="3" border="0" style="text-align: justify;border:none; border-spacing:0;">
<tr>
<td style="vertical-align:top; padding:3px; border:none"><p class="p_CodeExampleCondensed" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExampleCondensed">-&nbsp;7&nbsp;CRYPT_ARCH_ZIP,&nbsp;key&nbsp;required:&nbsp;false</span></p>
<p class="p_CodeExampleCondensed" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExampleCondensed">CryptEncode(method,data,key,result)=28&nbsp;/&nbsp;ok</span></p>
<p class="p_CodeExampleCondensed" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExampleCondensed">&oacute;I-Q/VH&Iacute;K.&ordf;,(Q(&Eacute;&Egrave;,V&Egrave;M-.NLO&nbsp;</span></p>
<p class="p_CodeExampleCondensed" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExampleCondensed">[00]&nbsp;F3&nbsp;|&nbsp;49&nbsp;|&nbsp;2D&nbsp;|&nbsp;51&nbsp;|&nbsp;2F&nbsp;|&nbsp;56&nbsp;|&nbsp;48&nbsp;|&nbsp;CD&nbsp;|&nbsp;4B&nbsp;|&nbsp;2E&nbsp;|&nbsp;AA&nbsp;|&nbsp;2C&nbsp;|&nbsp;28&nbsp;|&nbsp;51&nbsp;|&nbsp;28&nbsp;|&nbsp;C9&nbsp;|&nbsp;</span></p>
<p class="p_CodeExampleCondensed" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExampleCondensed">[16]&nbsp;C8&nbsp;|&nbsp;2C&nbsp;|&nbsp;56&nbsp;|&nbsp;C8&nbsp;|&nbsp;4D&nbsp;|&nbsp;2D&nbsp;|&nbsp;2E&nbsp;|&nbsp;4E&nbsp;|&nbsp;4C&nbsp;|&nbsp;4F&nbsp;|&nbsp;05&nbsp;|&nbsp;00&nbsp;|&nbsp;</span></p>
<p class="p_CodeExampleCondensed" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExampleCondensed">CryptEncode(CRYPT_BASE64,result,dummy,readable)=40&nbsp;/&nbsp;ok</span></p>
<p class="p_CodeExampleCondensed" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExampleCondensed">Try&nbsp;to&nbsp;decode&nbsp;this&nbsp;with&nbsp;CryptDecode.mq5&nbsp;(CRYPT_ARCH_ZIP):</span></p>
<p class="p_CodeExampleCondensed" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExampleCondensed">base64:'80ktUS9WSM1LLqosKFEoycgsVshNLS5OTE8FAA=='</span></p>
</td>
</tr>
</table>
</div>
<p class="p_Text"><span class="f_Text">Now let's transfer the experiments on encoding to files. To do this, run the script again and erase the text from the </span><span class="f_Text" style="font-style: italic;">Text</span><span class="f_Text"> field. As a result, the program will process the file </span><span class="f_Text" style="font-style: italic;">MQL5Book/clock10.htm</span><span class="f_Text"> several times and will create several derived files with different extensions.</span></p>
<div style="text-align: left; text-indent: 0; line-height: 1.0; page-break-inside: avoid; page-break-after: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0 0 0 0; margin: 2px 17px 2px 17px;"><table cellspacing="0" cellpadding="3" border="0" style="text-align: justify;border:none; border-spacing:0;">
<tr>
<td style="vertical-align:top; padding:3px; border:none"><p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample">File=MQL5Book/clock10.htm&nbsp;/&nbsp;ok</span>
<br><span class="f_CodeExample">FileLoad(File,data)=988&nbsp;/&nbsp;ok</span>
<br><span class="f_CodeExample">-&nbsp;0&nbsp;CRYPT_BASE64,&nbsp;key&nbsp;required:&nbsp;false</span>
<br><span class="f_CodeExample">CryptEncode(method,data,key,result)=1320&nbsp;/&nbsp;ok</span>
<br><span class="f_CodeExample">FileSave(filename,result)=true&nbsp;/&nbsp;ok</span>
<br><span class="f_CodeExample">File&nbsp;saved:&nbsp;MQL5Book/clock10.htm.BASE64</span>
<br><span class="f_CodeExample">-&nbsp;1&nbsp;CRYPT_AES128,&nbsp;key&nbsp;required:&nbsp;true</span>
<br><span class="f_CodeExample">CryptEncode(method,data,key,result)=992&nbsp;/&nbsp;ok</span>
<br><span class="f_CodeExample">FileSave(filename,result)=true&nbsp;/&nbsp;ok</span>
<br><span class="f_CodeExample">File&nbsp;saved:&nbsp;MQL5Book/clock10.htm.AES128</span>
<br><span class="f_CodeExample">-&nbsp;2&nbsp;CRYPT_AES256,&nbsp;key&nbsp;required:&nbsp;true</span>
<br><span class="f_CodeExample">CryptEncode(method,data,key,result)=992&nbsp;/&nbsp;ok</span>
<br><span class="f_CodeExample">FileSave(filename,result)=true&nbsp;/&nbsp;ok</span>
<br><span class="f_CodeExample">File&nbsp;saved:&nbsp;MQL5Book/clock10.htm.AES256</span>
<br><span class="f_CodeExample">-&nbsp;3&nbsp;CRYPT_DES,&nbsp;key&nbsp;required:&nbsp;true</span>
<br><span class="f_CodeExample">CryptEncode(method,data,key,result)=992&nbsp;/&nbsp;ok</span>
<br><span class="f_CodeExample">FileSave(filename,result)=true&nbsp;/&nbsp;ok</span>
<br><span class="f_CodeExample">File&nbsp;saved:&nbsp;MQL5Book/clock10.htm.DES</span>
<br><span class="f_CodeExample">-&nbsp;4&nbsp;CRYPT_HASH_SHA1,&nbsp;key&nbsp;required:&nbsp;false</span>
<br><span class="f_CodeExample">CryptEncode(method,data,key,result)=20&nbsp;/&nbsp;ok</span>
<br><span class="f_CodeExample">FileSave(filename,result)=true&nbsp;/&nbsp;ok</span>
<br><span class="f_CodeExample">File&nbsp;saved:&nbsp;MQL5Book/clock10.htm.SHA1</span>
<br><span class="f_CodeExample">[00]&nbsp;486ADFDD071CD23AB28E820B164D813A310B213F</span>
<br><span class="f_CodeExample">-&nbsp;5&nbsp;CRYPT_HASH_SHA256,&nbsp;key&nbsp;required:&nbsp;false</span>
<br><span class="f_CodeExample">CryptEncode(method,data,key,result)=32&nbsp;/&nbsp;ok</span>
<br><span class="f_CodeExample">FileSave(filename,result)=true&nbsp;/&nbsp;ok</span>
<br><span class="f_CodeExample">File&nbsp;saved:&nbsp;MQL5Book/clock10.htm.SHA256</span>
<br><span class="f_CodeExample">[00]&nbsp;8990BBAC9C23B1F987952564EBCEF2078232D8C9D6F2CCC2A50784E8CDE044D0</span>
<br><span class="f_CodeExample">-&nbsp;6&nbsp;CRYPT_HASH_MD5,&nbsp;key&nbsp;required:&nbsp;false</span>
<br><span class="f_CodeExample">CryptEncode(method,data,key,result)=16&nbsp;/&nbsp;ok</span>
<br><span class="f_CodeExample">FileSave(filename,result)=true&nbsp;/&nbsp;ok</span>
<br><span class="f_CodeExample">File&nbsp;saved:&nbsp;MQL5Book/clock10.htm.MD5</span>
<br><span class="f_CodeExample">[00]&nbsp;0CC4FBC899554BE0C0DBF5C18748C773</span>
<br><span class="f_CodeExample">-&nbsp;7&nbsp;CRYPT_ARCH_ZIP,&nbsp;key&nbsp;required:&nbsp;false</span>
<br><span class="f_CodeExample">CryptEncode(method,data,key,result)=687&nbsp;/&nbsp;ok</span>
<br><span class="f_CodeExample">FileSave(filename,result)=true&nbsp;/&nbsp;ok</span>
<br><span class="f_CodeExample">File&nbsp;saved:&nbsp;MQL5Book/clock10.htm.ZIP</span></p>
</td>
</tr>
</table>
</div>
<p class="p_Text"><span class="f_Text">You can look inside all the files from the file manager and make sure that there is nothing left in common with the original content. Many file managers have commands or plugins to calculate hash sums so that they can be compared to MD5, SHA1, and SHA256 hex values printed out to the log.</span></p>
<p class="p_Text"><span class="f_Text">If we try to encode a text or a file without providing a key of the correct length, we will get an INVALID_ARRAY(4006) error. For example, for a default text message, we select AES256 in the </span><span class="f_Text" style="font-style: italic;">method</span><span class="f_Text"> parameter (requires a 32-byte key). Using the </span><span class="f_Text" style="font-style: italic;">GenerateKey</span><span class="f_Text"> parameter, we order a key with a length of 16 bytes (or you can partially or completely remove the text from the </span><span class="f_Text" style="font-style: italic;">CustomKey</span><span class="f_Text"> field, leaving </span><span class="f_Text" style="font-style: italic;">GenerateKey</span><span class="f_Text"> default).</span></p>
<div style="text-align: left; text-indent: 0; line-height: 1.0; page-break-inside: avoid; page-break-after: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0 0 0 0; margin: 2px 17px 2px 17px;"><table cellspacing="0" cellpadding="3" border="0" style="text-align: justify;border:none; border-spacing:0;">
<tr>
<td style="vertical-align:top; padding:3px; border:none"><p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample">Key&nbsp;(bytes):</span>
<br><span class="f_CodeExample">[00]&nbsp;00&nbsp;|&nbsp;01&nbsp;|&nbsp;02&nbsp;|&nbsp;03&nbsp;|&nbsp;04&nbsp;|&nbsp;05&nbsp;|&nbsp;06&nbsp;|&nbsp;07&nbsp;|&nbsp;08&nbsp;|&nbsp;09&nbsp;|&nbsp;0A&nbsp;|&nbsp;0B&nbsp;|&nbsp;0C&nbsp;|&nbsp;0D&nbsp;|&nbsp;0E&nbsp;|&nbsp;0F&nbsp;|&nbsp;</span>
<br><span class="f_CodeExample">Text=Let's&nbsp;encrypt&nbsp;this&nbsp;message&nbsp;/&nbsp;ok</span>
<br><span class="f_CodeExample">StringToCharArray(Text,data,0,-1,CP_UTF8)=26&nbsp;/&nbsp;ok</span>
<br><span class="f_CodeExample">-&nbsp;0&nbsp;CRYPT_AES256,&nbsp;key&nbsp;required:&nbsp;true</span>
<br><span class="f_CodeExample">CryptEncode(method,data,key,result)=0&nbsp;/&nbsp;INVALID_ARRAY(4006)</span></p>
</td>
</tr>
</table>
</div>
<p class="p_Text"><span class="f_Text">You can also compress the same file (as we did with </span><span class="f_Text" style="font-style: italic;">clock10.htm</span><span class="f_Text">) using the CRYPT_ARCH_ZIP method or using a regular archiver. If you later look with a binary viewer utility (which is usually built into the file manager), then both results will show a common packed block, and the differences will be only in the meta-data framing it.</span></p>
<p class="p_ImageCaption"><img class="help" alt="Comparison of a file compressed with the CRYPT_ARCH_ZIP method (left) and a standard ZIP archive with it (right)" title="Comparison of a file compressed with the CRYPT_ARCH_ZIP method (left) and a standard ZIP archive with it (right)" width="600" height="628" style="margin:0 auto 0 auto;width:600px;height:628px;border:none" src="zip2cmp1.png"/></p>
<p class="p_ImageCaption"><span class="f_ImageCaption">Comparison of a file compressed with the CRYPT_ARCH_ZIP method (left) and a standard ZIP archive with it (right)</span></p>
<p class="p_Text"><span class="f_Text">It shows that the middle and main part of the archive is a sequence of bytes (highlighted in dark) identical to those produced by the </span><span class="f_Text" style="font-style: italic;">CryptEncode</span><span class="f_Text"> function.</span></p>
<p class="p_Text"><span class="f_Text">Finally, we will show how the </span><span class="f_Text" style="font-style: italic;">Base64</span><span class="f_Text"> text representation of a graphic file </span><span class="f_Text" style="font-style: italic;">clock10.png</span><span class="f_Text"> was generated. To do this, clear the field </span><span class="f_Text" style="font-style: italic;">Text</span><span class="f_Text"> and write </span><span class="f_Text" style="font-style: italic;">MQL5Book/clock10.png</span><span class="f_Text"> in the </span><span class="f_Text" style="font-style: italic;">File</span><span class="f_Text"> parameter. Choose </span><span class="f_Text" style="font-style: italic;">Base64</span><span class="f_Text"> in the drop-down list </span><span class="f_Text" style="font-style: italic;">Method</span><span class="f_Text">.</span></p>
<div style="text-align: left; text-indent: 0; line-height: 1.0; page-break-inside: avoid; page-break-after: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0 0 0 0; margin: 2px 17px 2px 17px;"><table cellspacing="0" cellpadding="3" border="0" style="text-align: justify;border:none; border-spacing:0;">
<tr>
<td style="vertical-align:top; padding:3px; border:none"><p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample">File=MQL5Book/clock10.png&nbsp;/&nbsp;ok</span>
<br><span class="f_CodeExample">FileLoad(File,data)=457&nbsp;/&nbsp;ok</span>
<br><span class="f_CodeExample">-&nbsp;0&nbsp;CRYPT_BASE64,&nbsp;key&nbsp;required:&nbsp;false</span>
<br><span class="f_CodeExample">CryptEncode(method,data,key,result)=612&nbsp;/&nbsp;ok</span>
<br><span class="f_CodeExample">FileSave(filename,result)=true&nbsp;/&nbsp;ok</span>
<br><span class="f_CodeExample">File&nbsp;saved:&nbsp;MQL5Book/clock10.png.BASE64</span></p>
</td>
</tr>
</table>
</div>
<p class="p_Text"><span class="f_Text">The </span><span class="f_Text" style="font-style: italic;">clock10.png.BASE64</span><span class="f_Text"> file has been created as a result. Inside it, we will see the very line that is inserted in the web page code, in the </span><span class="f_Text" style="font-style: italic;">img</span><span class="f_Text"> tag.</span></p>
<p class="p_Text"><span class="f_Text">By the way, the &quot;deflate&quot; compression method is the basis for the PNG graphics format, so we can use </span><span class="f_Text" style="font-style: italic;">CryptEncode</span><span class="f_Text"> to save resource bitmaps to PNG files. The header file </span><span class="f_Text" style="font-style: italic;">PNG.mqh</span><span class="f_Text"> is included with the book, with minimal support for internal structures necessary to describe the image: it is suggested to experiment with its source code independently. Using </span><span class="f_Text" style="font-style: italic;">PNG.mqh</span><span class="f_Text">, we have written a simple script </span><span class="f_Text" style="font-style: italic;">CryptPNG.mq5</span><span class="f_Text"> which converts the resource from the &quot;euro.bmp&quot; file supplied with the terminal to the &quot;my.png&quot; file. Loading PNG files is not implemented.</span></p>
<div style="text-align: left; text-indent: 0; line-height: 1.0; page-break-inside: avoid; page-break-after: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0 0 0 0; margin: 2px 17px 2px 17px;"><table cellspacing="0" cellpadding="3" border="0" style="text-align: justify;border:none; border-spacing:0;">
<tr>
<td style="vertical-align:top; padding:3px; border:none"><p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample" style="color: #0000ff;">#resource</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #008080;">&quot;\\Images\\euro.bmp&quot;</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span>
<br><span class="f_CodeExample" style="color: #0000ff;">#include</span><span class="f_CodeExample">&nbsp;&lt;</span><span class="f_CodeExample" style="color: #333333;">MQL5Book</span><span class="f_CodeExample">/</span><span class="f_CodeExample" style="color: #333333;">PNG</span><span class="f_CodeExample">.</span><span class="f_CodeExample" style="color: #333333;">mqh</span><span class="f_CodeExample">&gt;</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span>
<br><span class="f_CodeExample" style="color: #0000ff;">void</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">OnStart</span><span class="f_CodeExample">()</span>
<br><span class="f_CodeExample">{</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">uchar</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">null</span><span class="f_CodeExample">[];&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #808080;">//&nbsp;empty&nbsp;key&nbsp;for&nbsp;CRYPT_ARCH_ZIP</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">uchar</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #333333;">result</span><span class="f_CodeExample">[];&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #808080;">//&nbsp;receiving&nbsp;array</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">uint</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #333333;">data</span><span class="f_CodeExample">[];&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #808080;">//&nbsp;original&nbsp;pixels</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">uchar</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #333333;">bytes</span><span class="f_CodeExample">[];&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #808080;">//&nbsp;original&nbsp;bytes</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">int</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #333333;">width</span><span class="f_CodeExample">,&nbsp;</span><span class="f_CodeExample" style="color: #333333;">height</span><span class="f_CodeExample">;</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #ff0000;">PRTF</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #0000ff;">ResourceReadImage</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #008080;">&quot;::Images\\euro.bmp&quot;</span><span class="f_CodeExample">,&nbsp;</span><span class="f_CodeExample" style="color: #333333;">data</span><span class="f_CodeExample">,&nbsp;</span><span class="f_CodeExample" style="color: #333333;">width</span><span class="f_CodeExample">,&nbsp;</span><span class="f_CodeExample" style="color: #333333;">height</span><span class="f_CodeExample">));</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">ArrayResize</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #333333;">bytes</span><span class="f_CodeExample">,&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">ArraySize</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #333333;">data</span><span class="f_CodeExample">)&nbsp;*&nbsp;</span><span class="f_CodeExample" style="color: #333333;">3</span><span class="f_CodeExample">&nbsp;+&nbsp;</span><span class="f_CodeExample" style="color: #333333;">width</span><span class="f_CodeExample">);&nbsp;</span><span class="f_CodeExample" style="color: #808080;">//&nbsp;*3&nbsp;for&nbsp;PNG_CTYPE_TRUECOLOR&nbsp;(RGB)</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">ArrayInitialize</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #333333;">bytes</span><span class="f_CodeExample">,&nbsp;</span><span class="f_CodeExample" style="color: #333333;">0</span><span class="f_CodeExample">);</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">int</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #333333;">j</span><span class="f_CodeExample">&nbsp;=&nbsp;</span><span class="f_CodeExample" style="color: #333333;">0</span><span class="f_CodeExample">;</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">for</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #0000ff;">int</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #333333;">i</span><span class="f_CodeExample">&nbsp;=&nbsp;</span><span class="f_CodeExample" style="color: #333333;">0</span><span class="f_CodeExample">;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">i</span><span class="f_CodeExample">&nbsp;&lt;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">ArraySize</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #333333;">data</span><span class="f_CodeExample">);&nbsp;++</span><span class="f_CodeExample" style="color: #333333;">i</span><span class="f_CodeExample">)</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;{</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">if</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #333333;">i</span><span class="f_CodeExample">&nbsp;%&nbsp;</span><span class="f_CodeExample" style="color: #333333;">width</span><span class="f_CodeExample">&nbsp;==&nbsp;</span><span class="f_CodeExample" style="color: #333333;">0</span><span class="f_CodeExample">)&nbsp;</span><span class="f_CodeExample" style="color: #333333;">bytes</span><span class="f_CodeExample">[</span><span class="f_CodeExample" style="color: #333333;">j</span><span class="f_CodeExample">++]&nbsp;=&nbsp;</span><span class="f_CodeExample" style="color: #333333;">0</span><span class="f_CodeExample">;&nbsp;</span><span class="f_CodeExample" style="color: #808080;">//&nbsp;each&nbsp;line&nbsp;is&nbsp;prepended&nbsp;with&nbsp;a&nbsp;filter&nbsp;mode&nbsp;byte</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">const</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">uint</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #333333;">c</span><span class="f_CodeExample">&nbsp;=&nbsp;</span><span class="f_CodeExample" style="color: #333333;">data</span><span class="f_CodeExample">[</span><span class="f_CodeExample" style="color: #333333;">i</span><span class="f_CodeExample">];</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #808080;">//&nbsp;bytes[j++]&nbsp;=&nbsp;(uchar)((c&nbsp;&gt;&gt;&nbsp;24)&nbsp;&amp;&nbsp;0xFF);&nbsp;//&nbsp;alpha,&nbsp;for&nbsp;PNG_CTYPE_TRUECOLORALPHA&nbsp;(ARGB)</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">bytes</span><span class="f_CodeExample">[</span><span class="f_CodeExample" style="color: #333333;">j</span><span class="f_CodeExample">++]&nbsp;=&nbsp;(</span><span class="f_CodeExample" style="color: #0000ff;">uchar</span><span class="f_CodeExample">)((</span><span class="f_CodeExample" style="color: #333333;">c</span><span class="f_CodeExample">&nbsp;&gt;&gt;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">16</span><span class="f_CodeExample">)&nbsp;&amp;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">0xFF</span><span class="f_CodeExample">);</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">bytes</span><span class="f_CodeExample">[</span><span class="f_CodeExample" style="color: #333333;">j</span><span class="f_CodeExample">++]&nbsp;=&nbsp;(</span><span class="f_CodeExample" style="color: #0000ff;">uchar</span><span class="f_CodeExample">)((</span><span class="f_CodeExample" style="color: #333333;">c</span><span class="f_CodeExample">&nbsp;&gt;&gt;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">8</span><span class="f_CodeExample">)&nbsp;&amp;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">0xFF</span><span class="f_CodeExample">);</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">bytes</span><span class="f_CodeExample">[</span><span class="f_CodeExample" style="color: #333333;">j</span><span class="f_CodeExample">++]&nbsp;=&nbsp;(</span><span class="f_CodeExample" style="color: #0000ff;">uchar</span><span class="f_CodeExample">)(</span><span class="f_CodeExample" style="color: #333333;">c</span><span class="f_CodeExample">&nbsp;&amp;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">0xFF</span><span class="f_CodeExample">);</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;}</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #ff0000;">PRTF</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #0000ff;">CryptEncode</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #ff0000;">CRYPT_ARCH_ZIP</span><span class="f_CodeExample">,&nbsp;</span><span class="f_CodeExample" style="color: #333333;">bytes</span><span class="f_CodeExample">,&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">null</span><span class="f_CodeExample">,&nbsp;</span><span class="f_CodeExample" style="color: #333333;">result</span><span class="f_CodeExample">));</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">int</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #333333;">h</span><span class="f_CodeExample">&nbsp;=&nbsp;</span><span class="f_CodeExample" style="color: #ff0000;">PRTF</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #0000ff;">FileOpen</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #008080;">&quot;my.png&quot;</span><span class="f_CodeExample">,&nbsp;</span><span class="f_CodeExample" style="color: #ff0000;">FILE_BIN</span><span class="f_CodeExample">&nbsp;|&nbsp;</span><span class="f_CodeExample" style="color: #ff0000;">FILE_WRITE</span><span class="f_CodeExample">));</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">PNG</span><span class="f_CodeExample">::</span><span class="f_CodeExample" style="color: #333333;">Image</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #333333;">image</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #333333;">width</span><span class="f_CodeExample">,&nbsp;</span><span class="f_CodeExample" style="color: #333333;">height</span><span class="f_CodeExample">,&nbsp;</span><span class="f_CodeExample" style="color: #333333;">result</span><span class="f_CodeExample">);&nbsp;</span><span class="f_CodeExample" style="color: #808080;">//&nbsp;default&nbsp;PNG_CTYPE_TRUECOLOR&nbsp;(RGB)</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">image</span><span class="f_CodeExample">.</span><span class="f_CodeExample" style="color: #333333;">write</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #333333;">h</span><span class="f_CodeExample">);</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">FileClose</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #333333;">h</span><span class="f_CodeExample">);</span>
<br><span class="f_CodeExample">}</span></p>
</td>
</tr>
</table>
</div>

</div>

</body>
</html>
