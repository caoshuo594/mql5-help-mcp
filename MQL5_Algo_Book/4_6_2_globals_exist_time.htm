<!DOCTYPE html>
<html>
  <head>
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
  <title>4.6.2 Checking the existence and last activity time</title>
  <meta name="keywords" content="" />
  <link type="text/css" href="default.css" rel="stylesheet" />

   <script type="text/javascript" src="jquery.js"></script>
   <script type="text/javascript" src="helpman_settings.js"></script>
   <script type="text/javascript" src="helpman_topicinit.js"></script>


</head>

<body style="background-color:#FFFFFF; font-family:'Trebuchet MS',Tahoma,Arial,Helvetica,sans-serif; margin:0px;">



<table width="100%" height="49"  border="0" cellpadding="0" cellspacing="0" style="margin-top:0px; background-color:#1660af;">
  <tr>
    <td></td>
    <td valign="middle">
      <table style="margin-top:4px; margin-bottom:5px;" width="100%"  border="0" cellspacing="0" cellpadding="5">
        <tr valign="middle">
          <td class="nav">
<a class="h_m" href="index.htm">          MQL5 Programming for Traders </a> / <a class="h_m" href="part4.htm"> Part 4. Common APIs </a> / <a class="h_m" href="4_6_globals.htm"> 4.6 Client terminal global variables </a>/ 4.6.2 Checking the existence and last activity time
          </td>
          <td width="70" align="right">
          <a href="4_6_1_globals_set_get.htm"><img style="vertical-align:middle;" src="previous.png" alt="?????" width="27" height="27" border=0></a>&nbsp;
          <a href="4_6_3_globals_list.htm"><img style="vertical-align:middle;" src="next.png" alt="??????" width="27" height="27" border="0"></a>
          </td>
        </tr>
      </table>
    </td>
    <td width="5"></td>
  </tr>
</table>



<div id="help">
<p class="p_H3"><span class="f_H3">4.6.2 Checking the existence and last activity time</span></p>
<p class="p_Text"><span class="f_Text">As we saw in the previous section, you can check the existence of a global variable by trying to read its value: if this does not result in an error code in </span><span class="f_Text" style="font-style: italic;">_LastError</span><span class="f_Text">, then the global variable exists, and we have already obtained its value and can use it in the algorithm. However, if under some conditions you only need to check for the existence, but not read the global variable, it is more convenient to use another function specifically designed for this: </span><span class="f_Text" style="font-style: italic;">GlobalVariableCheck</span><span class="f_Text">.</span></p>
<p class="p_Text"><span class="f_Text">There is another way to check, namely, using the </span><span class="f_Text" style="font-style: italic;">GlobalVariableTime</span><span class="f_Text"> function. As its name implies, it allows you to find out the last time a variable was used. But if the variable does not exist, then the time of its use is absent, i.e., it is equal to 0.</span></p>
<p class="p_H4"><span class="f_H4">bool GlobalVariableCheck(const string name)</span></p>
<p class="p_Text"><span class="f_Text">The function checks for the existence of a global variable with the specified name and returns the result: </span><span class="f_Text" style="font-style: italic;">true</span><span class="f_Text"> (the variable exists) or </span><span class="f_Text" style="font-style: italic;">false</span><span class="f_Text"> (no variable).</span></p>
<p class="p_H4"><span class="f_H4">datetime GlobalVariableTime(const string name)</span></p>
<p class="p_Text"><span class="f_Text">The function returns the time the global variable with the specified name was last used. The fact of use can be represented by the modification or reading of the variable value.</span></p>
<p class="p_Quote"><span class="f_Quote">Checking for the variable existence with </span><span class="f_Quote" style="font-style: italic;">GlobalVariableCheck</span><span class="f_Quote"> or getting its time through </span><span class="f_Quote" style="font-style: italic;">GlobalVariableTime</span><span class="f_Quote"> do not change the time of use.</span></p>
<p class="p_Text"><span class="f_Text">In the script </span><span class="f_Text" style="font-style: italic;">GlobalsRunCheck.mq5</span><span class="f_Text">, we will slightly supplement the code from </span><span class="f_Text" style="font-style: italic;">GlobalsRunCount.mq5</span><span class="f_Text"> so that at the very beginning of the function </span><span class="f_Text" style="font-style: italic;">OnStart</span><span class="f_Text"> check for the presence of a variable and the time of its use.</span></p>
<div style="text-align: left; text-indent: 0; line-height: 1.0; page-break-inside: avoid; page-break-after: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0 0 0 0; margin: 2px 17px 2px 17px;"><table cellspacing="0" cellpadding="3" border="0" style="text-align: justify;border:none; border-spacing:0;">
<tr>
<td style="vertical-align:top; padding:3px; border:none"><p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample" style="color: #0000ff;">void</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">OnStart</span><span class="f_CodeExample">()</span>
<br><span class="f_CodeExample">{</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #ff0000;">PRTF</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #0000ff;">GlobalVariableCheck</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #333333;">gv</span><span class="f_CodeExample">));</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #ff0000;">PRTF</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #0000ff;">GlobalVariableTime</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #333333;">gv</span><span class="f_CodeExample">));</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;...</span></p>
</td>
</tr>
</table>
</div>
<p class="p_Text"><span class="f_Text">The code below is unchanged. Meanwhile, note that the </span><span class="f_Text" style="font-style: italic;">gv</span><span class="f_Text"> variable defined via __FILE__ will this time contain the new script name &quot;GlobalsRunCheck.mq5&quot; as the name of the global variable (i.e., each script has its own global counter).</span></p>
<p class="p_Text"><span class="f_Text">All runs except the very first one will show </span><span class="f_Text" style="font-style: italic;">true</span><span class="f_Text"> from the </span><span class="f_Text" style="font-style: italic;">GlobalVariableCheck</span><span class="f_Text"> function (the variable exists) and the time of the variable from the previous run. Here is an example log:</span></p>
<div style="text-align: left; text-indent: 0; line-height: 1.0; page-break-inside: avoid; page-break-after: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0 0 0 0; margin: 2px 17px 2px 17px;"><table cellspacing="0" cellpadding="3" border="0" style="text-align: justify;border:none; border-spacing:0;">
<tr>
<td style="vertical-align:top; padding:3px; border:none"><p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample">GlobalVariableCheck(gv)=false&nbsp;/&nbsp;ok</span>
<br><span class="f_CodeExample">GlobalVariableTime(gv)=1970.01.01&nbsp;00:00:00&nbsp;/&nbsp;GLOBALVARIABLE_NOT_FOUND(4501)</span>
<br><span class="f_CodeExample">GlobalVariableGet(gv)=0.0&nbsp;/&nbsp;GLOBALVARIABLE_NOT_FOUND(4501)</span>
<br><span class="f_CodeExample">GlobalVariableSet(gv,count)=2021.08.29&nbsp;16:59:35&nbsp;/&nbsp;ok</span>
<br><span class="f_CodeExample">This&nbsp;script&nbsp;run&nbsp;count:&nbsp;1</span>
<br><span class="f_CodeExample">GlobalVariableCheck(gv)=true&nbsp;/&nbsp;ok</span>
<br><span class="f_CodeExample">GlobalVariableTime(gv)=2021.08.29&nbsp;16:59:35&nbsp;/&nbsp;ok</span>
<br><span class="f_CodeExample">GlobalVariableGet(gv)=1.0&nbsp;/&nbsp;ok</span>
<br><span class="f_CodeExample">GlobalVariableSet(gv,count)=2021.08.29&nbsp;16:59:45&nbsp;/&nbsp;ok</span>
<br><span class="f_CodeExample">This&nbsp;script&nbsp;run&nbsp;count:&nbsp;2</span>
<br><span class="f_CodeExample">GlobalVariableCheck(gv)=true&nbsp;/&nbsp;ok</span>
<br><span class="f_CodeExample">GlobalVariableTime(gv)=2021.08.29&nbsp;16:59:45&nbsp;/&nbsp;ok</span>
<br><span class="f_CodeExample">GlobalVariableGet(gv)=2.0&nbsp;/&nbsp;ok</span>
<br><span class="f_CodeExample">GlobalVariableSet(gv,count)=2021.08.29&nbsp;16:59:56&nbsp;/&nbsp;ok</span>
<br><span class="f_CodeExample">This&nbsp;script&nbsp;run&nbsp;count:&nbsp;3</span></p>
</td>
</tr>
</table>
</div>

</div>

</body>
</html>
