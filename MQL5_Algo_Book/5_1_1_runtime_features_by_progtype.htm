<!DOCTYPE html>
<html>
  <head>
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
  <title>5.1.1 Designing MQL programs of various types</title>
  <meta name="keywords" content="" />
  <link type="text/css" href="default.css" rel="stylesheet" />

   <script type="text/javascript" src="jquery.js"></script>
   <script type="text/javascript" src="helpman_settings.js"></script>
   <script type="text/javascript" src="helpman_topicinit.js"></script>


</head>

<body style="background-color:#FFFFFF; font-family:'Trebuchet MS',Tahoma,Arial,Helvetica,sans-serif; margin:0px;">



<table width="100%" height="49"  border="0" cellpadding="0" cellspacing="0" style="margin-top:0px; background-color:#1660af;">
  <tr>
    <td></td>
    <td valign="middle">
      <table style="margin-top:4px; margin-bottom:5px;" width="100%"  border="0" cellspacing="0" cellpadding="5">
        <tr valign="middle">
          <td class="nav">
<a class="h_m" href="index.htm">          MQL5 Programming for Traders </a> / <a class="h_m" href="part5.htm"> Part 5. Creating application programs </a> / <a class="h_m" href="5_1_runtime.htm"> 5.1 General principles for executing MQL programs </a>/ 5.1.1 Designing MQL programs of various types
          </td>
          <td width="70" align="right">
          <a href="5_1_runtime.htm"><img style="vertical-align:middle;" src="previous.png" alt="?????" width="27" height="27" border=0></a>&nbsp;
          <a href="5_1_2_runtime_threads.htm"><img style="vertical-align:middle;" src="next.png" alt="??????" width="27" height="27" border="0"></a>
          </td>
        </tr>
      </table>
    </td>
    <td width="5"></td>
  </tr>
</table>



<div id="help">
<p class="p_H3"><span class="f_H3">5.1.1 Designing MQL programs of various types</span></p>
<p class="p_Text"><span class="f_Text">The program type is a fundamental property in MQL5. In contrast to C++ or other general-purpose programming languages, where any program can be developed in arbitrary directions, for example, by adding a graphical interface or uploading data from a server over the network, MQL programs are divided into certain groups according to their purpose. For example, technical timeseries analysis with visualization is implemented via indicators, but they are not able to trade. In turn, the trading API functions are available to Expert Advisors, but they lack indicator buffers (arrays for drawing lines).</span></p>
<p class="p_Text"><span class="f_Text">Therefore, when solving a specific applied problem, the developer should decompose it into parts, and the functionality of each part should fit into the specialization of a separate type. Of course, in simple cases, a single MQL program is enough, but sometimes the optimal technical solution is not obvious. For example, how would you implement the plotting of a Renko chart: as an <a href="5_4_indicators_make.htm" class="topiclink">indicator</a>, as a <a href="7_2_custom_symbols.htm" class="topiclink">custom symbol</a> generated by the service, or can as specific calculations directly in the trading Expert Advisor? All options are possible.</span></p>
<p class="p_Text"><span class="f_Text">The type of MQL program is characterized by several factors.</span></p>
<p class="p_Text"><span class="f_Text" style="font-weight: bold;">First</span><span class="f_Text">, each type of program has a separate folder in the MQL5 working directory. We have already mentioned this fact in the introduction to <a href="part1.htm" class="topiclink">Part 1</a> and listed the folders. So, for indicators, Expert Advisors, scripts, and services, the designated folders are </span><span class="f_Text" style="font-style: italic;">Indicators</span><span class="f_Text">, </span><span class="f_Text" style="font-style: italic;">Experts</span><span class="f_Text">, </span><span class="f_Text" style="font-style: italic;">Scripts</span><span class="f_Text">, and </span><span class="f_Text" style="font-style: italic;">Services</span><span class="f_Text">, respectively. The </span><span class="f_Text" style="font-style: italic;">Libraries</span><span class="f_Text"> subfolder is reserved for libraries in the MQL5 folder. In each of them, you can organize a tree of nested folders of arbitrary configuration.</span></p>
<p class="p_Text"><span class="f_Text">The binary file (the finished program with the extension </span><span class="f_Text" style="font-style: italic;">ex5</span><span class="f_Text">) – which is a result of compiling the mq5 file – is generated in the same directory as the source mq5 file. However, we should also mention projects in MetaEditor (files with the extension </span><span class="f_Text" style="font-style: italic;">mqproj</span><span class="f_Text">), which we will analyze in the chapter <a href="7_8_project.htm" class="topiclink">Projects</a>. When a project is developed, a finished product is created in a directory next to the project. When creating a program from the MQL5 Wizard in MetaEditor (command </span><span class="f_Text" style="font-style: italic;">File -&gt; New</span><span class="f_Text">), the source file is placed by default in the folder corresponding to the program type. If you accidentally copy a program to the wrong directory, nothing terrible will happen: it will not turn, for example, from an Expert Advisor into an indicator, or vice versa. It can be moved to the desired location directly in the editor, inside the </span><span class="f_Text" style="font-style: italic;">Navigator</span><span class="f_Text"> window, or in an external file manager. In the </span><span class="f_Text" style="font-style: italic;">Navigator</span><span class="f_Text">, each program type is displayed with a special icon.</span></p>
<p class="p_Quote"><span class="f_Quote">The location of a program within the MQL5 directory in a subfolder dedicated to a particular type does not determine the type of this particular MQL program. The type is determined based on the contents of the executable file, which, in turn, is formed by the compiler from property directives and statements in the source code. </span><br>
<span class="f_Quote">&nbsp;</span><br>
<span class="f_Quote">The hierarchy of folders by program types is used for convenience. It is recommended to stick to it, except when it comes to a group of related projects (with programs of different types), which are more logical to store in a separate directory.</span></p>
<p class="p_Text"><span class="f_Text" style="font-weight: bold;">Second</span><span class="f_Text">, each type of program is characterized by support for a limited, specific set of system events that activate the program. We will see an <a href="5_1_3_runtime_events_overview.htm" class="topiclink">Overview of event-handling functions</a> in a separate section. To receive events of a specific type in a program, it is necessary to describe a handler function with a predefined prototype (name, list of parameters, return value).</span></p>
<p class="p_Text"><span class="f_Text">For example, we have already seen that in scripts and services, work is started in the </span><span class="f_Text" style="font-style: italic;">OnStart</span><span class="f_Text"> function, and since it is the only one there, it can be called the main &quot;entry point&quot; through which the terminal transfers control to the application code. In other types of programs, the situation is somewhat more complicated. In general, we note that a program type is characterized by a certain set of handlers, some of which may be mandatory and some are optional (but at the same time, unacceptable for other types of programs). In particular, an indicator requires the </span><span class="f_Text" style="font-style: italic;">OnCalculate</span><span class="f_Text"> function (without it, an indicator will not compile and the compiler will generate an error). However, this function is not used in Expert Advisors.</span></p>
<p class="p_Text"><span class="f_Text" style="font-weight: bold;">Third</span><span class="f_Text">, some types of programs require special </span><span class="f_Text" style="font-style: italic;">#property</span><span class="f_Text"> directives. In the chapter <a href="2_9_9_preprocessor_properties.htm" class="topiclink">General properties of programs</a>, we have already seen directives that can be used in all types of programs. However, there are other, specialized directives. For example, in tasks with services, that we mentioned, we met the </span><span class="f_Text" style="font-style: italic;">#property service</span><span class="f_Text"> directive, which makes the program a service. Without it, even placing the program in the </span><span class="f_Text" style="font-style: italic;">Services</span><span class="f_Text"> folder will not allow it to run in the background.</span></p>
<p class="p_Text"><span class="f_Text">Similarly, the </span><span class="f_Text" style="font-style: italic;">#property library</span><span class="f_Text"> directive plays a defining role in the creation of libraries. All such directive properties will be discussed in the sections for the corresponding types of programs.</span></p>
<p class="p_Text"><span class="f_Text">The combination of directives and event handlers is taken into account when establishing an MQL program type in the following order (top to bottom until the first match):</span></p>
<ul style="list-style-type:disc">
<li class="p_li"><span class="f_li">indicator: the presence of the </span><span class="f_li" style="font-style: italic;">OnCalculate</span><span class="f_li"> handler</span></li>
<li class="p_li"><span class="f_li">library: </span><span class="f_li" style="font-style: italic;">#property library</span></li>
<li class="p_li"><span class="f_li">script: the presence of the </span><span class="f_li" style="font-style: italic;">OnStart</span><span class="f_li"> &nbsp;handler and the absence of </span><span class="f_li" style="font-style: italic;">#property service</span></li>
<li class="p_li"><span class="f_li">service: the presence of the </span><span class="f_li" style="font-style: italic;">OnStart</span><span class="f_li"> handler and </span><span class="f_li" style="font-style: italic;">#property service</span></li>
<li class="p_li"><span class="f_li">Expert Advisor: the presence of any other handler</span></li>
</ul>
<p class="p_Text"><span class="f_Text">An example of what effect these properties have on the compiler will be given in the section <a href="5_1_3_runtime_events_overview.htm" class="topiclink">Overview of event handling functions</a>.</span></p>
<p class="p_Quote"><span class="f_Quote">For all of the above points, one more point should be taken into account. The program type is determined by the main compiled module: a file with the mq5 extension, where other sources from other directories can be included using the </span><span class="f_Quote" style="font-style: italic;">#include</span><span class="f_Quote"> directive. All functions included in this way are taken into consideration on the same level as those that are present directly in the main mq5 file. </span><br>
<span class="f_Quote" style="font-style: italic;">&nbsp;</span><br>
<span class="f_Quote">On the other hand, </span><span class="f_Quote" style="font-style: italic;">#property</span><span class="f_Quote"> directives have an effect only when placed in the main compiled mq5 file. If the directives occur in files included in the program using </span><span class="f_Quote" style="font-style: italic;">#include</span><span class="f_Quote">, they will be ignored.</span></p>
<p class="p_Text"><span class="f_Text">The main mq5 file does not have to literally contain event handler functions. It is perfectly acceptable to place part or all of the algorithm in mqh header files and then include them in one or more programs. For example, we can implement the </span><span class="f_Text" style="font-style: italic;">OnStart</span><span class="f_Text"> handler with a set of useful actions in an mqh file and use it via </span><span class="f_Text" style="font-style: italic;">#include</span><span class="f_Text"> inside two separate programs: a script and a service.</span></p>
<p class="p_Text"><span class="f_Text">Meanwhile, let's note that the presence of common event handlers is not the only motive for separating common algorithm fragments into a header file. You can use the same calculation formula, for example, in an indicator and in an Expert Advisor, leaving their event handlers in the main program modules.</span></p>
<p class="p_Quote"><span class="f_Quote">Although it is customary to refer to include files as header files and give them the </span><span class="f_Quote" style="font-style: italic;">mqh</span><span class="f_Quote"> extension, this is not technically necessary. It is quite acceptable (although not recommended) to include another mq5 file or, for example, a txt file in one mq5 file. They may contain some legacy code or, let's say, initialization of certain arrays with constants. The inclusion of another mq5 file does not make it the main one. </span><br>
<span class="f_Quote" style="font-style: italic;">&nbsp;</span><br>
<span class="f_Quote">You should make sure that only the event-handling functions characteristic of the specific program type get into the program, and that there are no duplicates among them (as you know, functions are identified by a combination of names and a list of parameters: <a href="2_8_9_functions_overloading.htm" class="topiclink">function overload</a> only allowed with a different set of parameters). This is usually achieved using various preprocessor directives. For example, by defining the macro </span><span class="f_Quote" style="font-style: italic;">#define OnStart OnStartPrevious</span><span class="f_Quote"> before including a third-party mq5 script file in some of our programs, we will actually turn the </span><span class="f_Quote" style="font-style: italic;">OnStart</span><span class="f_Quote"> function described in it into </span><span class="f_Quote" style="font-style: italic;">OnStartPrevious</span><span class="f_Quote">, and we can call it as usual from our own event handlers. </span><br>
<span class="f_Quote" style="font-style: italic;">&nbsp;</span><br>
<span class="f_Quote">However, this approach makes sense only in exceptional cases when the source code of the included mq5 file cannot be modified due to some reason, in particular, when it cannot be structured with the selection of algorithms of interest into functions or classes in separate header files.</span></p>
<p class="p_Text"><span class="f_Text">According to the principle of interaction with the user, MQL programs can be divided into interactive and utilitarian ones.</span></p>
<p class="p_Text"><span class="f_Text">Interactive programs – indicators and Expert Advisors – can process <a href="5_1_3_runtime_events_overview.htm" class="topiclink">events</a>, which occur in the software environment in response to user actions, such as pressing buttons on the keyboard, moving the mouse, changing the window size, as well as many other events, for example, related to receiving quote data or to timer actions.</span></p>
<p class="p_Text"><span class="f_Text">Utility programs – services and scripts – are guided only by input variables set at the time of launch, and do not respond to events in the system.</span></p>
<p class="p_Text"><span class="f_Text">Apart from all types of programs are <a href="7_7_libraries.htm" class="topiclink">libraries</a>. They are always executed as part of another type of MQL program (one of the four main ones), and therefore do not have any distinctive characteristics or behavior. In particular, they cannot directly receive events from the terminal and do not have their own threads (see <a href="5_1_2_runtime_threads.htm" class="topiclink">next section</a>). The same library can be connected to many programs, and this happens dynamically at the time of the launch of each parent program. In the section on libraries, we'll learn how to describe a library's exported API and import it into a parent program.</span></p>

</div>

</body>
</html>
