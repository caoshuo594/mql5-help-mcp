<!DOCTYPE html>
<html>
  <head>
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
  <title>5.3.10 Finding the maximum and minimum values in a timeseries</title>
  <meta name="keywords" content="" />
  <link type="text/css" href="default.css" rel="stylesheet" />

   <script type="text/javascript" src="jquery.js"></script>
   <script type="text/javascript" src="helpman_settings.js"></script>
   <script type="text/javascript" src="helpman_topicinit.js"></script>


</head>

<body style="background-color:#FFFFFF; font-family:'Trebuchet MS',Tahoma,Arial,Helvetica,sans-serif; margin:0px;">



<table width="100%" height="49"  border="0" cellpadding="0" cellspacing="0" style="margin-top:0px; background-color:#1660af;">
  <tr>
    <td></td>
    <td valign="middle">
      <table style="margin-top:4px; margin-bottom:5px;" width="100%"  border="0" cellspacing="0" cellpadding="5">
        <tr valign="middle">
          <td class="nav">
<a class="h_m" href="index.htm">          MQL5 Programming for Traders </a> / <a class="h_m" href="part5.htm"> Part 5. Creating application programs </a> / <a class="h_m" href="5_3_timeseries.htm"> 5.3 Timeseries </a>/ 5.3.10 Finding the maximum and minimum values in a timeseries
          </td>
          <td width="70" align="right">
          <a href="5_3_9_timeseries_single_value.htm"><img style="vertical-align:middle;" src="previous.png" alt="?????" width="27" height="27" border=0></a>&nbsp;
          <a href="5_3_11_timeseries_ticks_mqltick.htm"><img style="vertical-align:middle;" src="next.png" alt="??????" width="27" height="27" border="0"></a>
          </td>
        </tr>
      </table>
    </td>
    <td width="5"></td>
  </tr>
</table>



<div id="help">
<p class="p_H3"><span class="f_H3">5.3.10 Finding the maximum and minimum values in a timeseries</span></p>
<p class="p_Text"><span class="f_Text">Among the group of functions for working with time series of quotes, there are two that provide the simplest aggregate processing: searching for the maximum and minimum values of the series at a given interval, respectively </span><span class="f_Text" style="font-style: italic;">iHighest</span><span class="f_Text"> and </span><span class="f_Text" style="font-style: italic;">iLowest</span><span class="f_Text">.</span></p>
<p class="p_H4"><span class="f_H4">int iHighest(const string symbol, ENUM_TIMEFRAMES timeframe, ENUM_SERIESMODE type, int count = WHOLE_ARRAY, int offset = 0)</span></p>
<p class="p_H4" style="margin: 0 23px 1px 17px;"><span class="f_H4">int iLowest(const string symbol, ENUM_TIMEFRAMES timeframe, ENUM_SERIESMODE type, int count = WHOLE_ARRAY, int offset = 0)</span></p>
<p class="p_Text"><span class="f_Text">The functions return the index of the largest/smallest value for a specific timeseries type, which is specified by a pair of </span><span class="f_Text" style="font-style: italic;">symbol/timeframe</span><span class="f_Text"> parameters, as well as the ENUM_SERIESMODE enumeration element (it describes the quote fields already familiar to us).</span></p>
<div style="text-align: justify; text-indent: 0; padding: 0 0 0 0; margin: 7px 17px 6px 17px;"><table class="table" cellspacing="0" cellpadding="5" border="1">
<thead>
<tr class="table">
<th class="table"><p class="p_BoldTitlesInTables"><span class="f_BoldTitlesInTables">Identifier</span></p>
</th>
<th class="table"><p class="p_BoldTitlesInTables"><span class="f_BoldTitlesInTables">Description</span></p>
</th>
</tr>
</thead>
<tbody>
<tr class="table">
<td class="table"><p class="p_fortable"><span class="f_fortable">MODE_OPEN</span></p>
</td>
<td class="table"><p class="p_fortable"><span class="f_fortable">Opening price</span></p>
</td>
</tr>
<tr class="table">
<td class="table"><p class="p_fortable"><span class="f_fortable">MODE_LOW</span></p>
</td>
<td class="table"><p class="p_fortable"><span class="f_fortable">High price</span></p>
</td>
</tr>
<tr class="table">
<td class="table"><p class="p_fortable"><span class="f_fortable">MODE_HIGH</span></p>
</td>
<td class="table"><p class="p_fortable"><span class="f_fortable">Low price</span></p>
</td>
</tr>
<tr class="table">
<td class="table"><p class="p_fortable"><span class="f_fortable">MODE_CLOSE</span></p>
</td>
<td class="table"><p class="p_fortable"><span class="f_fortable">Closing price</span></p>
</td>
</tr>
<tr class="table">
<td class="table"><p class="p_fortable"><span class="f_fortable">MODE_VOLUME</span></p>
</td>
<td class="table"><p class="p_fortable"><span class="f_fortable">Tick volume</span></p>
</td>
</tr>
<tr class="table">
<td class="table"><p class="p_fortable"><span class="f_fortable">MODE_REAL_VOLUME</span></p>
</td>
<td class="table"><p class="p_fortable"><span class="f_fortable">Real volume</span></p>
</td>
</tr>
<tr class="table">
<td class="table"><p class="p_fortable"><span class="f_fortable">MODE_SPREAD</span></p>
</td>
<td class="table"><p class="p_fortable"><span class="f_fortable">Spread</span></p>
</td>
</tr>
</tbody>
</table>
</div>
<p class="p_Text"><span class="f_Text">The </span><span class="f_Text" style="font-style: italic;">offset</span><span class="f_Text"> parameter specifies the index at which to start the search. Numbering is carried out as in a timeseries, that is, the increase in </span><span class="f_Text" style="font-style: italic;">offset</span><span class="f_Text"> results in a shift to the past, and the 0-th index means the current bar (this is the default value). The number of analyzed bars is specified in the </span><span class="f_Text" style="font-style: italic;">count</span><span class="f_Text"> parameter (WHOLE_ARRAY by default).</span></p>
<p class="p_Text"><span class="f_Text">In case of an error, the functions return -1. Use </span><span class="f_Text" style="font-style: italic;"><a href="4_9_15_env_last_error.htm" class="topiclink">GetLastError</a></span><span class="f_Text"> to find the error code.</span></p>
<p class="p_Text"><span class="f_Text">To demonstrate how one of these functions works (</span><span class="f_Text" style="font-style: italic;">iHighest</span><span class="f_Text">), let's modify the example from the previous section on estimating the real sizes of spreads by bars and compare the results. Of course, they must match. The new version of the script is attached in the file </span><span class="f_Text" style="font-style: italic;">SeriesSpreadHighest.mq5</span><span class="f_Text">.</span></p>
<p class="p_Text"><span class="f_Text">The changes affected the structure </span><span class="f_Text" style="font-style: italic;">SpreadPerBar</span><span class="f_Text"> and the work cycle inside </span><span class="f_Text" style="font-style: italic;">OnStart</span><span class="f_Text">.</span></p>
<p class="p_Text"><span class="f_Text">Fields have been added to the structure that allow you to understand how the new function works. Due to the nature of the algorithm, they are not obligatory.</span></p>
<div style="text-align: left; text-indent: 0; line-height: 1.0; page-break-inside: avoid; page-break-after: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0 0 0 0; margin: 2px 17px 2px 17px;"><table cellspacing="0" cellpadding="3" border="0" style="text-align: justify;border:none; border-spacing:0;">
<tr>
<td style="vertical-align:top; padding:3px; border:none"><p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample" style="color: #0000ff;">struct</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #333333;">SpreadPerBar</span>
<br><span class="f_CodeExample">{</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">datetime</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #333333;">time</span><span class="f_CodeExample">;</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">int</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #333333;">spread</span><span class="f_CodeExample">;</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">int&nbsp;</span><span class="f_CodeExample" style="color: #333333;">max</span><span class="f_CodeExample">;&nbsp;</span><span class="f_CodeExample" style="color: #808080;">//&nbsp;through&nbsp;index&nbsp;of&nbsp;the&nbsp;M1&nbsp;bar&nbsp;with&nbsp;a&nbsp;spread,&nbsp;the&nbsp;value&nbsp;of&nbsp;which&nbsp;is&nbsp;maximum</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #808080;">//&nbsp;among&nbsp;all&nbsp;M1-bars&nbsp;within&nbsp;the&nbsp;current&nbsp;bar&nbsp;of&nbsp;the&nbsp;higher&nbsp;timeframe</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">int&nbsp;</span><span class="f_CodeExample" style="color: #333333;">num</span><span class="f_CodeExample">;&nbsp;</span><span class="f_CodeExample" style="color: #808080;">//&nbsp;number&nbsp;of&nbsp;M1&nbsp;bars&nbsp;in&nbsp;the&nbsp;current&nbsp;bar&nbsp;of&nbsp;the&nbsp;higher&nbsp;timeframe</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">int</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #333333;">pos</span><span class="f_CodeExample">;&nbsp;</span><span class="f_CodeExample" style="color: #808080;">//&nbsp;initial&nbsp;index&nbsp;of&nbsp;the&nbsp;M1&nbsp;bar&nbsp;within&nbsp;the&nbsp;current&nbsp;bar&nbsp;of&nbsp;the&nbsp;higher&nbsp;timeframe</span>
<br><span class="f_CodeExample">};</span></p>
</td>
</tr>
</table>
</div>
<p class="p_Text"><span class="f_Text">The main transformations affected </span><span class="f_Text" style="font-style: italic;">OnStart</span><span class="f_Text">, but they are localized inside the loop (all other code fragments remained unchanged).</span></p>
<div style="text-align: left; text-indent: 0; line-height: 1.0; page-break-inside: avoid; page-break-after: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0 0 0 0; margin: 2px 17px 2px 17px;"><table cellspacing="0" cellpadding="3" border="0" style="text-align: justify;border:none; border-spacing:0;">
<tr>
<td style="vertical-align:top; padding:3px; border:none"><p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">for</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #0000ff;">int</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #333333;">i</span><span class="f_CodeExample">&nbsp;=&nbsp;</span><span class="f_CodeExample" style="color: #333333;">0</span><span class="f_CodeExample">;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">i</span><span class="f_CodeExample">&nbsp;&lt;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">BarCount</span><span class="f_CodeExample">;&nbsp;++</span><span class="f_CodeExample" style="color: #333333;">i</span><span class="f_CodeExample">)</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;{</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">const</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">datetime</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #333333;">next</span><span class="f_CodeExample">&nbsp;=&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">iTime</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #333333;">WorkSymbol</span><span class="f_CodeExample">,&nbsp;</span><span class="f_CodeExample" style="color: #333333;">TimeFrame</span><span class="f_CodeExample">,&nbsp;</span><span class="f_CodeExample" style="color: #333333;">i</span><span class="f_CodeExample">);</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">const</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">datetime</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #333333;">prev</span><span class="f_CodeExample">&nbsp;=&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">iTime</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #333333;">WorkSymbol</span><span class="f_CodeExample">,&nbsp;</span><span class="f_CodeExample" style="color: #333333;">TimeFrame</span><span class="f_CodeExample">,&nbsp;</span><span class="f_CodeExample" style="color: #333333;">i</span><span class="f_CodeExample">&nbsp;+&nbsp;</span><span class="f_CodeExample" style="color: #333333;">1</span><span class="f_CodeExample">);</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...</span></p>
</td>
</tr>
</table>
</div>
<p class="p_Text"><span class="f_Text">The borders of the current bar, </span><span class="f_Text" style="font-style: italic;">prev</span><span class="f_Text"> and </span><span class="f_Text" style="font-style: italic;">next</span><span class="f_Text">, are defined as before. However, instead of copying the timeseries elements between these labels into its own array </span><span class="f_Text" style="font-style: italic;">spreads</span><span class="f_Text">, and the subsequent call of </span><span class="f_Text" style="font-style: italic;">ArrayMaximum</span><span class="f_Text"> for it, we determine the indexes and the number of M1 bars that form the current bar of the higher timeframe. This is done in the following way.</span></p>
<p class="p_Text"><span class="f_Text">The </span><span class="f_Text" style="font-style: italic;">iBarShift</span><span class="f_Text"> function allows you to find out the offset (variable </span><span class="f_Text" style="font-style: italic;">p</span><span class="f_Text">) in the history of M1, where the right border of the bar with time </span><span class="f_Text" style="font-style: italic;">next - 1</span><span class="f_Text"> is located. The </span><span class="f_Text" style="font-style: italic;">bars</span><span class="f_Text"> function calculates the number of M1 bars (variable </span><span class="f_Text" style="font-style: italic;">n</span><span class="f_Text">) falling between </span><span class="f_Text" style="font-style: italic;">prev</span><span class="f_Text"> and </span><span class="f_Text" style="font-style: italic;">next - 1</span><span class="f_Text">. These two values become parameters in the </span><span class="f_Text" style="font-style: italic;">iHighest</span><span class="f_Text"> function call made to find the maximum value of type MODE_SPREAD, among </span><span class="f_Text" style="font-style: italic;">n</span><span class="f_Text"> M1 bars, starting from the index </span><span class="f_Text" style="font-style: italic;">p</span><span class="f_Text">. If the maximum is found without problems (</span><span class="f_Text" style="font-style: italic;">m &gt; -1</span><span class="f_Text">), it remains for us to take the corresponding value using </span><span class="f_Text" style="font-style: italic;">iSpread</span><span class="f_Text"> and place it in a structure.</span></p>
<div style="text-align: left; text-indent: 0; line-height: 1.0; page-break-inside: avoid; page-break-after: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0 0 0 0; margin: 2px 17px 2px 17px;"><table cellspacing="0" cellpadding="3" border="0" style="text-align: justify;border:none; border-spacing:0;">
<tr>
<td style="vertical-align:top; padding:3px; border:none"><p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">const</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">int</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #333333;">p</span><span class="f_CodeExample">&nbsp;=&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">iBarShift</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #333333;">WorkSymbol</span><span class="f_CodeExample">,&nbsp;</span><span class="f_CodeExample" style="color: #ff0000;">PERIOD_M1</span><span class="f_CodeExample">,&nbsp;</span><span class="f_CodeExample" style="color: #333333;">next</span><span class="f_CodeExample">&nbsp;-&nbsp;</span><span class="f_CodeExample" style="color: #333333;">1</span><span class="f_CodeExample">);</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">const</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">int</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #333333;">n</span><span class="f_CodeExample">&nbsp;=&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">Bars</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #333333;">WorkSymbol</span><span class="f_CodeExample">,&nbsp;</span><span class="f_CodeExample" style="color: #ff0000;">PERIOD_M1</span><span class="f_CodeExample">,&nbsp;</span><span class="f_CodeExample" style="color: #333333;">prev</span><span class="f_CodeExample">,&nbsp;</span><span class="f_CodeExample" style="color: #333333;">next</span><span class="f_CodeExample">&nbsp;-&nbsp;</span><span class="f_CodeExample" style="color: #333333;">1</span><span class="f_CodeExample">);</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">const</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">int</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #333333;">m</span><span class="f_CodeExample">&nbsp;=&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">iHighest</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #333333;">WorkSymbol</span><span class="f_CodeExample">,&nbsp;</span><span class="f_CodeExample" style="color: #ff0000;">PERIOD_M1</span><span class="f_CodeExample">,&nbsp;</span><span class="f_CodeExample" style="color: #ff0000;">MODE_SPREAD</span><span class="f_CodeExample">,&nbsp;</span><span class="f_CodeExample" style="color: #333333;">n</span><span class="f_CodeExample">,&nbsp;</span><span class="f_CodeExample" style="color: #333333;">p</span><span class="f_CodeExample">);</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">if</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #333333;">m</span><span class="f_CodeExample">&nbsp;&gt;&nbsp;-</span><span class="f_CodeExample" style="color: #333333;">1</span><span class="f_CodeExample">)</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">peaks</span><span class="f_CodeExample">[</span><span class="f_CodeExample" style="color: #333333;">i</span><span class="f_CodeExample">].</span><span class="f_CodeExample" style="color: #333333;">spread</span><span class="f_CodeExample">&nbsp;=&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">iSpread</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #333333;">WorkSymbol</span><span class="f_CodeExample">,&nbsp;</span><span class="f_CodeExample" style="color: #ff0000;">PERIOD_M1</span><span class="f_CodeExample">,&nbsp;</span><span class="f_CodeExample" style="color: #333333;">m</span><span class="f_CodeExample">);</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">peaks</span><span class="f_CodeExample">[</span><span class="f_CodeExample" style="color: #333333;">i</span><span class="f_CodeExample">].</span><span class="f_CodeExample" style="color: #333333;">time</span><span class="f_CodeExample">&nbsp;=&nbsp;</span><span class="f_CodeExample" style="color: #333333;">prev</span><span class="f_CodeExample">;</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">peaks</span><span class="f_CodeExample">[</span><span class="f_CodeExample" style="color: #333333;">i</span><span class="f_CodeExample">].</span><span class="f_CodeExample" style="color: #333333;">max</span><span class="f_CodeExample">&nbsp;=&nbsp;</span><span class="f_CodeExample" style="color: #333333;">m</span><span class="f_CodeExample">;</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">peaks</span><span class="f_CodeExample">[</span><span class="f_CodeExample" style="color: #333333;">i</span><span class="f_CodeExample">].</span><span class="f_CodeExample" style="color: #333333;">num</span><span class="f_CodeExample">&nbsp;=&nbsp;</span><span class="f_CodeExample" style="color: #333333;">n</span><span class="f_CodeExample">;</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #333333;">peaks</span><span class="f_CodeExample">[</span><span class="f_CodeExample" style="color: #333333;">i</span><span class="f_CodeExample">].</span><span class="f_CodeExample" style="color: #333333;">pos</span><span class="f_CodeExample">&nbsp;=&nbsp;</span><span class="f_CodeExample" style="color: #333333;">p</span><span class="f_CodeExample">;</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;}</span></p>
</td>
</tr>
</table>
</div>
<p class="p_Text"><span class="f_Text">When outputting the array with the results to the log, we will now additionally see the indexes of M1 bars, where the bar of the higher timeframe &quot;begins&quot; and where the maximum spread was found in it. The word &quot;begins&quot; is in quotation marks, because as new M1 bars arrive, these indexes will increase, and the virtual &quot;beginning&quot; of each will shift, although the opening times of historical bars, of course, remain constant.</span></p>
<div style="text-align: left; text-indent: 0; line-height: 1.0; page-break-inside: avoid; page-break-after: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0 0 0 0; margin: 2px 17px 2px 17px;"><table cellspacing="0" cellpadding="3" border="0" style="text-align: justify;border:none; border-spacing:0;">
<tr>
<td style="vertical-align:top; padding:3px; border:none"><p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample">Maximal&nbsp;speeds&nbsp;per&nbsp;intraday&nbsp;bar</span>
<br><span class="f_CodeExample">Processed&nbsp;100&nbsp;bars&nbsp;on&nbsp;EURUSD&nbsp;PERIOD_H1</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[time]&nbsp;[spread]&nbsp;[max]&nbsp;[num]&nbsp;[pos]</span>
<br><span class="f_CodeExample">[&nbsp;0]&nbsp;2021.10.12&nbsp;15:00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;7&nbsp;&nbsp;&nbsp;&nbsp;60&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;7</span>
<br><span class="f_CodeExample">[&nbsp;1]&nbsp;2021.10.12&nbsp;14:00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;89&nbsp;&nbsp;&nbsp;&nbsp;60&nbsp;&nbsp;&nbsp;&nbsp;67</span>
<br><span class="f_CodeExample">[&nbsp;2]&nbsp;2021.10.12&nbsp;13:00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;181&nbsp;&nbsp;&nbsp;&nbsp;60&nbsp;&nbsp;&nbsp;127</span>
<br><span class="f_CodeExample">[&nbsp;3]&nbsp;2021.10.12&nbsp;12:00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;213&nbsp;&nbsp;&nbsp;&nbsp;60&nbsp;&nbsp;&nbsp;187</span>
<br><span class="f_CodeExample">[&nbsp;4]&nbsp;2021.10.12&nbsp;11:00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;248&nbsp;&nbsp;&nbsp;&nbsp;60&nbsp;&nbsp;&nbsp;247</span>
<br><span class="f_CodeExample">[&nbsp;5]&nbsp;2021.10.12&nbsp;10:00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;307&nbsp;&nbsp;&nbsp;&nbsp;60&nbsp;&nbsp;&nbsp;307</span>
<br><span class="f_CodeExample">[&nbsp;6]&nbsp;2021.10.12&nbsp;09:00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;385&nbsp;&nbsp;&nbsp;&nbsp;60&nbsp;&nbsp;&nbsp;367</span>
<br><span class="f_CodeExample">[&nbsp;7]&nbsp;2021.10.12&nbsp;08:00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;469&nbsp;&nbsp;&nbsp;&nbsp;60&nbsp;&nbsp;&nbsp;427</span>
<br><span class="f_CodeExample">[&nbsp;8]&nbsp;2021.10.12&nbsp;07:00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;497&nbsp;&nbsp;&nbsp;&nbsp;60&nbsp;&nbsp;&nbsp;487</span>
<br><span class="f_CodeExample">[&nbsp;9]&nbsp;2021.10.12&nbsp;06:00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;550&nbsp;&nbsp;&nbsp;&nbsp;60&nbsp;&nbsp;&nbsp;547</span>
<br><span class="f_CodeExample">[10]&nbsp;2021.10.12&nbsp;05:00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;616&nbsp;&nbsp;&nbsp;&nbsp;60&nbsp;&nbsp;&nbsp;607</span>
<br><span class="f_CodeExample">[11]&nbsp;2021.10.12&nbsp;04:00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;678&nbsp;&nbsp;&nbsp;&nbsp;60&nbsp;&nbsp;&nbsp;667</span>
<br><span class="f_CodeExample">[12]&nbsp;2021.10.12&nbsp;03:00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;727&nbsp;&nbsp;&nbsp;&nbsp;60&nbsp;&nbsp;&nbsp;727</span>
<br><span class="f_CodeExample">[13]&nbsp;2021.10.12&nbsp;02:00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4&nbsp;&nbsp;&nbsp;820&nbsp;&nbsp;&nbsp;&nbsp;60&nbsp;&nbsp;&nbsp;787</span>
<br><span class="f_CodeExample">[14]&nbsp;2021.10.12&nbsp;01:00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;16&nbsp;&nbsp;&nbsp;906&nbsp;&nbsp;&nbsp;&nbsp;60&nbsp;&nbsp;&nbsp;847</span>
<br><span class="f_CodeExample">[15]&nbsp;2021.10.12&nbsp;00:00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;65&nbsp;&nbsp;&nbsp;956&nbsp;&nbsp;&nbsp;&nbsp;60&nbsp;&nbsp;&nbsp;907</span>
<br><span class="f_CodeExample">[16]&nbsp;2021.10.11&nbsp;23:00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;15&nbsp;&nbsp;&nbsp;967&nbsp;&nbsp;&nbsp;&nbsp;60&nbsp;&nbsp;&nbsp;967</span>
<br><span class="f_CodeExample">[17]&nbsp;2021.10.11&nbsp;22:00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;1039&nbsp;&nbsp;&nbsp;&nbsp;60&nbsp;&nbsp;1027</span>
<br><span class="f_CodeExample">[18]&nbsp;2021.10.11&nbsp;21:00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;1090&nbsp;&nbsp;&nbsp;&nbsp;60&nbsp;&nbsp;1087</span>
<br><span class="f_CodeExample">[19]&nbsp;2021.10.11&nbsp;20:00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;1148&nbsp;&nbsp;&nbsp;&nbsp;60&nbsp;&nbsp;1147</span>
<br><span class="f_CodeExample">[20]&nbsp;2021.10.11&nbsp;19:00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;1210&nbsp;&nbsp;&nbsp;&nbsp;60&nbsp;&nbsp;1207</span>
<br><span class="f_CodeExample">[21]&nbsp;2021.10.11&nbsp;18:00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;1313&nbsp;&nbsp;&nbsp;&nbsp;60&nbsp;&nbsp;1267</span>
<br><span class="f_CodeExample">[22]&nbsp;2021.10.11&nbsp;17:00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;1345&nbsp;&nbsp;&nbsp;&nbsp;60&nbsp;&nbsp;1327</span>
<br><span class="f_CodeExample">[23]&nbsp;2021.10.11&nbsp;16:00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;1411&nbsp;&nbsp;&nbsp;&nbsp;60&nbsp;&nbsp;1387</span>
<br><span class="f_CodeExample">[24]&nbsp;2021.10.11&nbsp;15:00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;1461&nbsp;&nbsp;&nbsp;&nbsp;60&nbsp;&nbsp;1447</span>
<br><span class="f_CodeExample">[25]&nbsp;2021.10.11&nbsp;14:00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;1526&nbsp;&nbsp;&nbsp;&nbsp;60&nbsp;&nbsp;1507</span>
<br><span class="f_CodeExample">...</span></p>
</td>
</tr>
</table>
</div>
<p class="p_Text"><span class="f_Text">For example, at the time the script was launched, the bar with the label 2021.10.12 14:00 started from the 67th bar M1 (i.e. it was opened 67 minutes ago), and the M1 bar with the maximum spread inside this H1 bar was found under the index 89. Obviously, this index should be less than the number of the M1 bar where the previous H1 bar started: 2021.10.12 13:00 – it was marked 127 minutes ago. In this H1 bar, in turn, the maximum spread for the 181 index was found. And this is less than the index 187 for an even older bar 2021.10.12 12:00.</span></p>
<p class="p_Text"><span class="f_Text">Indexes in the </span><span class="f_Text" style="font-style: italic;">pos</span><span class="f_Text"> and </span><span class="f_Text" style="font-style: italic;">max</span><span class="f_Text"> columns are constantly increasing because we walk around the bars in order from the present to the past. The </span><span class="f_Text" style="font-style: italic;">num</span><span class="f_Text"> column will almost have 60 &nbsp;since most H1 bars are made up of 60 M1 bars. But this is not always the case. For example, below are incomplete hourly bars, consisting of fewer minutes: this can be either the consequences of an earlier market close due to the holiday schedule, or real gaps in trading activity (lack of liquidity).</span></p>
<div style="text-align: left; text-indent: 0; line-height: 1.0; page-break-inside: avoid; page-break-after: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0 0 0 0; margin: 2px 17px 2px 17px;"><table cellspacing="0" cellpadding="3" border="0" style="text-align: justify;border:none; border-spacing:0;">
<tr>
<td style="vertical-align:top; padding:3px; border:none"><p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample">...</span>
<br><span class="f_CodeExample">[38]&nbsp;2021.10.11&nbsp;01:00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;20&nbsp;&nbsp;2346&nbsp;&nbsp;&nbsp;&nbsp;60&nbsp;&nbsp;2287</span>
<br><span class="f_CodeExample">[39]&nbsp;2021.10.11&nbsp;00:00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;85&nbsp;&nbsp;2404&nbsp;&nbsp;&nbsp;&nbsp;58&nbsp;&nbsp;2347</span>
<br><span class="f_CodeExample">[40]&nbsp;2021.10.08&nbsp;23:00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;15&nbsp;&nbsp;2406&nbsp;&nbsp;&nbsp;&nbsp;55&nbsp;&nbsp;2405</span>
<br><span class="f_CodeExample">[41]&nbsp;2021.10.08&nbsp;22:00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;2463&nbsp;&nbsp;&nbsp;&nbsp;60&nbsp;&nbsp;2460</span>
<br><span class="f_CodeExample">...</span></p>
</td>
</tr>
</table>
</div>

</div>

</body>
</html>
