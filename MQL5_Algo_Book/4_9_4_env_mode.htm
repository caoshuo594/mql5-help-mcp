<!DOCTYPE html>
<html>
  <head>
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
  <title>4.9.4 Terminal and program operating modes</title>
  <meta name="keywords" content="" />
  <link type="text/css" href="default.css" rel="stylesheet" />

   <script type="text/javascript" src="jquery.js"></script>
   <script type="text/javascript" src="helpman_settings.js"></script>
   <script type="text/javascript" src="helpman_topicinit.js"></script>


</head>

<body style="background-color:#FFFFFF; font-family:'Trebuchet MS',Tahoma,Arial,Helvetica,sans-serif; margin:0px;">



<table width="100%" height="49"  border="0" cellpadding="0" cellspacing="0" style="margin-top:0px; background-color:#1660af;">
  <tr>
    <td></td>
    <td valign="middle">
      <table style="margin-top:4px; margin-bottom:5px;" width="100%"  border="0" cellspacing="0" cellpadding="5">
        <tr valign="middle">
          <td class="nav">
<a class="h_m" href="index.htm">          MQL5 Programming for Traders </a> / <a class="h_m" href="part4.htm"> Part 4. Common APIs </a> / <a class="h_m" href="4_9_environment.htm"> 4.9 MQL program execution environment </a>/ 4.9.4 Terminal and program operating modes
          </td>
          <td width="70" align="right">
          <a href="4_9_3_env_type_license.htm"><img style="vertical-align:middle;" src="previous.png" alt="?????" width="27" height="27" border=0></a>&nbsp;
          <a href="4_9_5_env_permissions.htm"><img style="vertical-align:middle;" src="next.png" alt="??????" width="27" height="27" border="0"></a>
          </td>
        </tr>
      </table>
    </td>
    <td width="5"></td>
  </tr>
</table>



<div id="help">
<p class="p_H3"><span class="f_H3">4.9.4 Terminal and program operating modes</span></p>
<p class="p_Text"><span class="f_Text">The MetaTrader 5 environment provides a solution to various tasks at the intersection of trading and programming, which necessitates several modes of operation of both the terminal itself and a specific program.</span></p>
<p class="p_Text"><span class="f_Text">Using the MQL5 API, you can distinguish between regular online activity and backtesting, between source code debugging (in order to identify potential errors) and performance analysis (search for bottlenecks in the code), as well as between a local copy of the terminal and the cloud one (MetaTrader VPS).</span></p>
<p class="p_Text"><span class="f_Text">The modes are described by flags, each of which contains a value of a boolean type: </span><span class="f_Text" style="font-style: italic;">true</span><span class="f_Text"> or </span><span class="f_Text" style="font-style: italic;">false</span><span class="f_Text">.</span></p>
<div style="text-align: justify; text-indent: 0; padding: 0 0 0 0; margin: 7px 17px 6px 17px;"><table class="table" cellspacing="0" cellpadding="5" border="1">
<thead>
<tr class="table">
<th class="table"><p class="p_BoldTitlesInTables"><span class="f_BoldTitlesInTables">Identifier</span></p>
</th>
<th class="table" style="width:75%;"><p class="p_BoldTitlesInTables"><span class="f_BoldTitlesInTables">Description</span></p>
</th>
</tr>
</thead>
<tbody>
<tr class="table">
<td class="table"><p class="p_fortable"><span class="f_fortable">MQL_DEBUG</span></p>
</td>
<td class="table" style="width:75%;"><p class="p_fortable"><span class="f_fortable">The program is running in debug mode</span></p>
</td>
</tr>
<tr class="table">
<td class="table"><p class="p_fortable"><span class="f_fortable">MQL_PROFILER</span></p>
</td>
<td class="table" style="width:75%;"><p class="p_fortable"><span class="f_fortable">The program works in code profiling mode</span></p>
</td>
</tr>
<tr class="table">
<td class="table"><p class="p_fortable"><span class="f_fortable">MQL_TESTER</span></p>
</td>
<td class="table" style="width:75%;"><p class="p_fortable"><span class="f_fortable">The program works in the tester</span></p>
</td>
</tr>
<tr class="table">
<td class="table"><p class="p_fortable"><span class="f_fortable">MQL_FORWARD</span></p>
</td>
<td class="table" style="width:75%;"><p class="p_fortable"><span class="f_fortable">The program is executed in the process of forward testing</span></p>
</td>
</tr>
<tr class="table">
<td class="table"><p class="p_fortable"><span class="f_fortable">MQL_OPTIMIZATION</span></p>
</td>
<td class="table" style="width:75%;"><p class="p_fortable"><span class="f_fortable">The program is running in the optimization process</span></p>
</td>
</tr>
<tr class="table">
<td class="table"><p class="p_fortable"><span class="f_fortable">MQL_VISUAL_MODE</span></p>
</td>
<td class="table" style="width:75%;"><p class="p_fortable"><span class="f_fortable">The program is running in visual testing mode</span></p>
</td>
</tr>
<tr class="table">
<td class="table"><p class="p_fortable"><span class="f_fortable">MQL_FRAME_MODE</span></p>
</td>
<td class="table" style="width:75%;"><p class="p_fortable"><span class="f_fortable">The Expert Advisor is executed on the chart in the mode of collecting frames of optimization results</span></p>
</td>
</tr>
<tr class="table">
<td class="table"><p class="p_fortable"><span class="f_fortable">TERMINAL_VPS</span></p>
</td>
<td class="table" style="width:75%;"><p class="p_fortable"><span class="f_fortable">The terminal works on a virtual server MetaTrader Virtual Hosting (MetaTrader VPS)</span></p>
</td>
</tr>
</tbody>
</table>
</div>
<p class="p_Text"><span class="f_Text">The MQL_FORWARD, MQL_OPTIMIZATION, and MQL_VISUAL_MODE flags imply the presence of the MQL_TESTER flag set.</span></p>
<p class="p_Text"><span class="f_Text">Some pairwise combinations of flags are mutually exclusive, i.e., such flags cannot be enabled at the same time.</span></p>
<p class="p_Text"><span class="f_Text">In particular, the presence of MQL_FRAME_MODE excludes MQL_TESTER, and vice versa. MQL_OPTIMIZATION excludes MQL_VISUAL_MODE, and MQL_PROFILER excludes MQL_DEBUG.</span></p>
<p class="p_Text"><span class="f_Text">We will study all the flags related to testing (MQL_TESTER, MQL_VISUAL_MODE) in the sections devoted to <a href="6_5_18_tester_debug_profile.htm" class="topiclink">Expert Advisors</a> and, in part, to <a href="5_4_18_indicators_test.htm" class="topiclink">indicators</a>. Everything related to Expert Advisor optimization (MQL_OPTIMIZATION, MQL_FORWARD, MQL_FRAME_MODE) will be covered in a <a href="6_5_tester.htm" class="topiclink">separate section</a>.</span></p>
<p class="p_Text"><span class="f_Text">Now let's get acquainted with the principles of reading flags using the example of debugging (MQL_DEBUG) and profiling (MQL_PROFILER) modes. At the same time, let's recall how these modes are activated from the MetaEditor (for details, see the documentation, in sections <a href="https://www.metatrader5.com/en/metaeditor/help/development/debug" target="_blank" class="weblink" title="Documentation on mql5.com">Debugging</a> and <a href="https://www.metatrader5.com/en/metaeditor/help/development/profiling" target="_blank" class="weblink" title="Documentation on mql5.com">Profiling</a>).</span></p>
<p class="p_Text"><span class="f_Text">We will use the </span><span class="f_Text" style="font-style: italic;">EnvMode.mq5</span><span class="f_Text"> script.</span></p>
<div style="text-align: left; text-indent: 0; line-height: 1.0; page-break-inside: avoid; page-break-after: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0 0 0 0; margin: 2px 17px 2px 17px;"><table cellspacing="0" cellpadding="3" border="0" style="text-align: justify;border:none; border-spacing:0;">
<tr>
<td style="vertical-align:top; padding:3px; border:none"><p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample" style="color: #0000ff;">void</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">OnStart</span><span class="f_CodeExample">()</span>
<br><span class="f_CodeExample">{</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #ff0000;">PRTF</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #0000ff;">MQLInfoInteger</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #ff0000;">MQL_TESTER</span><span class="f_CodeExample">));</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #ff0000;">PRTF</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #0000ff;">MQLInfoInteger</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #ff0000;">MQL_DEBUG</span><span class="f_CodeExample">));</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #ff0000;">PRTF</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #0000ff;">MQLInfoInteger</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #ff0000;">MQL_PROFILER</span><span class="f_CodeExample">));</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #ff0000;">PRTF</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #0000ff;">MQLInfoInteger</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #ff0000;">MQL_VISUAL_MODE</span><span class="f_CodeExample">));</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #ff0000;">PRTF</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #0000ff;">MQLInfoInteger</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #ff0000;">MQL_OPTIMIZATION</span><span class="f_CodeExample">));</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #ff0000;">PRTF</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #0000ff;">MQLInfoInteger</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #ff0000;">MQL_FORWARD</span><span class="f_CodeExample">));</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #ff0000;">PRTF</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #0000ff;">MQLInfoInteger</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #ff0000;">MQL_FRAME_MODE</span><span class="f_CodeExample">));</span>
<br><span class="f_CodeExample">}</span></p>
</td>
</tr>
</table>
</div>
<p class="p_Text"><span class="f_Text">Before running the program, you should check the debugging/profiling settings. To do this, in MetaEditor, run the command </span><span class="f_Text" style="font-style: italic;">Tools -&gt; Options</span><span class="f_Text"> and check the field values in the </span><span class="f_Text" style="font-style: italic;">Debugging/Profiling</span><span class="f_Text"> tab. If the option </span><span class="f_Text" style="font-style: italic;">Use specified settings</span><span class="f_Text"> is enabled, then it is the values of the underlying fields that will affect the financial instrument chart and the timeframe on which the program will be launched. If the option is disabled, the first financial instrument in </span><span class="f_Text" style="font-style: italic;">Market Watch</span><span class="f_Text"> and the H1 timeframe will be used.</span></p>
<p class="p_Text"><span class="f_Text">At this stage, the choice of option is not critical.</span></p>
<p class="p_Text"><span class="f_Text">After preparations, run the script using the command </span><span class="f_Text" style="font-style: italic;">Debug -&gt; Start on Real Data</span><span class="f_Text"> (F5). Since the script only prints the requested properties to the log (and we don't need breakpoints in it), its execution will be instantaneous. If step-by-step debugging is needed, we could put a breakpoint (F9) on any statement in the source code, and the script execution would freeze there for any period we need, making it possible to study the contents of all variables in MetaEditor, and also move line by line (F10) along the algorithm.</span></p>
<p class="p_Text"><span class="f_Text">In the MetaTrader 5 log (Experts tab), we will see the following:</span></p>
<div style="text-align: left; text-indent: 0; line-height: 1.0; page-break-inside: avoid; page-break-after: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0 0 0 0; margin: 2px 17px 2px 17px;"><table cellspacing="0" cellpadding="3" border="0" style="text-align: justify;border:none; border-spacing:0;">
<tr>
<td style="vertical-align:top; padding:3px; border:none"><p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample">MQLInfoInteger(MQL_TESTER)=0&nbsp;/&nbsp;ok</span>
<br><span class="f_CodeExample">MQLInfoInteger(MQL_DEBUG)=1&nbsp;/&nbsp;ok</span>
<br><span class="f_CodeExample">MQLInfoInteger(MQL_PROFILER)=0&nbsp;/&nbsp;ok</span>
<br><span class="f_CodeExample">MQLInfoInteger(MQL_VISUAL_MODE)=0&nbsp;/&nbsp;ok</span>
<br><span class="f_CodeExample">MQLInfoInteger(MQL_OPTIMIZATION)=0&nbsp;/&nbsp;ok</span>
<br><span class="f_CodeExample">MQLInfoInteger(MQL_FORWARD)=0&nbsp;/&nbsp;ok</span>
<br><span class="f_CodeExample">MQLInfoInteger(MQL_FRAME_MODE)=0&nbsp;/&nbsp;ok</span></p>
</td>
</tr>
</table>
</div>
<p class="p_Text"><span class="f_Text">Flags of all modes are reset, except for MQL_DEBUG.</span></p>
<p class="p_Text"><span class="f_Text">Now let's run the same script from the </span><span class="f_Text" style="font-style: italic;">Navigator</span><span class="f_Text"> in MetaTrader 5 (just drag it with the mouse to any chart). We will get an almost identical set of flags, but this time MQL_DEBUG will be equal to 0 (because the program was executed in a regular way, and not under a debugger).</span></p>
<p class="p_Quote"><span class="f_Quote">Please note that the launch of the program with debugging is preceded by its recompilation in a special mode when service information permitting debugging is added to the executable file. Such binary file is larger and slower than usual. Therefore, after debugging is completed, before being used in real trading, transferred to the customer, or uploaded to the Market, the program should be recompiled with the </span><span class="f_Quote" style="font-style: italic;">File -&gt; Compile</span><span class="f_Quote"> (F7) command.</span><br>
<span class="f_Quote" style="font-style: italic;">&nbsp;</span><br>
<span class="f_Quote">The compilation method does not directly affect the MQL_DEBUG property. The debug version of the program, as we can see, can be launched in the terminal without a debugger, and MQL_DEBUG will be reset in this case. Two built-in macros allow you to determine the compilation method: _DEBUG and _RELEASE (see section <a href="2_9_7_preprocessor_predefined.htm" class="topiclink">Predefined Constants</a>). They are constants, not functions, because this property is &quot;hardwired&quot; into the program at compile time, and cannot then be changed (unlike the runtime environment).</span></p>
<p class="p_Text"><span class="f_Text">Now let's execute in MetaEditor the command </span><span class="f_Text" style="font-style: italic;">Debug -&gt; Start Profiling on Real Data</span><span class="f_Text">. Of course, there is no particular point in profiling such a simple script, but our task now is to make sure that the appropriate flag is turned on in the environment properties. Indeed, opposite the MQL_PROFILER there is 1 now.</span></p>
<div style="text-align: left; text-indent: 0; line-height: 1.0; page-break-inside: avoid; page-break-after: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0 0 0 0; margin: 2px 17px 2px 17px;"><table cellspacing="0" cellpadding="3" border="0" style="text-align: justify;border:none; border-spacing:0;">
<tr>
<td style="vertical-align:top; padding:3px; border:none"><p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample">MQLInfoInteger(MQL_TESTER)=0&nbsp;/&nbsp;ok</span>
<br><span class="f_CodeExample">MQLInfoInteger(MQL_DEBUG)=0&nbsp;/&nbsp;ok</span>
<br><span class="f_CodeExample">MQLInfoInteger(MQL_PROFILER)=1&nbsp;/&nbsp;ok</span>
<br><span class="f_CodeExample">...</span></p>
</td>
</tr>
</table>
</div>
<p class="p_Quote"><span class="f_Quote">The launch of the program with profiling is also preceded by its recompilation in another special mode, which adds other service information to the binary file that is necessary to measure the speed of instruction execution. After analyzing the profiler report and fixing bottlenecks, you should recompile the program in the usual way.</span></p>
<p class="p_Text"><span class="f_Text">In principle, debugging and profiling can be performed both online and in the tester (MQL_TESTER) on historical data, but the tester only supports Expert Advisors and indicators. Therefore, it is impossible to see the set MQL_TESTER or MQL_VISUAL_MODE flag in the script example.</span></p>
<p class="p_Text"><span class="f_Text">As you know, MetaTrader 5 allows you to test trading programs in quick mode (without a chart) and in visual mode (on a separate chart). It is in the second case that the MQL_VISUAL_MODE properties will be enabled. It makes sense to check it, in particular, to disable manipulations with <a href="5_8_objects.htm" class="topiclink">graphic objects</a> in the absence of visualization.</span></p>
<p class="p_Text"><span class="f_Text">To debug in visual mode using history, you must first enable the option </span><span class="f_Text" style="font-style: italic;">Use visual mode for debugging on history</span><span class="f_Text"> in the MetaEditor settings dialog. Analytical programs (indicators) are always tested in visual mode.</span></p>
<p class="p_Text"><span class="f_Text">Keep in mind that online debugging is not safe for trading Expert Advisors.</span></p>

</div>

</body>
</html>
