<!DOCTYPE html>
<html>
  <head>
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
  <title>5.3.6 Overview of Copy functions for obtaining arrays of quotes</title>
  <meta name="keywords" content="" />
  <link type="text/css" href="default.css" rel="stylesheet" />

   <script type="text/javascript" src="jquery.js"></script>
   <script type="text/javascript" src="helpman_settings.js"></script>
   <script type="text/javascript" src="helpman_topicinit.js"></script>


</head>

<body style="background-color:#FFFFFF; font-family:'Trebuchet MS',Tahoma,Arial,Helvetica,sans-serif; margin:0px;">



<table width="100%" height="49"  border="0" cellpadding="0" cellspacing="0" style="margin-top:0px; background-color:#1660af;">
  <tr>
    <td></td>
    <td valign="middle">
      <table style="margin-top:4px; margin-bottom:5px;" width="100%"  border="0" cellspacing="0" cellpadding="5">
        <tr valign="middle">
          <td class="nav">
<a class="h_m" href="index.htm">          MQL5 Programming for Traders </a> / <a class="h_m" href="part5.htm"> Part 5. Creating application programs </a> / <a class="h_m" href="5_3_timeseries.htm"> 5.3 Timeseries </a>/ 5.3.6 Overview of Copy functions for obtaining arrays of quotes
          </td>
          <td width="70" align="right">
          <a href="5_3_5_timeseries_ibarshift.htm"><img style="vertical-align:middle;" src="previous.png" alt="?????" width="27" height="27" border=0></a>&nbsp;
          <a href="5_3_7_timeseries_mqlrates.htm"><img style="vertical-align:middle;" src="next.png" alt="??????" width="27" height="27" border="0"></a>
          </td>
        </tr>
      </table>
    </td>
    <td width="5"></td>
  </tr>
</table>



<div id="help">
<p class="p_H3"><span class="f_H3">5.3.6 Overview of Copy functions for obtaining arrays of quotes</span></p>
<p class="p_Text"><span class="f_Text">The MQL5 API contains several functions for reading quote timeseries into arrays. Their names are given in the following table.</span></p>
<div style="text-align: justify; text-indent: 0; padding: 0 0 0 0; margin: 7px 17px 6px 17px;"><table class="table" cellspacing="0" cellpadding="5" border="1">
<thead>
<tr class="table">
<th class="table" style="width:25%;"><p class="p_BoldTitlesInTables"><span class="f_BoldTitlesInTables">Function</span></p>
</th>
<th class="table"><p class="p_BoldTitlesInTables"><span class="f_BoldTitlesInTables">Action</span></p>
</th>
</tr>
</thead>
<tbody>
<tr class="table">
<td class="table" style="width:25%;"><p class="p_fortable"><span class="f_fortable">CopyRates</span></p>
</td>
<td class="table"><p class="p_fortable"><span class="f_fortable">Get the history of quotes into an array of </span><span class="f_fortable" style="font-style: italic;">MqlRates</span><span class="f_fortable"> structures</span></p>
</td>
</tr>
<tr class="table">
<td class="table" style="width:25%;"><p class="p_fortable"><span class="f_fortable">CopyTime</span></p>
</td>
<td class="table"><p class="p_fortable"><span class="f_fortable">Get the history of bar opening times into an array of type </span><span class="f_fortable" style="font-style: italic;">datetime</span></p>
</td>
</tr>
<tr class="table">
<td class="table" style="width:25%;"><p class="p_fortable"><span class="f_fortable">CopyOpen</span></p>
</td>
<td class="table"><p class="p_fortable"><span class="f_fortable">Get the history of bar opening prices into an array of type </span><span class="f_fortable" style="font-style: italic;">double</span></p>
</td>
</tr>
<tr class="table">
<td class="table" style="width:25%;"><p class="p_fortable"><span class="f_fortable">CopyHigh</span></p>
</td>
<td class="table"><p class="p_fortable"><span class="f_fortable">Get the history of bar high prices into an array of type </span><span class="f_fortable" style="font-style: italic;">double</span></p>
</td>
</tr>
<tr class="table">
<td class="table" style="width:25%;"><p class="p_fortable"><span class="f_fortable">CopyLow</span></p>
</td>
<td class="table"><p class="p_fortable"><span class="f_fortable">Get the history of bar low prices into an array of type </span><span class="f_fortable" style="font-style: italic;">double</span></p>
</td>
</tr>
<tr class="table">
<td class="table" style="width:25%;"><p class="p_fortable"><span class="f_fortable">CopyClose</span></p>
</td>
<td class="table"><p class="p_fortable"><span class="f_fortable">Get the history of bar closing prices into an array of type </span><span class="f_fortable" style="font-style: italic;">double</span></p>
</td>
</tr>
<tr class="table">
<td class="table" style="width:25%;"><p class="p_fortable"><span class="f_fortable">CopyTickVolume</span></p>
</td>
<td class="table"><p class="p_fortable"><span class="f_fortable">Get the history of tick volumes into an array of type </span><span class="f_fortable" style="font-style: italic;">long</span></p>
</td>
</tr>
<tr class="table">
<td class="table" style="width:25%;"><p class="p_fortable"><span class="f_fortable">CopyRealVolume</span></p>
</td>
<td class="table"><p class="p_fortable"><span class="f_fortable">Get the history of exchange volumes into an array of type </span><span class="f_fortable" style="font-style: italic;">long</span></p>
</td>
</tr>
<tr class="table">
<td class="table" style="width:25%;"><p class="p_fortable"><span class="f_fortable">CopySpread</span></p>
</td>
<td class="table"><p class="p_fortable"><span class="f_fortable">Get the history of spreads into an array of type </span><span class="f_fortable" style="font-style: italic;">int</span></p>
</td>
</tr>
</tbody>
</table>
</div>
<p class="p_Text"><span class="f_Text">All functions take as the first two parameters the name of the desired symbol and period, which can be conditionally represented by the following pseudocode:</span></p>
<div style="text-align: left; text-indent: 0; line-height: 1.0; page-break-inside: avoid; page-break-after: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0 0 0 0; margin: 2px 17px 2px 17px;"><table cellspacing="0" cellpadding="3" border="0" style="text-align: justify;border:none; border-spacing:0;">
<tr>
<td style="vertical-align:top; padding:3px; border:none"><p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample" style="color: #0000ff;">int</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #333333;">Copy</span><span class="f_CodeExample">***(</span><span class="f_CodeExample" style="color: #0000ff;">const</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">string</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">symbol</span><span class="f_CodeExample">,&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">ENUM_TIMEFRAMES</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #333333;">timeframe</span><span class="f_CodeExample">,&nbsp;...)</span></p>
</td>
</tr>
</table>
</div>
<p class="p_Text"><span class="f_Text">Also, all functions have three variants of the prototype, which differ in the way the requested range is set:</span></p>
<ul>
<li class="p_li"><span class="f_li">Initial bar index and number of bars: </span><span class="f_li" style="font-style: italic;">Copy***(..., int offset, int count, ...)</span></li>
<li class="p_li"><span class="f_li">Range start time and number of bars: </span><span class="f_li" style="font-style: italic;">Copy***(..., datetime start, int count, ...)</span></li>
<li class="p_li"><span class="f_li">Range start and end times: </span><span class="f_li" style="font-style: italic;">Copy***(..., datetime start, datetime stop, ...)</span></li>
</ul>
<p class="p_Text"><span class="f_Text">At the same time, the parameter notation implies that the requested data has an indexing direction as in a timeseries, that is, the </span><span class="f_Text" style="font-style: italic;">offset</span><span class="f_Text"> position with index 0 stores the data of the current incomplete bar, and the increase in indexes corresponds to moving deeper into the price history. Because of this, in particular of the second option, the indicated number of bars </span><span class="f_Text" style="font-style: italic;">count</span><span class="f_Text"> will count backward from the start of the </span><span class="f_Text" style="font-style: italic;">offset</span><span class="f_Text"> range, that is, in the time decrease direction.</span></p>
<p class="p_Text"><span class="f_Text">The third option provides additional flexibility: it does not matter in which order the start and finish dates are specified (</span><span class="f_Text" style="font-style: italic;">start/stop</span><span class="f_Text">), as the functions will in any case return data in the range from the smaller date to the larger one. Suitable bars are selected in such a way that their opening time is between time counts </span><span class="f_Text" style="font-style: italic;">start/stop</span><span class="f_Text"> or is equal to one of them, that is, range [</span><span class="f_Text" style="font-style: italic;">start; stop</span><span class="f_Text">] is considered including boundaries.</span></p>
<p class="p_Text"><span class="f_Text">Which function option to choose is determined by the developer based on what is more important: to get a guaranteed number of elements (for example, for machine learning algorithms) or to cover a specific date interval (for example, with a predetermined uniform market behavior).</span></p>
<p class="p_Text"><span class="f_Text">The time representation accuracy in the </span><span class="f_Text" style="font-style: italic;">datetime</span><span class="f_Text"> type is 1 second. Values </span><span class="f_Text" style="font-style: italic;">start/stop</span><span class="f_Text"> do not have to be rounded to the size of the period. For example, the range from 14:59 to 16:01 will allow you to select two bars on the H1 timeframe for 15:00 and 16:00. A degenerate range with equal and rounded labels, for example, 15:00 in H1 quotes, corresponds to one bar.</span></p>
<p class="p_Text"><span class="f_Text">You can request bars on the daily timeframe even if there are non-zero hours/minutes/seconds in the start/stop parameters (despite the fact that the bar labels on the D1 timeframe have the time 00:00). In this case, only those D1 bars that have an opening time after the minimum of </span><span class="f_Text" style="font-style: italic;">start/stop</span><span class="f_Text"> and up to the maximum </span><span class="f_Text" style="font-style: italic;">start/stop</span><span class="f_Text"> (equality with labels of daily bars is impossible in this case since the required time contains hours/minutes/seconds). For example, between D'2021.09.01 12:00' and D'2021.09.03 07:00', there are two opening times of D1 bars – D'2021.09.02' and D'2021.09.03'. These bars will be included in the result. Bar D'2021.09.01' has an opening time of 00:00 which is earlier than the beginning of the range and is therefore discarded. Bar D'2021.09.03' is included in the result, despite the fact that only 7 hours of the morning from that day fell into the range. On the other hand, a request for several hours within a day, for example, between D'2021.09.01 12:00' and D'2021.09.01 15:00' will not cover a single day bar (the opening time of the D'2021.09.01' bar does not fall into this range), and therefore the receiving array will be empty.</span></p>
<p class="p_Text"><span class="f_Text">The only difference between all the functions from the table is the type of the array that receives the data, which is passed as the last parameter by reference. For example, the </span><span class="f_Text" style="font-style: italic;">CopyRates</span><span class="f_Text"> function puts the requested data into an array of structures </span><span class="f_Text" style="font-style: italic;"><a href="5_3_7_timeseries_mqlrates.htm" class="topiclink">MqlRates</a></span><span class="f_Text">, and the </span><span class="f_Text" style="font-style: italic;">CopyTime</span><span class="f_Text"> function places the bar opening times into an array of type </span><span class="f_Text" style="font-style: italic;">datetime</span><span class="f_Text">, and so on.</span></p>
<p class="p_Text"><span class="f_Text">Thus, common function prototypes can be represented as follows:</span></p>
<p class="p_H4"><span class="f_H4" style="letter-spacing: -1px;">int Copy***(const string symbol, ENUM_TIMEFRAMES timeframe, int offset, int count, type &amp;result[])</span></p>
<p class="p_H4" style="margin: 0 23px 1px 17px;"><span class="f_H4" style="letter-spacing: -1px;">int Copy***(const string symbol, ENUM_TIMEFRAMES timeframe, datetime start, int count, type &amp;result[])</span></p>
<p class="p_H4" style="margin: 0 23px 1px 17px;"><span class="f_H4" style="letter-spacing: -1px;">int Copy***(const string symbol, ENUM_TIMEFRAMES timeframe, datetime start, datetime stop, type &amp;result[])</span></p>
<p class="p_Text"><span class="f_Text">Here, the </span><span class="f_Text" style="font-style: italic;">type</span><span class="f_Text"> matches any of the types </span><span class="f_Text" style="font-style: italic;">MqlRates</span><span class="f_Text">, </span><span class="f_Text" style="font-style: italic;">datetime</span><span class="f_Text">, </span><span class="f_Text" style="font-style: italic;">double</span><span class="f_Text">, </span><span class="f_Text" style="font-style: italic;">long</span><span class="f_Text"> or </span><span class="f_Text" style="font-style: italic;">int</span><span class="f_Text">, depending on the specific function.</span></p>
<p class="p_Text"><span class="f_Text">The functions return the number of elements copied into the array or -1 on error. In particular, we will get -1 if there is no data on the server in the requested interval, or the interval is outside the maximum number of bars on the chart (</span><span class="f_Text" style="font-style: italic;">TerminalInfoInteger(TERMINAL_MAXBARS)</span><span class="f_Text">).</span></p>
<p class="p_Text"><span class="f_Text">It is important to note that in the receiving array, the received data is always physically placed in chronological order, from the past to the future. Thus, if the standard indexing is used for the receiving array (that is, the function </span><span class="f_Text" style="font-style: italic;"><a href="4_3_8_arrays_as_series.htm" class="topiclink">ArraySetAsSeries</a></span><span class="f_Text">), then the element at index 0 will be the oldest and the last element the newest. If the instruction was executed for the array </span><span class="f_Text" style="font-style: italic;">ArraySetAsSeries(result, true)</span><span class="f_Text">, then the numbering will be carried out in reverse order, as in a timeseries: the 0th element will be the newest in the range, and the last element will be the oldest. This is illustrated in the following figure.</span></p>
<p class="p_Text" style="text-align: center;"><img class="help" alt="Terminal timeseries and receiving array" title="Terminal timeseries and receiving array" width="600" height="306" style="margin:0 auto 0 auto;width:600px;height:306px;border:none" src="series_en.png"/></p>
<p class="p_ImageCaption"><span class="f_ImageCaption">Terminal timeseries and receiving array</span></p>
<p class="p_Text"><span class="f_Text">If successful, the specified number of elements from the terminal's own (internal) timeseries will be copied to the destination array. When requesting data by date range (</span><span class="f_Text" style="font-style: italic;">start/stop</span><span class="f_Text">), the number of elements in the resulting array will be determined indirectly, based on the contents of the history in this range. Therefore, to copy a previously unknown number of values, it is recommended to use dynamic arrays: the copy functions independently allocate the required size of the destination arrays (the size can be either increased or decreased).</span></p>
<p class="p_Text"><span class="f_Text">If you need to copy a known number of elements or do it frequently, such as every time you call </span><span class="f_Text" style="font-style: italic;"><a href="6_4_1_experts_ontick.htm" class="topiclink">OnTick</a></span><span class="f_Text"> in Expert Advisors or </span><span class="f_Text" style="font-style: italic;"><a href="5_4_2_indicators_oncalculate.htm" class="topiclink">OnCalculate</a></span><span class="f_Text"> in indicators, it is better to use statically distributed arrays. The fact is that memory allocation operations for dynamic arrays require additional time and can affect performance, especially during testing and optimization.</span></p>
<p class="p_Text"><span class="f_Text">Timeseries are accessed differently for different types of MQL programs if the requested data is not yet ready. For example, in custom <a href="5_4_indicators_make.htm" class="topiclink">indicators</a></span><span class="f_Text" style="font-style: italic;">, Copy</span><span class="f_Text"> functions immediately return an error, since the indicators are executed in the common interface thread of the terminal and cannot wait for data to be received (it is assumed that the indicators will request data during the next calls of their event handlers, and the timeseries will have already been downloaded and built by that time). In addition, in the chapter on indicators, we will learn that to access the quotes of the &quot;native&quot; chart on which the indicator is placed, it does not need to use </span><span class="f_Text" style="font-style: italic;">Copy</span><span class="f_Text"> functions, because all time series are automatically passed through array parameters of the handler </span><span class="f_Text" style="font-style: italic;"><a href="5_4_2_indicators_oncalculate.htm" class="topiclink">OnCalculate</a></span><span class="f_Text">.</span></p>
<p class="p_Text"><span class="f_Text">When accessed from Expert Advisors and scripts, several attempts are made to receive data with a short pause (with a wait inside the function), which gives time to load and calculate the missing timeseries. The function will return the amount of data that will be ready by the time this timeout expires, but the history loading will continue, and the next similar request will return more data.</span></p>
<p class="p_Text"><span class="f_Text">In any case, you should be prepared that the </span><span class="f_Text" style="font-style: italic;">Copy</span><span class="f_Text"> function will return an error instead of data (there are different reasons: connection failure, lack of requested data, processor load if many new timeseries are requested in parallel): analyze the cause of the problem in the code (<a href="4_9_15_env_last_error.htm" class="topiclink">_LastError</a>) and try again later, correct the settings, or inform the user.</span></p>
<p class="p_Text"><span class="f_Text">The presence of a symbol in </span><span class="f_Text" style="font-style: italic;">Market Watch</span><span class="f_Text"> is not a necessary condition for requesting timeseries using </span><span class="f_Text" style="font-style: italic;">Copy</span><span class="f_Text"> functions, however, for symbols included in this window, queries tend to run faster because some data has already been downloaded from the server and probably calculated for the requested periods. How to add characters to </span><span class="f_Text" style="font-style: italic;">Market Watch</span><span class="f_Text"> programmatically, we will learn in the section <a href="6_1_2_symbols_select.htm" class="topiclink">Editing the Market Watch list</a>.</span></p>
<p class="p_Text"><span class="f_Text">To explain the principles of how the functions work in practice, let's consider the script </span><span class="f_Text" style="font-style: italic;">SeriesCopy.mq5</span><span class="f_Text">. It contains multiple calls to the function </span><span class="f_Text" style="font-style: italic;">CopyTime</span><span class="f_Text">, which allows you to visually see how the timestamps and bar numbers correlate.</span></p>
<p class="p_Text"><span class="f_Text">The script defines a dynamic array </span><span class="f_Text" style="font-style: italic;">times</span><span class="f_Text"> to receive data. All requests are made for the &quot;EURUSD&quot; symbol and the H1 timeframe.</span></p>
<div style="text-align: left; text-indent: 0; line-height: 1.0; page-break-inside: avoid; page-break-after: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0 0 0 0; margin: 2px 17px 2px 17px;"><table cellspacing="0" cellpadding="3" border="0" style="text-align: justify;border:none; border-spacing:0;">
<tr>
<td style="vertical-align:top; padding:3px; border:none"><p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample" style="color: #0000ff;">void</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">OnStart</span><span class="f_CodeExample">()</span>
<br><span class="f_CodeExample">{</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">datetime</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #333333;">times</span><span class="f_CodeExample">[];</span></p>
</td>
</tr>
</table>
</div>
<p class="p_Text"><span class="f_Text">To begin with, a request is made for 10 bars, starting from September 5, 2021, into the past. Since this day is Sunday, the previous bars were on Friday the 3rd (see the log below).</span></p>
<div style="text-align: left; text-indent: 0; line-height: 1.0; page-break-inside: avoid; page-break-after: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0 0 0 0; margin: 2px 17px 2px 17px;"><table cellspacing="0" cellpadding="3" border="0" style="text-align: justify;border:none; border-spacing:0;">
<tr>
<td style="vertical-align:top; padding:3px; border:none"><p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #ff0000;">PRTF</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #0000ff;">CopyTime</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #008080;">&quot;EURUSD&quot;</span><span class="f_CodeExample">,&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">PERIOD_H1</span><span class="f_CodeExample">,&nbsp;</span><span class="f_CodeExample" style="color: #333333;">D</span><span class="f_CodeExample">'</span><span class="f_CodeExample" style="color: #333333;">2021</span><span class="f_CodeExample">.</span><span class="f_CodeExample" style="color: #333333;">09</span><span class="f_CodeExample">.</span><span class="f_CodeExample" style="color: #333333;">05</span><span class="f_CodeExample">',&nbsp;</span><span class="f_CodeExample" style="color: #333333;">10</span><span class="f_CodeExample">,&nbsp;</span><span class="f_CodeExample" style="color: #333333;">times</span><span class="f_CodeExample">));&nbsp;</span><span class="f_CodeExample" style="color: #808080;">//&nbsp;10&nbsp;/&nbsp;ok</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">ArrayPrint</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #333333;">times</span><span class="f_CodeExample">);</span>
<br><span class="f_CodeExample" style="color: #808080;">&nbsp;&nbsp;&nbsp;/*</span>
<br><span class="f_CodeExample" style="color: #808080; letter-spacing: -1px;">&nbsp;&nbsp;&nbsp;[0]&nbsp;2021.09.03&nbsp;14:00&nbsp;2021.09.03&nbsp;15:00&nbsp;2021.09.03&nbsp;16:00&nbsp;2021.09.03&nbsp;17:00&nbsp;2021.09.03&nbsp;18:00</span>
<br><span class="f_CodeExample" style="color: #808080; letter-spacing: -1px;">&nbsp;&nbsp;&nbsp;[5]&nbsp;2021.09.03&nbsp;19:00&nbsp;2021.09.03&nbsp;20:00&nbsp;2021.09.03&nbsp;21:00&nbsp;2021.09.03&nbsp;22:00&nbsp;2021.09.03&nbsp;23:00</span>
<br><span class="f_CodeExample" style="color: #808080;">&nbsp;&nbsp;&nbsp;*/</span></p>
</td>
</tr>
</table>
</div>
<p class="p_Text"><span class="f_Text">The output of the array is done by default in chronological order (despite the fact that the function parameters are set in the reverse coordinate system: as in a timeseries). Let's change the indexing order in the receiving array and output it again.</span></p>
<div style="text-align: left; text-indent: 0; line-height: 1.0; page-break-inside: avoid; page-break-after: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0 0 0 0; margin: 2px 17px 2px 17px;"><table cellspacing="0" cellpadding="3" border="0" style="text-align: justify;border:none; border-spacing:0;">
<tr>
<td style="vertical-align:top; padding:3px; border:none"><p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #ff0000;">PRTF</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #0000ff;">ArraySetAsSeries</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #333333;">times</span><span class="f_CodeExample">,&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">true</span><span class="f_CodeExample">));&nbsp;</span><span class="f_CodeExample" style="color: #808080;">//&nbsp;true&nbsp;/&nbsp;ok</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">ArrayPrint</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #333333;">times</span><span class="f_CodeExample">);</span>
<br><span class="f_CodeExample" style="color: #808080;">&nbsp;&nbsp;&nbsp;/*</span>
<br><span class="f_CodeExample" style="color: #808080; letter-spacing: -1px;">&nbsp;&nbsp;&nbsp;[0]&nbsp;2021.09.03&nbsp;23:00&nbsp;2021.09.03&nbsp;22:00&nbsp;2021.09.03&nbsp;21:00&nbsp;2021.09.03&nbsp;20:00&nbsp;2021.09.03&nbsp;19:00</span>
<br><span class="f_CodeExample" style="color: #808080; letter-spacing: -1px;">&nbsp;&nbsp;&nbsp;[5]&nbsp;2021.09.03&nbsp;18:00&nbsp;2021.09.03&nbsp;17:00&nbsp;2021.09.03&nbsp;16:00&nbsp;2021.09.03&nbsp;15:00&nbsp;2021.09.03&nbsp;14:00</span>
<br><span class="f_CodeExample" style="color: #808080;">&nbsp;&nbsp;&nbsp;*/</span></p>
</td>
</tr>
</table>
</div>
<p class="p_Text"><span class="f_Text">For the next experiments, we will restore the usual order.</span></p>
<div style="text-align: left; text-indent: 0; line-height: 1.0; page-break-inside: avoid; page-break-after: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0 0 0 0; margin: 2px 17px 2px 17px;"><table cellspacing="0" cellpadding="3" border="0" style="text-align: justify;border:none; border-spacing:0;">
<tr>
<td style="vertical-align:top; padding:3px; border:none"><p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #ff0000;">PRTF</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #0000ff;">ArraySetAsSeries</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #333333;">times</span><span class="f_CodeExample">,&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">false</span><span class="f_CodeExample">));&nbsp;</span><span class="f_CodeExample" style="color: #808080;">//&nbsp;true&nbsp;/&nbsp;ok</span></p>
</td>
</tr>
</table>
</div>
<p class="p_Text"><span class="f_Text">Now let's request an indefinite number of bars between two time points (the number is unknown, because holidays may be in the range, for example). We will do this in two ways: in the first case, we indicate the range from the future to the past, and in the second, from the past to the future. The results match.</span></p>
<div style="text-align: left; text-indent: 0; line-height: 1.0; page-break-inside: avoid; page-break-after: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0 0 0 0; margin: 2px 17px 2px 17px;"><table cellspacing="0" cellpadding="3" border="0" style="text-align: justify;border:none; border-spacing:0;">
<tr>
<td style="vertical-align:top; padding:3px; border:none"><p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #808080;">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TO</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #ff0000;">PRTF</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #0000ff;">CopyTime</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #008080;">&quot;EURUSD&quot;</span><span class="f_CodeExample">,&nbsp;</span><span class="f_CodeExample" style="color: #ff0000;">PERIOD_H1</span><span class="f_CodeExample">,&nbsp;</span><span class="f_CodeExample" style="color: #333333;">D</span><span class="f_CodeExample">'</span><span class="f_CodeExample" style="color: #333333;">2021</span><span class="f_CodeExample">.</span><span class="f_CodeExample" style="color: #333333;">09</span><span class="f_CodeExample">.</span><span class="f_CodeExample" style="color: #333333;">06</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #333333;">03</span><span class="f_CodeExample">:</span><span class="f_CodeExample" style="color: #333333;">00</span><span class="f_CodeExample">',&nbsp;</span><span class="f_CodeExample" style="color: #333333;">D</span><span class="f_CodeExample">'</span><span class="f_CodeExample" style="color: #333333;">2021</span><span class="f_CodeExample">.</span><span class="f_CodeExample" style="color: #333333;">09</span><span class="f_CodeExample">.</span><span class="f_CodeExample" style="color: #333333;">05</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #333333;">03</span><span class="f_CodeExample">:</span><span class="f_CodeExample" style="color: #333333;">00</span><span class="f_CodeExample">',&nbsp;</span><span class="f_CodeExample" style="color: #333333;">times</span><span class="f_CodeExample">));</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">ArrayPrint</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #333333;">times</span><span class="f_CodeExample">)&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #808080;">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TO</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #ff0000;">PRTF</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #0000ff;">CopyTime</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #008080;">&quot;EURUSD&quot;</span><span class="f_CodeExample">,&nbsp;</span><span class="f_CodeExample" style="color: #ff0000;">PERIOD_H1</span><span class="f_CodeExample">,&nbsp;</span><span class="f_CodeExample" style="color: #333333;">D</span><span class="f_CodeExample">'</span><span class="f_CodeExample" style="color: #333333;">2021</span><span class="f_CodeExample">.</span><span class="f_CodeExample" style="color: #333333;">09</span><span class="f_CodeExample">.</span><span class="f_CodeExample" style="color: #333333;">05</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #333333;">03</span><span class="f_CodeExample">:</span><span class="f_CodeExample" style="color: #333333;">00</span><span class="f_CodeExample">',&nbsp;</span><span class="f_CodeExample" style="color: #333333;">D</span><span class="f_CodeExample">'</span><span class="f_CodeExample" style="color: #333333;">2021</span><span class="f_CodeExample">.</span><span class="f_CodeExample" style="color: #333333;">09</span><span class="f_CodeExample">.</span><span class="f_CodeExample" style="color: #333333;">06</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #333333;">03</span><span class="f_CodeExample">:</span><span class="f_CodeExample" style="color: #333333;">00</span><span class="f_CodeExample">',&nbsp;</span><span class="f_CodeExample" style="color: #333333;">times</span><span class="f_CodeExample">));</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">ArrayPrint</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #333333;">times</span><span class="f_CodeExample">);</span>
<br><span class="f_CodeExample" style="color: #808080;">&nbsp;&nbsp;&nbsp;/*</span>
<br><span class="f_CodeExample" style="color: #808080; letter-spacing: -1px;">&nbsp;&nbsp;&nbsp;CopyTime(EURUSD,PERIOD_H1,D'2021.09.06&nbsp;03:00',D'2021.09.05&nbsp;03:00',times)=4&nbsp;/&nbsp;ok</span>
<br><span class="f_CodeExample" style="color: #808080; letter-spacing: -1px;">&nbsp;&nbsp;&nbsp;2021.09.06&nbsp;00:00&nbsp;2021.09.06&nbsp;01:00&nbsp;2021.09.06&nbsp;02:00&nbsp;2021.09.06&nbsp;03:00</span>
<br><span class="f_CodeExample" style="color: #808080; letter-spacing: -1px;">&nbsp;&nbsp;&nbsp;CopyTime(EURUSD,PERIOD_H1,D'2021.09.05&nbsp;03:00',D'2021.09.06&nbsp;03:00',times)=4&nbsp;/&nbsp;ok</span>
<br><span class="f_CodeExample" style="color: #808080; letter-spacing: -1px;">&nbsp;&nbsp;&nbsp;2021.09.06&nbsp;00:00&nbsp;2021.09.06&nbsp;01:00&nbsp;2021.09.06&nbsp;02:00&nbsp;2021.09.06&nbsp;03:00</span>
<br><span class="f_CodeExample" style="color: #808080;">&nbsp;&nbsp;&nbsp;*/</span></p>
</td>
</tr>
</table>
</div>
<p class="p_Text"><span class="f_Text">By printing the arrays, we can see that they are identical. Let's return to the timeseries indexing mode and discuss one more point.</span></p>
<div style="text-align: left; text-indent: 0; line-height: 1.0; page-break-inside: avoid; page-break-after: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0 0 0 0; margin: 2px 17px 2px 17px;"><table cellspacing="0" cellpadding="3" border="0" style="text-align: justify;border:none; border-spacing:0;">
<tr>
<td style="vertical-align:top; padding:3px; border:none"><p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #ff0000;">PRTF</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #0000ff;">ArraySetAsSeries</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #333333;">times</span><span class="f_CodeExample">,&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">true</span><span class="f_CodeExample">));&nbsp;</span><span class="f_CodeExample" style="color: #808080;">//&nbsp;true&nbsp;/&nbsp;ok</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">ArrayPrint</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #333333;">times</span><span class="f_CodeExample">);</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #808080;">//&nbsp;2021.09.06&nbsp;03:00&nbsp;2021.09.06&nbsp;02:00&nbsp;2021.09.06&nbsp;01:00&nbsp;2021.09.06&nbsp;00:00</span></p>
</td>
</tr>
</table>
</div>
<p class="p_Text"><span class="f_Text">Although the two timestamps are 24 hours apart, which implies getting 25 elements in the array (remember that the beginning and end are processed inclusively), the result contains only 4 bars. The fact is that September 5th falls on a Sunday, and therefore, out of the entire range, trading was carried out only in the morning hours of the 6th.</span></p>
<p class="p_Text"><span class="f_Text">Also, note that the receiving array has been automatically reduced in size from 10 to 4 elements.</span></p>
<p class="p_Text"><span class="f_Text">Finally, we will request 10 bars, starting from the 100th bar (the results obtained will depend on your current time and available history).</span></p>
<div style="text-align: left; text-indent: 0; line-height: 1.0; page-break-inside: avoid; page-break-after: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0 0 0 0; margin: 2px 17px 2px 17px;"><table cellspacing="0" cellpadding="3" border="0" style="text-align: justify;border:none; border-spacing:0;">
<tr>
<td style="vertical-align:top; padding:3px; border:none"><p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #ff0000;">PRTF</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #0000ff;">CopyTime</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #008080;">&quot;EURUSD&quot;</span><span class="f_CodeExample">,&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">PERIOD_H1</span><span class="f_CodeExample">,&nbsp;</span><span class="f_CodeExample" style="color: #333333;">100</span><span class="f_CodeExample">,&nbsp;</span><span class="f_CodeExample" style="color: #333333;">10</span><span class="f_CodeExample">,&nbsp;</span><span class="f_CodeExample" style="color: #333333;">times</span><span class="f_CodeExample">));&nbsp;</span><span class="f_CodeExample" style="color: #808080;">//&nbsp;10&nbsp;/&nbsp;ok</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">ArrayPrint</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #333333;">times</span><span class="f_CodeExample">);</span>
<br><span class="f_CodeExample" style="color: #808080;">&nbsp;&nbsp;&nbsp;/*</span>
<br><span class="f_CodeExample" style="color: #808080;">&nbsp;&nbsp;&nbsp;[0]&nbsp;2021.10.04&nbsp;19:00&nbsp;2021.10.04&nbsp;18:00&nbsp;2021.10.04&nbsp;17:00&nbsp;2021.10.04&nbsp;16:00&nbsp;2021.10.04&nbsp;15:00</span>
<br><span class="f_CodeExample" style="color: #808080;">&nbsp;&nbsp;&nbsp;[5]&nbsp;2021.10.04&nbsp;14:00&nbsp;2021.10.04&nbsp;13:00&nbsp;2021.10.04&nbsp;12:00&nbsp;2021.10.04&nbsp;11:00&nbsp;2021.10.04&nbsp;10:00</span>
<br><span class="f_CodeExample" style="color: #808080;">&nbsp;&nbsp;&nbsp;*/</span>
<br><span class="f_CodeExample">}</span></p>
</td>
</tr>
</table>
</div>
<p class="p_Text"><span class="f_Text">Due to indexing as in a timeseries, the array is displayed in reverse chronological order.</span></p>

</div>

</body>
</html>
