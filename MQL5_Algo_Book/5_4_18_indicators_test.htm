<!DOCTYPE html>
<html>
  <head>
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
  <title>5.4.18 Testing indicators</title>
  <meta name="keywords" content="" />
  <link type="text/css" href="default.css" rel="stylesheet" />

   <script type="text/javascript" src="jquery.js"></script>
   <script type="text/javascript" src="helpman_settings.js"></script>
   <script type="text/javascript" src="helpman_topicinit.js"></script>


</head>

<body style="background-color:#FFFFFF; font-family:'Trebuchet MS',Tahoma,Arial,Helvetica,sans-serif; margin:0px;">



<table width="100%" height="49"  border="0" cellpadding="0" cellspacing="0" style="margin-top:0px; background-color:#1660af;">
  <tr>
    <td></td>
    <td valign="middle">
      <table style="margin-top:4px; margin-bottom:5px;" width="100%"  border="0" cellspacing="0" cellpadding="5">
        <tr valign="middle">
          <td class="nav">
<a class="h_m" href="index.htm">          MQL5 Programming for Traders </a> / <a class="h_m" href="part5.htm"> Part 5. Creating application programs </a> / <a class="h_m" href="5_4_indicators_make.htm"> 5.4 Creating custom indicators </a>/ 5.4.18 Testing indicators
          </td>
          <td width="70" align="right">
          <a href="5_4_17_indicators_newbars.htm"><img style="vertical-align:middle;" src="previous.png" alt="?????" width="27" height="27" border=0></a>&nbsp;
          <a href="5_4_19_indicators_limitations.htm"><img style="vertical-align:middle;" src="next.png" alt="??????" width="27" height="27" border="0"></a>
          </td>
        </tr>
      </table>
    </td>
    <td width="5"></td>
  </tr>
</table>



<div id="help">
<p class="p_H3"><span class="f_H3">5.4.18 Testing indicators</span></p>
<p class="p_Text"><span class="f_Text">The built-in MetaTrader 5 tester supports two types of MQL programs: Expert Advisors and Indicators. Indicators are always tested in the visual window. But this applies only to testing an isolated indicator. If the indicator is created and called from an Expert Advisor programmatically, then this Expert Advisor together with the indicator(s) can be tested without visualization, at the user's discretion. We will study the technology of using indicators from the MQL code in the next chapter. The same technology will be used for integration with Expert Advisors.</span></p>
<p class="p_Text"><span class="f_Text">At the same time, the indicator developer should pay attention to the fact that without visualization, the tester uses an accelerated calculation method for indicators called from Expert Advisors. The data is not calculated at every tick, but only when the relevant data is requested from indicator buffers (see the </span><span class="f_Text" style="font-style: italic;"><a href="5_5_4_indicators_copybuffer.htm" class="topiclink">CopyBuffer</a></span><span class="f_Text"> function).</span></p>
<p class="p_Text"><span class="f_Text">If the indicator has not yet been calculated on the current tick, it is calculated once at the first access to its data. If other requests are generated during the same tick, the calculated data is returned in the ready form. If the indicator buffers are not read on the current tick, it is not calculated. The on-demand calculation of indicators gives a significant acceleration in testing and optimization.</span></p>
<p class="p_Text"><span class="f_Text">If a certain indicator requires precise calculations and cannot skip ticks, MQL5 can instruct the tester to enable indicator recalculation on every tick. This is done with the following directive:</span></p>
<div style="text-align: left; text-indent: 0; line-height: 1.0; page-break-inside: avoid; page-break-after: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0 0 0 0; margin: 2px 17px 2px 17px;"><table cellspacing="0" cellpadding="3" border="0" style="text-align: justify;border:none; border-spacing:0;">
<tr>
<td style="vertical-align:top; padding:3px; border:none"><p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample" style="color: #0000ff;">#property</span><span class="f_CodeExample">&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">tester_everytick_calculate</span></p>
</td>
</tr>
</table>
</div>
<p class="p_Text"><span class="f_Text">The word </span><span class="f_Text" style="font-style: italic;">everytick</span><span class="f_Text"> in the directive refers specifically to the calculation of the indicator and does not affect the tick generation mode. In other words, ticks mean price changes generated by the tester, whether for every tick, for OHLC M1 prices, or for bar openings, and this tester setting remains in effect.</span></p>
<p class="p_Text"><span class="f_Text">For the indicators that we have considered in this chapter, this property is not critical. It should also be noted that it only applies to operations in the strategy tester. In the terminal, indicators always receive </span><span class="f_Text" style="font-style: italic;">OnCalculate</span><span class="f_Text"> events on each incoming tick (providing for the possibility to skip ticks if your calculations in </span><span class="f_Text" style="font-style: italic;">OnCalculate</span><span class="f_Text"> take too much time and fail to complete before a new tick arrives).</span></p>
<p class="p_Text"><span class="f_Text">As for the tester, the indicators are calculated on each tick under any of the following conditions:</span></p>
<ul style="list-style-type:disc">
<li class="p_li"><span class="f_li">In visual mode</span></li>
<li class="p_li"><span class="f_li">If there is the </span><span class="f_li" style="font-style: italic;">tester_everytick_calculate</span><span class="f_li"> directive</span></li>
<li class="p_li"><span class="f_li">If they have the </span><span class="f_li" style="font-style: italic;"><a href="5_9_7_events_custom.htm" class="topiclink">EventChartCustom</a></span><span class="f_li"> call or the </span><span class="f_li" style="font-style: italic;"><a href="5_9_1_events_onchartevent.htm" class="topiclink">OnChartEvent</a></span><span class="f_li"> or </span><span class="f_li" style="font-style: italic;"><a href="5_6_2_timer_ontimer.htm" class="topiclink">OnTimer</a></span><span class="f_li"> functions</span></li>
</ul>
<p class="p_Text"><span class="f_Text">Let's try to test the </span><span class="f_Text" style="font-style: italic;">IndMultiSymbolMonitor.mq5</span><span class="f_Text"> indicator from the previous section.</span></p>
<p class="p_Text"><span class="f_Text">We select the main symbol and timeframe of the EURUSD, H1 chart. The tick generation method is &quot;based on real ticks&quot;.</span></p>
<p class="p_Text"><span class="f_Text">After starting the test, we should see the following entries in the log of the visual mode window:</span></p>
<div style="text-align: left; text-indent: 0; line-height: 1.0; page-break-inside: avoid; page-break-after: avoid; border-color: #d8dfea; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0 0 0 0; margin: 2px 17px 2px 17px;"><table cellspacing="0" cellpadding="3" border="0" style="text-align: justify;border:none; border-spacing:0;">
<tr>
<td style="vertical-align:top; padding:3px; border:none"><p class="p_CodeExampleCondensed" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExampleCondensed">2021.10.20&nbsp;00:00:00&nbsp;&nbsp;&nbsp;New&nbsp;bar(s)&nbsp;on:&nbsp;EURUSD&nbsp;USDCHF&nbsp;USDJPY&nbsp;,&nbsp;in-sync:false</span></p>
<p class="p_CodeExampleCondensed" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExampleCondensed">2021.10.20&nbsp;00:00:00&nbsp;&nbsp;&nbsp;New&nbsp;bar(s)&nbsp;on:&nbsp;AUDUSD&nbsp;,&nbsp;in-sync:false</span></p>
<p class="p_CodeExampleCondensed" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExampleCondensed">2021.10.20&nbsp;00:00:00&nbsp;&nbsp;&nbsp;New&nbsp;bar(s)&nbsp;on:&nbsp;GBPUSD&nbsp;,&nbsp;in-sync:false</span></p>
<p class="p_CodeExampleCondensed" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExampleCondensed">2021.10.20&nbsp;00:00:02&nbsp;&nbsp;&nbsp;New&nbsp;bar(s)&nbsp;on:&nbsp;USDCAD&nbsp;,&nbsp;in-sync:false</span></p>
<p class="p_CodeExampleCondensed" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExampleCondensed">2021.10.20&nbsp;00:00:11&nbsp;&nbsp;&nbsp;New&nbsp;bar(s)&nbsp;on:&nbsp;NZDUSD&nbsp;,&nbsp;in-sync:true</span></p>
<p class="p_CodeExampleCondensed" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExampleCondensed">2021.10.20&nbsp;01:00:04&nbsp;&nbsp;&nbsp;New&nbsp;bar(s)&nbsp;on:&nbsp;EURUSD&nbsp;GBPUSD&nbsp;USDCHF&nbsp;USDJPY&nbsp;AUDUSD&nbsp;USDCAD&nbsp;NZDUSD&nbsp;,&nbsp;in-sync:true</span></p>
<p class="p_CodeExampleCondensed" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExampleCondensed">2021.10.20&nbsp;02:00:00&nbsp;&nbsp;&nbsp;New&nbsp;bar(s)&nbsp;on:&nbsp;EURUSD&nbsp;USDJPY&nbsp;NZDUSD&nbsp;,&nbsp;in-sync:false</span></p>
<p class="p_CodeExampleCondensed" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExampleCondensed">2021.10.20&nbsp;02:00:00&nbsp;&nbsp;&nbsp;New&nbsp;bar(s)&nbsp;on:&nbsp;USDCHF&nbsp;,&nbsp;in-sync:false</span></p>
<p class="p_CodeExampleCondensed" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExampleCondensed">2021.10.20&nbsp;02:00:01&nbsp;&nbsp;&nbsp;New&nbsp;bar(s)&nbsp;on:&nbsp;AUDUSD&nbsp;,&nbsp;in-sync:false</span></p>
<p class="p_CodeExampleCondensed" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExampleCondensed">2021.10.20&nbsp;02:00:15&nbsp;&nbsp;&nbsp;New&nbsp;bar(s)&nbsp;on:&nbsp;GBPUSD&nbsp;USDCAD&nbsp;,&nbsp;in-sync:true</span></p>
<p class="p_CodeExampleCondensed" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExampleCondensed">2021.10.20&nbsp;03:00:00&nbsp;&nbsp;&nbsp;New&nbsp;bar(s)&nbsp;on:&nbsp;EURUSD&nbsp;AUDUSD&nbsp;NZDUSD&nbsp;,&nbsp;in-sync:false</span></p>
<p class="p_CodeExampleCondensed" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExampleCondensed">2021.10.20&nbsp;03:00:00&nbsp;&nbsp;&nbsp;New&nbsp;bar(s)&nbsp;on:&nbsp;GBPUSD&nbsp;USDJPY&nbsp;USDCAD&nbsp;,&nbsp;in-sync:false</span></p>
<p class="p_CodeExampleCondensed" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExampleCondensed">2021.10.20&nbsp;03:00:12&nbsp;&nbsp;&nbsp;New&nbsp;bar(s)&nbsp;on:&nbsp;USDCHF&nbsp;,&nbsp;in-sync:true</span></p>
</td>
</tr>
</table>
</div>
<p class="p_Text"><span class="f_Text">As you can see, new bars appear on different symbols gradually. Usually, several events occur before the &quot;in-sync&quot; flag set to </span><span class="f_Text" style="font-style: italic;">true</span><span class="f_Text"> appears.</span></p>
<p class="p_Text"><span class="f_Text">You can run testing for other indicators of this chapter as well. Please note that if an MQL program queries the history of ticks, select the generation method &quot;based on real ticks&quot; in the tester.</span></p>
<p class="p_Text"><span class="f_Text">Testing &quot;by open prices&quot; can only be used for indicators and Expert Advisors that are developed with support for this mode, for example, they calculate only by </span><span class="f_Text" style="font-style: italic;">Open</span><span class="f_Text"> prices or analyze completed bars starting from the 1st one.</span></p>
<p class="p_Quote"><span class="f_Quote">Attention! When testing indicators in the tester, the </span><span class="f_Quote" style="font-style: italic;">OnDeinit</span><span class="f_Quote"> event does not work. Moreover, other finalization is not performed, for example, destructors of global objects are not called.</span></p>

</div>

</body>
</html>
